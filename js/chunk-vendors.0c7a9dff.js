(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00ee":function(e,t,n){var r=n("b622"),i=r("toStringTag"),a={};a[i]="z",e.exports="[object z]"===String(a)},"0366":function(e,t,n){var r=n("1c0b");e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},"045f":function(e,t,n){"use strict";var r=n("be09"),i=n("a559"),a=n("8362"),o=function(e){var t={};return e?(e.trim().split("\n").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n).trim().toLowerCase(),i=e.slice(n+1).trim();"undefined"===typeof t[r]?t[r]=i:Array.isArray(t[r])?t[r].push(i):t[r]=[t[r],i]})),t):t};function s(e,t){for(var n=0;n<e.length;n++)t(e[n])}function u(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function c(e,t,n){var r=e;return a(t)?(n=t,"string"===typeof e&&(r={uri:e})):r=i({},t,{uri:e}),r.callback=n,r}function l(e,t,n){return t=c(e,t,n),d(t)}function d(e){if("undefined"===typeof e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,i){t||(t=!0,e.callback(n,r,i))};function r(){4===h.readyState&&setTimeout(s,0)}function i(){var e=void 0;if(e=h.response?h.response:h.responseText||p(h),_)try{e=JSON.parse(e)}catch(t){}return e}function a(e){return clearTimeout(f),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,w)}function s(){if(!d){var t;clearTimeout(f),t=e.useXDR&&void 0===h.status?200:1223===h.status?204:h.status;var r=w,a=null;return 0!==t?(r={body:i(),statusCode:t,method:v,headers:{},url:m,rawRequest:h},h.getAllResponseHeaders&&(r.headers=o(h.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,r,r.body)}}var c,d,h=e.xhr||null;h||(h=e.cors||e.useXDR?new l.XDomainRequest:new l.XMLHttpRequest);var f,m=h.url=e.uri||e.url,v=h.method=e.method||"GET",g=e.body||e.data,y=h.headers=e.headers||{},b=!!e.sync,_=!1,w={body:void 0,headers:{},statusCode:0,method:v,url:m,rawRequest:h};if("json"in e&&!1!==e.json&&(_=!0,y["accept"]||y["Accept"]||(y["Accept"]="application/json"),"GET"!==v&&"HEAD"!==v&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),g=JSON.stringify(!0===e.json?g:e.json))),h.onreadystatechange=r,h.onload=s,h.onerror=a,h.onprogress=function(){},h.onabort=function(){d=!0},h.ontimeout=a,h.open(v,m,!b,e.username,e.password),b||(h.withCredentials=!!e.withCredentials),!b&&e.timeout>0&&(f=setTimeout((function(){if(!d){d=!0,h.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",a(e)}}),e.timeout)),h.setRequestHeader)for(c in y)y.hasOwnProperty(c)&&h.setRequestHeader(c,y[c]);else if(e.headers&&!u(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(h.responseType=e.responseType),"beforeSend"in e&&"function"===typeof e.beforeSend&&e.beforeSend(h),h.send(g||null),h}function p(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(n){}return null}function h(){}e.exports=l,e.exports.default=l,l.XMLHttpRequest=r.XMLHttpRequest||h,l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:r.XDomainRequest,s(["get","put","post","patch","head","delete"],(function(e){l["delete"===e?"del":e]=function(t,n,r){return n=c(t,n,r),n.method=e.toUpperCase(),d(n)}}))},"04b8":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},"0538":function(e,t,n){"use strict";var r=n("1c0b"),i=n("861d"),a=[].slice,o={},s=function(e,t,n){if(!(t in o)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";o[t]=Function("C,a","return new C("+r.join(",")+")")}return o[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),o=function(){var r=n.concat(a.call(arguments));return this instanceof o?s(t,r.length,r):t.apply(e,r)};return i(t.prototype)&&(o.prototype=t.prototype),o}},"057f":function(e,t,n){var r=n("fc6a"),i=n("241c").f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return i(e)}catch(t){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?s(e):i(r(e))}},"06cf":function(e,t,n){var r=n("83ab"),i=n("d1e7"),a=n("5c6c"),o=n("fc6a"),s=n("c04e"),u=n("5135"),c=n("0cfb"),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=o(e),t=s(t,!0),c)try{return l(e,t)}catch(n){}if(u(e,t))return a(!i.f.call(e,t),e[t])}},"0cfb":function(e,t,n){var r=n("83ab"),i=n("d039"),a=n("cc12");e.exports=!r&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},"113e":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},"19aa":function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},"1be4":function(e,t,n){var r=n("d066");e.exports=r("document","documentElement")},"1c0b":function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},"1c7e":function(e,t,n){var r=n("b622"),i=r("iterator"),a=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){a=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(u){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(u){}return n}},"1cdc":function(e,t,n){var r=n("342f");e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(r)},"1d80":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e}},"1da1":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("d3b7");function r(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)}))}}},"1fb5":function(e,t,n){"use strict";t.byteLength=l,t.toByteArray=p,t.fromByteArray=m;for(var r=[],i=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function l(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r}function d(e,t,n){return 3*(t+n)/4-n}function p(e){var t,n,r=c(e),o=r[0],s=r[1],u=new a(d(e,o,s)),l=0,p=s>0?o-4:o;for(n=0;n<p;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),i.push(h(r));return i.join("")}function m(e){for(var t,n=e.length,i=n%3,a=[],o=16383,s=0,u=n-i;s<u;s+=o)a.push(f(e,s,s+o>u?u:s+o));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},2266:function(e,t,n){var r=n("825a"),i=n("e95a"),a=n("50c4"),o=n("0366"),s=n("35a1"),u=n("9bdd"),c=function(e,t){this.stopped=e,this.result=t},l=e.exports=function(e,t,n,l,d){var p,h,f,m,v,g,y,b=o(t,n,l?2:1);if(d)p=e;else{if(h=s(e),"function"!=typeof h)throw TypeError("Target is not iterable");if(i(h)){for(f=0,m=a(e.length);m>f;f++)if(v=l?b(r(y=e[f])[0],y[1]):b(e[f]),v&&v instanceof c)return v;return new c(!1)}p=h.call(e)}g=p.next;while(!(y=g.call(p)).done)if(v=u(p,b,y.value,l),"object"==typeof v&&v&&v instanceof c)return v;return new c(!1)};l.stop=function(e){return new c(!0,e)}},"23cb":function(e,t,n){var r=n("a691"),i=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):a(n,t)}},"23e7":function(e,t,n){var r=n("da84"),i=n("06cf").f,a=n("9112"),o=n("6eeb"),s=n("ce4e"),u=n("e893"),c=n("94ca");e.exports=function(e,t){var n,l,d,p,h,f,m=e.target,v=e.global,g=e.stat;if(l=v?r:g?r[m]||s(m,{}):(r[m]||{}).prototype,l)for(d in t){if(h=t[d],e.noTargetGet?(f=i(l,d),p=f&&f.value):p=l[d],n=c(v?d:m+(g?".":"#")+d,e.forced),!n&&void 0!==p){if(typeof h===typeof p)continue;u(h,p)}(e.sham||p&&p.sham)&&a(h,"sham",!0),o(l,d,h,e)}}},"241c":function(e,t,n){var r=n("ca84"),i=n("7839"),a=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,a)}},"256f":function(e,t,n){"use strict";var r=n("4329"),i=8589934592,a=4294967296,o="shared",s=function(e,t){var n=1;e>t&&(n=-1);while(Math.abs(t-e)>a)e+=n*i;return e},u=function(e){var t,n;u.prototype.init.call(this),this.type_=e||o,this.push=function(e){this.type_!==o&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=s(e.dts,n),e.pts=s(e.pts,n),t=e.dts,this.trigger("data",e))},this.flush=function(){n=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,t=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};u.prototype=new r,e.exports={TimestampRolloverStream:u,handleRollover:s}},"25f0":function(e,t,n){"use strict";var r=n("6eeb"),i=n("825a"),a=n("d039"),o=n("ad6d"),s="toString",u=RegExp.prototype,c=u[s],l=a((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=s;(l||d)&&r(RegExp.prototype,s,(function(){var e=i(this),t=String(e.source),n=e.flags,r=String(void 0===n&&e instanceof RegExp&&!("flags"in u)?o.call(e):n);return"/"+t+"/"+r}),{unsafe:!0})},2626:function(e,t,n){"use strict";var r=n("d066"),i=n("9bf2"),a=n("b622"),o=n("83ab"),s=a("species");e.exports=function(e){var t=r(e),n=i.f;o&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},2806:function(e,t,n){"use strict";var r,i,a,o,s,u=n("7fe1").toUnsigned,c=n("7fe1").toHexString,l=n("9afa");r=function(e){var t={},n=l.findBox(e,["moov","trak"]);return n.reduce((function(e,t){var n,r,i,a,o;return n=l.findBox(t,["tkhd"])[0],n?(r=n[0],i=0===r?12:20,a=u(n[i]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),o=l.findBox(t,["mdia","mdhd"])[0],o?(r=o[0],i=0===r?12:20,e[a]=u(o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3]),e):null):null}),t)},i=function(e,t){var n,r,i;return n=l.findBox(t,["moof","traf"]),r=[].concat.apply([],n.map((function(t){return l.findBox(t,["tfhd"]).map((function(n){var r,i,a;return r=u(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i=e[r]||9e4,a=l.findBox(t,["tfdt"]).map((function(e){var t,n;return t=e[0],n=u(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=u(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n}))[0],a=a||1/0,a/i}))}))),i=Math.min.apply(null,r),isFinite(i)?i:0},a=function(e,t){var n,r=l.findBox(t,["moof","traf"]),i=0,a=0;if(r&&r.length)for(var o=l.parseTraf(r[0]),s=0;s<o.boxes.length;s++)"tfhd"===o.boxes[s].type?n=o.boxes[s].trackId:"tfdt"===o.boxes[s].type?i=o.boxes[s].baseMediaDecodeTime:"trun"===o.boxes[s].type&&o.boxes[s].samples.length&&(a=o.boxes[s].samples[0].compositionTimeOffset||0);var u=e[n]||9e4;return(i+a)/u},o=function(e){var t=l.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t=l.findBox(e,["mdia","hdlr"]),r=l.findBox(e,["tkhd"]);t.forEach((function(e,t){var i,a,o,s=l.parseType(e.subarray(8,12)),u=r[t];"vide"===s&&(i=new DataView(u.buffer,u.byteOffset,u.byteLength),a=i.getUint8(0),o=0===a?i.getUint32(12):i.getUint32(20),n.push(o))}))})),n},s=function(e){var t=l.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t,r,i={},a=l.findBox(e,["tkhd"])[0];a&&(t=new DataView(a.buffer,a.byteOffset,a.byteLength),r=t.getUint8(0),i.id=0===r?t.getUint32(12):t.getUint32(20));var o=l.findBox(e,["mdia","hdlr"])[0];if(o){var s=l.parseType(o.subarray(8,12));i.type="vide"===s?"video":"soun"===s?"audio":s}var d=l.findBox(e,["mdia","minf","stbl","stsd"])[0];if(d){var p=d.subarray(8);i.codec=l.parseType(p.subarray(4,8));var h,f,m=l.findBox(p,[i.codec])[0];m&&(/^[a-z]vc[1-9]$/i.test(i.codec)?(h=m.subarray(78),f=l.parseType(h.subarray(4,8)),"avcC"===f&&h.length>11?(i.codec+=".",i.codec+=c(h[9]),i.codec+=c(h[10]),i.codec+=c(h[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)&&(h=m.subarray(28),f=l.parseType(h.subarray(4,8)),"esds"===f&&h.length>20&&0!==h[19]?(i.codec+="."+c(h[19]),i.codec+="."+c(h[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"))}var v=l.findBox(e,["mdia","mdhd"])[0];if(v&&a){var g=0===r?12:20;i.timescale=u(v[g]<<24|v[g+1]<<16|v[g+2]<<8|v[g+3])}n.push(i)})),n},e.exports={findBox:l.findBox,parseType:l.parseType,timescale:r,startTime:i,compositionStartTime:a,videoTrackIds:o,tracks:s}},"282b":function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){var t=e.split("\nm=");return t.map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1];break}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){var n=r.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:n.map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){var n=r.matchPrefix(e+t,"a=crypto:");return n.map(r.parseCryptoLine)},r.getIceParameters=function(e,t){var n=r.matchPrefix(e+t,"a=ice-ufrag:")[0],i=r.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),a=3;a<i.length;a++){var o=i[a],s=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var u=r.parseRtpMap(s),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(u.parameters=c.length?r.parseFmtp(c[0]):{},u.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(u.name.toUpperCase());break;default:break}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),u=s.length>0&&s[0].ssrc,c=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){var t=e.substr(17).split(" ");return t.map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===u&&(t=c[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10)};u&&t&&(r.rtx={ssrc:t}),n.push(r),a&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:u,mechanism:o?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&u&&n.push({ssrc:u});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var a=r.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return t=n[0].substr(7).split(" "),{stream:t[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?(t=i[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var a=r.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};var o=r.matchPrefix(e,"a=sctpmap:");if(o.length>0){var s=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i,a=void 0!==t?t:2;i=e||r.generateSessionId();var o=n||"thisisadapterortc";return"v=0\r\no="+o+" "+i+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+o,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2);default:}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){var t=r.splitLines(e),n=t[0].split(" ");return n[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e),n=t[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0],n=t.substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},r.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},e.exports=r},2877:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o,s){var u,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),o?(u=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=u):i&&(u=s?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(e,t){return u.call(t),l(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,u):[u]}return{exports:e,options:c}}n.d(t,"a",(function(){return r}))},"29d8":function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(e,t,n){if(!e){if(t instanceof a)return t;e=t}var r={},i=e instanceof Function;function o(t){var a=e[t];!a&&i&&(a=2==e.length?function(n){e(t,n)}:e),r[t]=a&&function(e){a("[xmldom "+t+"]\t"+e+s(n))}||function(){}}return n=n||{},o("warning"),o("error"),o("fatalError"),r}function a(){this.cdata=!1}function o(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function s(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function u(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function c(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new l,o=n.domBuilder||new a,s=n.errorHandler,u=n.locator,c=n.xmlns||{},d={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&o.setDocumentLocator(u),r.errorHandler=i(s,o,u),r.domBuilder=n.domBuilder||o,/\/x?html?$/.test(t)&&(d.nbsp=" ",d.copy="©",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",e?r.parse(e,c,d):r.errorHandler.error("invalid doc source"),o.doc},a.prototype={startDocument:function(){this.doc=(new d).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,a=i.createElementNS(e,n||t),s=r.length;c(this,a),this.currentElement=a,this.locator&&o(this.locator,a);for(var u=0;u<s;u++){e=r.getURI(u);var l=r.getValue(u),d=(n=r.getQName(u),i.createAttributeNS(e,n));this.locator&&o(r.getLocator(u),d),d.value=d.nodeValue=l,a.setAttributeNode(d)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&o(this.locator,n),c(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=u.apply(this,arguments),e){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&o(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=u.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&o(this.locator,r),c(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&o(this.locator,i),c(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,s(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,s(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,s(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){a.prototype[e]=function(){return null}}));var l=n("d61d").XMLReader,d=t.DOMImplementation=n("749c").DOMImplementation;t.XMLSerializer=n("749c").XMLSerializer,t.DOMParser=r},"29d85":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},"2b0e":function(e,t,n){"use strict";(function(e){
/*!
 * Vue.js v2.6.11
 * (c) 2014-2019 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function r(e){return void 0===e||null===e}function i(e){return void 0!==e&&null!==e}function a(e){return!0===e}function o(e){return!1===e}function s(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function u(e){return null!==e&&"object"===typeof e}var c=Object.prototype.toString;function l(e){return"[object Object]"===c.call(e)}function d(e){return"[object RegExp]"===c.call(e)}function p(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function h(e){return i(e)&&"function"===typeof e.then&&"function"===typeof e.catch}function f(e){return null==e?"":Array.isArray(e)||l(e)&&e.toString===c?JSON.stringify(e,null,2):String(e)}function m(e){var t=parseFloat(e);return isNaN(t)?e:t}function v(e,t){for(var n=Object.create(null),r=e.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}v("slot,component",!0);var g=v("key,ref,slot,slot-scope,is");function y(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var b=Object.prototype.hasOwnProperty;function _(e,t){return b.call(e,t)}function w(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}var x=/-(\w)/g,T=w((function(e){return e.replace(x,(function(e,t){return t?t.toUpperCase():""}))})),C=w((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),S=/\B([A-Z])/g,E=w((function(e){return e.replace(S,"-$1").toLowerCase()}));function k(e,t){function n(n){var r=arguments.length;return r?r>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n}function R(e,t){return e.bind(t)}var O=Function.prototype.bind?R:k;function A(e,t){t=t||0;var n=e.length-t,r=new Array(n);while(n--)r[n]=e[n+t];return r}function I(e,t){for(var n in t)e[n]=t[n];return e}function N(e){for(var t={},n=0;n<e.length;n++)e[n]&&I(t,e[n]);return t}function D(e,t,n){}var P=function(e,t,n){return!1},M=function(e){return e};function L(e,t){if(e===t)return!0;var n=u(e),r=u(t);if(!n||!r)return!n&&!r&&String(e)===String(t);try{var i=Array.isArray(e),a=Array.isArray(t);if(i&&a)return e.length===t.length&&e.every((function(e,n){return L(e,t[n])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(i||a)return!1;var o=Object.keys(e),s=Object.keys(t);return o.length===s.length&&o.every((function(n){return L(e[n],t[n])}))}catch(c){return!1}}function j(e,t){for(var n=0;n<e.length;n++)if(L(e[n],t))return n;return-1}function B(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var U="data-server-rendered",F=["component","directive","filter"],V=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],q={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:P,isReservedAttr:P,isUnknownElement:P,getTagNamespace:D,parsePlatformTagName:M,mustUseProp:P,async:!0,_lifecycleHooks:V},W=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function z(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function G(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var H=new RegExp("[^"+W.source+".$_\\d]");function $(e){if(!H.test(e)){var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}}var K,Y="__proto__"in{},X="undefined"!==typeof window,J="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,Q=J&&WXEnvironment.platform.toLowerCase(),Z=X&&window.navigator.userAgent.toLowerCase(),ee=Z&&/msie|trident/.test(Z),te=Z&&Z.indexOf("msie 9.0")>0,ne=Z&&Z.indexOf("edge/")>0,re=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===Q),ie=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),ae={}.watch,oe=!1;if(X)try{var se={};Object.defineProperty(se,"passive",{get:function(){oe=!0}}),window.addEventListener("test-passive",null,se)}catch(To){}var ue=function(){return void 0===K&&(K=!X&&!J&&"undefined"!==typeof e&&(e["process"]&&"server"===e["process"].env.VUE_ENV)),K},ce=X&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function le(e){return"function"===typeof e&&/native code/.test(e.toString())}var de,pe="undefined"!==typeof Symbol&&le(Symbol)&&"undefined"!==typeof Reflect&&le(Reflect.ownKeys);de="undefined"!==typeof Set&&le(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var he=D,fe=0,me=function(){this.id=fe++,this.subs=[]};me.prototype.addSub=function(e){this.subs.push(e)},me.prototype.removeSub=function(e){y(this.subs,e)},me.prototype.depend=function(){me.target&&me.target.addDep(this)},me.prototype.notify=function(){var e=this.subs.slice();for(var t=0,n=e.length;t<n;t++)e[t].update()},me.target=null;var ve=[];function ge(e){ve.push(e),me.target=e}function ye(){ve.pop(),me.target=ve[ve.length-1]}var be=function(e,t,n,r,i,a,o,s){this.tag=e,this.data=t,this.children=n,this.text=r,this.elm=i,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},_e={child:{configurable:!0}};_e.child.get=function(){return this.componentInstance},Object.defineProperties(be.prototype,_e);var we=function(e){void 0===e&&(e="");var t=new be;return t.text=e,t.isComment=!0,t};function xe(e){return new be(void 0,void 0,void 0,String(e))}function Te(e){var t=new be(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var Ce=Array.prototype,Se=Object.create(Ce),Ee=["push","pop","shift","unshift","splice","sort","reverse"];Ee.forEach((function(e){var t=Ce[e];G(Se,e,(function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];var i,a=t.apply(this,n),o=this.__ob__;switch(e){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2);break}return i&&o.observeArray(i),o.dep.notify(),a}))}));var ke=Object.getOwnPropertyNames(Se),Re=!0;function Oe(e){Re=e}var Ae=function(e){this.value=e,this.dep=new me,this.vmCount=0,G(e,"__ob__",this),Array.isArray(e)?(Y?Ie(e,Se):Ne(e,Se,ke),this.observeArray(e)):this.walk(e)};function Ie(e,t){e.__proto__=t}function Ne(e,t,n){for(var r=0,i=n.length;r<i;r++){var a=n[r];G(e,a,t[a])}}function De(e,t){var n;if(u(e)&&!(e instanceof be))return _(e,"__ob__")&&e.__ob__ instanceof Ae?n=e.__ob__:Re&&!ue()&&(Array.isArray(e)||l(e))&&Object.isExtensible(e)&&!e._isVue&&(n=new Ae(e)),t&&n&&n.vmCount++,n}function Pe(e,t,n,r,i){var a=new me,o=Object.getOwnPropertyDescriptor(e,t);if(!o||!1!==o.configurable){var s=o&&o.get,u=o&&o.set;s&&!u||2!==arguments.length||(n=e[t]);var c=!i&&De(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=s?s.call(e):n;return me.target&&(a.depend(),c&&(c.dep.depend(),Array.isArray(t)&&je(t))),t},set:function(t){var r=s?s.call(e):n;t===r||t!==t&&r!==r||s&&!u||(u?u.call(e,t):n=t,c=!i&&De(t),a.notify())}})}}function Me(e,t,n){if(Array.isArray(e)&&p(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var r=e.__ob__;return e._isVue||r&&r.vmCount?n:r?(Pe(r.value,t,n),r.dep.notify(),n):(e[t]=n,n)}function Le(e,t){if(Array.isArray(e)&&p(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||_(e,t)&&(delete e[t],n&&n.dep.notify())}}function je(e){for(var t=void 0,n=0,r=e.length;n<r;n++)t=e[n],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&je(t)}Ae.prototype.walk=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)Pe(e,t[n])},Ae.prototype.observeArray=function(e){for(var t=0,n=e.length;t<n;t++)De(e[t])};var Be=q.optionMergeStrategies;function Ue(e,t){if(!t)return e;for(var n,r,i,a=pe?Reflect.ownKeys(t):Object.keys(t),o=0;o<a.length;o++)n=a[o],"__ob__"!==n&&(r=e[n],i=t[n],_(e,n)?r!==i&&l(r)&&l(i)&&Ue(r,i):Me(e,n,i));return e}function Fe(e,t,n){return n?function(){var r="function"===typeof t?t.call(n,n):t,i="function"===typeof e?e.call(n,n):e;return r?Ue(r,i):i}:t?e?function(){return Ue("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function Ve(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?qe(n):n}function qe(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}function We(e,t,n,r){var i=Object.create(e||null);return t?I(i,t):i}Be.data=function(e,t,n){return n?Fe(e,t,n):t&&"function"!==typeof t?e:Fe(e,t)},V.forEach((function(e){Be[e]=Ve})),F.forEach((function(e){Be[e+"s"]=We})),Be.watch=function(e,t,n,r){if(e===ae&&(e=void 0),t===ae&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var i={};for(var a in I(i,e),t){var o=i[a],s=t[a];o&&!Array.isArray(o)&&(o=[o]),i[a]=o?o.concat(s):Array.isArray(s)?s:[s]}return i},Be.props=Be.methods=Be.inject=Be.computed=function(e,t,n,r){if(!e)return t;var i=Object.create(null);return I(i,e),t&&I(i,t),i},Be.provide=Fe;var ze=function(e,t){return void 0===t?e:t};function Ge(e,t){var n=e.props;if(n){var r,i,a,o={};if(Array.isArray(n)){r=n.length;while(r--)i=n[r],"string"===typeof i&&(a=T(i),o[a]={type:null})}else if(l(n))for(var s in n)i=n[s],a=T(s),o[a]=l(i)?i:{type:i};else 0;e.props=o}}function He(e,t){var n=e.inject;if(n){var r=e.inject={};if(Array.isArray(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(l(n))for(var a in n){var o=n[a];r[a]=l(o)?I({from:a},o):{from:o}}else 0}}function $e(e){var t=e.directives;if(t)for(var n in t){var r=t[n];"function"===typeof r&&(t[n]={bind:r,update:r})}}function Ke(e,t,n){if("function"===typeof t&&(t=t.options),Ge(t,n),He(t,n),$e(t),!t._base&&(t.extends&&(e=Ke(e,t.extends,n)),t.mixins))for(var r=0,i=t.mixins.length;r<i;r++)e=Ke(e,t.mixins[r],n);var a,o={};for(a in e)s(a);for(a in t)_(e,a)||s(a);function s(r){var i=Be[r]||ze;o[r]=i(e[r],t[r],n,r)}return o}function Ye(e,t,n,r){if("string"===typeof n){var i=e[t];if(_(i,n))return i[n];var a=T(n);if(_(i,a))return i[a];var o=C(a);if(_(i,o))return i[o];var s=i[n]||i[a]||i[o];return s}}function Xe(e,t,n,r){var i=t[e],a=!_(n,e),o=n[e],s=et(Boolean,i.type);if(s>-1)if(a&&!_(i,"default"))o=!1;else if(""===o||o===E(e)){var u=et(String,i.type);(u<0||s<u)&&(o=!0)}if(void 0===o){o=Je(r,i,e);var c=Re;Oe(!0),De(o),Oe(c)}return o}function Je(e,t,n){if(_(t,"default")){var r=t.default;return e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n]?e._props[n]:"function"===typeof r&&"Function"!==Qe(t.type)?r.call(e):r}}function Qe(e){var t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function Ze(e,t){return Qe(e)===Qe(t)}function et(e,t){if(!Array.isArray(t))return Ze(t,e)?0:-1;for(var n=0,r=t.length;n<r;n++)if(Ze(t[n],e))return n;return-1}function tt(e,t,n){ge();try{if(t){var r=t;while(r=r.$parent){var i=r.$options.errorCaptured;if(i)for(var a=0;a<i.length;a++)try{var o=!1===i[a].call(r,e,t,n);if(o)return}catch(To){rt(To,r,"errorCaptured hook")}}}rt(e,t,n)}finally{ye()}}function nt(e,t,n,r,i){var a;try{a=n?e.apply(t,n):e.call(t),a&&!a._isVue&&h(a)&&!a._handled&&(a.catch((function(e){return tt(e,r,i+" (Promise/async)")})),a._handled=!0)}catch(To){tt(To,r,i)}return a}function rt(e,t,n){if(q.errorHandler)try{return q.errorHandler.call(null,e,t,n)}catch(To){To!==e&&it(To,null,"config.errorHandler")}it(e,t,n)}function it(e,t,n){if(!X&&!J||"undefined"===typeof console)throw e;console.error(e)}var at,ot=!1,st=[],ut=!1;function ct(){ut=!1;var e=st.slice(0);st.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!==typeof Promise&&le(Promise)){var lt=Promise.resolve();at=function(){lt.then(ct),re&&setTimeout(D)},ot=!0}else if(ee||"undefined"===typeof MutationObserver||!le(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())at="undefined"!==typeof setImmediate&&le(setImmediate)?function(){setImmediate(ct)}:function(){setTimeout(ct,0)};else{var dt=1,pt=new MutationObserver(ct),ht=document.createTextNode(String(dt));pt.observe(ht,{characterData:!0}),at=function(){dt=(dt+1)%2,ht.data=String(dt)},ot=!0}function ft(e,t){var n;if(st.push((function(){if(e)try{e.call(t)}catch(To){tt(To,t,"nextTick")}else n&&n(t)})),ut||(ut=!0,at()),!e&&"undefined"!==typeof Promise)return new Promise((function(e){n=e}))}var mt=new de;function vt(e){gt(e,mt),mt.clear()}function gt(e,t){var n,r,i=Array.isArray(e);if(!(!i&&!u(e)||Object.isFrozen(e)||e instanceof be)){if(e.__ob__){var a=e.__ob__.dep.id;if(t.has(a))return;t.add(a)}if(i){n=e.length;while(n--)gt(e[n],t)}else{r=Object.keys(e),n=r.length;while(n--)gt(e[r[n]],t)}}}var yt=w((function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var n="~"===e.charAt(0);e=n?e.slice(1):e;var r="!"===e.charAt(0);return e=r?e.slice(1):e,{name:e,once:n,capture:r,passive:t}}));function bt(e,t){function n(){var e=arguments,r=n.fns;if(!Array.isArray(r))return nt(r,null,arguments,t,"v-on handler");for(var i=r.slice(),a=0;a<i.length;a++)nt(i[a],null,e,t,"v-on handler")}return n.fns=e,n}function _t(e,t,n,i,o,s){var u,c,l,d;for(u in e)c=e[u],l=t[u],d=yt(u),r(c)||(r(l)?(r(c.fns)&&(c=e[u]=bt(c,s)),a(d.once)&&(c=e[u]=o(d.name,c,d.capture)),n(d.name,c,d.capture,d.passive,d.params)):c!==l&&(l.fns=c,e[u]=l));for(u in t)r(e[u])&&(d=yt(u),i(d.name,t[u],d.capture))}function wt(e,t,n){var o;e instanceof be&&(e=e.data.hook||(e.data.hook={}));var s=e[t];function u(){n.apply(this,arguments),y(o.fns,u)}r(s)?o=bt([u]):i(s.fns)&&a(s.merged)?(o=s,o.fns.push(u)):o=bt([s,u]),o.merged=!0,e[t]=o}function xt(e,t,n){var a=t.options.props;if(!r(a)){var o={},s=e.attrs,u=e.props;if(i(s)||i(u))for(var c in a){var l=E(c);Tt(o,u,c,l,!0)||Tt(o,s,c,l,!1)}return o}}function Tt(e,t,n,r,a){if(i(t)){if(_(t,n))return e[n]=t[n],a||delete t[n],!0;if(_(t,r))return e[n]=t[r],a||delete t[r],!0}return!1}function Ct(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}function St(e){return s(e)?[xe(e)]:Array.isArray(e)?kt(e):void 0}function Et(e){return i(e)&&i(e.text)&&o(e.isComment)}function kt(e,t){var n,o,u,c,l=[];for(n=0;n<e.length;n++)o=e[n],r(o)||"boolean"===typeof o||(u=l.length-1,c=l[u],Array.isArray(o)?o.length>0&&(o=kt(o,(t||"")+"_"+n),Et(o[0])&&Et(c)&&(l[u]=xe(c.text+o[0].text),o.shift()),l.push.apply(l,o)):s(o)?Et(c)?l[u]=xe(c.text+o):""!==o&&l.push(xe(o)):Et(o)&&Et(c)?l[u]=xe(c.text+o.text):(a(e._isVList)&&i(o.tag)&&r(o.key)&&i(t)&&(o.key="__vlist"+t+"_"+n+"__"),l.push(o)));return l}function Rt(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function Ot(e){var t=At(e.$options.inject,e);t&&(Oe(!1),Object.keys(t).forEach((function(n){Pe(e,n,t[n])})),Oe(!0))}function At(e,t){if(e){for(var n=Object.create(null),r=pe?Reflect.ownKeys(e):Object.keys(e),i=0;i<r.length;i++){var a=r[i];if("__ob__"!==a){var o=e[a].from,s=t;while(s){if(s._provided&&_(s._provided,o)){n[a]=s._provided[o];break}s=s.$parent}if(!s)if("default"in e[a]){var u=e[a].default;n[a]="function"===typeof u?u.call(t):u}else 0}}return n}}function It(e,t){if(!e||!e.length)return{};for(var n={},r=0,i=e.length;r<i;r++){var a=e[r],o=a.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,a.context!==t&&a.fnContext!==t||!o||null==o.slot)(n.default||(n.default=[])).push(a);else{var s=o.slot,u=n[s]||(n[s]=[]);"template"===a.tag?u.push.apply(u,a.children||[]):u.push(a)}}for(var c in n)n[c].every(Nt)&&delete n[c];return n}function Nt(e){return e.isComment&&!e.asyncFactory||" "===e.text}function Dt(e,t,r){var i,a=Object.keys(t).length>0,o=e?!!e.$stable:!a,s=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(o&&r&&r!==n&&s===r.$key&&!a&&!r.$hasNormal)return r;for(var u in i={},e)e[u]&&"$"!==u[0]&&(i[u]=Pt(t,u,e[u]))}else i={};for(var c in t)c in i||(i[c]=Mt(t,c));return e&&Object.isExtensible(e)&&(e._normalized=i),G(i,"$stable",o),G(i,"$key",s),G(i,"$hasNormal",a),i}function Pt(e,t,n){var r=function(){var e=arguments.length?n.apply(null,arguments):n({});return e=e&&"object"===typeof e&&!Array.isArray(e)?[e]:St(e),e&&(0===e.length||1===e.length&&e[0].isComment)?void 0:e};return n.proxy&&Object.defineProperty(e,t,{get:r,enumerable:!0,configurable:!0}),r}function Mt(e,t){return function(){return e[t]}}function Lt(e,t){var n,r,a,o,s;if(Array.isArray(e)||"string"===typeof e)for(n=new Array(e.length),r=0,a=e.length;r<a;r++)n[r]=t(e[r],r);else if("number"===typeof e)for(n=new Array(e),r=0;r<e;r++)n[r]=t(r+1,r);else if(u(e))if(pe&&e[Symbol.iterator]){n=[];var c=e[Symbol.iterator](),l=c.next();while(!l.done)n.push(t(l.value,n.length)),l=c.next()}else for(o=Object.keys(e),n=new Array(o.length),r=0,a=o.length;r<a;r++)s=o[r],n[r]=t(e[s],s,r);return i(n)||(n=[]),n._isVList=!0,n}function jt(e,t,n,r){var i,a=this.$scopedSlots[e];a?(n=n||{},r&&(n=I(I({},r),n)),i=a(n)||t):i=this.$slots[e]||t;var o=n&&n.slot;return o?this.$createElement("template",{slot:o},i):i}function Bt(e){return Ye(this.$options,"filters",e,!0)||M}function Ut(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function Ft(e,t,n,r,i){var a=q.keyCodes[t]||n;return i&&r&&!q.keyCodes[t]?Ut(i,r):a?Ut(a,e):r?E(r)!==t:void 0}function Vt(e,t,n,r,i){if(n)if(u(n)){var a;Array.isArray(n)&&(n=N(n));var o=function(o){if("class"===o||"style"===o||g(o))a=e;else{var s=e.attrs&&e.attrs.type;a=r||q.mustUseProp(t,s,o)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var u=T(o),c=E(o);if(!(u in a)&&!(c in a)&&(a[o]=n[o],i)){var l=e.on||(e.on={});l["update:"+o]=function(e){n[o]=e}}};for(var s in n)o(s)}else;return e}function qt(e,t){var n=this._staticTrees||(this._staticTrees=[]),r=n[e];return r&&!t||(r=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),zt(r,"__static__"+e,!1)),r}function Wt(e,t,n){return zt(e,"__once__"+t+(n?"_"+n:""),!0),e}function zt(e,t,n){if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]&&"string"!==typeof e[r]&&Gt(e[r],t+"_"+r,n);else Gt(e,t,n)}function Gt(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function Ht(e,t){if(t)if(l(t)){var n=e.on=e.on?I({},e.on):{};for(var r in t){var i=n[r],a=t[r];n[r]=i?[].concat(i,a):a}}else;return e}function $t(e,t,n,r){t=t||{$stable:!n};for(var i=0;i<e.length;i++){var a=e[i];Array.isArray(a)?$t(a,t,n):a&&(a.proxy&&(a.fn.proxy=!0),t[a.key]=a.fn)}return r&&(t.$key=r),t}function Kt(e,t){for(var n=0;n<t.length;n+=2){var r=t[n];"string"===typeof r&&r&&(e[t[n]]=t[n+1])}return e}function Yt(e,t){return"string"===typeof e?t+e:e}function Xt(e){e._o=Wt,e._n=m,e._s=f,e._l=Lt,e._t=jt,e._q=L,e._i=j,e._m=qt,e._f=Bt,e._k=Ft,e._b=Vt,e._v=xe,e._e=we,e._u=$t,e._g=Ht,e._d=Kt,e._p=Yt}function Jt(e,t,r,i,o){var s,u=this,c=o.options;_(i,"_uid")?(s=Object.create(i),s._original=i):(s=i,i=i._original);var l=a(c._compiled),d=!l;this.data=e,this.props=t,this.children=r,this.parent=i,this.listeners=e.on||n,this.injections=At(c.inject,i),this.slots=function(){return u.$slots||Dt(e.scopedSlots,u.$slots=It(r,i)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Dt(e.scopedSlots,this.slots())}}),l&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=Dt(e.scopedSlots,this.$slots)),c._scopeId?this._c=function(e,t,n,r){var a=dn(s,e,t,n,r,d);return a&&!Array.isArray(a)&&(a.fnScopeId=c._scopeId,a.fnContext=i),a}:this._c=function(e,t,n,r){return dn(s,e,t,n,r,d)}}function Qt(e,t,r,a,o){var s=e.options,u={},c=s.props;if(i(c))for(var l in c)u[l]=Xe(l,c,t||n);else i(r.attrs)&&en(u,r.attrs),i(r.props)&&en(u,r.props);var d=new Jt(r,u,o,a,e),p=s.render.call(null,d._c,d);if(p instanceof be)return Zt(p,r,d.parent,s,d);if(Array.isArray(p)){for(var h=St(p)||[],f=new Array(h.length),m=0;m<h.length;m++)f[m]=Zt(h[m],r,d.parent,s,d);return f}}function Zt(e,t,n,r,i){var a=Te(e);return a.fnContext=n,a.fnOptions=r,t.slot&&((a.data||(a.data={})).slot=t.slot),a}function en(e,t){for(var n in t)e[T(n)]=t[n]}Xt(Jt.prototype);var tn={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var n=e;tn.prepatch(n,n)}else{var r=e.componentInstance=an(e,An);r.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var n=t.componentOptions,r=t.componentInstance=e.componentInstance;Mn(r,n.propsData,n.listeners,t,n.children)},insert:function(e){var t=e.context,n=e.componentInstance;n._isMounted||(n._isMounted=!0,Un(n,"mounted")),e.data.keepAlive&&(t._isMounted?Qn(n):jn(n,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?Bn(t,!0):t.$destroy())}},nn=Object.keys(tn);function rn(e,t,n,o,s){if(!r(e)){var c=n.$options._base;if(u(e)&&(e=c.extend(e)),"function"===typeof e){var l;if(r(e.cid)&&(l=e,e=wn(l,c),void 0===e))return _n(l,t,n,o,s);t=t||{},wr(e),i(t.model)&&un(e.options,t);var d=xt(t,e,s);if(a(e.options.functional))return Qt(e,d,t,n,o);var p=t.on;if(t.on=t.nativeOn,a(e.options.abstract)){var h=t.slot;t={},h&&(t.slot=h)}on(t);var f=e.options.name||s,m=new be("vue-component-"+e.cid+(f?"-"+f:""),t,void 0,void 0,void 0,n,{Ctor:e,propsData:d,listeners:p,tag:s,children:o},l);return m}}}function an(e,t){var n={_isComponent:!0,_parentVnode:e,parent:t},r=e.data.inlineTemplate;return i(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new e.componentOptions.Ctor(n)}function on(e){for(var t=e.hook||(e.hook={}),n=0;n<nn.length;n++){var r=nn[n],i=t[r],a=tn[r];i===a||i&&i._merged||(t[r]=i?sn(a,i):a)}}function sn(e,t){var n=function(n,r){e(n,r),t(n,r)};return n._merged=!0,n}function un(e,t){var n=e.model&&e.model.prop||"value",r=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[n]=t.model.value;var a=t.on||(t.on={}),o=a[r],s=t.model.callback;i(o)?(Array.isArray(o)?-1===o.indexOf(s):o!==s)&&(a[r]=[s].concat(o)):a[r]=s}var cn=1,ln=2;function dn(e,t,n,r,i,o){return(Array.isArray(n)||s(n))&&(i=r,r=n,n=void 0),a(o)&&(i=ln),pn(e,t,n,r,i)}function pn(e,t,n,r,a){if(i(n)&&i(n.__ob__))return we();if(i(n)&&i(n.is)&&(t=n.is),!t)return we();var o,s,u;(Array.isArray(r)&&"function"===typeof r[0]&&(n=n||{},n.scopedSlots={default:r[0]},r.length=0),a===ln?r=St(r):a===cn&&(r=Ct(r)),"string"===typeof t)?(s=e.$vnode&&e.$vnode.ns||q.getTagNamespace(t),o=q.isReservedTag(t)?new be(q.parsePlatformTagName(t),n,r,void 0,void 0,e):n&&n.pre||!i(u=Ye(e.$options,"components",t))?new be(t,n,r,void 0,void 0,e):rn(u,n,e,r,t)):o=rn(t,n,e,r);return Array.isArray(o)?o:i(o)?(i(s)&&hn(o,s),i(n)&&fn(n),o):we()}function hn(e,t,n){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,n=!0),i(e.children))for(var o=0,s=e.children.length;o<s;o++){var u=e.children[o];i(u.tag)&&(r(u.ns)||a(n)&&"svg"!==u.tag)&&hn(u,t,n)}}function fn(e){u(e.style)&&vt(e.style),u(e.class)&&vt(e.class)}function mn(e){e._vnode=null,e._staticTrees=null;var t=e.$options,r=e.$vnode=t._parentVnode,i=r&&r.context;e.$slots=It(t._renderChildren,i),e.$scopedSlots=n,e._c=function(t,n,r,i){return dn(e,t,n,r,i,!1)},e.$createElement=function(t,n,r,i){return dn(e,t,n,r,i,!0)};var a=r&&r.data;Pe(e,"$attrs",a&&a.attrs||n,null,!0),Pe(e,"$listeners",t._parentListeners||n,null,!0)}var vn,gn=null;function yn(e){Xt(e.prototype),e.prototype.$nextTick=function(e){return ft(e,this)},e.prototype._render=function(){var e,t=this,n=t.$options,r=n.render,i=n._parentVnode;i&&(t.$scopedSlots=Dt(i.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=i;try{gn=t,e=r.call(t._renderProxy,t.$createElement)}catch(To){tt(To,t,"render"),e=t._vnode}finally{gn=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof be||(e=we()),e.parent=i,e}}function bn(e,t){return(e.__esModule||pe&&"Module"===e[Symbol.toStringTag])&&(e=e.default),u(e)?t.extend(e):e}function _n(e,t,n,r,i){var a=we();return a.asyncFactory=e,a.asyncMeta={data:t,context:n,children:r,tag:i},a}function wn(e,t){if(a(e.error)&&i(e.errorComp))return e.errorComp;if(i(e.resolved))return e.resolved;var n=gn;if(n&&i(e.owners)&&-1===e.owners.indexOf(n)&&e.owners.push(n),a(e.loading)&&i(e.loadingComp))return e.loadingComp;if(n&&!i(e.owners)){var o=e.owners=[n],s=!0,c=null,l=null;n.$on("hook:destroyed",(function(){return y(o,n)}));var d=function(e){for(var t=0,n=o.length;t<n;t++)o[t].$forceUpdate();e&&(o.length=0,null!==c&&(clearTimeout(c),c=null),null!==l&&(clearTimeout(l),l=null))},p=B((function(n){e.resolved=bn(n,t),s?o.length=0:d(!0)})),f=B((function(t){i(e.errorComp)&&(e.error=!0,d(!0))})),m=e(p,f);return u(m)&&(h(m)?r(e.resolved)&&m.then(p,f):h(m.component)&&(m.component.then(p,f),i(m.error)&&(e.errorComp=bn(m.error,t)),i(m.loading)&&(e.loadingComp=bn(m.loading,t),0===m.delay?e.loading=!0:c=setTimeout((function(){c=null,r(e.resolved)&&r(e.error)&&(e.loading=!0,d(!1))}),m.delay||200)),i(m.timeout)&&(l=setTimeout((function(){l=null,r(e.resolved)&&f(null)}),m.timeout)))),s=!1,e.loading?e.loadingComp:e.resolved}}function xn(e){return e.isComment&&e.asyncFactory}function Tn(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(i(n)&&(i(n.componentOptions)||xn(n)))return n}}function Cn(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Rn(e,t)}function Sn(e,t){vn.$on(e,t)}function En(e,t){vn.$off(e,t)}function kn(e,t){var n=vn;return function r(){var i=t.apply(null,arguments);null!==i&&n.$off(e,r)}}function Rn(e,t,n){vn=e,_t(t,n||{},Sn,En,kn,e),vn=void 0}function On(e){var t=/^hook:/;e.prototype.$on=function(e,n){var r=this;if(Array.isArray(e))for(var i=0,a=e.length;i<a;i++)r.$on(e[i],n);else(r._events[e]||(r._events[e]=[])).push(n),t.test(e)&&(r._hasHookEvent=!0);return r},e.prototype.$once=function(e,t){var n=this;function r(){n.$off(e,r),t.apply(n,arguments)}return r.fn=t,n.$on(e,r),n},e.prototype.$off=function(e,t){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(e)){for(var r=0,i=e.length;r<i;r++)n.$off(e[r],t);return n}var a,o=n._events[e];if(!o)return n;if(!t)return n._events[e]=null,n;var s=o.length;while(s--)if(a=o[s],a===t||a.fn===t){o.splice(s,1);break}return n},e.prototype.$emit=function(e){var t=this,n=t._events[e];if(n){n=n.length>1?A(n):n;for(var r=A(arguments,1),i='event handler for "'+e+'"',a=0,o=n.length;a<o;a++)nt(n[a],t,r,t,i)}return t}}var An=null;function In(e){var t=An;return An=e,function(){An=t}}function Nn(e){var t=e.$options,n=t.parent;if(n&&!t.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function Dn(e){e.prototype._update=function(e,t){var n=this,r=n.$el,i=n._vnode,a=In(n);n._vnode=e,n.$el=i?n.__patch__(i,e):n.__patch__(n.$el,e,t,!1),a(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Un(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||y(t.$children,e),e._watcher&&e._watcher.teardown();var n=e._watchers.length;while(n--)e._watchers[n].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Un(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function Pn(e,t,n){var r;return e.$el=t,e.$options.render||(e.$options.render=we),Un(e,"beforeMount"),r=function(){e._update(e._render(),n)},new nr(e,r,D,{before:function(){e._isMounted&&!e._isDestroyed&&Un(e,"beforeUpdate")}},!0),n=!1,null==e.$vnode&&(e._isMounted=!0,Un(e,"mounted")),e}function Mn(e,t,r,i,a){var o=i.data.scopedSlots,s=e.$scopedSlots,u=!!(o&&!o.$stable||s!==n&&!s.$stable||o&&e.$scopedSlots.$key!==o.$key),c=!!(a||e.$options._renderChildren||u);if(e.$options._parentVnode=i,e.$vnode=i,e._vnode&&(e._vnode.parent=i),e.$options._renderChildren=a,e.$attrs=i.data.attrs||n,e.$listeners=r||n,t&&e.$options.props){Oe(!1);for(var l=e._props,d=e.$options._propKeys||[],p=0;p<d.length;p++){var h=d[p],f=e.$options.props;l[h]=Xe(h,f,t,e)}Oe(!0),e.$options.propsData=t}r=r||n;var m=e.$options._parentListeners;e.$options._parentListeners=r,Rn(e,r,m),c&&(e.$slots=It(a,i.context),e.$forceUpdate())}function Ln(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function jn(e,t){if(t){if(e._directInactive=!1,Ln(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++)jn(e.$children[n]);Un(e,"activated")}}function Bn(e,t){if((!t||(e._directInactive=!0,!Ln(e)))&&!e._inactive){e._inactive=!0;for(var n=0;n<e.$children.length;n++)Bn(e.$children[n]);Un(e,"deactivated")}}function Un(e,t){ge();var n=e.$options[t],r=t+" hook";if(n)for(var i=0,a=n.length;i<a;i++)nt(n[i],e,null,e,r);e._hasHookEvent&&e.$emit("hook:"+t),ye()}var Fn=[],Vn=[],qn={},Wn=!1,zn=!1,Gn=0;function Hn(){Gn=Fn.length=Vn.length=0,qn={},Wn=zn=!1}var $n=0,Kn=Date.now;if(X&&!ee){var Yn=window.performance;Yn&&"function"===typeof Yn.now&&Kn()>document.createEvent("Event").timeStamp&&(Kn=function(){return Yn.now()})}function Xn(){var e,t;for($n=Kn(),zn=!0,Fn.sort((function(e,t){return e.id-t.id})),Gn=0;Gn<Fn.length;Gn++)e=Fn[Gn],e.before&&e.before(),t=e.id,qn[t]=null,e.run();var n=Vn.slice(),r=Fn.slice();Hn(),Zn(n),Jn(r),ce&&q.devtools&&ce.emit("flush")}function Jn(e){var t=e.length;while(t--){var n=e[t],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&Un(r,"updated")}}function Qn(e){e._inactive=!1,Vn.push(e)}function Zn(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,jn(e[t],!0)}function er(e){var t=e.id;if(null==qn[t]){if(qn[t]=!0,zn){var n=Fn.length-1;while(n>Gn&&Fn[n].id>e.id)n--;Fn.splice(n+1,0,e)}else Fn.push(e);Wn||(Wn=!0,ft(Xn))}}var tr=0,nr=function(e,t,n,r,i){this.vm=e,i&&(e._watcher=this),e._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++tr,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new de,this.newDepIds=new de,this.expression="","function"===typeof t?this.getter=t:(this.getter=$(t),this.getter||(this.getter=D)),this.value=this.lazy?void 0:this.get()};nr.prototype.get=function(){var e;ge(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(To){if(!this.user)throw To;tt(To,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&vt(e),ye(),this.cleanupDeps()}return e},nr.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},nr.prototype.cleanupDeps=function(){var e=this.deps.length;while(e--){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},nr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():er(this)},nr.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||u(e)||this.deep){var t=this.value;if(this.value=e,this.user)try{this.cb.call(this.vm,e,t)}catch(To){tt(To,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,e,t)}}},nr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},nr.prototype.depend=function(){var e=this.deps.length;while(e--)this.deps[e].depend()},nr.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);var e=this.deps.length;while(e--)this.deps[e].removeSub(this);this.active=!1}};var rr={enumerable:!0,configurable:!0,get:D,set:D};function ir(e,t,n){rr.get=function(){return this[t][n]},rr.set=function(e){this[t][n]=e},Object.defineProperty(e,n,rr)}function ar(e){e._watchers=[];var t=e.$options;t.props&&or(e,t.props),t.methods&&fr(e,t.methods),t.data?sr(e):De(e._data={},!0),t.computed&&lr(e,t.computed),t.watch&&t.watch!==ae&&mr(e,t.watch)}function or(e,t){var n=e.$options.propsData||{},r=e._props={},i=e.$options._propKeys=[],a=!e.$parent;a||Oe(!1);var o=function(a){i.push(a);var o=Xe(a,t,n,e);Pe(r,a,o),a in e||ir(e,"_props",a)};for(var s in t)o(s);Oe(!0)}function sr(e){var t=e.$options.data;t=e._data="function"===typeof t?ur(t,e):t||{},l(t)||(t={});var n=Object.keys(t),r=e.$options.props,i=(e.$options.methods,n.length);while(i--){var a=n[i];0,r&&_(r,a)||z(a)||ir(e,"_data",a)}De(t,!0)}function ur(e,t){ge();try{return e.call(t,t)}catch(To){return tt(To,t,"data()"),{}}finally{ye()}}var cr={lazy:!0};function lr(e,t){var n=e._computedWatchers=Object.create(null),r=ue();for(var i in t){var a=t[i],o="function"===typeof a?a:a.get;0,r||(n[i]=new nr(e,o||D,D,cr)),i in e||dr(e,i,a)}}function dr(e,t,n){var r=!ue();"function"===typeof n?(rr.get=r?pr(t):hr(n),rr.set=D):(rr.get=n.get?r&&!1!==n.cache?pr(t):hr(n.get):D,rr.set=n.set||D),Object.defineProperty(e,t,rr)}function pr(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),me.target&&t.depend(),t.value}}function hr(e){return function(){return e.call(this,this)}}function fr(e,t){e.$options.props;for(var n in t)e[n]="function"!==typeof t[n]?D:O(t[n],e)}function mr(e,t){for(var n in t){var r=t[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)vr(e,n,r[i]);else vr(e,n,r)}}function vr(e,t,n,r){return l(n)&&(r=n,n=n.handler),"string"===typeof n&&(n=e[n]),e.$watch(t,n,r)}function gr(e){var t={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=Me,e.prototype.$delete=Le,e.prototype.$watch=function(e,t,n){var r=this;if(l(t))return vr(r,e,t,n);n=n||{},n.user=!0;var i=new nr(r,e,t,n);if(n.immediate)try{t.call(r,i.value)}catch(a){tt(a,r,'callback for immediate watcher "'+i.expression+'"')}return function(){i.teardown()}}}var yr=0;function br(e){e.prototype._init=function(e){var t=this;t._uid=yr++,t._isVue=!0,e&&e._isComponent?_r(t,e):t.$options=Ke(wr(t.constructor),e||{},t),t._renderProxy=t,t._self=t,Nn(t),Cn(t),mn(t),Un(t,"beforeCreate"),Ot(t),ar(t),Rt(t),Un(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}function _r(e,t){var n=e.$options=Object.create(e.constructor.options),r=t._parentVnode;n.parent=t.parent,n._parentVnode=r;var i=r.componentOptions;n.propsData=i.propsData,n._parentListeners=i.listeners,n._renderChildren=i.children,n._componentTag=i.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}function wr(e){var t=e.options;if(e.super){var n=wr(e.super),r=e.superOptions;if(n!==r){e.superOptions=n;var i=xr(e);i&&I(e.extendOptions,i),t=e.options=Ke(n,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function xr(e){var t,n=e.options,r=e.sealedOptions;for(var i in n)n[i]!==r[i]&&(t||(t={}),t[i]=n[i]);return t}function Tr(e){this._init(e)}function Cr(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=A(arguments,1);return n.unshift(this),"function"===typeof e.install?e.install.apply(e,n):"function"===typeof e&&e.apply(null,n),t.push(e),this}}function Sr(e){e.mixin=function(e){return this.options=Ke(this.options,e),this}}function Er(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,r=n.cid,i=e._Ctor||(e._Ctor={});if(i[r])return i[r];var a=e.name||n.options.name;var o=function(e){this._init(e)};return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.cid=t++,o.options=Ke(n.options,e),o["super"]=n,o.options.props&&kr(o),o.options.computed&&Rr(o),o.extend=n.extend,o.mixin=n.mixin,o.use=n.use,F.forEach((function(e){o[e]=n[e]})),a&&(o.options.components[a]=o),o.superOptions=n.options,o.extendOptions=e,o.sealedOptions=I({},o.options),i[r]=o,o}}function kr(e){var t=e.options.props;for(var n in t)ir(e.prototype,"_props",n)}function Rr(e){var t=e.options.computed;for(var n in t)dr(e.prototype,n,t[n])}function Or(e){F.forEach((function(t){e[t]=function(e,n){return n?("component"===t&&l(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"===typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}}))}function Ar(e){return e&&(e.Ctor.options.name||e.tag)}function Ir(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!d(e)&&e.test(t)}function Nr(e,t){var n=e.cache,r=e.keys,i=e._vnode;for(var a in n){var o=n[a];if(o){var s=Ar(o.componentOptions);s&&!t(s)&&Dr(n,a,r,i)}}}function Dr(e,t,n,r){var i=e[t];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),e[t]=null,y(n,t)}br(Tr),gr(Tr),On(Tr),Dn(Tr),yn(Tr);var Pr=[String,RegExp,Array],Mr={name:"keep-alive",abstract:!0,props:{include:Pr,exclude:Pr,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)Dr(this.cache,e,this.keys)},mounted:function(){var e=this;this.$watch("include",(function(t){Nr(e,(function(e){return Ir(t,e)}))})),this.$watch("exclude",(function(t){Nr(e,(function(e){return!Ir(t,e)}))}))},render:function(){var e=this.$slots.default,t=Tn(e),n=t&&t.componentOptions;if(n){var r=Ar(n),i=this,a=i.include,o=i.exclude;if(a&&(!r||!Ir(a,r))||o&&r&&Ir(o,r))return t;var s=this,u=s.cache,c=s.keys,l=null==t.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):t.key;u[l]?(t.componentInstance=u[l].componentInstance,y(c,l),c.push(l)):(u[l]=t,c.push(l),this.max&&c.length>parseInt(this.max)&&Dr(u,c[0],c,this._vnode)),t.data.keepAlive=!0}return t||e&&e[0]}},Lr={KeepAlive:Mr};function jr(e){var t={get:function(){return q}};Object.defineProperty(e,"config",t),e.util={warn:he,extend:I,mergeOptions:Ke,defineReactive:Pe},e.set=Me,e.delete=Le,e.nextTick=ft,e.observable=function(e){return De(e),e},e.options=Object.create(null),F.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,I(e.options.components,Lr),Cr(e),Sr(e),Er(e),Or(e)}jr(Tr),Object.defineProperty(Tr.prototype,"$isServer",{get:ue}),Object.defineProperty(Tr.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Tr,"FunctionalRenderContext",{value:Jt}),Tr.version="2.6.11";var Br=v("style,class"),Ur=v("input,textarea,option,select,progress"),Fr=function(e,t,n){return"value"===n&&Ur(e)&&"button"!==t||"selected"===n&&"option"===e||"checked"===n&&"input"===e||"muted"===n&&"video"===e},Vr=v("contenteditable,draggable,spellcheck"),qr=v("events,caret,typing,plaintext-only"),Wr=function(e,t){return Kr(t)||"false"===t?"false":"contenteditable"===e&&qr(t)?t:"true"},zr=v("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Gr="http://www.w3.org/1999/xlink",Hr=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},$r=function(e){return Hr(e)?e.slice(6,e.length):""},Kr=function(e){return null==e||!1===e};function Yr(e){var t=e.data,n=e,r=e;while(i(r.componentInstance))r=r.componentInstance._vnode,r&&r.data&&(t=Xr(r.data,t));while(i(n=n.parent))n&&n.data&&(t=Xr(t,n.data));return Jr(t.staticClass,t.class)}function Xr(e,t){return{staticClass:Qr(e.staticClass,t.staticClass),class:i(e.class)?[e.class,t.class]:t.class}}function Jr(e,t){return i(e)||i(t)?Qr(e,Zr(t)):""}function Qr(e,t){return e?t?e+" "+t:e:t||""}function Zr(e){return Array.isArray(e)?ei(e):u(e)?ti(e):"string"===typeof e?e:""}function ei(e){for(var t,n="",r=0,a=e.length;r<a;r++)i(t=Zr(e[r]))&&""!==t&&(n&&(n+=" "),n+=t);return n}function ti(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}var ni={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ri=v("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),ii=v("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ai=function(e){return ri(e)||ii(e)};function oi(e){return ii(e)?"svg":"math"===e?"math":void 0}var si=Object.create(null);function ui(e){if(!X)return!0;if(ai(e))return!1;if(e=e.toLowerCase(),null!=si[e])return si[e];var t=document.createElement(e);return e.indexOf("-")>-1?si[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:si[e]=/HTMLUnknownElement/.test(t.toString())}var ci=v("text,number,password,search,email,tel,url");function li(e){if("string"===typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}function di(e,t){var n=document.createElement(e);return"select"!==e||t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n}function pi(e,t){return document.createElementNS(ni[e],t)}function hi(e){return document.createTextNode(e)}function fi(e){return document.createComment(e)}function mi(e,t,n){e.insertBefore(t,n)}function vi(e,t){e.removeChild(t)}function gi(e,t){e.appendChild(t)}function yi(e){return e.parentNode}function bi(e){return e.nextSibling}function _i(e){return e.tagName}function wi(e,t){e.textContent=t}function xi(e,t){e.setAttribute(t,"")}var Ti=Object.freeze({createElement:di,createElementNS:pi,createTextNode:hi,createComment:fi,insertBefore:mi,removeChild:vi,appendChild:gi,parentNode:yi,nextSibling:bi,tagName:_i,setTextContent:wi,setStyleScope:xi}),Ci={create:function(e,t){Si(t)},update:function(e,t){e.data.ref!==t.data.ref&&(Si(e,!0),Si(t))},destroy:function(e){Si(e,!0)}};function Si(e,t){var n=e.data.ref;if(i(n)){var r=e.context,a=e.componentInstance||e.elm,o=r.$refs;t?Array.isArray(o[n])?y(o[n],a):o[n]===a&&(o[n]=void 0):e.data.refInFor?Array.isArray(o[n])?o[n].indexOf(a)<0&&o[n].push(a):o[n]=[a]:o[n]=a}}var Ei=new be("",{},[]),ki=["create","activate","update","remove","destroy"];function Ri(e,t){return e.key===t.key&&(e.tag===t.tag&&e.isComment===t.isComment&&i(e.data)===i(t.data)&&Oi(e,t)||a(e.isAsyncPlaceholder)&&e.asyncFactory===t.asyncFactory&&r(t.asyncFactory.error))}function Oi(e,t){if("input"!==e.tag)return!0;var n,r=i(n=e.data)&&i(n=n.attrs)&&n.type,a=i(n=t.data)&&i(n=n.attrs)&&n.type;return r===a||ci(r)&&ci(a)}function Ai(e,t,n){var r,a,o={};for(r=t;r<=n;++r)a=e[r].key,i(a)&&(o[a]=r);return o}function Ii(e){var t,n,o={},u=e.modules,c=e.nodeOps;for(t=0;t<ki.length;++t)for(o[ki[t]]=[],n=0;n<u.length;++n)i(u[n][ki[t]])&&o[ki[t]].push(u[n][ki[t]]);function l(e){return new be(c.tagName(e).toLowerCase(),{},[],void 0,e)}function d(e,t){function n(){0===--n.listeners&&p(e)}return n.listeners=t,n}function p(e){var t=c.parentNode(e);i(t)&&c.removeChild(t,e)}function h(e,t,n,r,o,s,u){if(i(e.elm)&&i(s)&&(e=s[u]=Te(e)),e.isRootInsert=!o,!f(e,t,n,r)){var l=e.data,d=e.children,p=e.tag;i(p)?(e.elm=e.ns?c.createElementNS(e.ns,p):c.createElement(p,e),x(e),b(e,d,t),i(l)&&w(e,t),y(n,e.elm,r)):a(e.isComment)?(e.elm=c.createComment(e.text),y(n,e.elm,r)):(e.elm=c.createTextNode(e.text),y(n,e.elm,r))}}function f(e,t,n,r){var o=e.data;if(i(o)){var s=i(e.componentInstance)&&o.keepAlive;if(i(o=o.hook)&&i(o=o.init)&&o(e,!1),i(e.componentInstance))return m(e,t),y(n,e.elm,r),a(s)&&g(e,t,n,r),!0}}function m(e,t){i(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,_(e)?(w(e,t),x(e)):(Si(e),t.push(e))}function g(e,t,n,r){var a,s=e;while(s.componentInstance)if(s=s.componentInstance._vnode,i(a=s.data)&&i(a=a.transition)){for(a=0;a<o.activate.length;++a)o.activate[a](Ei,s);t.push(s);break}y(n,e.elm,r)}function y(e,t,n){i(e)&&(i(n)?c.parentNode(n)===e&&c.insertBefore(e,t,n):c.appendChild(e,t))}function b(e,t,n){if(Array.isArray(t)){0;for(var r=0;r<t.length;++r)h(t[r],n,e.elm,null,!0,t,r)}else s(e.text)&&c.appendChild(e.elm,c.createTextNode(String(e.text)))}function _(e){while(e.componentInstance)e=e.componentInstance._vnode;return i(e.tag)}function w(e,n){for(var r=0;r<o.create.length;++r)o.create[r](Ei,e);t=e.data.hook,i(t)&&(i(t.create)&&t.create(Ei,e),i(t.insert)&&n.push(e))}function x(e){var t;if(i(t=e.fnScopeId))c.setStyleScope(e.elm,t);else{var n=e;while(n)i(t=n.context)&&i(t=t.$options._scopeId)&&c.setStyleScope(e.elm,t),n=n.parent}i(t=An)&&t!==e.context&&t!==e.fnContext&&i(t=t.$options._scopeId)&&c.setStyleScope(e.elm,t)}function T(e,t,n,r,i,a){for(;r<=i;++r)h(n[r],a,e,t,!1,n,r)}function C(e){var t,n,r=e.data;if(i(r))for(i(t=r.hook)&&i(t=t.destroy)&&t(e),t=0;t<o.destroy.length;++t)o.destroy[t](e);if(i(t=e.children))for(n=0;n<e.children.length;++n)C(e.children[n])}function S(e,t,n){for(;t<=n;++t){var r=e[t];i(r)&&(i(r.tag)?(E(r),C(r)):p(r.elm))}}function E(e,t){if(i(t)||i(e.data)){var n,r=o.remove.length+1;for(i(t)?t.listeners+=r:t=d(e.elm,r),i(n=e.componentInstance)&&i(n=n._vnode)&&i(n.data)&&E(n,t),n=0;n<o.remove.length;++n)o.remove[n](e,t);i(n=e.data.hook)&&i(n=n.remove)?n(e,t):t()}else p(e.elm)}function k(e,t,n,a,o){var s,u,l,d,p=0,f=0,m=t.length-1,v=t[0],g=t[m],y=n.length-1,b=n[0],_=n[y],w=!o;while(p<=m&&f<=y)r(v)?v=t[++p]:r(g)?g=t[--m]:Ri(v,b)?(O(v,b,a,n,f),v=t[++p],b=n[++f]):Ri(g,_)?(O(g,_,a,n,y),g=t[--m],_=n[--y]):Ri(v,_)?(O(v,_,a,n,y),w&&c.insertBefore(e,v.elm,c.nextSibling(g.elm)),v=t[++p],_=n[--y]):Ri(g,b)?(O(g,b,a,n,f),w&&c.insertBefore(e,g.elm,v.elm),g=t[--m],b=n[++f]):(r(s)&&(s=Ai(t,p,m)),u=i(b.key)?s[b.key]:R(b,t,p,m),r(u)?h(b,a,e,v.elm,!1,n,f):(l=t[u],Ri(l,b)?(O(l,b,a,n,f),t[u]=void 0,w&&c.insertBefore(e,l.elm,v.elm)):h(b,a,e,v.elm,!1,n,f)),b=n[++f]);p>m?(d=r(n[y+1])?null:n[y+1].elm,T(e,d,n,f,y,a)):f>y&&S(t,p,m)}function R(e,t,n,r){for(var a=n;a<r;a++){var o=t[a];if(i(o)&&Ri(e,o))return a}}function O(e,t,n,s,u,l){if(e!==t){i(t.elm)&&i(s)&&(t=s[u]=Te(t));var d=t.elm=e.elm;if(a(e.isAsyncPlaceholder))i(t.asyncFactory.resolved)?N(e.elm,t,n):t.isAsyncPlaceholder=!0;else if(a(t.isStatic)&&a(e.isStatic)&&t.key===e.key&&(a(t.isCloned)||a(t.isOnce)))t.componentInstance=e.componentInstance;else{var p,h=t.data;i(h)&&i(p=h.hook)&&i(p=p.prepatch)&&p(e,t);var f=e.children,m=t.children;if(i(h)&&_(t)){for(p=0;p<o.update.length;++p)o.update[p](e,t);i(p=h.hook)&&i(p=p.update)&&p(e,t)}r(t.text)?i(f)&&i(m)?f!==m&&k(d,f,m,n,l):i(m)?(i(e.text)&&c.setTextContent(d,""),T(d,null,m,0,m.length-1,n)):i(f)?S(f,0,f.length-1):i(e.text)&&c.setTextContent(d,""):e.text!==t.text&&c.setTextContent(d,t.text),i(h)&&i(p=h.hook)&&i(p=p.postpatch)&&p(e,t)}}}function A(e,t,n){if(a(n)&&i(e.parent))e.parent.data.pendingInsert=t;else for(var r=0;r<t.length;++r)t[r].data.hook.insert(t[r])}var I=v("attrs,class,staticClass,staticStyle,key");function N(e,t,n,r){var o,s=t.tag,u=t.data,c=t.children;if(r=r||u&&u.pre,t.elm=e,a(t.isComment)&&i(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(i(u)&&(i(o=u.hook)&&i(o=o.init)&&o(t,!0),i(o=t.componentInstance)))return m(t,n),!0;if(i(s)){if(i(c))if(e.hasChildNodes())if(i(o=u)&&i(o=o.domProps)&&i(o=o.innerHTML)){if(o!==e.innerHTML)return!1}else{for(var l=!0,d=e.firstChild,p=0;p<c.length;p++){if(!d||!N(d,c[p],n,r)){l=!1;break}d=d.nextSibling}if(!l||d)return!1}else b(t,c,n);if(i(u)){var h=!1;for(var f in u)if(!I(f)){h=!0,w(t,n);break}!h&&u["class"]&&vt(u["class"])}}else e.data!==t.text&&(e.data=t.text);return!0}return function(e,t,n,s){if(!r(t)){var u=!1,d=[];if(r(e))u=!0,h(t,d);else{var p=i(e.nodeType);if(!p&&Ri(e,t))O(e,t,d,null,null,s);else{if(p){if(1===e.nodeType&&e.hasAttribute(U)&&(e.removeAttribute(U),n=!0),a(n)&&N(e,t,d))return A(t,d,!0),e;e=l(e)}var f=e.elm,m=c.parentNode(f);if(h(t,d,f._leaveCb?null:m,c.nextSibling(f)),i(t.parent)){var v=t.parent,g=_(t);while(v){for(var y=0;y<o.destroy.length;++y)o.destroy[y](v);if(v.elm=t.elm,g){for(var b=0;b<o.create.length;++b)o.create[b](Ei,v);var w=v.data.hook.insert;if(w.merged)for(var x=1;x<w.fns.length;x++)w.fns[x]()}else Si(v);v=v.parent}}i(m)?S([e],0,0):i(e.tag)&&C(e)}}return A(t,d,u),t.elm}i(e)&&C(e)}}var Ni={create:Di,update:Di,destroy:function(e){Di(e,Ei)}};function Di(e,t){(e.data.directives||t.data.directives)&&Pi(e,t)}function Pi(e,t){var n,r,i,a=e===Ei,o=t===Ei,s=Li(e.data.directives,e.context),u=Li(t.data.directives,t.context),c=[],l=[];for(n in u)r=s[n],i=u[n],r?(i.oldValue=r.value,i.oldArg=r.arg,Bi(i,"update",t,e),i.def&&i.def.componentUpdated&&l.push(i)):(Bi(i,"bind",t,e),i.def&&i.def.inserted&&c.push(i));if(c.length){var d=function(){for(var n=0;n<c.length;n++)Bi(c[n],"inserted",t,e)};a?wt(t,"insert",d):d()}if(l.length&&wt(t,"postpatch",(function(){for(var n=0;n<l.length;n++)Bi(l[n],"componentUpdated",t,e)})),!a)for(n in s)u[n]||Bi(s[n],"unbind",e,e,o)}var Mi=Object.create(null);function Li(e,t){var n,r,i=Object.create(null);if(!e)return i;for(n=0;n<e.length;n++)r=e[n],r.modifiers||(r.modifiers=Mi),i[ji(r)]=r,r.def=Ye(t.$options,"directives",r.name,!0);return i}function ji(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function Bi(e,t,n,r,i){var a=e.def&&e.def[t];if(a)try{a(n.elm,e,n,r,i)}catch(To){tt(To,n.context,"directive "+e.name+" "+t+" hook")}}var Ui=[Ci,Ni];function Fi(e,t){var n=t.componentOptions;if((!i(n)||!1!==n.Ctor.options.inheritAttrs)&&(!r(e.data.attrs)||!r(t.data.attrs))){var a,o,s,u=t.elm,c=e.data.attrs||{},l=t.data.attrs||{};for(a in i(l.__ob__)&&(l=t.data.attrs=I({},l)),l)o=l[a],s=c[a],s!==o&&Vi(u,a,o);for(a in(ee||ne)&&l.value!==c.value&&Vi(u,"value",l.value),c)r(l[a])&&(Hr(a)?u.removeAttributeNS(Gr,$r(a)):Vr(a)||u.removeAttribute(a))}}function Vi(e,t,n){e.tagName.indexOf("-")>-1?qi(e,t,n):zr(t)?Kr(n)?e.removeAttribute(t):(n="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,n)):Vr(t)?e.setAttribute(t,Wr(t,n)):Hr(t)?Kr(n)?e.removeAttributeNS(Gr,$r(t)):e.setAttributeNS(Gr,t,n):qi(e,t,n)}function qi(e,t,n){if(Kr(n))e.removeAttribute(t);else{if(ee&&!te&&"TEXTAREA"===e.tagName&&"placeholder"===t&&""!==n&&!e.__ieph){var r=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",r)};e.addEventListener("input",r),e.__ieph=!0}e.setAttribute(t,n)}}var Wi={create:Fi,update:Fi};function zi(e,t){var n=t.elm,a=t.data,o=e.data;if(!(r(a.staticClass)&&r(a.class)&&(r(o)||r(o.staticClass)&&r(o.class)))){var s=Yr(t),u=n._transitionClasses;i(u)&&(s=Qr(s,Zr(u))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var Gi,Hi={create:zi,update:zi},$i="__r",Ki="__c";function Yi(e){if(i(e[$i])){var t=ee?"change":"input";e[t]=[].concat(e[$i],e[t]||[]),delete e[$i]}i(e[Ki])&&(e.change=[].concat(e[Ki],e.change||[]),delete e[Ki])}function Xi(e,t,n){var r=Gi;return function i(){var a=t.apply(null,arguments);null!==a&&Zi(e,i,n,r)}}var Ji=ot&&!(ie&&Number(ie[1])<=53);function Qi(e,t,n,r){if(Ji){var i=$n,a=t;t=a._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=i||e.timeStamp<=0||e.target.ownerDocument!==document)return a.apply(this,arguments)}}Gi.addEventListener(e,t,oe?{capture:n,passive:r}:n)}function Zi(e,t,n,r){(r||Gi).removeEventListener(e,t._wrapper||t,n)}function ea(e,t){if(!r(e.data.on)||!r(t.data.on)){var n=t.data.on||{},i=e.data.on||{};Gi=t.elm,Yi(n),_t(n,i,Qi,Zi,Xi,t.context),Gi=void 0}}var ta,na={create:ea,update:ea};function ra(e,t){if(!r(e.data.domProps)||!r(t.data.domProps)){var n,a,o=t.elm,s=e.data.domProps||{},u=t.data.domProps||{};for(n in i(u.__ob__)&&(u=t.data.domProps=I({},u)),s)n in u||(o[n]="");for(n in u){if(a=u[n],"textContent"===n||"innerHTML"===n){if(t.children&&(t.children.length=0),a===s[n])continue;1===o.childNodes.length&&o.removeChild(o.childNodes[0])}if("value"===n&&"PROGRESS"!==o.tagName){o._value=a;var c=r(a)?"":String(a);ia(o,c)&&(o.value=c)}else if("innerHTML"===n&&ii(o.tagName)&&r(o.innerHTML)){ta=ta||document.createElement("div"),ta.innerHTML="<svg>"+a+"</svg>";var l=ta.firstChild;while(o.firstChild)o.removeChild(o.firstChild);while(l.firstChild)o.appendChild(l.firstChild)}else if(a!==s[n])try{o[n]=a}catch(To){}}}}function ia(e,t){return!e.composing&&("OPTION"===e.tagName||aa(e,t)||oa(e,t))}function aa(e,t){var n=!0;try{n=document.activeElement!==e}catch(To){}return n&&e.value!==t}function oa(e,t){var n=e.value,r=e._vModifiers;if(i(r)){if(r.number)return m(n)!==m(t);if(r.trim)return n.trim()!==t.trim()}return n!==t}var sa={create:ra,update:ra},ua=w((function(e){var t={},n=/;(?![^(]*\))/g,r=/:(.+)/;return e.split(n).forEach((function(e){if(e){var n=e.split(r);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}));function ca(e){var t=la(e.style);return e.staticStyle?I(e.staticStyle,t):t}function la(e){return Array.isArray(e)?N(e):"string"===typeof e?ua(e):e}function da(e,t){var n,r={};if(t){var i=e;while(i.componentInstance)i=i.componentInstance._vnode,i&&i.data&&(n=ca(i.data))&&I(r,n)}(n=ca(e.data))&&I(r,n);var a=e;while(a=a.parent)a.data&&(n=ca(a.data))&&I(r,n);return r}var pa,ha=/^--/,fa=/\s*!important$/,ma=function(e,t,n){if(ha.test(t))e.style.setProperty(t,n);else if(fa.test(n))e.style.setProperty(E(t),n.replace(fa,""),"important");else{var r=ga(t);if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)e.style[r]=n[i];else e.style[r]=n}},va=["Webkit","Moz","ms"],ga=w((function(e){if(pa=pa||document.createElement("div").style,e=T(e),"filter"!==e&&e in pa)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<va.length;n++){var r=va[n]+t;if(r in pa)return r}}));function ya(e,t){var n=t.data,a=e.data;if(!(r(n.staticStyle)&&r(n.style)&&r(a.staticStyle)&&r(a.style))){var o,s,u=t.elm,c=a.staticStyle,l=a.normalizedStyle||a.style||{},d=c||l,p=la(t.data.style)||{};t.data.normalizedStyle=i(p.__ob__)?I({},p):p;var h=da(t,!0);for(s in d)r(h[s])&&ma(u,s,"");for(s in h)o=h[s],o!==d[s]&&ma(u,s,null==o?"":o)}}var ba={create:ya,update:ya},_a=/\s+/;function wa(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(_a).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function xa(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(_a).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{var n=" "+(e.getAttribute("class")||"")+" ",r=" "+t+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?e.setAttribute("class",n):e.removeAttribute("class")}}function Ta(e){if(e){if("object"===typeof e){var t={};return!1!==e.css&&I(t,Ca(e.name||"v")),I(t,e),t}return"string"===typeof e?Ca(e):void 0}}var Ca=w((function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}})),Sa=X&&!te,Ea="transition",ka="animation",Ra="transition",Oa="transitionend",Aa="animation",Ia="animationend";Sa&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Ra="WebkitTransition",Oa="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Aa="WebkitAnimation",Ia="webkitAnimationEnd"));var Na=X?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function Da(e){Na((function(){Na(e)}))}function Pa(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),wa(e,t))}function Ma(e,t){e._transitionClasses&&y(e._transitionClasses,t),xa(e,t)}function La(e,t,n){var r=Ba(e,t),i=r.type,a=r.timeout,o=r.propCount;if(!i)return n();var s=i===Ea?Oa:Ia,u=0,c=function(){e.removeEventListener(s,l),n()},l=function(t){t.target===e&&++u>=o&&c()};setTimeout((function(){u<o&&c()}),a+1),e.addEventListener(s,l)}var ja=/\b(transform|all)(,|$)/;function Ba(e,t){var n,r=window.getComputedStyle(e),i=(r[Ra+"Delay"]||"").split(", "),a=(r[Ra+"Duration"]||"").split(", "),o=Ua(i,a),s=(r[Aa+"Delay"]||"").split(", "),u=(r[Aa+"Duration"]||"").split(", "),c=Ua(s,u),l=0,d=0;t===Ea?o>0&&(n=Ea,l=o,d=a.length):t===ka?c>0&&(n=ka,l=c,d=u.length):(l=Math.max(o,c),n=l>0?o>c?Ea:ka:null,d=n?n===Ea?a.length:u.length:0);var p=n===Ea&&ja.test(r[Ra+"Property"]);return{type:n,timeout:l,propCount:d,hasTransform:p}}function Ua(e,t){while(e.length<t.length)e=e.concat(e);return Math.max.apply(null,t.map((function(t,n){return Fa(t)+Fa(e[n])})))}function Fa(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Va(e,t){var n=e.elm;i(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var a=Ta(e.data.transition);if(!r(a)&&!i(n._enterCb)&&1===n.nodeType){var o=a.css,s=a.type,c=a.enterClass,l=a.enterToClass,d=a.enterActiveClass,p=a.appearClass,h=a.appearToClass,f=a.appearActiveClass,v=a.beforeEnter,g=a.enter,y=a.afterEnter,b=a.enterCancelled,_=a.beforeAppear,w=a.appear,x=a.afterAppear,T=a.appearCancelled,C=a.duration,S=An,E=An.$vnode;while(E&&E.parent)S=E.context,E=E.parent;var k=!S._isMounted||!e.isRootInsert;if(!k||w||""===w){var R=k&&p?p:c,O=k&&f?f:d,A=k&&h?h:l,I=k&&_||v,N=k&&"function"===typeof w?w:g,D=k&&x||y,P=k&&T||b,M=m(u(C)?C.enter:C);0;var L=!1!==o&&!te,j=za(N),U=n._enterCb=B((function(){L&&(Ma(n,A),Ma(n,O)),U.cancelled?(L&&Ma(n,R),P&&P(n)):D&&D(n),n._enterCb=null}));e.data.show||wt(e,"insert",(function(){var t=n.parentNode,r=t&&t._pending&&t._pending[e.key];r&&r.tag===e.tag&&r.elm._leaveCb&&r.elm._leaveCb(),N&&N(n,U)})),I&&I(n),L&&(Pa(n,R),Pa(n,O),Da((function(){Ma(n,R),U.cancelled||(Pa(n,A),j||(Wa(M)?setTimeout(U,M):La(n,s,U)))}))),e.data.show&&(t&&t(),N&&N(n,U)),L||j||U()}}}function qa(e,t){var n=e.elm;i(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var a=Ta(e.data.transition);if(r(a)||1!==n.nodeType)return t();if(!i(n._leaveCb)){var o=a.css,s=a.type,c=a.leaveClass,l=a.leaveToClass,d=a.leaveActiveClass,p=a.beforeLeave,h=a.leave,f=a.afterLeave,v=a.leaveCancelled,g=a.delayLeave,y=a.duration,b=!1!==o&&!te,_=za(h),w=m(u(y)?y.leave:y);0;var x=n._leaveCb=B((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[e.key]=null),b&&(Ma(n,l),Ma(n,d)),x.cancelled?(b&&Ma(n,c),v&&v(n)):(t(),f&&f(n)),n._leaveCb=null}));g?g(T):T()}function T(){x.cancelled||(!e.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[e.key]=e),p&&p(n),b&&(Pa(n,c),Pa(n,d),Da((function(){Ma(n,c),x.cancelled||(Pa(n,l),_||(Wa(w)?setTimeout(x,w):La(n,s,x)))}))),h&&h(n,x),b||_||x())}}function Wa(e){return"number"===typeof e&&!isNaN(e)}function za(e){if(r(e))return!1;var t=e.fns;return i(t)?za(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function Ga(e,t){!0!==t.data.show&&Va(t)}var Ha=X?{create:Ga,activate:Ga,remove:function(e,t){!0!==e.data.show?qa(e,t):t()}}:{},$a=[Wi,Hi,na,sa,ba,Ha],Ka=$a.concat(Ui),Ya=Ii({nodeOps:Ti,modules:Ka});te&&document.addEventListener("selectionchange",(function(){var e=document.activeElement;e&&e.vmodel&&ro(e,"input")}));var Xa={inserted:function(e,t,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?wt(n,"postpatch",(function(){Xa.componentUpdated(e,t,n)})):Ja(e,t,n.context),e._vOptions=[].map.call(e.options,eo)):("textarea"===n.tag||ci(e.type))&&(e._vModifiers=t.modifiers,t.modifiers.lazy||(e.addEventListener("compositionstart",to),e.addEventListener("compositionend",no),e.addEventListener("change",no),te&&(e.vmodel=!0)))},componentUpdated:function(e,t,n){if("select"===n.tag){Ja(e,t,n.context);var r=e._vOptions,i=e._vOptions=[].map.call(e.options,eo);if(i.some((function(e,t){return!L(e,r[t])}))){var a=e.multiple?t.value.some((function(e){return Za(e,i)})):t.value!==t.oldValue&&Za(t.value,i);a&&ro(e,"change")}}}};function Ja(e,t,n){Qa(e,t,n),(ee||ne)&&setTimeout((function(){Qa(e,t,n)}),0)}function Qa(e,t,n){var r=t.value,i=e.multiple;if(!i||Array.isArray(r)){for(var a,o,s=0,u=e.options.length;s<u;s++)if(o=e.options[s],i)a=j(r,eo(o))>-1,o.selected!==a&&(o.selected=a);else if(L(eo(o),r))return void(e.selectedIndex!==s&&(e.selectedIndex=s));i||(e.selectedIndex=-1)}}function Za(e,t){return t.every((function(t){return!L(t,e)}))}function eo(e){return"_value"in e?e._value:e.value}function to(e){e.target.composing=!0}function no(e){e.target.composing&&(e.target.composing=!1,ro(e.target,"input"))}function ro(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}function io(e){return!e.componentInstance||e.data&&e.data.transition?e:io(e.componentInstance._vnode)}var ao={bind:function(e,t,n){var r=t.value;n=io(n);var i=n.data&&n.data.transition,a=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;r&&i?(n.data.show=!0,Va(n,(function(){e.style.display=a}))):e.style.display=r?a:"none"},update:function(e,t,n){var r=t.value,i=t.oldValue;if(!r!==!i){n=io(n);var a=n.data&&n.data.transition;a?(n.data.show=!0,r?Va(n,(function(){e.style.display=e.__vOriginalDisplay})):qa(n,(function(){e.style.display="none"}))):e.style.display=r?e.__vOriginalDisplay:"none"}},unbind:function(e,t,n,r,i){i||(e.style.display=e.__vOriginalDisplay)}},oo={model:Xa,show:ao},so={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function uo(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?uo(Tn(t.children)):e}function co(e){var t={},n=e.$options;for(var r in n.propsData)t[r]=e[r];var i=n._parentListeners;for(var a in i)t[T(a)]=i[a];return t}function lo(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}function po(e){while(e=e.parent)if(e.data.transition)return!0}function ho(e,t){return t.key===e.key&&t.tag===e.tag}var fo=function(e){return e.tag||xn(e)},mo=function(e){return"show"===e.name},vo={name:"transition",props:so,abstract:!0,render:function(e){var t=this,n=this.$slots.default;if(n&&(n=n.filter(fo),n.length)){0;var r=this.mode;0;var i=n[0];if(po(this.$vnode))return i;var a=uo(i);if(!a)return i;if(this._leaving)return lo(e,i);var o="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?o+"comment":o+a.tag:s(a.key)?0===String(a.key).indexOf(o)?a.key:o+a.key:a.key;var u=(a.data||(a.data={})).transition=co(this),c=this._vnode,l=uo(c);if(a.data.directives&&a.data.directives.some(mo)&&(a.data.show=!0),l&&l.data&&!ho(a,l)&&!xn(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var d=l.data.transition=I({},u);if("out-in"===r)return this._leaving=!0,wt(d,"afterLeave",(function(){t._leaving=!1,t.$forceUpdate()})),lo(e,i);if("in-out"===r){if(xn(a))return c;var p,h=function(){p()};wt(u,"afterEnter",h),wt(u,"enterCancelled",h),wt(d,"delayLeave",(function(e){p=e}))}}return i}}},go=I({tag:String,moveClass:String},so);delete go.mode;var yo={props:go,beforeMount:function(){var e=this,t=this._update;this._update=function(n,r){var i=In(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,i(),t.call(e,n,r)}},render:function(e){for(var t=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],a=this.children=[],o=co(this),s=0;s<i.length;s++){var u=i[s];if(u.tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))a.push(u),n[u.key]=u,(u.data||(u.data={})).transition=o;else;}if(r){for(var c=[],l=[],d=0;d<r.length;d++){var p=r[d];p.data.transition=o,p.data.pos=p.elm.getBoundingClientRect(),n[p.key]?c.push(p):l.push(p)}this.kept=e(t,null,c),this.removed=l}return e(t,null,a)},updated:function(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach(bo),e.forEach(_o),e.forEach(wo),this._reflow=document.body.offsetHeight,e.forEach((function(e){if(e.data.moved){var n=e.elm,r=n.style;Pa(n,t),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(Oa,n._moveCb=function e(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(Oa,e),n._moveCb=null,Ma(n,t))})}})))},methods:{hasMove:function(e,t){if(!Sa)return!1;if(this._hasMove)return this._hasMove;var n=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach((function(e){xa(n,e)})),wa(n,t),n.style.display="none",this.$el.appendChild(n);var r=Ba(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}};function bo(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function _o(e){e.data.newPos=e.elm.getBoundingClientRect()}function wo(e){var t=e.data.pos,n=e.data.newPos,r=t.left-n.left,i=t.top-n.top;if(r||i){e.data.moved=!0;var a=e.elm.style;a.transform=a.WebkitTransform="translate("+r+"px,"+i+"px)",a.transitionDuration="0s"}}var xo={Transition:vo,TransitionGroup:yo};Tr.config.mustUseProp=Fr,Tr.config.isReservedTag=ai,Tr.config.isReservedAttr=Br,Tr.config.getTagNamespace=oi,Tr.config.isUnknownElement=ui,I(Tr.options.directives,oo),I(Tr.options.components,xo),Tr.prototype.__patch__=X?Ya:D,Tr.prototype.$mount=function(e,t){return e=e&&X?li(e):void 0,Pn(this,e,t)},X&&setTimeout((function(){q.devtools&&ce&&ce.emit("init",Tr)}),0),t["a"]=Tr}).call(this,n("c8ba"))},"2b8c":function(e,t,n){var r=n("be09"),i=e.exports={WebVTT:n("d02c"),VTTCue:n("b03c"),VTTRegion:n("f97d")};r.vttjs=i,r.WebVTT=i.WebVTT;var a=i.VTTCue,o=i.VTTRegion,s=r.VTTCue,u=r.VTTRegion;i.shim=function(){r.VTTCue=a,r.VTTRegion=o},i.restore=function(){r.VTTCue=s,r.VTTRegion=u},r.VTTCue||i.shim()},"2cf4":function(e,t,n){var r,i,a,o=n("da84"),s=n("d039"),u=n("c6b6"),c=n("0366"),l=n("1be4"),d=n("cc12"),p=n("1cdc"),h=o.location,f=o.setImmediate,m=o.clearImmediate,v=o.process,g=o.MessageChannel,y=o.Dispatch,b=0,_={},w="onreadystatechange",x=function(e){if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},T=function(e){return function(){x(e)}},C=function(e){x(e.data)},S=function(e){o.postMessage(e+"",h.protocol+"//"+h.host)};f&&m||(f=function(e){var t=[],n=1;while(arguments.length>n)t.push(arguments[n++]);return _[++b]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},r(b),b},m=function(e){delete _[e]},"process"==u(v)?r=function(e){v.nextTick(T(e))}:y&&y.now?r=function(e){y.now(T(e))}:g&&!p?(i=new g,a=i.port2,i.port1.onmessage=C,r=c(a.postMessage,a,1)):!o.addEventListener||"function"!=typeof postMessage||o.importScripts||s(S)||"file:"===h.protocol?r=w in d("script")?function(e){l.appendChild(d("script"))[w]=function(){l.removeChild(this),x(e)}}:function(e){setTimeout(T(e),0)}:(r=S,o.addEventListener("message",C,!1))),e.exports={set:f,clear:m}},"2d00":function(e,t,n){var r,i,a=n("da84"),o=n("342f"),s=a.process,u=s&&s.versions,c=u&&u.v8;c?(r=c.split("."),i=r[0]+r[1]):o&&(r=o.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/),r&&(i=r[1]))),e.exports=i&&+i},"31bb":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},3410:function(e,t,n){var r=n("23e7"),i=n("d039"),a=n("7b0b"),o=n("e163"),s=n("e177"),u=i((function(){o(1)}));r({target:"Object",stat:!0,forced:u,sham:!s},{getPrototypeOf:function(e){return o(a(e))}})},"342d":function(e,t,n){(function(){"use strict";var t={complement:window.document.title,separator:"|"},n={},r=[],i=[],a=!1,o={shorthand:{ch:"charset",tg:"target",n:"name",he:"http-equiv",ip:"itemprop",c:"content",p:"property",sc:"scheme",r:"rel",h:"href",sz:"sizes",t:"type",s:"src",a:"async",d:"defer",i:"inner"},getPlace:function(e){return window.document.getElementsByTagName(e)[0]},undoTitle:function(e){e.before&&(window.document.title=e.before)},undo:function(){r.length&&(r.forEach((function(e){e.parentElement.removeChild(e)})),r=[])},prepareElement:function(e,t){var n=this;return Object.keys(e).forEach((function(r){var i=n.shorthand[r]||r;i.match(/(body|undo|replace)/g)||("inner"!==i?t.setAttribute(i,e[r]):t.textContent=e[r])})),t},title:function(e){if(e){n.before=t.complement;var r=e.inner+" "+(e.separator||t.separator)+" "+(e.complement||t.complement);window.document.title=r.trim()}},update:function(){r.length&&(r.forEach((function(e,t){if(i[t]&&!i[t].isEqualNode(e))return e.parentElement.replaceChild(i[t],r[t]),void r.splice(t,1,i[t])})),i=[])},add:function(e,t,n){n.appendChild(t),(void 0===e.undo||e.undo)&&r.push(t)},handle:function(e,t,n,r){var a=this;e&&e.forEach((function(e){var o=e.body?a.getPlace("body"):a.getPlace(n),s=window.document.getElementById(e.id);s||(s=window.document.createElement(t),r=!1),s.hasAttribute("id")?a.prepareElement(e,s):(s=a.prepareElement(e,s),r?i.push(s):a.add(e,s,o))}))}};function s(e,r){function i(e){var t=this,n="function"===typeof t.$options.head?t.$options.head.bind(t)():t.$options.head;n&&(Object.keys(n).forEach((function(r){var i=n[r];if(i){var a="function"===typeof i?n[r].bind(t)():n[r];"title"!==r?o.handle(a,r,"head",e):o[r](a)}})),t.$emit("okHead"))}function s(){this.$options.head&&(o.undoTitle(n),o.undo())}a||(a=!0,r&&e.util.extend(t,r),e.version.match(/[1].(.)+/g)&&e.mixin({ready:function(){i.call(this)},destroyed:function(){s.call(this)},events:{updateHead:function(){i.call(this,!0),o.update()}}}),e.version.match(/[2].(.)+/g)&&e.mixin({created:function(){var e=this;e.$on("updateHead",(function(){i.call(this,!0),o.update()}))},mounted:function(){i.call(this)},beforeDestroy:function(){s.call(this)}}))}s.version="2.2.0","undefined"!==typeof Vue&&Vue.use(s),e.exports=s})()},"342f":function(e,t,n){var r=n("d066");e.exports=r("navigator","userAgent")||""},"35a1":function(e,t,n){var r=n("f5df"),i=n("3f8c"),a=n("b622"),o=a("iterator");e.exports=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},"36c6":function(e,t,n){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}n("3410"),e.exports=r},"36c64":function(e,t){var n,r,i,a,o,s,u,c=9e4;n=function(e){return e*c},r=function(e,t){return e*t},i=function(e){return e/c},a=function(e,t){return e/t},o=function(e,t){return n(a(e,t))},s=function(e,t){return r(i(e),t)},u=function(e,t,n){return i(n?e:e-t)},e.exports={ONE_SECOND_IN_TS:c,secondsToVideoTs:n,secondsToAudioTs:r,videoTsToSeconds:i,audioTsToSeconds:a,audioTsToVideoTs:o,videoTsToAudioTs:s,metadataTsToSeconds:u}},"37e8":function(e,t,n){var r=n("83ab"),i=n("9bf2"),a=n("825a"),o=n("df75");e.exports=r?Object.defineProperties:function(e,t){a(e);var n,r=o(t),s=r.length,u=0;while(s>u)i.f(e,n=r[u++],t[n]);return e}},3966:function(module,exports,__webpack_require__){
/*!
 * videojs-record
 * @version 4.0.0
 * @see https://github.com/collab-project/videojs-record
 * @copyright 2014-2020 Collab
 * @license MIT
 */
(function(e,t){module.exports=t(__webpack_require__("a9ee"),__webpack_require__("f0e2"))})(window,(function(__WEBPACK_EXTERNAL_MODULE_recordrtc__,__WEBPACK_EXTERNAL_MODULE_video_js__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/assertThisInitialized.js ***!
  \**********************************************************************/
/*! no static exports found */function(module,exports){eval("function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/assertThisInitialized.js?")},"./node_modules/@babel/runtime/helpers/asyncToGenerator.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/asyncToGenerator.js ***!
  \*****************************************************************/
/*! no static exports found */function(module,exports){eval('function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/asyncToGenerator.js?')},"./node_modules/@babel/runtime/helpers/classCallCheck.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/classCallCheck.js ***!
  \***************************************************************/
/*! no static exports found */function(module,exports){eval('function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError("Cannot call a class as a function");\n  }\n}\n\nmodule.exports = _classCallCheck;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/classCallCheck.js?')},"./node_modules/@babel/runtime/helpers/createClass.js":
/*!************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/createClass.js ***!
  \************************************************************/
/*! no static exports found */function(module,exports){eval('function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if ("value" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/createClass.js?')},"./node_modules/@babel/runtime/helpers/get.js":
/*!****************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/get.js ***!
  \****************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('var superPropBase = __webpack_require__(/*! ./superPropBase */ "./node_modules/@babel/runtime/helpers/superPropBase.js");\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== "undefined" && Reflect.get) {\n    module.exports = _get = Reflect.get;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nmodule.exports = _get;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/get.js?')},"./node_modules/@babel/runtime/helpers/getPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/getPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */function(module,exports){eval("function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/getPrototypeOf.js?")},"./node_modules/@babel/runtime/helpers/inherits.js":
/*!*********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/inherits.js ***!
  \*********************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== "function" && superClass !== null) {\n    throw new TypeError("Super expression must either be null or a function");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/inherits.js?')},"./node_modules/@babel/runtime/helpers/interopRequireDefault.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/interopRequireDefault.js ***!
  \**********************************************************************/
/*! no static exports found */function(module,exports){eval('function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    "default": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/interopRequireDefault.js?')},"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js ***!
  \**************************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('var _typeof = __webpack_require__(/*! ../helpers/typeof */ "./node_modules/@babel/runtime/helpers/typeof.js");\n\nvar assertThisInitialized = __webpack_require__(/*! ./assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === "object" || typeof call === "function")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js?')},"./node_modules/@babel/runtime/helpers/setPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/setPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */function(module,exports){eval("function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/setPrototypeOf.js?")},"./node_modules/@babel/runtime/helpers/superPropBase.js":
/*!**************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/superPropBase.js ***!
  \**************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('var getPrototypeOf = __webpack_require__(/*! ./getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/superPropBase.js?')},"./node_modules/@babel/runtime/helpers/typeof.js":
/*!*******************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/typeof.js ***!
  \*******************************************************/
/*! no static exports found */function(module,exports){eval('function _typeof(obj) {\n  "@babel/helpers - typeof";\n\n  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/helpers/typeof.js?')},"./node_modules/@babel/runtime/regenerator/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/regenerator/index.js ***!
  \**********************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('module.exports = __webpack_require__(/*! regenerator-runtime */ "./node_modules/regenerator-runtime/runtime.js");\n\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/@babel/runtime/regenerator/index.js?')},"./node_modules/add-zero/index.js":
/*!****************************************!*\
  !*** ./node_modules/add-zero/index.js ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval("var __WEBPACK_AMD_DEFINE_RESULT__;(function(exports) {\n\n  'use strict';\n\n  function addZero(value, digits) {\n    digits = digits || 2;\n\n    var isNegative = Number(value) < 0;\n    var buffer = value.toString();\n    var size = 0;\n\n    // Strip minus sign if number is negative\n    if(isNegative) {\n      buffer = buffer.slice(1);\n    }\n\n    size = digits - buffer.length + 1;\n    buffer = new Array(size).join('0').concat(buffer);\n\n    // Adds back minus sign if needed\n    return (isNegative ? '-' : '') + buffer;\n  }\n\n  if(true) {\n    !(__WEBPACK_AMD_DEFINE_RESULT__ = (function() { return addZero; }).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else {}\n\n})(this);\n\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/add-zero/index.js?")},"./node_modules/global/window.js":
/*!***************************************!*\
  !*** ./node_modules/global/window.js ***!
  \***************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('/* WEBPACK VAR INJECTION */(function(global) {var win;\n\nif (typeof window !== "undefined") {\n    win = window;\n} else if (typeof global !== "undefined") {\n    win = global;\n} else if (typeof self !== "undefined"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/global/window.js?')},"./node_modules/parse-ms/index.js":
/*!****************************************!*\
  !*** ./node_modules/parse-ms/index.js ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\nmodule.exports = milliseconds => {\n\tif (typeof milliseconds !== 'number') {\n\t\tthrow new TypeError('Expected a number');\n\t}\n\n\tconst roundTowardsZero = milliseconds > 0 ? Math.floor : Math.ceil;\n\n\treturn {\n\t\tdays: roundTowardsZero(milliseconds / 86400000),\n\t\thours: roundTowardsZero(milliseconds / 3600000) % 24,\n\t\tminutes: roundTowardsZero(milliseconds / 60000) % 60,\n\t\tseconds: roundTowardsZero(milliseconds / 1000) % 60,\n\t\tmilliseconds: roundTowardsZero(milliseconds) % 1000,\n\t\tmicroseconds: roundTowardsZero(milliseconds * 1000) % 1000,\n\t\tnanoseconds: roundTowardsZero(milliseconds * 1e6) % 1000\n\t};\n};\n\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/parse-ms/index.js?")},"./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  "use strict";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === "function" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || "@@iterator";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";\n  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there\'s no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don\'t have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: "normal", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: "throw", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = "suspendedStart";\n  var GenStateSuspendedYield = "suspendedYield";\n  var GenStateExecuting = "executing";\n  var GenStateCompleted = "completed";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don\'t natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = "GeneratorFunction";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    ["next", "throw", "return"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === "function" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === "GeneratorFunction"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = "GeneratorFunction";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, "__await")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === "throw") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === "object" &&\n            hasOwn.call(value, "__await")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke("next", value, resolve, reject);\n          }, function(err) {\n            invoke("throw", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke("throw", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error("Generator is already running");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === "throw") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === "next") {\n          // Setting context._sent for legacy support of Babel\'s\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === "throw") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === "return") {\n          context.abrupt("return", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === "normal") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === "throw") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = "throw";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === "throw") {\n        // Note: ["return"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator["return"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = "return";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === "throw") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // "return" to "throw", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = "throw";\n        context.arg = new TypeError(\n          "The iterator does not provide a \'throw\' method");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === "throw") {\n      context.method = "throw";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = "throw";\n      context.arg = new TypeError("iterator result is not an object");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was "throw" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was "next", forget context.arg since it has been\n      // "consumed" by the delegate iterator. If context.method was\n      // "return", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== "return") {\n        context.method = "next";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = "Generator";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers\' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn\'t happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return "[object Generator]";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = "normal";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: "root" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === "function") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel\'s\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = "next";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === "t" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === "throw") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = "throw";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = "next";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === "root") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle("end");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, "catchLoc");\n          var hasFinally = hasOwn.call(entry, "finallyLoc");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error("try statement without catch or finally");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, "finallyLoc") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === "break" ||\n           type === "continue") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = "next";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === "throw") {\n        throw record.arg;\n      }\n\n      if (record.type === "break" ||\n          record.type === "continue") {\n        this.next = record.arg;\n      } else if (record.type === "return") {\n        this.rval = this.arg = record.arg;\n        this.method = "return";\n        this.next = "end";\n      } else if (record.type === "normal" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    "catch": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === "throw") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error("illegal catch attempt");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === "next") {\n        // Deliberately forget the last sent value so that we don\'t\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n   true ? module.exports : undefined\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you\'ve misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you\'re not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function("r", "regeneratorRuntime = r")(runtime);\n}\n\n\n//# sourceURL=webpack://VideojsRecord/./node_modules/regenerator-runtime/runtime.js?')},"./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */function(module,exports){eval('var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function("return this")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === "object") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it\'s\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n//# sourceURL=webpack://VideojsRecord/(webpack)/buildin/global.js?')},"./src/css/videojs.record.scss":
/*!*************************************!*\
  !*** ./src/css/videojs.record.scss ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval("// extracted by mini-css-extract-plugin\n\n//# sourceURL=webpack://VideojsRecord/./src/css/videojs.record.scss?")},"./src/js/controls/animation-display.js":
/*!**********************************************!*\
  !*** ./src/js/controls/animation-display.js ***!
  \**********************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar AnimationDisplay = function (_Component) {\n  (0, _inherits2.default)(AnimationDisplay, _Component);\n\n  var _super = _createSuper(AnimationDisplay);\n\n  function AnimationDisplay() {\n    (0, _classCallCheck2.default)(this, AnimationDisplay);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(AnimationDisplay, [{\n    key: "createEl",\n    value: function createEl() {\n      return (0, _get2.default)((0, _getPrototypeOf2.default)(AnimationDisplay.prototype), "createEl", this).call(this, \'div\', {\n        className: \'vjs-animation-display\',\n        innerHTML: \'<img />\'\n      });\n    }\n  }]);\n  return AnimationDisplay;\n}(Component);\n\nComponent.registerComponent(\'AnimationDisplay\', AnimationDisplay);\nvar _default = AnimationDisplay;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/animation-display.js?')},"./src/js/controls/camera-button.js":
/*!******************************************!*\
  !*** ./src/js/controls/camera-button.js ***!
  \******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Button = _video.default.getComponent(\'Button\');\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar CameraButton = function (_Button) {\n  (0, _inherits2.default)(CameraButton, _Button);\n\n  var _super = _createSuper(CameraButton);\n\n  function CameraButton() {\n    (0, _classCallCheck2.default)(this, CameraButton);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(CameraButton, [{\n    key: "buildCSSClass",\n    value: function buildCSSClass() {\n      return \'vjs-camera-button vjs-control vjs-button vjs-icon-photo-camera\';\n    }\n  }, {\n    key: "enable",\n    value: function enable() {\n      (0, _get2.default)((0, _getPrototypeOf2.default)(CameraButton.prototype), "enable", this).call(this);\n      this.on(this.player_, _event.default.START_RECORD, this.onStart);\n      this.on(this.player_, _event.default.STOP_RECORD, this.onStop);\n    }\n  }, {\n    key: "disable",\n    value: function disable() {\n      (0, _get2.default)((0, _getPrototypeOf2.default)(CameraButton.prototype), "disable", this).call(this);\n      this.off(this.player_, _event.default.START_RECORD, this.onStart);\n      this.off(this.player_, _event.default.STOP_RECORD, this.onStop);\n    }\n  }, {\n    key: "show",\n    value: function show() {\n      if (this.layoutExclude && this.layoutExclude === true) {\n        return;\n      }\n\n      (0, _get2.default)((0, _getPrototypeOf2.default)(CameraButton.prototype), "show", this).call(this);\n    }\n  }, {\n    key: "handleClick",\n    value: function handleClick(event) {\n      var recorder = this.player_.record();\n\n      if (!recorder.isProcessing()) {\n        recorder.start();\n      } else {\n        recorder.retrySnapshot();\n        this.onStop();\n        this.player_.trigger(_event.default.RETRY);\n      }\n    }\n  }, {\n    key: "onStart",\n    value: function onStart(event) {\n      this.removeClass(\'vjs-icon-photo-camera\');\n      this.addClass(\'vjs-icon-replay\');\n      this.controlText(\'Retry\');\n    }\n  }, {\n    key: "onStop",\n    value: function onStop(event) {\n      this.removeClass(\'vjs-icon-replay\');\n      this.addClass(\'vjs-icon-photo-camera\');\n      this.controlText(\'Image\');\n    }\n  }]);\n  return CameraButton;\n}(Button);\n\nCameraButton.prototype.controlText_ = \'Image\';\nComponent.registerComponent(\'CameraButton\', CameraButton);\nvar _default = CameraButton;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/camera-button.js?')},"./src/js/controls/device-button.js":
/*!******************************************!*\
  !*** ./src/js/controls/device-button.js ***!
  \******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Button = _video.default.getComponent(\'Button\');\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar DeviceButton = function (_Button) {\n  (0, _inherits2.default)(DeviceButton, _Button);\n\n  var _super = _createSuper(DeviceButton);\n\n  function DeviceButton() {\n    (0, _classCallCheck2.default)(this, DeviceButton);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(DeviceButton, [{\n    key: "handleClick",\n    value: function handleClick(event) {\n      this.player_.record().getDevice();\n    }\n  }, {\n    key: "show",\n    value: function show() {\n      if (this.layoutExclude && this.layoutExclude === true) {\n        return;\n      }\n\n      (0, _get2.default)((0, _getPrototypeOf2.default)(DeviceButton.prototype), "show", this).call(this);\n    }\n  }]);\n  return DeviceButton;\n}(Button);\n\nDeviceButton.prototype.controlText_ = \'Device\';\nComponent.registerComponent(\'DeviceButton\', DeviceButton);\nvar _default = DeviceButton;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/device-button.js?')},"./src/js/controls/picture-in-picture-toggle.js":
/*!******************************************************!*\
  !*** ./src/js/controls/picture-in-picture-toggle.js ***!
  \******************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Button = _video.default.getComponent(\'Button\');\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar PictureInPictureToggle = function (_Button) {\n  (0, _inherits2.default)(PictureInPictureToggle, _Button);\n\n  var _super = _createSuper(PictureInPictureToggle);\n\n  function PictureInPictureToggle(player, options) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, PictureInPictureToggle);\n    _this = _super.call(this, player, options);\n\n    _this.on(_this.player_, _event.default.ENTER_PIP, _this.onStart);\n\n    _this.on(_this.player_, _event.default.LEAVE_PIP, _this.onStop);\n\n    return _this;\n  }\n\n  (0, _createClass2.default)(PictureInPictureToggle, [{\n    key: "buildCSSClass",\n    value: function buildCSSClass() {\n      return \'vjs-pip-button vjs-control vjs-button vjs-icon-picture-in-picture-start\';\n    }\n  }, {\n    key: "show",\n    value: function show() {\n      if (this.layoutExclude && this.layoutExclude === true) {\n        return;\n      }\n\n      (0, _get2.default)((0, _getPrototypeOf2.default)(PictureInPictureToggle.prototype), "show", this).call(this);\n    }\n  }, {\n    key: "handleClick",\n    value: function () {\n      var _handleClick = (0, _asyncToGenerator2.default)(_regenerator.default.mark(function _callee(event) {\n        var recorder;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                recorder = this.player_.record();\n                this.disable();\n                _context.prev = 2;\n\n                if (!(recorder.mediaElement !== document.pictureInPictureElement)) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _context.next = 6;\n                return recorder.mediaElement.requestPictureInPicture();\n\n              case 6:\n                _context.next = 10;\n                break;\n\n              case 8:\n                _context.next = 10;\n                return document.exitPictureInPicture();\n\n              case 10:\n                _context.next = 15;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context["catch"](2);\n                this.player_.trigger(_event.default.ERROR, _context.t0);\n\n              case 15:\n                _context.prev = 15;\n                this.enable();\n                return _context.finish(15);\n\n              case 18:\n              case "end":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 12, 15, 18]]);\n      }));\n\n      function handleClick(_x) {\n        return _handleClick.apply(this, arguments);\n      }\n\n      return handleClick;\n    }()\n  }, {\n    key: "onStart",\n    value: function onStart(event) {\n      this.removeClass(\'vjs-icon-picture-in-picture-start\');\n      this.addClass(\'vjs-icon-picture-in-picture-stop\');\n    }\n  }, {\n    key: "onStop",\n    value: function onStop(event) {\n      this.removeClass(\'vjs-icon-picture-in-picture-stop\');\n      this.addClass(\'vjs-icon-picture-in-picture-start\');\n    }\n  }]);\n  return PictureInPictureToggle;\n}(Button);\n\nPictureInPictureToggle.prototype.controlText_ = \'Picture in Picture\';\nComponent.registerComponent(\'PictureInPictureToggle\', PictureInPictureToggle);\nvar _default = PictureInPictureToggle;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/picture-in-picture-toggle.js?')},"./src/js/controls/record-canvas.js":
/*!******************************************!*\
  !*** ./src/js/controls/record-canvas.js ***!
  \******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar RecordCanvas = function (_Component) {\n  (0, _inherits2.default)(RecordCanvas, _Component);\n\n  var _super = _createSuper(RecordCanvas);\n\n  function RecordCanvas() {\n    (0, _classCallCheck2.default)(this, RecordCanvas);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(RecordCanvas, [{\n    key: "createEl",\n    value: function createEl() {\n      return (0, _get2.default)((0, _getPrototypeOf2.default)(RecordCanvas.prototype), "createEl", this).call(this, \'div\', {\n        className: \'vjs-record-canvas\',\n        innerHTML: \'<canvas></canvas>\'\n      });\n    }\n  }]);\n  return RecordCanvas;\n}(Component);\n\nComponent.registerComponent(\'RecordCanvas\', RecordCanvas);\nvar _default = RecordCanvas;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/record-canvas.js?')},"./src/js/controls/record-indicator.js":
/*!*********************************************!*\
  !*** ./src/js/controls/record-indicator.js ***!
  \*********************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar RecordIndicator = function (_Component) {\n  (0, _inherits2.default)(RecordIndicator, _Component);\n\n  var _super = _createSuper(RecordIndicator);\n\n  function RecordIndicator(player, options) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, RecordIndicator);\n    _this = _super.call(this, player, options);\n\n    _this.enable();\n\n    return _this;\n  }\n\n  (0, _createClass2.default)(RecordIndicator, [{\n    key: "createEl",\n    value: function createEl() {\n      var props = {\n        className: \'vjs-record-indicator vjs-control\',\n        dir: \'ltr\'\n      };\n      var attr = {\n        \'data-label\': this.localize(\'REC\')\n      };\n      return (0, _get2.default)((0, _getPrototypeOf2.default)(RecordIndicator.prototype), "createEl", this).call(this, \'div\', props, attr);\n    }\n  }, {\n    key: "enable",\n    value: function enable() {\n      this.on(this.player_, _event.default.START_RECORD, this.show);\n      this.on(this.player_, _event.default.STOP_RECORD, this.hide);\n    }\n  }, {\n    key: "disable",\n    value: function disable() {\n      this.off(this.player_, _event.default.START_RECORD, this.show);\n      this.off(this.player_, _event.default.STOP_RECORD, this.hide);\n    }\n  }, {\n    key: "show",\n    value: function show() {\n      if (this.layoutExclude && this.layoutExclude === true) {\n        return;\n      }\n\n      (0, _get2.default)((0, _getPrototypeOf2.default)(RecordIndicator.prototype), "show", this).call(this);\n    }\n  }]);\n  return RecordIndicator;\n}(Component);\n\nComponent.registerComponent(\'RecordIndicator\', RecordIndicator);\nvar _default = RecordIndicator;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/record-indicator.js?')},"./src/js/controls/record-toggle.js":
/*!******************************************!*\
  !*** ./src/js/controls/record-toggle.js ***!
  \******************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Button = _video.default.getComponent(\'Button\');\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar RecordToggle = function (_Button) {\n  (0, _inherits2.default)(RecordToggle, _Button);\n\n  var _super = _createSuper(RecordToggle);\n\n  function RecordToggle() {\n    (0, _classCallCheck2.default)(this, RecordToggle);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(RecordToggle, [{\n    key: "buildCSSClass",\n    value: function buildCSSClass() {\n      return \'vjs-record-button vjs-control vjs-button vjs-icon-record-start\';\n    }\n  }, {\n    key: "enable",\n    value: function enable() {\n      (0, _get2.default)((0, _getPrototypeOf2.default)(RecordToggle.prototype), "enable", this).call(this);\n      this.on(this.player_, _event.default.START_RECORD, this.onStart);\n      this.on(this.player_, _event.default.STOP_RECORD, this.onStop);\n    }\n  }, {\n    key: "disable",\n    value: function disable() {\n      (0, _get2.default)((0, _getPrototypeOf2.default)(RecordToggle.prototype), "disable", this).call(this);\n      this.off(this.player_, _event.default.START_RECORD, this.onStart);\n      this.off(this.player_, _event.default.STOP_RECORD, this.onStop);\n    }\n  }, {\n    key: "show",\n    value: function show() {\n      if (this.layoutExclude && this.layoutExclude === true) {\n        return;\n      }\n\n      (0, _get2.default)((0, _getPrototypeOf2.default)(RecordToggle.prototype), "show", this).call(this);\n    }\n  }, {\n    key: "handleClick",\n    value: function handleClick(event) {\n      var recorder = this.player_.record();\n\n      if (!recorder.isRecording()) {\n        recorder.start();\n      } else {\n        recorder.stop();\n      }\n    }\n  }, {\n    key: "onStart",\n    value: function onStart(event) {\n      this.removeClass(\'vjs-icon-record-start\');\n      this.addClass(\'vjs-icon-record-stop\');\n      this.controlText(\'Stop\');\n    }\n  }, {\n    key: "onStop",\n    value: function onStop(event) {\n      this.removeClass(\'vjs-icon-record-stop\');\n      this.addClass(\'vjs-icon-record-start\');\n      this.controlText(\'Record\');\n    }\n  }]);\n  return RecordToggle;\n}(Button);\n\nRecordToggle.prototype.controlText_ = \'Record\';\nComponent.registerComponent(\'RecordToggle\', RecordToggle);\nvar _default = RecordToggle;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/controls/record-toggle.js?')},"./src/js/defaults.js":
/*!****************************!*\
  !*** ./src/js/defaults.js ***!
  \****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar pluginDefaultOptions = {\n  image: false,\n  audio: false,\n  video: false,\n  animation: false,\n  screen: false,\n  maxLength: 10,\n  maxFileSize: 0,\n  displayMilliseconds: false,\n  frameWidth: 320,\n  frameHeight: 240,\n  debug: false,\n  pip: false,\n  autoMuteDevice: false,\n  videoBitRate: 1200,\n  videoEngine: 'recordrtc',\n  videoFrameRate: 30,\n  videoMimeType: 'video/webm',\n  videoRecorderType: 'auto',\n  videoWorkerURL: '',\n  videoWebAssemblyURL: '',\n  audioEngine: 'recordrtc',\n  audioRecorderType: 'auto',\n  audioMimeType: 'auto',\n  audioBufferSize: 4096,\n  audioSampleRate: 44100,\n  audioBitRate: 128,\n  audioChannels: 2,\n  audioWorkerURL: '',\n  audioWebAssemblyURL: '',\n  audioBufferUpdate: false,\n  animationFrameRate: 200,\n  animationQuality: 10,\n  imageOutputType: 'dataURL',\n  imageOutputFormat: 'image/png',\n  imageOutputQuality: 0.92,\n  timeSlice: 0,\n  convertEngine: '',\n  convertWorkerURL: '',\n  convertOptions: [],\n  hotKeys: false,\n  pluginLibraryOptions: {}\n};\nvar _default = pluginDefaultOptions;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/defaults.js?")},"./src/js/engine/convert-engine.js":
/*!*****************************************!*\
  !*** ./src/js/engine/convert-engine.js ***!
  \*****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.FFMPEGJS = exports.TSEBML = exports.CONVERT_PLUGINS = exports.ConvertEngine = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _fileUtil = __webpack_require__(/*! ../utils/file-util */ "./src/js/utils/file-util.js");\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar TSEBML = \'ts-ebml\';\nexports.TSEBML = TSEBML;\nvar FFMPEGJS = \'ffmpeg.js\';\nexports.FFMPEGJS = FFMPEGJS;\nvar CONVERT_PLUGINS = [TSEBML, FFMPEGJS];\nexports.CONVERT_PLUGINS = CONVERT_PLUGINS;\n\nvar ConvertEngine = function (_Component) {\n  (0, _inherits2.default)(ConvertEngine, _Component);\n\n  var _super = _createSuper(ConvertEngine);\n\n  function ConvertEngine(player, options) {\n    (0, _classCallCheck2.default)(this, ConvertEngine);\n    options.evented = true;\n    return _super.call(this, player, options);\n  }\n\n  (0, _createClass2.default)(ConvertEngine, [{\n    key: "setup",\n    value: function setup(mediaType, debug) {\n      this.mediaType = mediaType;\n      this.debug = debug;\n    }\n  }, {\n    key: "loadBlob",\n    value: function loadBlob(data) {\n      return (0, _fileUtil.blobToArrayBuffer)(data);\n    }\n  }, {\n    key: "addFileInfo",\n    value: function addFileInfo(fileObj, now) {\n      (0, _fileUtil.addFileInfo)(fileObj, now);\n    }\n  }]);\n  return ConvertEngine;\n}(Component);\n\nexports.ConvertEngine = ConvertEngine;\n_video.default.ConvertEngine = ConvertEngine;\nComponent.registerComponent(\'ConvertEngine\', ConvertEngine);\n\n//# sourceURL=webpack://VideojsRecord/./src/js/engine/convert-engine.js?')},"./src/js/engine/engine-loader.js":
/*!****************************************!*\
  !*** ./src/js/engine/engine-loader.js ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.getConvertEngine = exports.getVideoEngine = exports.isAudioPluginActive = exports.getAudioEngine = void 0;\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _recordRtc = _interopRequireDefault(__webpack_require__(/*! ./record-rtc */ "./src/js/engine/record-rtc.js"));\n\nvar _convertEngine = __webpack_require__(/*! ./convert-engine */ "./src/js/engine/convert-engine.js");\n\nvar _recordEngine = __webpack_require__(/*! ./record-engine */ "./src/js/engine/record-engine.js");\n\nvar getAudioEngine = function getAudioEngine(audioEngine) {\n  var AudioEngineClass;\n\n  switch (audioEngine) {\n    case _recordEngine.RECORDRTC:\n      AudioEngineClass = _recordRtc.default;\n      break;\n\n    case _recordEngine.LIBVORBISJS:\n      AudioEngineClass = _video.default.LibVorbisEngine;\n      break;\n\n    case _recordEngine.RECORDERJS:\n      AudioEngineClass = _video.default.RecorderjsEngine;\n      break;\n\n    case _recordEngine.LAMEJS:\n      AudioEngineClass = _video.default.LamejsEngine;\n      break;\n\n    case _recordEngine.OPUSRECORDER:\n      AudioEngineClass = _video.default.OpusRecorderEngine;\n      break;\n\n    case _recordEngine.VMSG:\n      AudioEngineClass = _video.default.VmsgEngine;\n      break;\n\n    default:\n      throw new Error(\'Unknown audioEngine: \' + audioEngine);\n  }\n\n  return AudioEngineClass;\n};\n\nexports.getAudioEngine = getAudioEngine;\n\nvar getVideoEngine = function getVideoEngine(videoEngine) {\n  var VideoEngineClass;\n\n  switch (videoEngine) {\n    case _recordEngine.RECORDRTC:\n      VideoEngineClass = _recordRtc.default;\n      break;\n\n    case _recordEngine.WEBMWASM:\n      VideoEngineClass = _video.default.WebmWasmEngine;\n      break;\n\n    default:\n      throw new Error(\'Unknown videoEngine: \' + videoEngine);\n  }\n\n  return VideoEngineClass;\n};\n\nexports.getVideoEngine = getVideoEngine;\n\nvar isAudioPluginActive = function isAudioPluginActive(audioEngine) {\n  return _recordEngine.AUDIO_PLUGINS.indexOf(audioEngine) > -1;\n};\n\nexports.isAudioPluginActive = isAudioPluginActive;\n\nvar getConvertEngine = function getConvertEngine(convertEngine) {\n  var ConvertEngineClass;\n\n  switch (convertEngine) {\n    case \'\':\n      break;\n\n    case _convertEngine.TSEBML:\n      ConvertEngineClass = _video.default.TsEBMLEngine;\n      break;\n\n    case _convertEngine.FFMPEGJS:\n      ConvertEngineClass = _video.default.FFmpegjsEngine;\n      break;\n\n    default:\n      throw new Error(\'Unknown convertEngine: \' + convertEngine);\n  }\n\n  return ConvertEngineClass;\n};\n\nexports.getConvertEngine = getConvertEngine;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/engine/engine-loader.js?')},"./src/js/engine/record-engine.js":
/*!****************************************!*\
  !*** ./src/js/engine/record-engine.js ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.WEBMWASM = exports.VMSG = exports.OPUSRECORDER = exports.LAMEJS = exports.RECORDERJS = exports.LIBVORBISJS = exports.RECORDRTC = exports.VIDEO_PLUGINS = exports.AUDIO_PLUGINS = exports.RECORD_PLUGINS = exports.RecordEngine = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nvar _fileUtil = __webpack_require__(/*! ../utils/file-util */ "./src/js/utils/file-util.js");\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar RECORDRTC = \'recordrtc\';\nexports.RECORDRTC = RECORDRTC;\nvar LIBVORBISJS = \'libvorbis.js\';\nexports.LIBVORBISJS = LIBVORBISJS;\nvar RECORDERJS = \'recorder.js\';\nexports.RECORDERJS = RECORDERJS;\nvar LAMEJS = \'lamejs\';\nexports.LAMEJS = LAMEJS;\nvar OPUSRECORDER = \'opus-recorder\';\nexports.OPUSRECORDER = OPUSRECORDER;\nvar VMSG = \'vmsg\';\nexports.VMSG = VMSG;\nvar WEBMWASM = \'webm-wasm\';\nexports.WEBMWASM = WEBMWASM;\nvar AUDIO_PLUGINS = [LIBVORBISJS, RECORDERJS, LAMEJS, OPUSRECORDER, VMSG];\nexports.AUDIO_PLUGINS = AUDIO_PLUGINS;\nvar VIDEO_PLUGINS = [WEBMWASM];\nexports.VIDEO_PLUGINS = VIDEO_PLUGINS;\nvar RECORD_PLUGINS = AUDIO_PLUGINS.concat(VIDEO_PLUGINS);\nexports.RECORD_PLUGINS = RECORD_PLUGINS;\n\nvar RecordEngine = function (_Component) {\n  (0, _inherits2.default)(RecordEngine, _Component);\n\n  var _super = _createSuper(RecordEngine);\n\n  function RecordEngine(player, options) {\n    (0, _classCallCheck2.default)(this, RecordEngine);\n    options.evented = true;\n    return _super.call(this, player, options);\n  }\n\n  (0, _createClass2.default)(RecordEngine, [{\n    key: "dispose",\n    value: function dispose() {\n      if (this.recordedData !== undefined) {\n        URL.revokeObjectURL(this.recordedData);\n      }\n    }\n  }, {\n    key: "destroy",\n    value: function destroy() {}\n  }, {\n    key: "addFileInfo",\n    value: function addFileInfo(fileObj) {\n      (0, _fileUtil.addFileInfo)(fileObj);\n    }\n  }, {\n    key: "onStopRecording",\n    value: function onStopRecording(data) {\n      this.recordedData = data;\n      this.addFileInfo(this.recordedData);\n      this.dispose();\n      this.trigger(_event.default.RECORD_COMPLETE);\n    }\n  }, {\n    key: "saveAs",\n    value: function saveAs(name) {\n      var fileName = name[Object.keys(name)[0]];\n      (0, _fileUtil.downloadBlob)(fileName, this.recordedData);\n    }\n  }]);\n  return RecordEngine;\n}(Component);\n\nexports.RecordEngine = RecordEngine;\n_video.default.RecordEngine = RecordEngine;\nComponent.registerComponent(\'RecordEngine\', RecordEngine);\n\n//# sourceURL=webpack://VideojsRecord/./src/js/engine/record-engine.js?')},"./src/js/engine/record-mode.js":
/*!**************************************!*\
  !*** ./src/js/engine/record-mode.js ***!
  \**************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AUDIO_SCREEN = exports.SCREEN_ONLY = exports.ANIMATION = exports.AUDIO_VIDEO = exports.VIDEO_ONLY = exports.AUDIO_ONLY = exports.IMAGE_ONLY = exports.getRecorderMode = void 0;\nvar IMAGE_ONLY = 'image_only';\nexports.IMAGE_ONLY = IMAGE_ONLY;\nvar AUDIO_ONLY = 'audio_only';\nexports.AUDIO_ONLY = AUDIO_ONLY;\nvar VIDEO_ONLY = 'video_only';\nexports.VIDEO_ONLY = VIDEO_ONLY;\nvar AUDIO_VIDEO = 'audio_video';\nexports.AUDIO_VIDEO = AUDIO_VIDEO;\nvar AUDIO_SCREEN = 'audio_screen';\nexports.AUDIO_SCREEN = AUDIO_SCREEN;\nvar ANIMATION = 'animation';\nexports.ANIMATION = ANIMATION;\nvar SCREEN_ONLY = 'screen_only';\nexports.SCREEN_ONLY = SCREEN_ONLY;\n\nvar getRecorderMode = function getRecorderMode(image, audio, video, animation, screen) {\n  if (isModeEnabled(image)) {\n    return IMAGE_ONLY;\n  } else if (isModeEnabled(animation)) {\n    return ANIMATION;\n  } else if (isModeEnabled(audio) && isModeEnabled(video)) {\n    return AUDIO_VIDEO;\n  } else if (isModeEnabled(audio) && isModeEnabled(screen)) {\n    return AUDIO_SCREEN;\n  } else if (!isModeEnabled(audio) && isModeEnabled(screen)) {\n    return SCREEN_ONLY;\n  } else if (isModeEnabled(audio) && !isModeEnabled(video)) {\n    return AUDIO_ONLY;\n  } else if (!isModeEnabled(audio) && isModeEnabled(video)) {\n    return VIDEO_ONLY;\n  }\n};\n\nexports.getRecorderMode = getRecorderMode;\n\nvar isModeEnabled = function isModeEnabled(mode) {\n  return mode === Object(mode) || mode === true;\n};\n\n//# sourceURL=webpack://VideojsRecord/./src/js/engine/record-mode.js?")},"./src/js/engine/record-rtc.js":
/*!*************************************!*\
  !*** ./src/js/engine/record-rtc.js ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _recordrtc = _interopRequireDefault(__webpack_require__(/*! recordrtc */ "recordrtc"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ../event */ "./src/js/event.js"));\n\nvar _recordEngine = __webpack_require__(/*! ./record-engine */ "./src/js/engine/record-engine.js");\n\nvar _detectBrowser = __webpack_require__(/*! ../utils/detect-browser */ "./src/js/utils/detect-browser.js");\n\nvar _recordMode = __webpack_require__(/*! ./record-mode */ "./src/js/engine/record-mode.js");\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Component = _video.default.getComponent(\'Component\');\n\nvar RecordRTCEngine = function (_RecordEngine) {\n  (0, _inherits2.default)(RecordRTCEngine, _RecordEngine);\n\n  var _super = _createSuper(RecordRTCEngine);\n\n  function RecordRTCEngine() {\n    (0, _classCallCheck2.default)(this, RecordRTCEngine);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(RecordRTCEngine, [{\n    key: "setup",\n    value: function setup(stream, mediaType, debug) {\n      this.inputStream = stream;\n      this.mediaType = mediaType;\n      this.debug = debug;\n\n      if (\'screen\' in this.mediaType) {\n        this.mediaType.video = true;\n      }\n\n      if (this.recorderType !== undefined) {\n        this.mediaType.video = this.recorderType;\n      }\n\n      this.engine = new _recordrtc.default.MRecordRTC();\n      this.engine.mediaType = this.mediaType;\n      this.engine.disableLogs = !this.debug;\n      this.engine.mimeType = this.mimeType;\n      this.engine.bufferSize = this.bufferSize;\n      this.engine.sampleRate = this.sampleRate;\n      this.engine.numberOfAudioChannels = this.audioChannels;\n      this.engine.video = this.video;\n      this.engine.canvas = this.canvas;\n      this.engine.bitrate = this.bitRate;\n      this.engine.quality = this.quality;\n      this.engine.frameRate = this.frameRate;\n\n      if (this.timeSlice !== undefined) {\n        this.engine.timeSlice = this.timeSlice;\n        this.engine.onTimeStamp = this.onTimeStamp.bind(this);\n      }\n\n      this.engine.workerPath = this.workerPath;\n      this.engine.webAssemblyPath = this.videoWebAssemblyURL;\n      this.engine.addStream(this.inputStream);\n    }\n  }, {\n    key: "dispose",\n    value: function dispose() {\n      (0, _get2.default)((0, _getPrototypeOf2.default)(RecordRTCEngine.prototype), "dispose", this).call(this);\n      this.destroy();\n    }\n  }, {\n    key: "destroy",\n    value: function destroy() {\n      if (this.engine && typeof this.engine.destroy === \'function\') {\n        this.engine.destroy();\n      }\n    }\n  }, {\n    key: "start",\n    value: function start() {\n      this.engine.startRecording();\n    }\n  }, {\n    key: "stop",\n    value: function stop() {\n      this.engine.stopRecording(this.onStopRecording.bind(this));\n    }\n  }, {\n    key: "pause",\n    value: function pause() {\n      this.engine.pauseRecording();\n    }\n  }, {\n    key: "resume",\n    value: function resume() {\n      this.engine.resumeRecording();\n    }\n  }, {\n    key: "saveAs",\n    value: function saveAs(name) {\n      if (this.engine && name !== undefined) {\n        this.engine.save(name);\n      }\n    }\n  }, {\n    key: "onStopRecording",\n    value: function onStopRecording(audioVideoURL, type) {\n      var _this = this;\n\n      URL.revokeObjectURL(audioVideoURL);\n      var recordType = this.player().record().getRecordType();\n      this.engine.getBlob(function (recording) {\n        switch (recordType) {\n          case _recordMode.AUDIO_ONLY:\n            if (recording.audio !== undefined) {\n              _this.recordedData = recording.audio;\n            }\n\n            break;\n\n          case _recordMode.VIDEO_ONLY:\n          case _recordMode.AUDIO_VIDEO:\n          case _recordMode.AUDIO_SCREEN:\n          case _recordMode.SCREEN_ONLY:\n            if (recording.video !== undefined) {\n              _this.recordedData = recording.video;\n            }\n\n            break;\n\n          case _recordMode.ANIMATION:\n            if (recording.gif !== undefined) {\n              _this.recordedData = recording.gif;\n            }\n\n            break;\n        }\n\n        _this.addFileInfo(_this.recordedData);\n\n        _this.trigger(_event.default.RECORD_COMPLETE);\n      });\n    }\n  }, {\n    key: "onTimeStamp",\n    value: function onTimeStamp(current, all) {\n      this.player().currentTimestamp = current;\n      this.player().allTimestamps = all;\n      var internal;\n\n      switch (this.player().record().getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          internal = this.engine.audioRecorder;\n          break;\n\n        case _recordMode.ANIMATION:\n          internal = this.engine.gifRecorder;\n          break;\n\n        default:\n          internal = this.engine.videoRecorder;\n      }\n\n      var maxFileSizeReached = false;\n\n      if (internal) {\n        internal = internal.getInternalRecorder();\n      }\n\n      if (internal instanceof _recordrtc.default.MediaStreamRecorder === true) {\n        this.player().recordedData = internal.getArrayOfBlobs();\n        this.addFileInfo(this.player().recordedData[this.player_.recordedData.length - 1]);\n\n        if (this.maxFileSize > 0) {\n          var currentSize = new Blob(this.player().recordedData).size;\n\n          if (currentSize >= this.maxFileSize) {\n            maxFileSizeReached = true;\n          }\n        }\n      }\n\n      this.player().trigger(_event.default.TIMESTAMP);\n\n      if (maxFileSizeReached) {\n        this.player().record().stop();\n      }\n    }\n  }]);\n  return RecordRTCEngine;\n}(_recordEngine.RecordEngine);\n\n_video.default.RecordRTCEngine = RecordRTCEngine;\nComponent.registerComponent(\'RecordRTCEngine\', RecordRTCEngine);\nvar _default = RecordRTCEngine;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/engine/record-rtc.js?')},"./src/js/event.js":
/*!*************************!*\
  !*** ./src/js/event.js ***!
  \*************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ \"./node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ \"./node_modules/@babel/runtime/helpers/classCallCheck.js\"));\n\nvar Event = function Event() {\n  (0, _classCallCheck2.default)(this, Event);\n};\n\nEvent.READY = 'ready';\nEvent.ERROR = 'error';\nEvent.PLAYING = 'playing';\nEvent.LOADEDMETADATA = 'loadedmetadata';\nEvent.LOADSTART = 'loadstart';\nEvent.USERINACTIVE = 'userinactive';\nEvent.TIMEUPDATE = 'timeupdate';\nEvent.DURATIONCHANGE = 'durationchange';\nEvent.ENDED = 'ended';\nEvent.PAUSE = 'pause';\nEvent.PLAY = 'play';\nEvent.DEVICE_READY = 'deviceReady';\nEvent.DEVICE_ERROR = 'deviceError';\nEvent.START_RECORD = 'startRecord';\nEvent.STOP_RECORD = 'stopRecord';\nEvent.FINISH_RECORD = 'finishRecord';\nEvent.RECORD_COMPLETE = 'recordComplete';\nEvent.PROGRESS_RECORD = 'progressRecord';\nEvent.TIMESTAMP = 'timestamp';\nEvent.ENUMERATE_READY = 'enumerateReady';\nEvent.ENUMERATE_ERROR = 'enumerateError';\nEvent.AUDIO_BUFFER_UPDATE = 'audioBufferUpdate';\nEvent.AUDIO_OUTPUT_READY = 'audioOutputReady';\nEvent.START_CONVERT = 'startConvert';\nEvent.FINISH_CONVERT = 'finishConvert';\nEvent.ENTER_PIP = 'enterPIP';\nEvent.LEAVE_PIP = 'leavePIP';\nEvent.RETRY = 'retry';\nEvent.ENTERPICTUREINPICTURE = 'enterpictureinpicture';\nEvent.LEAVEPICTUREINPICTURE = 'leavepictureinpicture';\nObject.freeze(Event);\nvar _default = Event;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/event.js?")},"./src/js/hot-keys.js":
/*!****************************!*\
  !*** ./src/js/hot-keys.js ***!
  \****************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _recordMode = __webpack_require__(/*! ./engine/record-mode */ \"./src/js/engine/record-mode.js\");\n\nvar X_KEY = 88;\nvar P_KEY = 80;\nvar C_KEY = 67;\n\nvar defaultKeyHandler = function defaultKeyHandler(event) {\n  switch (event.which) {\n    case X_KEY:\n      switch (this.player_.record().getRecordType()) {\n        case _recordMode.IMAGE_ONLY:\n          this.player_.cameraButton.trigger('click');\n          break;\n\n        default:\n          this.player_.recordToggle.trigger('click');\n      }\n\n      break;\n\n    case P_KEY:\n      if (this.player_.record().pictureInPicture === true) {\n        this.player_.pipToggle.trigger('click');\n      }\n\n      break;\n\n    case C_KEY:\n      if (this.player_.controlBar.playToggle && this.player_.controlBar.playToggle.contentEl()) {\n        player.controlBar.playToggle.trigger('click');\n      }\n\n      break;\n  }\n};\n\nvar _default = defaultKeyHandler;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/hot-keys.js?")},"./src/js/utils/browser-shim.js":
/*!**************************************!*\
  !*** ./src/js/utils/browser-shim.js ***!
  \**************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar setSrcObject = function setSrcObject(stream, element) {\n  if ('srcObject' in element) {\n    element.srcObject = stream;\n  } else if ('mozSrcObject' in element) {\n    element.mozSrcObject = stream;\n  } else {\n    element.srcObject = stream;\n  }\n};\n\nvar _default = setSrcObject;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/browser-shim.js?")},"./src/js/utils/compare-version.js":
/*!*****************************************!*\
  !*** ./src/js/utils/compare-version.js ***!
  \*****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar compareVersion = function compareVersion(v1, v2) {\n  if (typeof v1 !== 'string') return false;\n  if (typeof v2 !== 'string') return false;\n  v1 = v1.split('.');\n  v2 = v2.split('.');\n  var k = Math.min(v1.length, v2.length);\n  var i = 0;\n\n  for (i; i < k; ++i) {\n    v1[i] = parseInt(v1[i], 10);\n    v2[i] = parseInt(v2[i], 10);\n    if (v1[i] > v2[i]) return 1;\n    if (v1[i] < v2[i]) return -1;\n  }\n\n  return v1.length === v2.length ? 0 : v1.length < v2.length ? -1 : 1;\n};\n\nvar _default = compareVersion;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/compare-version.js?")},"./src/js/utils/detect-browser.js":
/*!****************************************!*\
  !*** ./src/js/utils/detect-browser.js ***!
  \****************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ \"./node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isFirefox = exports.isSafari = exports.isChrome = exports.isOpera = exports.isEdge = exports.detectBrowser = void 0;\n\nvar _window = _interopRequireDefault(__webpack_require__(/*! global/window */ \"./node_modules/global/window.js\"));\n\nvar detectBrowser = function detectBrowser() {\n  var result = {};\n  result.browser = null;\n  result.version = null;\n  result.minVersion = null;\n\n  if (typeof _window.default === 'undefined' || !_window.default.navigator) {\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  if (navigator.mozGetUserMedia) {\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n    result.minVersion = 31;\n  } else if (navigator.webkitGetUserMedia) {\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n    result.minVersion = 38;\n  } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\n    result.minVersion = 10547;\n  } else if (_window.default.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n  } else {\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n};\n\nexports.detectBrowser = detectBrowser;\n\nvar extractVersion = function extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n};\n\nvar isEdge = function isEdge() {\n  return detectBrowser().browser === 'edge';\n};\n\nexports.isEdge = isEdge;\n\nvar isSafari = function isSafari() {\n  return detectBrowser().browser === 'safari';\n};\n\nexports.isSafari = isSafari;\n\nvar isOpera = function isOpera() {\n  return !!_window.default.opera || navigator.userAgent.indexOf('OPR/') !== -1;\n};\n\nexports.isOpera = isOpera;\n\nvar isChrome = function isChrome() {\n  return detectBrowser().browser === 'chrome';\n};\n\nexports.isChrome = isChrome;\n\nvar isFirefox = function isFirefox() {\n  return detectBrowser().browser === 'firefox';\n};\n\nexports.isFirefox = isFirefox;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/detect-browser.js?")},"./src/js/utils/file-util.js":
/*!***********************************!*\
  !*** ./src/js/utils/file-util.js ***!
  \***********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ \"./node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addFileInfo = exports.blobToArrayBuffer = exports.downloadBlob = void 0;\n\nvar _mime = _interopRequireDefault(__webpack_require__(/*! ./mime */ \"./src/js/utils/mime.js\"));\n\nvar downloadBlob = function downloadBlob(fileName, data) {\n  if (typeof navigator.msSaveOrOpenBlob !== 'undefined') {\n    return navigator.msSaveOrOpenBlob(data, fileName);\n  } else if (typeof navigator.msSaveBlob !== 'undefined') {\n    return navigator.msSaveBlob(data, fileName);\n  }\n\n  var hyperlink = document.createElement('a');\n  hyperlink.href = URL.createObjectURL(data);\n  hyperlink.download = fileName;\n  hyperlink.style = 'display:none;opacity:0;color:transparent;';\n  (document.body || document.documentElement).appendChild(hyperlink);\n\n  if (typeof hyperlink.click === 'function') {\n    hyperlink.click();\n  } else {\n    hyperlink.target = '_blank';\n    hyperlink.dispatchEvent(new MouseEvent('click', {\n      view: window,\n      bubbles: true,\n      cancelable: true\n    }));\n  }\n\n  URL.revokeObjectURL(hyperlink.href);\n};\n\nexports.downloadBlob = downloadBlob;\n\nvar blobToArrayBuffer = function blobToArrayBuffer(fileObj) {\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n\n    reader.onloadend = function () {\n      resolve(reader.result);\n    };\n\n    reader.onerror = function (ev) {\n      reject(ev.error);\n    };\n\n    reader.readAsArrayBuffer(fileObj);\n  });\n};\n\nexports.blobToArrayBuffer = blobToArrayBuffer;\n\nvar addFileInfo = function addFileInfo(fileObj, dateObj, fileExtension) {\n  if (fileObj instanceof Blob || fileObj instanceof File) {\n    if (dateObj === undefined) {\n      dateObj = new Date();\n    }\n\n    try {\n      fileObj.lastModified = dateObj.getTime();\n      fileObj.lastModifiedDate = dateObj;\n    } catch (e) {\n      if (e instanceof TypeError) {} else {\n        throw e;\n      }\n    }\n\n    if (fileExtension === undefined) {\n      fileExtension = '.' + (0, _mime.default)(fileObj.type);\n    }\n\n    try {\n      fileObj.name = dateObj.getTime() + fileExtension;\n    } catch (e) {\n      if (e instanceof TypeError) {} else {\n        throw e;\n      }\n    }\n  }\n};\n\nexports.addFileInfo = addFileInfo;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/file-util.js?")},"./src/js/utils/format-time.js":
/*!*************************************!*\
  !*** ./src/js/utils/format-time.js ***!
  \*************************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.default = void 0;\n\nvar _parseMs = _interopRequireDefault(__webpack_require__(/*! parse-ms */ "./node_modules/parse-ms/index.js"));\n\nvar _addZero = _interopRequireDefault(__webpack_require__(/*! add-zero */ "./node_modules/add-zero/index.js"));\n\nvar formatTime = function formatTime(seconds, guide) {\n  var displayMilliseconds = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  seconds = seconds < 0 ? 0 : seconds;\n\n  if (isNaN(seconds) || seconds === Infinity) {\n    seconds = 0;\n  }\n\n  var inputTime = (0, _parseMs.default)(seconds * 1000);\n  var guideTime = inputTime;\n\n  if (guide !== undefined) {\n    guideTime = (0, _parseMs.default)(guide * 1000);\n  }\n\n  var hr = (0, _addZero.default)(inputTime.hours);\n  var min = (0, _addZero.default)(inputTime.minutes);\n  var sec = (0, _addZero.default)(inputTime.seconds);\n  var ms = (0, _addZero.default)(inputTime.milliseconds, 3);\n\n  if (inputTime.days > 0 || guideTime.days > 0) {\n    var day = (0, _addZero.default)(inputTime.days);\n    return "".concat(day, ":").concat(hr, ":").concat(min, ":").concat(sec);\n  }\n\n  if (inputTime.hours > 0 || guideTime.hours > 0) {\n    return "".concat(hr, ":").concat(min, ":").concat(sec);\n  }\n\n  if (displayMilliseconds) {\n    return "".concat(min, ":").concat(sec, ":").concat(ms);\n  }\n\n  return "".concat(min, ":").concat(sec);\n};\n\nvar _default = formatTime;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/format-time.js?')},"./src/js/utils/mime.js":
/*!******************************!*\
  !*** ./src/js/utils/mime.js ***!
  \******************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar EXTRACT_TYPE_REGEXP = /^\\s*([^;\\s]*)(?:;|\\s|$)/;\nvar Mimetypes = {\n  'video/ogg': 'ogv',\n  'video/mp4': 'mp4',\n  'video/x-matroska': 'mkv',\n  'video/webm': 'webm',\n  'audio/mp4': 'm4a',\n  'audio/mpeg': 'mp3',\n  'audio/aac': 'aac',\n  'audio/flac': 'flac',\n  'audio/ogg': 'oga',\n  'audio/wav': 'wav',\n  'audio/webm': 'webm',\n  'application/x-mpegURL': 'm3u8',\n  'image/jpeg': 'jpg',\n  'image/gif': 'gif',\n  'image/png': 'png',\n  'image/svg+xml': 'svg',\n  'image/webp': 'webp'\n};\n\nvar getExtension = function getExtension(mimeType) {\n  var match = EXTRACT_TYPE_REGEXP.exec(mimeType);\n  var result = match && match[1].toLowerCase();\n  return Mimetypes[result];\n};\n\nvar _default = getExtension;\nexports.default = _default;\nmodule.exports = exports.default;\n\n//# sourceURL=webpack://VideojsRecord/./src/js/utils/mime.js?")},"./src/js/videojs.record.js":
/*!**********************************!*\
  !*** ./src/js/videojs.record.js ***!
  \**********************************/
/*! no static exports found */function(module,exports,__webpack_require__){"use strict";eval('\n\nvar _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");\n\nObject.defineProperty(exports, "__esModule", {\n  value: true\n});\nexports.Record = void 0;\n\nvar _typeof2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/typeof */ "./node_modules/@babel/runtime/helpers/typeof.js"));\n\nvar _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));\n\nvar _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));\n\nvar _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));\n\nvar _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));\n\nvar _video = _interopRequireDefault(__webpack_require__(/*! video.js */ "video.js"));\n\nvar _animationDisplay = _interopRequireDefault(__webpack_require__(/*! ./controls/animation-display */ "./src/js/controls/animation-display.js"));\n\nvar _recordCanvas = _interopRequireDefault(__webpack_require__(/*! ./controls/record-canvas */ "./src/js/controls/record-canvas.js"));\n\nvar _deviceButton = _interopRequireDefault(__webpack_require__(/*! ./controls/device-button */ "./src/js/controls/device-button.js"));\n\nvar _cameraButton = _interopRequireDefault(__webpack_require__(/*! ./controls/camera-button */ "./src/js/controls/camera-button.js"));\n\nvar _recordToggle = _interopRequireDefault(__webpack_require__(/*! ./controls/record-toggle */ "./src/js/controls/record-toggle.js"));\n\nvar _recordIndicator = _interopRequireDefault(__webpack_require__(/*! ./controls/record-indicator */ "./src/js/controls/record-indicator.js"));\n\nvar _pictureInPictureToggle = _interopRequireDefault(__webpack_require__(/*! ./controls/picture-in-picture-toggle */ "./src/js/controls/picture-in-picture-toggle.js"));\n\nvar _event = _interopRequireDefault(__webpack_require__(/*! ./event */ "./src/js/event.js"));\n\nvar _hotKeys = _interopRequireDefault(__webpack_require__(/*! ./hot-keys */ "./src/js/hot-keys.js"));\n\nvar _defaults = _interopRequireDefault(__webpack_require__(/*! ./defaults */ "./src/js/defaults.js"));\n\nvar _formatTime = _interopRequireDefault(__webpack_require__(/*! ./utils/format-time */ "./src/js/utils/format-time.js"));\n\nvar _browserShim = _interopRequireDefault(__webpack_require__(/*! ./utils/browser-shim */ "./src/js/utils/browser-shim.js"));\n\nvar _compareVersion = _interopRequireDefault(__webpack_require__(/*! ./utils/compare-version */ "./src/js/utils/compare-version.js"));\n\nvar _detectBrowser = __webpack_require__(/*! ./utils/detect-browser */ "./src/js/utils/detect-browser.js");\n\nvar _engineLoader = __webpack_require__(/*! ./engine/engine-loader */ "./src/js/engine/engine-loader.js");\n\nvar _recordMode = __webpack_require__(/*! ./engine/record-mode */ "./src/js/engine/record-mode.js");\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nvar Plugin = _video.default.getPlugin(\'plugin\');\n\nvar Player = _video.default.getComponent(\'Player\');\n\nvar AUTO = \'auto\';\n\nvar Record = function (_Plugin) {\n  (0, _inherits2.default)(Record, _Plugin);\n\n  var _super = _createSuper(Record);\n\n  function Record(player, options) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, Record);\n    _this = _super.call(this, player, options);\n\n    Player.prototype.play = function play() {\n      var retval = this.techGet_(\'play\');\n\n      if (retval !== undefined && typeof retval.then === \'function\') {\n        retval.then(null, function (e) {});\n      }\n\n      return retval;\n    };\n\n    player.addClass(\'vjs-record\');\n\n    _this.loadOptions();\n\n    _this.resetState();\n\n    _video.default.setFormatTime(function (seconds, guide) {\n      return (0, _formatTime.default)(seconds, guide, _this.displayMilliseconds);\n    });\n\n    var deviceIcon = \'av-perm\';\n\n    switch (_this.getRecordType()) {\n      case _recordMode.IMAGE_ONLY:\n      case _recordMode.VIDEO_ONLY:\n      case _recordMode.ANIMATION:\n        deviceIcon = \'video-perm\';\n        break;\n\n      case _recordMode.AUDIO_ONLY:\n        deviceIcon = \'audio-perm\';\n        break;\n\n      case _recordMode.SCREEN_ONLY:\n        deviceIcon = \'screen-perm\';\n        break;\n\n      case _recordMode.AUDIO_SCREEN:\n        deviceIcon = \'sv-perm\';\n        break;\n    }\n\n    _deviceButton.default.prototype.buildCSSClass = function () {\n      return \'vjs-record vjs-device-button vjs-control vjs-icon-\' + deviceIcon;\n    };\n\n    player.deviceButton = new _deviceButton.default(player, options);\n    player.addChild(player.deviceButton);\n    player.recordIndicator = new _recordIndicator.default(player, options);\n    player.recordIndicator.hide();\n    player.addChild(player.recordIndicator);\n    player.recordCanvas = new _recordCanvas.default(player, options);\n    player.recordCanvas.hide();\n    player.addChild(player.recordCanvas);\n    player.animationDisplay = new _animationDisplay.default(player, options);\n    player.animationDisplay.hide();\n    player.addChild(player.animationDisplay);\n    player.cameraButton = new _cameraButton.default(player, options);\n    player.cameraButton.hide();\n    player.recordToggle = new _recordToggle.default(player, options);\n    player.recordToggle.hide();\n    var oldVideoJS = _video.default.VERSION === undefined || (0, _compareVersion.default)(_video.default.VERSION, \'7.6.0\') === -1;\n\n    if (!(\'exitPictureInPicture\' in document)) {\n      _this.pictureInPicture = false;\n    } else if (oldVideoJS) {\n      player.pipToggle = new _pictureInPictureToggle.default(player, options);\n      player.pipToggle.hide();\n    }\n\n    if (_this.pictureInPicture === true) {\n      _this.onEnterPiPHandler = _this.onEnterPiP.bind((0, _assertThisInitialized2.default)(_this));\n      _this.onLeavePiPHandler = _this.onLeavePiP.bind((0, _assertThisInitialized2.default)(_this));\n    }\n\n    if (_this.player.options_.controlBar) {\n      var customUIElements = [\'deviceButton\', \'recordIndicator\', \'cameraButton\', \'recordToggle\'];\n\n      if (player.pipToggle) {\n        customUIElements.push(\'pipToggle\');\n      }\n\n      customUIElements.forEach(function (element) {\n        if (_this.player.options_.controlBar[element] !== undefined) {\n          _this.player[element].layoutExclude = true;\n\n          _this.player[element].hide();\n        }\n      });\n    }\n\n    _this.player.one(_event.default.READY, _this.setupUI.bind((0, _assertThisInitialized2.default)(_this)));\n\n    return _this;\n  }\n\n  (0, _createClass2.default)(Record, [{\n    key: "loadOptions",\n    value: function loadOptions() {\n      var newOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var recordOptions = _video.default.mergeOptions(_defaults.default, this.player.options_.plugins.record, newOptions);\n\n      this.recordImage = recordOptions.image;\n      this.recordAudio = recordOptions.audio;\n      this.recordVideo = recordOptions.video;\n      this.recordAnimation = recordOptions.animation;\n      this.recordScreen = recordOptions.screen;\n      this.maxLength = recordOptions.maxLength;\n      this.maxFileSize = recordOptions.maxFileSize;\n      this.displayMilliseconds = recordOptions.displayMilliseconds;\n      this.debug = recordOptions.debug;\n      this.pictureInPicture = recordOptions.pip;\n      this.recordTimeSlice = recordOptions.timeSlice;\n      this.autoMuteDevice = recordOptions.autoMuteDevice;\n      this.pluginLibraryOptions = recordOptions.pluginLibraryOptions;\n      this.videoFrameWidth = recordOptions.frameWidth;\n      this.videoFrameHeight = recordOptions.frameHeight;\n      this.videoFrameRate = recordOptions.videoFrameRate;\n      this.videoBitRate = recordOptions.videoBitRate;\n      this.videoEngine = recordOptions.videoEngine;\n      this.videoRecorderType = recordOptions.videoRecorderType;\n      this.videoMimeType = recordOptions.videoMimeType;\n      this.videoWorkerURL = recordOptions.videoWorkerURL;\n      this.videoWebAssemblyURL = recordOptions.videoWebAssemblyURL;\n      this.convertEngine = recordOptions.convertEngine;\n      this.convertWorkerURL = recordOptions.convertWorkerURL;\n      this.convertOptions = recordOptions.convertOptions;\n      this.audioEngine = recordOptions.audioEngine;\n      this.audioRecorderType = recordOptions.audioRecorderType;\n      this.audioWorkerURL = recordOptions.audioWorkerURL;\n      this.audioWebAssemblyURL = recordOptions.audioWebAssemblyURL;\n      this.audioBufferSize = recordOptions.audioBufferSize;\n      this.audioSampleRate = recordOptions.audioSampleRate;\n      this.audioBitRate = recordOptions.audioBitRate;\n      this.audioChannels = recordOptions.audioChannels;\n      this.audioMimeType = recordOptions.audioMimeType;\n      this.audioBufferUpdate = recordOptions.audioBufferUpdate;\n      this.imageOutputType = recordOptions.imageOutputType;\n      this.imageOutputFormat = recordOptions.imageOutputFormat;\n      this.imageOutputQuality = recordOptions.imageOutputQuality;\n      this.animationFrameRate = recordOptions.animationFrameRate;\n      this.animationQuality = recordOptions.animationQuality;\n    }\n  }, {\n    key: "setupUI",\n    value: function setupUI() {\n      var _this2 = this;\n\n      this.player.controlBar.addChild(this.player.cameraButton);\n      this.player.controlBar.el().insertBefore(this.player.cameraButton.el(), this.player.controlBar.el().firstChild);\n      this.player.controlBar.el().insertBefore(this.player.recordToggle.el(), this.player.controlBar.el().firstChild);\n\n      if (this.pictureInPicture === true) {\n        if (this.player.controlBar.pictureInPictureToggle === undefined && this.player.pipToggle !== undefined) {\n          this.player.controlBar.addChild(this.player.pipToggle);\n        } else if (this.player.controlBar.pictureInPictureToggle !== undefined) {\n          this.player.pipToggle = this.player.controlBar.pictureInPictureToggle;\n          this.player.pipToggle.hide();\n        }\n      }\n\n      if (this.player.controlBar.remainingTimeDisplay !== undefined) {\n        this.player.controlBar.remainingTimeDisplay.el().style.display = \'none\';\n      }\n\n      if (this.player.controlBar.liveDisplay !== undefined) {\n        this.player.controlBar.liveDisplay.el().style.display = \'none\';\n      }\n\n      this.player.loop(false);\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer = this.player.wavesurfer();\n          break;\n\n        case _recordMode.IMAGE_ONLY:\n        case _recordMode.VIDEO_ONLY:\n        case _recordMode.AUDIO_VIDEO:\n        case _recordMode.ANIMATION:\n        case _recordMode.SCREEN_ONLY:\n        case _recordMode.AUDIO_SCREEN:\n          if (this.player.bigPlayButton !== undefined) {\n            this.player.bigPlayButton.hide();\n          }\n\n          this.player.one(_event.default.LOADEDMETADATA, function () {\n            _this2.setDuration(_this2.maxLength);\n          });\n          this.player.one(_event.default.LOADSTART, function () {\n            _this2.setDuration(_this2.maxLength);\n          });\n\n          if (this.player.usingNativeControls_ === true) {\n            if (this.player.tech_.el_ !== undefined) {\n              this.player.tech_.el_.controls = false;\n            }\n          }\n\n          this.player.removeTechControlsListeners_();\n\n          if (this.player.options_.controls) {\n            if (this.player.controlBar.progressControl !== undefined) {\n              this.player.controlBar.progressControl.hide();\n            }\n\n            this.player.on(_event.default.USERINACTIVE, function (event) {\n              _this2.player.userActive(true);\n            });\n            this.player.controlBar.show();\n            this.player.controlBar.el().style.display = \'flex\';\n          }\n\n          break;\n      }\n\n      this.player.off(_event.default.TIMEUPDATE);\n      this.player.off(_event.default.DURATIONCHANGE);\n      this.player.off(_event.default.LOADEDMETADATA);\n      this.player.off(_event.default.LOADSTART);\n      this.player.off(_event.default.ENDED);\n      this.setDuration(this.maxLength);\n\n      if (this.player.options_.plugins.record && this.player.options_.plugins.record.hotKeys && this.player.options_.plugins.record.hotKeys !== false) {\n        var handler = this.player.options_.plugins.record.hotKeys;\n\n        if (handler === true) {\n          handler = _hotKeys.default;\n        }\n\n        this.player.options_.userActions = {\n          hotkeys: handler\n        };\n      }\n\n      if (this.player.controlBar.playToggle !== undefined) {\n        this.player.controlBar.playToggle.hide();\n      }\n    }\n  }, {\n    key: "isRecording",\n    value: function isRecording() {\n      return this._recording;\n    }\n  }, {\n    key: "isProcessing",\n    value: function isProcessing() {\n      return this._processing;\n    }\n  }, {\n    key: "isDestroyed",\n    value: function isDestroyed() {\n      var destroyed = this.player === null;\n\n      if (destroyed === false) {\n        destroyed = this.player.children() === null;\n      }\n\n      return destroyed;\n    }\n  }, {\n    key: "getDevice",\n    value: function getDevice() {\n      var _this3 = this;\n\n      if (this.deviceReadyCallback === undefined) {\n        this.deviceReadyCallback = this.onDeviceReady.bind(this);\n      }\n\n      if (this.deviceErrorCallback === undefined) {\n        this.deviceErrorCallback = this.onDeviceError.bind(this);\n      }\n\n      if (this.engineStopCallback === undefined) {\n        this.engineStopCallback = this.onRecordComplete.bind(this);\n      }\n\n      if (this.streamVisibleCallback === undefined) {\n        this.streamVisibleCallback = this.onStreamVisible.bind(this);\n      }\n\n      if (this.getRecordType() === _recordMode.SCREEN_ONLY || this.getRecordType() === _recordMode.AUDIO_SCREEN) {\n        if (navigator.mediaDevices === undefined || navigator.mediaDevices.getDisplayMedia === undefined) {\n          this.player.trigger(_event.default.ERROR, \'This browser does not support navigator.mediaDevices.getDisplayMedia\');\n          return;\n        }\n      } else {\n        if (navigator.mediaDevices === undefined || navigator.mediaDevices.getUserMedia === undefined) {\n          this.player.trigger(_event.default.ERROR, \'This browser does not support navigator.mediaDevices.getUserMedia\');\n          return;\n        }\n      }\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.mediaType = {\n            audio: this.audioRecorderType === AUTO ? true : this.audioRecorderType,\n            video: false\n          };\n          this.surfer.surfer.microphone.un(_event.default.DEVICE_READY, this.deviceReadyCallback);\n          this.surfer.surfer.microphone.un(_event.default.DEVICE_ERROR, this.deviceErrorCallback);\n          this.surfer.surfer.microphone.on(_event.default.DEVICE_READY, this.deviceReadyCallback);\n          this.surfer.surfer.microphone.on(_event.default.DEVICE_ERROR, this.deviceErrorCallback);\n          this.surfer.setupPlaybackEvents(false);\n          this.surfer.liveMode = true;\n          this.surfer.surfer.microphone.paused = false;\n\n          if (this.surfer.surfer.backend.ac.state === \'suspended\') {\n            this.surfer.surfer.backend.ac.resume();\n          }\n\n          if (this.audioBufferUpdate === true) {\n            this.surfer.surfer.microphone.reloadBufferFunction = function (event) {\n              if (!_this3.surfer.surfer.microphone.paused) {\n                _this3.surfer.surfer.empty();\n\n                _this3.surfer.surfer.loadDecodedBuffer(event.inputBuffer);\n\n                _this3.player.recordedData = event.inputBuffer;\n\n                _this3.player.trigger(_event.default.AUDIO_BUFFER_UPDATE);\n              }\n            };\n          }\n\n          this.surfer.surfer.microphone.start();\n          break;\n\n        case _recordMode.IMAGE_ONLY:\n        case _recordMode.VIDEO_ONLY:\n          if (this.getRecordType() === _recordMode.IMAGE_ONLY) {\n            this.player.el().firstChild.addEventListener(_event.default.PLAYING, this.streamVisibleCallback);\n          }\n\n          this.mediaType = {\n            audio: false,\n            video: this.videoRecorderType === AUTO ? true : this.videoRecorderType\n          };\n          navigator.mediaDevices.getUserMedia({\n            audio: false,\n            video: this.getRecordType() === _recordMode.IMAGE_ONLY ? this.recordImage : this.recordVideo\n          }).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));\n          break;\n\n        case _recordMode.AUDIO_SCREEN:\n          this.mediaType = {\n            audio: this.audioRecorderType === AUTO ? true : this.audioRecorderType,\n            video: this.videoRecorderType === AUTO ? true : this.videoRecorderType\n          };\n          var audioScreenConstraints = {};\n\n          if (this.recordScreen === true) {\n            audioScreenConstraints = {\n              video: true\n            };\n          } else if ((0, _typeof2.default)(this.recordScreen) === \'object\' && this.recordScreen.constructor === Object) {\n            audioScreenConstraints = this.recordScreen;\n          }\n\n          navigator.mediaDevices.getDisplayMedia(audioScreenConstraints).then(function (screenStream) {\n            navigator.mediaDevices.getUserMedia({\n              audio: _this3.recordAudio\n            }).then(function (mic) {\n              screenStream.addTrack(mic.getTracks()[0]);\n\n              _this3.onDeviceReady.bind(_this3)(screenStream);\n            }).catch(_this3.onDeviceError.bind(_this3));\n          }).catch(this.onDeviceError.bind(this));\n          break;\n\n        case _recordMode.AUDIO_VIDEO:\n          this.mediaType = {\n            audio: this.audioRecorderType === AUTO ? true : this.audioRecorderType,\n            video: this.videoRecorderType === AUTO ? true : this.videoRecorderType\n          };\n          navigator.mediaDevices.getUserMedia({\n            audio: this.recordAudio,\n            video: this.recordVideo\n          }).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));\n          break;\n\n        case _recordMode.ANIMATION:\n          this.mediaType = {\n            audio: false,\n            video: false,\n            gif: true\n          };\n          navigator.mediaDevices.getUserMedia({\n            audio: false,\n            video: this.recordAnimation\n          }).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));\n          break;\n\n        case _recordMode.SCREEN_ONLY:\n          this.mediaType = {\n            audio: false,\n            video: false,\n            screen: true,\n            gif: false\n          };\n          var screenOnlyConstraints = {};\n\n          if (this.recordScreen === true) {\n            screenOnlyConstraints = {\n              video: true\n            };\n          } else if ((0, _typeof2.default)(this.recordScreen) === \'object\' && this.recordScreen.constructor === Object) {\n            screenOnlyConstraints = this.recordScreen;\n          }\n\n          navigator.mediaDevices.getDisplayMedia(screenOnlyConstraints).then(this.onDeviceReady.bind(this)).catch(this.onDeviceError.bind(this));\n          break;\n      }\n    }\n  }, {\n    key: "onDeviceReady",\n    value: function onDeviceReady(stream) {\n      var _this4 = this;\n\n      this._deviceActive = true;\n      this.stream = stream;\n      this.player.deviceButton.hide();\n      this.setDuration(this.maxLength);\n      this.setCurrentTime(0);\n\n      if (this.player.controlBar.playToggle !== undefined) {\n        this.player.controlBar.playToggle.hide();\n      }\n\n      this.off(this.player, _event.default.TIMEUPDATE, this.playbackTimeUpdate);\n      this.off(this.player, _event.default.ENDED, this.playbackTimeUpdate);\n\n      if (this.getRecordType() !== _recordMode.IMAGE_ONLY) {\n        if (this.getRecordType() !== _recordMode.AUDIO_ONLY && (0, _engineLoader.isAudioPluginActive)(this.audioEngine)) {\n          throw new Error(\'Currently \' + this.audioEngine + \' is only supported in audio-only mode.\');\n        }\n\n        var EngineClass, engineType;\n\n        switch (this.getRecordType()) {\n          case _recordMode.AUDIO_ONLY:\n            EngineClass = (0, _engineLoader.getAudioEngine)(this.audioEngine);\n            engineType = this.audioEngine;\n            break;\n\n          default:\n            EngineClass = (0, _engineLoader.getVideoEngine)(this.videoEngine);\n            engineType = this.videoEngine;\n        }\n\n        try {\n          this.engine = new EngineClass(this.player, this.player.options_);\n        } catch (err) {\n          throw new Error(\'Could not load \' + engineType + \' plugin\');\n        }\n\n        this.engine.on(_event.default.RECORD_COMPLETE, this.engineStopCallback);\n        this.engine.bufferSize = this.audioBufferSize;\n        this.engine.sampleRate = this.audioSampleRate;\n        this.engine.bitRate = this.audioBitRate;\n        this.engine.audioChannels = this.audioChannels;\n        this.engine.audioWorkerURL = this.audioWorkerURL;\n        this.engine.audioWebAssemblyURL = this.audioWebAssemblyURL;\n        this.engine.mimeType = {\n          video: this.videoMimeType,\n          gif: \'image/gif\'\n        };\n\n        if (this.audioMimeType !== null && this.audioMimeType !== AUTO) {\n          this.engine.mimeType.audio = this.audioMimeType;\n        }\n\n        this.engine.videoWorkerURL = this.videoWorkerURL;\n        this.engine.videoWebAssemblyURL = this.videoWebAssemblyURL;\n        this.engine.videoBitRate = this.videoBitRate;\n        this.engine.videoFrameRate = this.videoFrameRate;\n        this.engine.video = {\n          width: this.videoFrameWidth,\n          height: this.videoFrameHeight\n        };\n        this.engine.canvas = {\n          width: this.videoFrameWidth,\n          height: this.videoFrameHeight\n        };\n        this.engine.quality = this.animationQuality;\n        this.engine.frameRate = this.animationFrameRate;\n\n        if (this.recordTimeSlice && this.recordTimeSlice > 0) {\n          this.engine.timeSlice = this.recordTimeSlice;\n          this.engine.maxFileSize = this.maxFileSize;\n        }\n\n        this.engine.pluginLibraryOptions = this.pluginLibraryOptions;\n        this.engine.setup(this.stream, this.mediaType, this.debug);\n\n        if (this.convertEngine !== \'\') {\n          var ConvertEngineClass = (0, _engineLoader.getConvertEngine)(this.convertEngine);\n\n          try {\n            this.converter = new ConvertEngineClass(this.player, this.player.options_);\n          } catch (err) {\n            throw new Error(\'Could not load \' + this.convertEngine + \' plugin\');\n          }\n\n          this.converter.convertWorkerURL = this.convertWorkerURL;\n          this.converter.convertOptions = this.convertOptions;\n          this.converter.pluginLibraryOptions = this.pluginLibraryOptions;\n          this.converter.setup(this.mediaType, this.debug);\n        }\n\n        var uiElements = [\'currentTimeDisplay\', \'timeDivider\', \'durationDisplay\'];\n        uiElements.forEach(function (element) {\n          element = _this4.player.controlBar[element];\n\n          if (element !== undefined) {\n            element.el().style.display = \'block\';\n            element.show();\n          }\n        });\n        this.player.recordToggle.show();\n      } else {\n        this.player.recordIndicator.disable();\n        this.retrySnapshot();\n      }\n\n      if (this.getRecordType() !== _recordMode.AUDIO_ONLY) {\n        this.mediaElement = this.player.el().firstChild;\n        this.mediaElement.controls = false;\n        this.mediaElement.muted = true;\n        this.displayVolumeControl(false);\n\n        if (this.pictureInPicture === true) {\n          this.player.pipToggle.show();\n          this.mediaElement.removeEventListener(_event.default.ENTERPICTUREINPICTURE, this.onEnterPiPHandler);\n          this.mediaElement.removeEventListener(_event.default.LEAVEPICTUREINPICTURE, this.onLeavePiPHandler);\n          this.mediaElement.addEventListener(_event.default.ENTERPICTUREINPICTURE, this.onEnterPiPHandler);\n          this.mediaElement.addEventListener(_event.default.LEAVEPICTUREINPICTURE, this.onLeavePiPHandler);\n        }\n\n        this.load(this.stream);\n        this.player.one(_event.default.LOADEDMETADATA, function () {\n          _this4.mediaElement.play();\n\n          _this4.player.trigger(_event.default.DEVICE_READY);\n        });\n      } else {\n        this.player.trigger(_event.default.DEVICE_READY);\n      }\n    }\n  }, {\n    key: "onDeviceError",\n    value: function onDeviceError(code) {\n      this._deviceActive = false;\n\n      if (!this.isDestroyed()) {\n        this.player.deviceErrorCode = code;\n        this.player.trigger(_event.default.DEVICE_ERROR);\n      }\n    }\n  }, {\n    key: "start",\n    value: function start() {\n      var _this5 = this;\n\n      if (!this.isProcessing()) {\n        if (this.stream && this.stream.active === false) {\n          this.getDevice();\n          return;\n        }\n\n        this._recording = true;\n\n        if (this.player.controlBar.playToggle !== undefined) {\n          this.player.controlBar.playToggle.hide();\n        }\n\n        this.off(this.player, _event.default.TIMEUPDATE, this.playbackTimeUpdate);\n        this.off(this.player, _event.default.ENDED, this.playbackTimeUpdate);\n\n        switch (this.getRecordType()) {\n          case _recordMode.AUDIO_ONLY:\n            this.surfer.setupPlaybackEvents(false);\n            this.surfer.surfer.microphone.paused = false;\n            this.surfer.liveMode = true;\n            this.surfer.surfer.microphone.play();\n            break;\n\n          case _recordMode.VIDEO_ONLY:\n          case _recordMode.AUDIO_VIDEO:\n          case _recordMode.AUDIO_SCREEN:\n          case _recordMode.SCREEN_ONLY:\n            this.startVideoPreview();\n            break;\n\n          case _recordMode.ANIMATION:\n            this.player.recordCanvas.hide();\n            this.player.animationDisplay.hide();\n            this.mediaElement.style.display = \'block\';\n            this.captureFrame().then(function (result) {\n              _this5.startVideoPreview();\n            });\n            break;\n        }\n\n        if (this.autoMuteDevice) {\n          this.muteTracks(false);\n        }\n\n        switch (this.getRecordType()) {\n          case _recordMode.IMAGE_ONLY:\n            this.createSnapshot();\n            this.player.trigger(_event.default.START_RECORD);\n            break;\n\n          case _recordMode.VIDEO_ONLY:\n          case _recordMode.AUDIO_VIDEO:\n          case _recordMode.AUDIO_SCREEN:\n          case _recordMode.ANIMATION:\n          case _recordMode.SCREEN_ONLY:\n            this.player.one(_event.default.LOADEDMETADATA, function () {\n              _this5.startRecording();\n            });\n            break;\n\n          default:\n            this.startRecording();\n        }\n      }\n    }\n  }, {\n    key: "startRecording",\n    value: function startRecording() {\n      this.paused = false;\n      this.pauseTime = this.pausedTime = 0;\n      this.startTime = performance.now();\n      var COUNTDOWN_SPEED = 100;\n      this.countDown = this.player.setInterval(this.onCountDown.bind(this), COUNTDOWN_SPEED);\n\n      if (this.engine !== undefined) {\n        this.engine.dispose();\n      }\n\n      this.engine.start();\n      this.player.trigger(_event.default.START_RECORD);\n    }\n  }, {\n    key: "stop",\n    value: function stop() {\n      if (!this.isProcessing()) {\n        this._recording = false;\n        this._processing = true;\n\n        if (this.getRecordType() !== _recordMode.IMAGE_ONLY) {\n          this.player.trigger(_event.default.STOP_RECORD);\n          this.player.clearInterval(this.countDown);\n\n          if (this.engine) {\n            this.engine.stop();\n          }\n\n          if (this.autoMuteDevice) {\n            this.muteTracks(true);\n          }\n        } else {\n          if (this.player.recordedData) {\n            this.player.trigger(_event.default.FINISH_RECORD);\n          }\n        }\n      }\n    }\n  }, {\n    key: "stopDevice",\n    value: function stopDevice() {\n      if (this.isRecording()) {\n        this.player.one(_event.default.FINISH_RECORD, this.stopStream.bind(this));\n        this.stop();\n      } else {\n        this.stopStream();\n      }\n    }\n  }, {\n    key: "stopStream",\n    value: function stopStream() {\n      if (this.stream) {\n        this._deviceActive = false;\n\n        if (this.getRecordType() === _recordMode.AUDIO_ONLY) {\n          this.surfer.surfer.microphone.stopDevice();\n          return;\n        }\n\n        this.stream.getTracks().forEach(function (stream) {\n          stream.stop();\n        });\n      }\n    }\n  }, {\n    key: "pause",\n    value: function pause() {\n      if (!this.paused) {\n        this.pauseTime = performance.now();\n        this.paused = true;\n        this.engine.pause();\n      }\n    }\n  }, {\n    key: "resume",\n    value: function resume() {\n      if (this.paused) {\n        this.pausedTime += performance.now() - this.pauseTime;\n        this.engine.resume();\n        this.paused = false;\n      }\n    }\n  }, {\n    key: "onRecordComplete",\n    value: function onRecordComplete() {\n      var _this6 = this;\n\n      this.player.recordedData = this.engine.recordedData;\n\n      if (this.player.controlBar.playToggle !== undefined) {\n        this.player.controlBar.playToggle.removeClass(\'vjs-ended\');\n        this.player.controlBar.playToggle.show();\n      }\n\n      if (this.converter !== undefined) {\n        this.converter.convert(this.player.recordedData);\n      }\n\n      this.player.trigger(_event.default.FINISH_RECORD);\n\n      if (this.isDestroyed()) {\n        return;\n      }\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.pause();\n          this.surfer.setupPlaybackEvents(true);\n          this.player.loadingSpinner.show();\n          this.surfer.surfer.once(_event.default.READY, function () {\n            _this6._processing = false;\n          });\n          this.load(this.player.recordedData);\n          break;\n\n        case _recordMode.VIDEO_ONLY:\n        case _recordMode.AUDIO_VIDEO:\n        case _recordMode.AUDIO_SCREEN:\n        case _recordMode.SCREEN_ONLY:\n          this.player.one(_event.default.PAUSE, function () {\n            _this6._processing = false;\n\n            _this6.player.loadingSpinner.hide();\n\n            _this6.setDuration(_this6.streamDuration);\n\n            _this6.on(_this6.player, _event.default.TIMEUPDATE, _this6.playbackTimeUpdate);\n\n            _this6.on(_this6.player, _event.default.ENDED, _this6.playbackTimeUpdate);\n\n            if (_this6.getRecordType() === _recordMode.AUDIO_VIDEO || _this6.getRecordType() === _recordMode.AUDIO_SCREEN) {\n              _this6.mediaElement.muted = false;\n\n              _this6.displayVolumeControl(true);\n            }\n\n            _this6.load(_this6.player.recordedData);\n          });\n          this.player.pause();\n          break;\n\n        case _recordMode.ANIMATION:\n          this._processing = false;\n          this.player.loadingSpinner.hide();\n          this.setDuration(this.streamDuration);\n          this.mediaElement.style.display = \'none\';\n          this.player.recordCanvas.show();\n          this.player.pause();\n          this.on(this.player, _event.default.PLAY, this.showAnimation);\n          this.on(this.player, _event.default.PAUSE, this.hideAnimation);\n          break;\n      }\n    }\n  }, {\n    key: "onCountDown",\n    value: function onCountDown() {\n      if (!this.paused) {\n        var now = performance.now();\n        var duration = this.maxLength;\n        var currentTime = (now - (this.startTime + this.pausedTime)) / 1000;\n        this.streamDuration = currentTime;\n\n        if (currentTime >= duration) {\n          currentTime = duration;\n          this.stop();\n        }\n\n        this.setDuration(duration);\n        this.setCurrentTime(currentTime, duration);\n        this.player.trigger(_event.default.PROGRESS_RECORD);\n      }\n    }\n  }, {\n    key: "getCurrentTime",\n    value: function getCurrentTime() {\n      var currentTime = isNaN(this.streamCurrentTime) ? 0 : this.streamCurrentTime;\n\n      if (this.getRecordType() === _recordMode.AUDIO_ONLY) {\n        currentTime = this.surfer.getCurrentTime();\n      }\n\n      return currentTime;\n    }\n  }, {\n    key: "setCurrentTime",\n    value: function setCurrentTime(currentTime, duration) {\n      currentTime = isNaN(currentTime) ? 0 : currentTime;\n      duration = isNaN(duration) ? 0 : duration;\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.setCurrentTime(currentTime, duration);\n          break;\n\n        case _recordMode.VIDEO_ONLY:\n        case _recordMode.AUDIO_VIDEO:\n        case _recordMode.AUDIO_SCREEN:\n        case _recordMode.ANIMATION:\n        case _recordMode.SCREEN_ONLY:\n          if (this.player.controlBar.currentTimeDisplay && this.player.controlBar.currentTimeDisplay.contentEl() && this.player.controlBar.currentTimeDisplay.contentEl().lastChild) {\n            this.streamCurrentTime = Math.min(currentTime, duration);\n            this.player.controlBar.currentTimeDisplay.formattedTime_ = this.player.controlBar.currentTimeDisplay.contentEl().lastChild.textContent = (0, _formatTime.default)(this.streamCurrentTime, duration, this.displayMilliseconds);\n          }\n\n          break;\n      }\n    }\n  }, {\n    key: "getDuration",\n    value: function getDuration() {\n      var duration = isNaN(this.streamDuration) ? 0 : this.streamDuration;\n      return duration;\n    }\n  }, {\n    key: "setDuration",\n    value: function setDuration(duration) {\n      duration = isNaN(duration) ? 0 : duration;\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.setDuration(duration);\n          break;\n\n        case _recordMode.VIDEO_ONLY:\n        case _recordMode.AUDIO_VIDEO:\n        case _recordMode.AUDIO_SCREEN:\n        case _recordMode.ANIMATION:\n        case _recordMode.SCREEN_ONLY:\n          if (this.player.controlBar.durationDisplay && this.player.controlBar.durationDisplay.contentEl() && this.player.controlBar.durationDisplay.contentEl().lastChild) {\n            this.player.controlBar.durationDisplay.formattedTime_ = this.player.controlBar.durationDisplay.contentEl().lastChild.textContent = (0, _formatTime.default)(duration, duration, this.displayMilliseconds);\n          }\n\n          break;\n      }\n    }\n  }, {\n    key: "load",\n    value: function load(url) {\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.load(url);\n          break;\n\n        case _recordMode.IMAGE_ONLY:\n        case _recordMode.VIDEO_ONLY:\n        case _recordMode.AUDIO_VIDEO:\n        case _recordMode.AUDIO_SCREEN:\n        case _recordMode.ANIMATION:\n        case _recordMode.SCREEN_ONLY:\n          if (url instanceof Blob || url instanceof File) {\n            this.mediaElement.srcObject = null;\n            this.mediaElement.src = URL.createObjectURL(url);\n          } else {\n            (0, _browserShim.default)(url, this.mediaElement);\n          }\n\n          break;\n      }\n    }\n  }, {\n    key: "saveAs",\n    value: function saveAs(name) {\n      if (this.engine && name !== undefined) {\n        this.engine.saveAs(name);\n      }\n    }\n  }, {\n    key: "dispose",\n    value: function dispose() {\n      this.player.off(_event.default.READY);\n      this.player.off(_event.default.USERINACTIVE);\n      this.player.off(_event.default.LOADEDMETADATA);\n\n      if (this.engine) {\n        this.engine.dispose();\n        this.engine.destroy();\n        this.engine.off(_event.default.RECORD_COMPLETE, this.engineStopCallback);\n      }\n\n      this.stop();\n      this.stopDevice();\n      this.removeRecording();\n      this.player.clearInterval(this.countDown);\n\n      if (this.getRecordType() === _recordMode.AUDIO_ONLY) {\n        if (this.surfer) {\n          this.surfer.destroy();\n        }\n      } else if (this.getRecordType() === _recordMode.IMAGE_ONLY) {\n        if (this.mediaElement && this.streamVisibleCallback) {\n          this.mediaElement.removeEventListener(_event.default.PLAYING, this.streamVisibleCallback);\n        }\n      }\n\n      this.resetState();\n      (0, _get2.default)((0, _getPrototypeOf2.default)(Record.prototype), "dispose", this).call(this);\n    }\n  }, {\n    key: "destroy",\n    value: function destroy() {\n      this.player.dispose();\n    }\n  }, {\n    key: "reset",\n    value: function reset() {\n      var _this7 = this;\n\n      if (this.engine) {\n        this.engine.dispose();\n        this.engine.off(_event.default.RECORD_COMPLETE, this.engineStopCallback);\n      }\n\n      this.stop();\n      this.stopDevice();\n      this.player.clearInterval(this.countDown);\n      this.removeRecording();\n      this.loadOptions();\n      this.resetState();\n      this.setDuration(this.maxLength);\n      this.setCurrentTime(0);\n      this.player.reset();\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          if (this.surfer && this.surfer.surfer) {\n            this.surfer.surfer.empty();\n          }\n\n          break;\n\n        case _recordMode.IMAGE_ONLY:\n        case _recordMode.ANIMATION:\n          this.player.recordCanvas.hide();\n          this.player.cameraButton.hide();\n          break;\n      }\n\n      if (this.player.controlBar.playToggle !== undefined) {\n        this.player.controlBar.playToggle.hide();\n      }\n\n      this.player.deviceButton.show();\n      this.player.recordToggle.hide();\n      this.player.one(_event.default.LOADEDMETADATA, function () {\n        _this7.setDuration(_this7.maxLength);\n      });\n    }\n  }, {\n    key: "resetState",\n    value: function resetState() {\n      this._recording = false;\n      this._processing = false;\n      this._deviceActive = false;\n      this.devices = [];\n    }\n  }, {\n    key: "removeRecording",\n    value: function removeRecording() {\n      if (this.mediaElement && this.mediaElement.src.startsWith(\'blob:\') === true) {\n        URL.revokeObjectURL(this.mediaElement.src);\n        this.mediaElement.src = \'\';\n      }\n    }\n  }, {\n    key: "exportImage",\n    value: function exportImage() {\n      var format = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \'image/png\';\n      var quality = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      if (this.getRecordType() === _recordMode.AUDIO_ONLY) {\n        return this.surfer.surfer.exportImage(format, quality, \'blob\');\n      } else {\n        var recordCanvas = this.player.recordCanvas.el().firstChild;\n        this.drawCanvas(recordCanvas, this.mediaElement);\n        return new Promise(function (resolve) {\n          recordCanvas.toBlob(resolve, format, quality);\n        });\n      }\n    }\n  }, {\n    key: "muteTracks",\n    value: function muteTracks(mute) {\n      if ((this.getRecordType() === _recordMode.AUDIO_ONLY || this.getRecordType() === _recordMode.AUDIO_SCREEN || this.getRecordType() === _recordMode.AUDIO_VIDEO) && this.stream.getAudioTracks().length > 0) {\n        this.stream.getAudioTracks()[0].enabled = !mute;\n      }\n\n      if (this.getRecordType() !== _recordMode.AUDIO_ONLY && this.stream.getVideoTracks().length > 0) {\n        this.stream.getVideoTracks()[0].enabled = !mute;\n      }\n    }\n  }, {\n    key: "getRecordType",\n    value: function getRecordType() {\n      return (0, _recordMode.getRecorderMode)(this.recordImage, this.recordAudio, this.recordVideo, this.recordAnimation, this.recordScreen);\n    }\n  }, {\n    key: "createSnapshot",\n    value: function createSnapshot() {\n      var _this8 = this;\n\n      this.captureFrame().then(function (result) {\n        if (_this8.imageOutputType === \'blob\') {\n          result.toBlob(function (blob) {\n            _this8.player.recordedData = blob;\n\n            _this8.displaySnapshot();\n          });\n        } else if (_this8.imageOutputType === \'dataURL\') {\n          _this8.player.recordedData = result.toDataURL(_this8.imageOutputFormat, _this8.imageOutputQuality);\n\n          _this8.displaySnapshot();\n        }\n      }, this.imageOutputFormat, this.imageOutputQuality);\n    }\n  }, {\n    key: "displaySnapshot",\n    value: function displaySnapshot() {\n      this.mediaElement.style.display = \'none\';\n      this.player.recordCanvas.show();\n      this.stop();\n    }\n  }, {\n    key: "retrySnapshot",\n    value: function retrySnapshot() {\n      this._processing = false;\n      this.player.recordCanvas.hide();\n      this.player.el().firstChild.style.display = \'block\';\n    }\n  }, {\n    key: "captureFrame",\n    value: function captureFrame() {\n      var _this9 = this;\n\n      var detected = (0, _detectBrowser.detectBrowser)();\n      var recordCanvas = this.player.recordCanvas.el().firstChild;\n      recordCanvas.width = this.player.width();\n      recordCanvas.height = this.player.height();\n      return new Promise(function (resolve, reject) {\n        if (detected.browser === \'chrome\' && detected.version >= 60 && (typeof ImageCapture === "undefined" ? "undefined" : (0, _typeof2.default)(ImageCapture)) === (typeof Function === "undefined" ? "undefined" : (0, _typeof2.default)(Function))) {\n          try {\n            var track = _this9.stream.getVideoTracks()[0];\n\n            var imageCapture = new ImageCapture(track);\n            imageCapture.grabFrame().then(function (imageBitmap) {\n              _this9.drawCanvas(recordCanvas, imageBitmap);\n\n              resolve(recordCanvas);\n            }).catch(function (error) {});\n          } catch (err) {}\n        }\n\n        _this9.drawCanvas(recordCanvas, _this9.mediaElement);\n\n        resolve(recordCanvas);\n      });\n    }\n  }, {\n    key: "drawCanvas",\n    value: function drawCanvas(canvas, element) {\n      canvas.getContext(\'2d\').drawImage(element, 0, 0, canvas.width, canvas.height);\n    }\n  }, {\n    key: "startVideoPreview",\n    value: function startVideoPreview() {\n      this.off(_event.default.TIMEUPDATE);\n      this.off(_event.default.DURATIONCHANGE);\n      this.off(_event.default.LOADEDMETADATA);\n      this.off(_event.default.PLAY);\n      this.mediaElement.muted = true;\n      this.displayVolumeControl(false);\n      this.removeRecording();\n      this.load(this.stream);\n      this.mediaElement.play();\n    }\n  }, {\n    key: "showAnimation",\n    value: function showAnimation() {\n      var animationDisplay = this.player.animationDisplay.el().firstChild;\n      animationDisplay.width = this.player.width();\n      animationDisplay.height = this.player.height();\n      this.player.recordCanvas.hide();\n      (0, _browserShim.default)(this.player.recordedData, animationDisplay);\n      this.player.animationDisplay.show();\n    }\n  }, {\n    key: "hideAnimation",\n    value: function hideAnimation() {\n      this.player.recordCanvas.show();\n      this.player.animationDisplay.hide();\n    }\n  }, {\n    key: "playbackTimeUpdate",\n    value: function playbackTimeUpdate() {\n      this.setCurrentTime(this.player.currentTime(), this.streamDuration);\n    }\n  }, {\n    key: "enumerateDevices",\n    value: function enumerateDevices() {\n      var _this10 = this;\n\n      if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        this.player.enumerateErrorCode = \'enumerateDevices() not supported.\';\n        this.player.trigger(_event.default.ENUMERATE_ERROR);\n        return;\n      }\n\n      navigator.mediaDevices.enumerateDevices(this).then(function (devices) {\n        _this10.devices = [];\n        devices.forEach(function (device) {\n          _this10.devices.push(device);\n        });\n\n        _this10.player.trigger(_event.default.ENUMERATE_READY);\n      }).catch(function (err) {\n        _this10.player.enumerateErrorCode = err;\n\n        _this10.player.trigger(_event.default.ENUMERATE_ERROR);\n      });\n    }\n  }, {\n    key: "setVideoInput",\n    value: function setVideoInput(deviceId) {\n      if (this.recordVideo === Object(this.recordVideo)) {\n        this.recordVideo.deviceId = {\n          exact: deviceId\n        };\n      } else if (this.recordVideo === true) {\n        this.recordVideo = {\n          deviceId: {\n            exact: deviceId\n          }\n        };\n      }\n\n      this.stopDevice();\n      this.getDevice();\n    }\n  }, {\n    key: "setAudioInput",\n    value: function setAudioInput(deviceId) {\n      if (this.recordAudio === Object(this.recordAudio)) {\n        this.recordAudio.deviceId = {\n          exact: deviceId\n        };\n      } else if (this.recordAudio === true) {\n        this.recordAudio = {\n          deviceId: {\n            exact: deviceId\n          }\n        };\n      }\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.surfer.microphone.constraints = {\n            video: false,\n            audio: this.recordAudio\n          };\n          break;\n      }\n\n      this.stopDevice();\n      this.getDevice();\n    }\n  }, {\n    key: "setAudioOutput",\n    value: function setAudioOutput(deviceId) {\n      var _this11 = this;\n\n      var errorMessage;\n\n      switch (this.getRecordType()) {\n        case _recordMode.AUDIO_ONLY:\n          this.surfer.surfer.setSinkId(deviceId).then(function (result) {\n            _this11.player.trigger(_event.default.AUDIO_OUTPUT_READY);\n\n            return;\n          }).catch(function (err) {\n            errorMessage = err;\n          });\n          break;\n\n        default:\n          var element = player.tech_.el_;\n\n          if (deviceId) {\n            if (typeof element.sinkId !== \'undefined\') {\n              element.setSinkId(deviceId).then(function (result) {\n                _this11.player.trigger(_event.default.AUDIO_OUTPUT_READY);\n\n                return;\n              }).catch(function (err) {\n                errorMessage = err;\n              });\n            } else {\n              errorMessage = \'Browser does not support audio output device selection.\';\n            }\n          } else {\n            errorMessage = "Invalid deviceId: ".concat(deviceId);\n          }\n\n          break;\n      }\n\n      this.player.trigger(_event.default.ERROR, errorMessage);\n    }\n  }, {\n    key: "displayVolumeControl",\n    value: function displayVolumeControl(display) {\n      if (this.player.controlBar.volumePanel !== undefined) {\n        if (display === true) {\n          display = \'flex\';\n        } else {\n          display = \'none\';\n        }\n\n        this.player.controlBar.volumePanel.el().style.display = display;\n      }\n    }\n  }, {\n    key: "onStreamVisible",\n    value: function onStreamVisible(event) {\n      this.mediaElement.removeEventListener(_event.default.PLAYING, this.streamVisibleCallback);\n      this.player.cameraButton.onStop();\n      this.player.cameraButton.show();\n    }\n  }, {\n    key: "onEnterPiP",\n    value: function onEnterPiP(event) {\n      this.player.trigger(_event.default.ENTER_PIP, event);\n    }\n  }, {\n    key: "onLeavePiP",\n    value: function onLeavePiP(event) {\n      this.player.trigger(_event.default.LEAVE_PIP);\n    }\n  }]);\n  return Record;\n}(Plugin);\n\nexports.Record = Record;\nRecord.VERSION = "4.0.0";\n_video.default.Record = Record;\n\nif (_video.default.getPlugin(\'record\') === undefined) {\n  _video.default.registerPlugin(\'record\', Record);\n}\n\n//# sourceURL=webpack://VideojsRecord/./src/js/videojs.record.js?')},0:
/*!**********************************************************************!*\
  !*** multi ./src/js/videojs.record.js ./src/css/videojs.record.scss ***!
  \**********************************************************************/
/*! no static exports found */function(module,exports,__webpack_require__){eval('__webpack_require__(/*! /home/thijs/projects/videojs-record/src/js/videojs.record.js */"./src/js/videojs.record.js");\nmodule.exports = __webpack_require__(/*! /home/thijs/projects/videojs-record/src/css/videojs.record.scss */"./src/css/videojs.record.scss");\n\n\n//# sourceURL=webpack://VideojsRecord/multi_./src/js/videojs.record.js_./src/css/videojs.record.scss?')},recordrtc:
/*!****************************!*\
  !*** external "RecordRTC" ***!
  \****************************/
/*! no static exports found */function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_recordrtc__;\n\n//# sourceURL=webpack://VideojsRecord/external_%22RecordRTC%22?")},"video.js":
/*!**************************!*\
  !*** external "videojs" ***!
  \**************************/
/*! no static exports found */function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_video_js__;\n\n//# sourceURL=webpack://VideojsRecord/external_%22videojs%22?")}})}))},"3bbe":function(e,t,n){var r=n("861d");e.exports=function(e){if(!r(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},"3bfc":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},"3c96":function(e,t){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e.exports=n},"3ca3":function(e,t,n){"use strict";var r=n("6547").charAt,i=n("69f3"),a=n("7dd0"),o="String Iterator",s=i.set,u=i.getterFor(o);a(String,"String",(function(e){s(this,{type:o,string:String(e),index:0})}),(function(){var e,t=u(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},"3d50":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},"3f8c":function(e,t){e.exports={}},"423e":function(e,t,n){"use strict";var r=n("ae75"),i=function(e){var t=31&e[1];return t<<=8,t|=e[2],t},a=function(e){return!!(64&e[1])},o=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},s=function(e,t){var n=i(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},u=function(e){var t=a(e),n=4+o(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},c=function(e){var t={},n=a(e),r=4+o(e);if(n&&(r+=e[r]+1),1&e[r+5]){var i,s,u;i=(15&e[r+1])<<8|e[r+2],s=3+i-4,u=(15&e[r+10])<<8|e[r+11];var c=12+u;while(c<s){var l=r+c;t[(31&e[l+1])<<8|e[l+2]]=e[l],c+=5+((15&e[l+3])<<8|e[l+4])}return t}},l=function(e,t){var n=i(e),a=t[n];switch(a){case r.H264_STREAM_TYPE:return"video";case r.ADTS_STREAM_TYPE:return"audio";case r.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},d=function(e){var t=a(e);if(!t)return null;var n=4+o(e);if(n>=e.byteLength)return null;var r,i=null;return r=e[n+7],192&r&&(i={},i.pts=(14&e[n+9])<<27|(255&e[n+10])<<20|(254&e[n+11])<<12|(255&e[n+12])<<5|(254&e[n+13])>>>3,i.pts*=4,i.pts+=(6&e[n+13])>>>1,i.dts=i.pts,64&r&&(i.dts=(14&e[n+14])<<27|(255&e[n+15])<<20|(254&e[n+16])<<12|(255&e[n+17])<<5|(254&e[n+18])>>>3,i.dts*=4,i.dts+=(6&e[n+18])>>>1)),i},p=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},h=function(e){for(var t,n=4+o(e),r=e.subarray(n),i=0,a=0,s=!1;a<r.byteLength-3;a++)if(1===r[a+2]){i=a+5;break}while(i<r.byteLength)switch(r[i]){case 0:if(0!==r[i-1]){i+=2;break}if(0!==r[i-2]){i++;break}a+3!==i-2&&(t=p(31&r[a+3]),"slice_layer_without_partitioning_rbsp_idr"===t&&(s=!0));do{i++}while(1!==r[i]&&i<r.length);a=i-2,i+=3;break;case 1:if(0!==r[i-1]||0!==r[i-2]){i+=3;break}t=p(31&r[a+3]),"slice_layer_without_partitioning_rbsp_idr"===t&&(s=!0),a=i-2,i+=3;break;default:i+=3;break}return r=r.subarray(a),i-=a,a=0,r&&r.byteLength>3&&(t=p(31&r[a+3]),"slice_layer_without_partitioning_rbsp_idr"===t&&(s=!0)),s};e.exports={parseType:s,parsePat:u,parsePmt:c,parsePayloadUnitStartIndicator:a,parsePesType:l,parsePesTime:d,videoPacketContainsKeyFrame:h}},"428f":function(e,t,n){var r=n("da84");e.exports=r},4329:function(e,t,n){"use strict";var r=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var r;return!!e[t]&&(r=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var n,r,i,a;if(n=e[t],n)if(2===arguments.length)for(i=n.length,r=0;r<i;++r)n[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(i=n.length,r=0;r<i;++r)n[r].apply(this,a)}},this.dispose=function(){e={}}}};r.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},r.prototype.push=function(e){this.trigger("data",e)},r.prototype.flush=function(e){this.trigger("done",e)},r.prototype.partialFlush=function(e){this.trigger("partialdone",e)},r.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},r.prototype.reset=function(e){this.trigger("reset",e)},e.exports=r},4362:function(e,t,n){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,r="/";t.cwd=function(){return r},t.chdir=function(t){e||(e=n("df7c")),r=e.resolve(t,r)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"44ad":function(e,t,n){var r=n("d039"),i=n("c6b6"),a="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?a.call(e,""):Object(e)}:Object},"44d2":function(e,t,n){var r=n("b622"),i=n("7c73"),a=n("9bf2"),o=r("unscopables"),s=Array.prototype;void 0==s[o]&&a.f(s,o,{configurable:!0,value:i(null)}),e.exports=function(e){s[o][e]=!0}},"44de":function(e,t,n){var r=n("da84");e.exports=function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},"45ef":function(e,t,n){"use strict";n.r(t),function(e,r,i){n.d(t,"AdadeltaOptimizer",(function(){return Pp})),n.d(t,"AdagradOptimizer",(function(){return Mp})),n.d(t,"AdamOptimizer",(function(){return Lp})),n.d(t,"AdamaxOptimizer",(function(){return jp})),n.d(t,"DataStorage",(function(){return ii})),n.d(t,"ENV",(function(){return d})),n.d(t,"Environment",(function(){return c})),n.d(t,"KernelBackend",(function(){return ai})),n.d(t,"MomentumOptimizer",(function(){return Up})),n.d(t,"Optimizer",(function(){return Dp})),n.d(t,"RMSPropOptimizer",(function(){return Fp})),n.d(t,"Rank",(function(){return me})),n.d(t,"Reduction",(function(){return jl})),n.d(t,"SGDOptimizer",(function(){return Bp})),n.d(t,"Tensor",(function(){return he})),n.d(t,"TensorBuffer",(function(){return ce})),n.d(t,"Variable",(function(){return fe})),n.d(t,"abs",(function(){return Ms})),n.d(t,"acos",(function(){return Ls})),n.d(t,"acosh",(function(){return js})),n.d(t,"add",(function(){return Lu})),n.d(t,"addN",(function(){return ju})),n.d(t,"addStrict",(function(){return Bu})),n.d(t,"all",(function(){return tl})),n.d(t,"any",(function(){return nl})),n.d(t,"argMax",(function(){return rl})),n.d(t,"argMin",(function(){return il})),n.d(t,"asin",(function(){return Bs})),n.d(t,"asinh",(function(){return Us})),n.d(t,"atan",(function(){return Fs})),n.d(t,"atan2",(function(){return Uu})),n.d(t,"atanh",(function(){return Vs})),n.d(t,"avgPool",(function(){return Gc})),n.d(t,"avgPool3d",(function(){return Kc})),n.d(t,"backend",(function(){return rn})),n.d(t,"backend_util",(function(){return Ci})),n.d(t,"basicLSTMCell",(function(){return wl})),n.d(t,"batchNorm",(function(){return Eu})),n.d(t,"batchNorm2d",(function(){return ku})),n.d(t,"batchNorm3d",(function(){return Ru})),n.d(t,"batchNorm4d",(function(){return Ou})),n.d(t,"batchNormalization",(function(){return Su})),n.d(t,"batchNormalization2d",(function(){return xu})),n.d(t,"batchNormalization3d",(function(){return Tu})),n.d(t,"batchNormalization4d",(function(){return Cu})),n.d(t,"batchToSpaceND",(function(){return sr})),n.d(t,"booleanMaskAsync",(function(){return bc})),n.d(t,"browser",(function(){return _p})),n.d(t,"buffer",(function(){return ar})),n.d(t,"cast",(function(){return ur})),n.d(t,"ceil",(function(){return qs})),n.d(t,"clipByValue",(function(){return Ws})),n.d(t,"clone",(function(){return cr})),n.d(t,"complex",(function(){return xn})),n.d(t,"concat",(function(){return Vn})),n.d(t,"concat1d",(function(){return qn})),n.d(t,"concat2d",(function(){return Wn})),n.d(t,"concat3d",(function(){return zn})),n.d(t,"concat4d",(function(){return Gn})),n.d(t,"conv1d",(function(){return Tc})),n.d(t,"conv2d",(function(){return Cc})),n.d(t,"conv2dTranspose",(function(){return Nc})),n.d(t,"conv3d",(function(){return Sc})),n.d(t,"conv3dTranspose",(function(){return Dc})),n.d(t,"cos",(function(){return zs})),n.d(t,"cosh",(function(){return Gs})),n.d(t,"cumsum",(function(){return lr})),n.d(t,"customGrad",(function(){return ei})),n.d(t,"deprecationWarn",(function(){return Vt})),n.d(t,"depthToSpace",(function(){return dr})),n.d(t,"depthwiseConv2d",(function(){return Rc})),n.d(t,"diag",(function(){return Pl})),n.d(t,"disableDeprecationWarnings",(function(){return Ft})),n.d(t,"dispose",(function(){return $t})),n.d(t,"disposeVariables",(function(){return qt})),n.d(t,"div",(function(){return Fu})),n.d(t,"divStrict",(function(){return Vu})),n.d(t,"dot",(function(){return Mc})),n.d(t,"dropout",(function(){return Ml})),n.d(t,"elu",(function(){return pl})),n.d(t,"enableDebugMode",(function(){return Ut})),n.d(t,"enableProdMode",(function(){return Bt})),n.d(t,"engine",(function(){return Wt})),n.d(t,"env",(function(){return l})),n.d(t,"equal",(function(){return rc})),n.d(t,"equalStrict",(function(){return ic})),n.d(t,"erf",(function(){return Hs})),n.d(t,"exp",(function(){return $s})),n.d(t,"expandDims",(function(){return pr})),n.d(t,"expm1",(function(){return Ks})),n.d(t,"eye",(function(){return hr})),n.d(t,"fft",(function(){return kl})),n.d(t,"fill",(function(){return Ln})),n.d(t,"findBackend",(function(){return en})),n.d(t,"findBackendFactory",(function(){return tn})),n.d(t,"floor",(function(){return Ys})),n.d(t,"floorDiv",(function(){return qu})),n.d(t,"frame",(function(){return Fl})),n.d(t,"fused",(function(){return fd})),n.d(t,"gather",(function(){return gc})),n.d(t,"gatherND",(function(){return Dl})),n.d(t,"getBackend",(function(){return Qt})),n.d(t,"grad",(function(){return Yr})),n.d(t,"grads",(function(){return Xr})),n.d(t,"greater",(function(){return ac})),n.d(t,"greaterEqual",(function(){return oc})),n.d(t,"greaterEqualStrict",(function(){return sc})),n.d(t,"greaterStrict",(function(){return uc})),n.d(t,"hammingWindow",(function(){return Ul})),n.d(t,"hannWindow",(function(){return Bl})),n.d(t,"ifft",(function(){return Rl})),n.d(t,"imag",(function(){return Cn})),n.d(t,"image",(function(){return ld})),n.d(t,"inTopKAsync",(function(){return Wl})),n.d(t,"io",(function(){return vp})),n.d(t,"irfft",(function(){return Al})),n.d(t,"isFinite",(function(){return su})),n.d(t,"isInf",(function(){return ou})),n.d(t,"isNaN",(function(){return au})),n.d(t,"keep",(function(){return Kt})),n.d(t,"leakyRelu",(function(){return hl})),n.d(t,"less",(function(){return cc})),n.d(t,"lessEqual",(function(){return lc})),n.d(t,"lessEqualStrict",(function(){return dc})),n.d(t,"lessStrict",(function(){return pc})),n.d(t,"linalg",(function(){return rd})),n.d(t,"linspace",(function(){return jn})),n.d(t,"localResponseNormalization",(function(){return bl})),n.d(t,"log",(function(){return Xs})),n.d(t,"log1p",(function(){return Js})),n.d(t,"logSigmoid",(function(){return Qs})),n.d(t,"logSoftmax",(function(){return ri})),n.d(t,"logSumExp",(function(){return al})),n.d(t,"logicalAnd",(function(){return Au})),n.d(t,"logicalNot",(function(){return Iu})),n.d(t,"logicalOr",(function(){return Nu})),n.d(t,"logicalXor",(function(){return Du})),n.d(t,"losses",(function(){return Zl})),n.d(t,"matMul",(function(){return Pc})),n.d(t,"math",(function(){return yp})),n.d(t,"max",(function(){return ol})),n.d(t,"maxPool",(function(){return zc})),n.d(t,"maxPool3d",(function(){return $c})),n.d(t,"maximum",(function(){return Wu})),n.d(t,"maximumStrict",(function(){return zu})),n.d(t,"mean",(function(){return sl})),n.d(t,"memory",(function(){return zt})),n.d(t,"min",(function(){return ul})),n.d(t,"minimum",(function(){return Gu})),n.d(t,"minimumStrict",(function(){return Hu})),n.d(t,"mod",(function(){return $u})),n.d(t,"modStrict",(function(){return Ku})),n.d(t,"moments",(function(){return cl})),n.d(t,"movingAverage",(function(){return Tl})),n.d(t,"mul",(function(){return Yu})),n.d(t,"mulStrict",(function(){return Xu})),n.d(t,"multiRNNCell",(function(){return xl})),n.d(t,"multinomial",(function(){return fr})),n.d(t,"neg",(function(){return Zs})),n.d(t,"nextFrame",(function(){return zp})),n.d(t,"norm",(function(){return _l})),n.d(t,"notEqual",(function(){return hc})),n.d(t,"notEqualStrict",(function(){return fc})),n.d(t,"oneHot",(function(){return mr})),n.d(t,"ones",(function(){return Pn})),n.d(t,"onesLike",(function(){return Un})),n.d(t,"op",(function(){return wn})),n.d(t,"outerProduct",(function(){return Lc})),n.d(t,"pad",(function(){return vr})),n.d(t,"pad1d",(function(){return gr})),n.d(t,"pad2d",(function(){return yr})),n.d(t,"pad3d",(function(){return br})),n.d(t,"pad4d",(function(){return _r})),n.d(t,"pool",(function(){return Hc})),n.d(t,"pow",(function(){return Ju})),n.d(t,"powStrict",(function(){return Qu})),n.d(t,"prelu",(function(){return fl})),n.d(t,"print",(function(){return or})),n.d(t,"prod",(function(){return dl})),n.d(t,"profile",(function(){return Gt})),n.d(t,"rand",(function(){return wr})),n.d(t,"randomGamma",(function(){return Tr})),n.d(t,"randomNormal",(function(){return xr})),n.d(t,"randomUniform",(function(){return Cr})),n.d(t,"range",(function(){return Bn})),n.d(t,"ready",(function(){return Jt})),n.d(t,"real",(function(){return Tn})),n.d(t,"reciprocal",(function(){return eu})),n.d(t,"registerBackend",(function(){return nn})),n.d(t,"relu",(function(){return ml})),n.d(t,"relu6",(function(){return vl})),n.d(t,"removeBackend",(function(){return Zt})),n.d(t,"reshape",(function(){return Sr})),n.d(t,"reverse",(function(){return jc})),n.d(t,"reverse1d",(function(){return Bc})),n.d(t,"reverse2d",(function(){return Uc})),n.d(t,"reverse3d",(function(){return Fc})),n.d(t,"reverse4d",(function(){return Vc})),n.d(t,"rfft",(function(){return Ol})),n.d(t,"round",(function(){return tu})),n.d(t,"rsqrt",(function(){return nu})),n.d(t,"scalar",(function(){return kn})),n.d(t,"scatterND",(function(){return El})),n.d(t,"selu",(function(){return gl})),n.d(t,"separableConv2d",(function(){return Ic})),n.d(t,"serialization",(function(){return Cp})),n.d(t,"setBackend",(function(){return Xt})),n.d(t,"setPlatform",(function(){return an})),n.d(t,"setdiff1dAsync",(function(){return Nr})),n.d(t,"sigmoid",(function(){return ru})),n.d(t,"sign",(function(){return iu})),n.d(t,"signal",(function(){return ql})),n.d(t,"sin",(function(){return uu})),n.d(t,"sinh",(function(){return cu})),n.d(t,"slice",(function(){return Yc})),n.d(t,"slice1d",(function(){return Xc})),n.d(t,"slice2d",(function(){return Jc})),n.d(t,"slice3d",(function(){return Qc})),n.d(t,"slice4d",(function(){return Zc})),n.d(t,"softmax",(function(){return ni})),n.d(t,"softplus",(function(){return lu})),n.d(t,"spaceToBatchND",(function(){return Er})),n.d(t,"sparseToDense",(function(){return Nl})),n.d(t,"spectral",(function(){return Il})),n.d(t,"split",(function(){return Hn})),n.d(t,"sqrt",(function(){return du})),n.d(t,"square",(function(){return pu})),n.d(t,"squaredDifference",(function(){return Zu})),n.d(t,"squaredDifferenceStrict",(function(){return ec})),n.d(t,"squeeze",(function(){return kr})),n.d(t,"stack",(function(){return Rr})),n.d(t,"step",(function(){return hu})),n.d(t,"stft",(function(){return Vl})),n.d(t,"stridedSlice",(function(){return Cl})),n.d(t,"sub",(function(){return tc})),n.d(t,"subStrict",(function(){return nc})),n.d(t,"sum",(function(){return ll})),n.d(t,"tan",(function(){return fu})),n.d(t,"tanh",(function(){return mu})),n.d(t,"tensor",(function(){return Sn})),n.d(t,"tensor1d",(function(){return Rn})),n.d(t,"tensor2d",(function(){return On})),n.d(t,"tensor3d",(function(){return An})),n.d(t,"tensor4d",(function(){return In})),n.d(t,"tensor5d",(function(){return Nn})),n.d(t,"tensor6d",(function(){return Dn})),n.d(t,"tensor_util",(function(){return Re})),n.d(t,"test_util",(function(){return Ap})),n.d(t,"tidy",(function(){return Ht})),n.d(t,"tile",(function(){return Or})),n.d(t,"time",(function(){return Yt})),n.d(t,"topk",(function(){return Sl})),n.d(t,"train",(function(){return qp})),n.d(t,"transpose",(function(){return yl})),n.d(t,"truncatedNormal",(function(){return Ar})),n.d(t,"unsortedSegmentSum",(function(){return yc})),n.d(t,"unstack",(function(){return Ir})),n.d(t,"util",(function(){return Z})),n.d(t,"valueAndGrad",(function(){return Jr})),n.d(t,"valueAndGrads",(function(){return Qr})),n.d(t,"variable",(function(){return _e})),n.d(t,"variableGrads",(function(){return Zr})),n.d(t,"version_core",(function(){return Ip})),n.d(t,"webgl",(function(){return Np})),n.d(t,"where",(function(){return Pu})),n.d(t,"whereAsync",(function(){return Mu})),n.d(t,"zeros",(function(){return Mn})),n.d(t,"zerosLike",(function(){return Fn}));
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function s(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var c=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],i=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,i)}))}},e}();function l(){return d}var d=null;function p(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function h(e,t,n){return Math.max(e,Math.min(t,n))}function f(e){return e%2==0?e:e+1}function m(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function v(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function g(e,t,n){void 0===n&&(n=""),v(w(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function y(e){v(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function b(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||M(e)&&!n)for(var r=0;r<e.length;++r)b(e[r],t,n);else t.push(e);return t}function _(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function w(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function x(e){return e%1==0}function T(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function C(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function S(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function E(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,i){var a=0,o=function(){if(e())r();else{var s=t(++a);null!=n&&a>=n?i():setTimeout(o,s)}};o()}))}function k(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(-1===e[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function R(e,t){var n=t.length;return v((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),v(e.every((function(e){return x(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function O(e,t){for(var n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,a=null==t||i?null:R(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=a){if(a[o]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==a[o]||a[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function A(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function I(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function N(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function D(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function P(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function M(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function L(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function j(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function B(e){return"string"==typeof e||e instanceof String}function U(e){return"boolean"==typeof e}function F(e){return"number"==typeof e}function V(e){return Array.isArray(e)?V(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":F(e)?"float32":B(e)?"string":U(e)?"bool":"float32"}function q(e){return!!(e&&e.constructor&&e.call&&e.apply)}function W(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function z(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function G(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=b(e)),n&&N(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)0!==Math.round(e[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function H(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var i=new Array;if(1===n.length)for(var a=n[0],o=0;o<a;o++)i[o]=r[t+o];else{a=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(o=0;o<a;o++)i[o]=e(t+o*u,s,r)}return i}(0,e,t)}function $(e,t){for(var n=K(e,t),r=0;r<n.length;r++)n[r]=1;return n}function K(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Y(){return l().platform.now()}function X(e){e.forEach((function(t){v(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function J(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",l().platform.encode(e,t)}function Q(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",l().platform.decode(e,t)}var Z=Object.freeze({shuffle:p,clamp:h,nearestLargerEven:f,sum:m,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:v,assertShapesMatch:g,assertNonNull:y,flatten:b,sizeFromShape:_,isScalarShape:function(e){return 0===e.length},arraysEqual:w,isInt:x,tanh:T,sizeToSquarishShape:C,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return p(t),t},rightPad:S,repeatedTry:E,inferFromImplicitShape:k,parseAxisParam:R,squeezeShape:O,getTypedArrayFromDType:A,getArrayFromDType:I,checkConversionForErrors:N,isValidDtype:D,hasEncodingLoss:P,isTypedArray:M,bytesPerElement:L,bytesFromStringArray:j,isString:B,isBoolean:U,isNumber:F,inferDtype:V,isFunction:q,nearestDivisor:W,computeStrides:z,toTypedArray:G,toNestedArray:H,makeOnesTypedArray:$,makeZerosTypedArray:K,now:Y,assertNonNegativeIntegerDimensions:X,fetch:function(e,t){return l().platform.fetch(e,t)},encodeString:J,decodeString:Q}),ee=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new te)}return e.prototype.profileKernel=function(e,t,n){var r,i=this,a=this.backendTimer.time((function(){r=n()}));return(Array.isArray(r)?r:[r]).forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),a.then((function(a){var o="";null!=a.getExtraProfileInfo&&(o=a.getExtraProfileInfo()),i.logger.logKernelProfile(e,n,r,a.kernelMs,t,o)}))}))})),r},e}(),te=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,i,a){var o=S(r+"ms",9),s=S(e,25),u=t.rank,c=t.size,l=S(t.shape.toString(),14),d="";for(var p in i){var h=i[p].shape,f=h.length;d+=p+": "+f+"D "+(f>0?h:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+d+"\t%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),ne=20,re=3,ie=7;function ae(e,t,n,r){var i=z(t),a=function(e,t,n,r){var i=_(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u="complex64"===n?ue(e):e;if(s>1)for(var c=0;c<i/a;c++)for(var l=c*a,d=0;d<a;d++)o[d]=Math.max(o[d],oe(u[l+d],0,n).length);return o}(e,t,n,i),o=t.length,s=function e(t,n,r,i,a,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c){if("complex64"===r){var l=ue(t);return[oe(l[0],0,r)]}return"bool"===r?[se(t[0])]:[t[0].toString()]}if(1===c){if(u>ne){var d=re*s,p=Array.from(t.slice(0,d)),h=Array.from(t.slice(u-re*s,u));return"complex64"===r&&(p=ue(p),h=ue(h)),["["+p.map((function(e,t){return oe(e,a[t],r)})).join(", ")+", ..., "+h.map((function(e,t){return oe(e,a[u-re+t],r)})).join(", ")+"]"]}var f="complex64"===r?ue(t):Array.from(t);return["["+f.map((function(e,t){return oe(e,a[t],r)})).join(", ")+"]"]}var m=n.slice(1),v=i.slice(1),g=i[0]*s,y=[];if(u>ne){for(var b=0;b<re;b++){var _=b*g,w=_+g;y.push.apply(y,e(t.slice(_,w),m,r,v,a,!1))}y.push("...");for(b=u-re;b<u;b++){_=b*g,w=_+g;y.push.apply(y,e(t.slice(_,w),m,r,v,a,b===u-1))}}else for(b=0;b<u;b++){_=b*g,w=_+g;y.push.apply(y,e(t.slice(_,w),m,r,v,a,b===u-1))}var x=2===c?",":"";y[0]="["+y[0]+x;for(b=1;b<y.length-1;b++)y[b]=" "+y[b]+x;var T=",\n";for(b=2;b<c;b++)T+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(o?"":T),y}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function oe(e,t,n){return S(Array.isArray(e)?parseFloat(e[0].toFixed(ie))+" + "+parseFloat(e[1].toFixed(ie))+"j":B(e)?"'"+e+"'":"bool"===n?se(e):parseFloat(e.toFixed(ie)).toString(),t)}function se(e){return 0===e?"false":"true"}function ue(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var ce=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=_(e),null!=n){var i=n.length;v(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||I(t,this.size),this.strides=z(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),v(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var i=this.locToIndex(n);this.values[i]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,i=e;r<i.length;r++){var a=i[r];if(a<0||a>=this.shape[n]){var o="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return he.make(this.shape,{values:this.values},this.dtype)},e}(),le=null,de=null,pe=null,he=function(){function e(e,t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=_(e),this.strides=z(e),this.dataId=null!=r?r:{},this.id=le().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",le().registerTensor(this,i),null!=n&&le().write(i,this.dataId,n)}return e.make=function(t,n,r,i){var a=n.values;return null!=n.values&&"string"===r&&B(n.values[0])&&(a=n.values.map((function(e){return J(e)}))),new e(t,r,a,n.dataId,i)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),v(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),this.reshape([e,t,n,r,i])},e.prototype.asType=function(e){return this.throwIfDisposed(),de.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,de.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return de.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,H(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return H(this.shape,this.dataSync())},e.prototype.data=function(){return s(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=le().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return Q(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=le().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return Q(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,le().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(le().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),de.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),de.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),de.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),de.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),de.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),de.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),de.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),ae(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),de.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),de.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),de.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),de.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),de.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),de.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),de.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),de.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),de.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),de.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),de.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),de.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,i){return void 0===n&&(n=.001),pe("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,i,r,n)},e.prototype.batchNorm=function(e,t,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),de.batchNorm(this,e,t,n,r,i)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),de.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),de.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),de.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),de.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),de.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),de.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),de.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),de.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),de.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),de.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),de.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),de.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),de.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),de.div(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),de.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),de.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),de.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),de.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),de.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),de.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),de.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),de.modStrict(this,e)},e.prototype.squaredDifference=function(e){return this.throwIfDisposed(),de.squaredDifference(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),de.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),de.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),de.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),de.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),de.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),de.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),de.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),de.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),de.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),de.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),de.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),de.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),de.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),de.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),de.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),de.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),de.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),de.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),de.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),de.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),de.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),de.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),de.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),de.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),de.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),de.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),de.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),de.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),de.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),de.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),de.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),de.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),de.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),de.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),de.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),de.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),de.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),de.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),de.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),de.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),de.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),de.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),de.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),de.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),de.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),de.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),de.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),de.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),de.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),de.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),de.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),de.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),de.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),de.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),de.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),de.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),de.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),de.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),de.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),de.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),de.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),de.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),de.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),de.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),de.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),de.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,i,a){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),de.conv1d(this,e,t,n,r,i,a)},e.prototype.conv2d=function(e,t,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),de.conv2d(this,e,t,n,r,i,a)},e.prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),de.conv2dTranspose(this,e,t,n,r,i)},e.prototype.depthwiseConv2D=function(e,t,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),de.depthwiseConv2d(this,e,t,n,r,i,a)},e.prototype.separableConv2d=function(e,t,n,r,i,a){return void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC"),this.throwIfDisposed(),de.separableConv2d(this,e,t,n,r,i,a)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),de.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),de.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),de.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,i){return this.throwIfDisposed(),de.pool(this,e,t,n,r,i)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),fe.variable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),de.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),de.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),de.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),de.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,i,a,o,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),de.stridedSlice(this,e,t,n,r,i,a,o,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),de.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),de.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),de.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),de.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),de.spectral.irfft(this)},e}();Object.defineProperty(he,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var fe=function(e){function t(t,n,r){void 0===n&&(n=!0);var i=e.call(this,t.shape,t.dtype,null,t.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=le().nextVariableId().toString());try{le().registerVariable(i)}catch(e){throw le().disposeTensor(i),e}return i}return o(t,e),t.variable=function(e,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==e.dtype&&(e=e.asType(i)),new t(e,n,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!w(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");le().disposeTensor(this),this.dataId=e.dataId,le().registerTensor(this)},t.prototype.dispose=function(){le().disposeVariable(this),this.isDisposedInternal=!0},t}(he);Object.defineProperty(fe,Symbol.hasInstance,{value:function(e){return e instanceof he&&null!=e.assign&&e.assign instanceof Function}});var me,ve,ge,ye,be,_e=fe.variable;!function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(me||(me={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ve||(ve={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(ge||(ge={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(ye||(ye={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(be||(be={}));var we={float32:ye,int32:ve,bool:ge,complex64:be};function xe(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return we[e][t]}function Te(e){return xe(e,"int32")}function Ce(e,t){if(e.dtype===t.dtype)return[e,t];var n=xe(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Se(e,t){v(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function Ee(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof he)n.push(t);else if(i=t,Array.isArray(i)||"object"==typeof i){var i,a=t;for(var o in a){var s=a[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}var ke,Re=Object.freeze({makeTypesMatch:Ce,assertTypesMatch:Se,isTensorInList:function(e,t){for(var n=0;n<t.length;n++)if(t[n].id===e.id)return!0;return!1},getTensorsInContainer:Ee}),Oe=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),Ae=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Oe}return e.prototype.ready=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[e],this.profiler=new ee(this.backendInstance),[2,!0]}}))}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(i<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),i=r.success,a=r.asyncInit;if(a||i)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){this.write(e,t,this.readSync(t))},e.prototype.tidy=function(e,t){var n,r=this,i=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=e}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=he.make(e.shape,{dataId:e.dataId},e.dtype);return this.addTapeNode([e],t,(function(e){return[e.toFloat()]})),t},e.prototype.runKernel=function(e,t,n){var r,i=this,a=[],o=this.isTapeOn(),s=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(e){o&&(a=e.map((function(e){return i.keep(i.clone(e))})))},c=this.state.numBytes,l=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(s,t,(function(){return e(i.backend,u)})):e(i.backend,u)})),o){var d={id:this.state.nextTapeNodeId++,name:s,inputs:t,outputs:Array.isArray(r)?r:[r],saved:a};null!=n&&(d.gradient=function(e){return n(e,a)}),this.state.activeTape.push(d)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-c,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-l,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShape:Array.isArray(r)?r.map((function(e){return e.shape})):r.shape}),r},e.prototype.registerTensor=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*L(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:null!=t?t:this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=t?t.register(e.dataId,e.shape,e.dtype):this.backend.register(e.dataId,e.shape,e.dtype)}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof fe||this.track(e)},e.prototype.registerVariable=function(e){if(null!=this.state.registeredVariables[e.name])throw new Error("Variable with name "+e.name+" was already registered");this.state.registeredVariables[e.name]=e},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n){var r={};e.forEach((function(e,t){r[t]=e}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[t],gradient:function(e){var t=n(e),r={};return t.forEach((function(e,t){r[t]=function(){return e}})),r}};this.state.activeTape.push(i)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=Ee(e),r=new Set(n.map((function(e){return e.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var i=this;if(void 0===r&&(r=!1),v(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",e)}));v(a instanceof he,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(a=0;a<e.length;a++){var o=(f=e[a]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<t.length;l++)if(r[u.id]){f.outputs.forEach((function(e){return r[e.id]=!0})),c=!0,i[f.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;var p={};for(a=e.length-1;a>=0;a--)for(o=(f=e[a]).inputs,l=0;l<f.outputs.length;l++)if(d[f.outputs[l].id]){for(var s in o)d[o[s].id]=!0,p[f.id]=!0;break}var h=[];for(a=0;a<e.length;a++){var f;if(i[(f=e[a]).id]&&p[f.id]){var m={};for(var s in f.inputs){var v=f.inputs[s];r[v.id]&&(m[s]=v)}var g=Object.assign({},f);g.inputs=m,g.outputs=f.outputs,h.push(g)}}return h}(this.state.activeTape,t,a);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[a.id]=null==n?(e=a.shape,r=$(_(e),"float32"),he.make(e,{values:r})):n,function(e,t,n){for(var r=function(r){var i=t[r],a=[];if(i.outputs.forEach((function(t){var n=e[t.id];if(null!=n)a.push(n);else{var r=he.make(t.shape,{values:K(t.size,t.dtype)},t.dtype);a.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var o=i.gradient(1===i.outputs.length?a[0]:a),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var a=i.inputs[t];if(!w(r.shape,a.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+a.shape+"'");if(null==e[a.id])e[a.id]=r;else{var s=e[a.id];e[a.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=t.length-1;i>=0;i--)r(i)}(s,o,(function(e){return i.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(e){for(var t in e.saved)e.saved[t].dispose()})),i.state.activeTape=null),{value:a,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return v(q(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];v(r.every((function(e){return e instanceof he})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(e,t){a[t]=e})),t.runKernel((function(t,i){return v((n=e.apply(void 0,r.concat([i]))).value instanceof he,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),v(q(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),a,(function(e,t){var i=n.gradFunc(e,t),a=Array.isArray(i)?i:[i];v(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),v(a.every((function(e){return e instanceof he})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o}))}},e.prototype.write=function(e,t,n){var r=this.state.tensorInfo.get(t),i=r.backend;if(e=e||this.backend,"string"===r.dtype){var a=j(n);this.state.numBytes+=a-r.bytes,r.bytes=a}e!==i&&(i.disposeData(t),r.backend=e,e.register(t,r.shape,r.dtype)),e.write(t,n)},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},e.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=Y(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=Y()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Oe,this.registry)this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),Ie=function(){var t=function(){if(null==ke){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof e)t=e;else if("undefined"!=typeof r)t=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}ke=t}return ke}();if(null==t._tfengine){var n=new c(t);t._tfengine=new Ae(n)}return function(e){d=e}(t._tfengine.ENV),le=function(){return t._tfengine},t._tfengine}();function Ne(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var De=l();De.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),De.registerFlag("IS_BROWSER",(function(){return Ne()})),De.registerFlag("IS_NODE",(function(){return"undefined"!=typeof r&&void 0!==r.versions&&void 0!==r.versions.node})),De.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),De.registerFlag("PROD",(function(){return!1})),De.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return De.getBool("DEBUG")})),De.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),De.registerFlag("IS_TEST",(function(){return!1}));var Pe,Me,Le={},je={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Be(e,t){Le[e]=t}function Ue(e){e in Le||(Le[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=Fe(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Le[e]}),!1),1===e?t.getContext("webgl",je)||t.getContext("experimental-webgl",je):t.getContext("webgl2",je)}(e));var t=Le[e];return t.isContextLost()?(delete Le[e],Ue(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Le[e])}function Fe(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ve(e,t){return[t,e]}function qe(e){var t=_(e);return C(Math.ceil(t/4))}function We(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function ze(e,t){var n,r,i,a,o,s,u,c,d,p=e;return 2===l().getNumber("WEBGL_VERSION")?(n=p.R32F,r=p.R16F,i=p.RGBA16F,a=p.RGBA32F,o=p.RED,s=4,u=1,c=p.HALF_FLOAT,d=p.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=p.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:d}}function Ge(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Ye(e,t))}(e),r}!function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Pe||(Pe={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Me||(Me={}));var He=5.96e-8,$e=65504;function Ke(e){return!!(l().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||He<Math.abs(e)&&Math.abs(e)<$e)}function Ye(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Xe(e,t,n){return bt(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Je(e,t,n){var r=bt(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Ge(e,t,(function(){return e.shaderSource(r,n)})),Ge(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Qe(e,t,n){var r=bt(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Ge(e,t,(function(){return e.shaderSource(r,n)})),Ge(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=tt.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],i=e.split("\n"),a=i.length.toString().length+2,o=i.map((function(e,t){return S((t+1).toString(),a)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),d=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+S(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Ze,et,tt=/ERROR: [0-9]+:([0-9]+):/g;function nt(e,t){return bt(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function rt(e,t,n){if(Ge(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function it(e,t,n){if(Ge(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function at(e,t,n){var r=bt(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Ge(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),Ge(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function ot(e,t,n){var r=bt(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Ge(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),Ge(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function st(e,t){return bt(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function ut(e,t){var n=l().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function ct(e,t){return bt(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function lt(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return-1!==u&&(Ge(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,i)})),Ge(e,t,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)})),Ge(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function dt(e,t,n,r){_t(e,r),Ge(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function pt(e,t,n,r){return bt(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function ht(e,t,n){return e.getUniformLocation(t,n)}function ft(e,t,n,r,i,a){Ge(e,t,(function(){return dt(e,t,r,a)})),Ge(e,t,(function(){return e.uniform1i(i,a)}))}function mt(e,t,n,r){Ge(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),Ge(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function vt(e,t,n){Ge(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),Ge(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function gt(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+yt(e,t))}function yt(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function bt(e,t,n,r){var i=Ge(e,t,(function(){return n()}));if(null==i)throw new Error(r);return i}function _t(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function wt(e,t){return void 0===t&&(t=2),_(e.slice(0,e.length-t))}function xt(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Tt(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[wt(e)].concat(xt(e))),t}function Ct(e,t){var n;void 0===t&&(t=!1);var r=l().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?f(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var i=O(e);e=i.newShape}var a=_(e);if(e.length<=1&&a<=r)return[1,a];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=wt(e),s=2,u=2;return e.length&&(s=(n=xt(e))[0],u=n[1]),C(a=o*(s/2)*(u/2)).map((function(e){return 2*e}))}return C(a)}function St(e){return e%2==0}function Et(e,t){if(w(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(St(n)&&St(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&St(e[0])&&St(t[0])}function kt(e){if(null==Ze){var t=Ue(e);Ze=t.getParameter(t.MAX_TEXTURE_SIZE)}return Ze}function Rt(e){if(null==et){var t=Ue(e);et=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,et)}function Ot(e){if(0===e)return 0;var t=Ue(e);return At(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:At(t,"EXT_disjoint_timer_query")?1:0}function At(e,t){return null!=e.getExtension(t)}function It(e){try{if(null!=Ue(e))return!0}catch(e){return!1}return!1}function Nt(e){if(0===e)return!1;var t=Ue(e);if(1===e){if(!At(t,"OES_texture_float"))return!1}else if(!At(t,"EXT_color_buffer_float"))return!1;return Pt(t)}function Dt(e){if(0===e)return!1;var t=Ue(e);if(1!==e){if(At(t,"EXT_color_buffer_float"))return Pt(t);if(At(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=ze(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),a}(t,n)}return!1}return!!At(t,"OES_texture_float")&&!!At(t,"WEBGL_color_buffer_float")&&Pt(t)}function Pt(e){var t=ze(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function Mt(e){return 2===e&&null!=Ue(e).fenceSync}var Lt=Object.freeze({callAndCheck:Ge,canBeRepresented:Ke,getWebGLErrorMessage:Ye,getExtensionOrThrow:Xe,createVertexShader:Je,createFragmentShader:Qe,createProgram:nt,linkProgram:rt,validateProgram:it,createStaticVertexBuffer:at,createStaticIndexBuffer:ot,getNumChannels:function(){return 2===l().getNumber("WEBGL_VERSION")?1:4},createTexture:st,validateTextureSize:ut,createFramebuffer:ct,bindVertexBufferToProgramAttribute:lt,bindTextureUnit:dt,unbindTextureUnit:function(e,t,n){_t(e,n),Ge(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:pt,getProgramUniformLocation:ht,bindTextureToProgramUniformSampler:ft,bindCanvasToFramebuffer:function(e,t){Ge(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Ge(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),Ge(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:mt,unbindColorTextureFromFramebuffer:vt,validateFramebuffer:gt,getFramebufferErrorMessage:yt,getBatchDim:wt,getRowsCols:xt,getShapeAs3D:Tt,getTextureShapeFromLogicalShape:Ct,isReshapeFree:Et,getWebGLMaxTextureSize:kt,resetMaxTextureSize:function(){Ze=null},resetMaxTexturesInShader:function(){et=null},getMaxTexturesInShader:Rt,getWebGLDisjointQueryTimerVersion:Ot,hasExtension:At,isWebGLVersionEnabled:It,isCapableOfRenderingToFloatTexture:Nt,isDownloadFloatTextureEnabled:Dt,isWebGLFenceEnabled:Mt}),jt=l();function Bt(){l().set("PROD",!0)}function Ut(){l().set("DEBUG",!0)}function Ft(){l().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Vt(e){l().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function qt(){Ie.disposeVariables()}function Wt(){return Ie}function zt(){return Ie.memory()}function Gt(e){return Ie.profile(e)}function Ht(e,t){return Ie.tidy(e,t)}function $t(e){Ee(e).forEach((function(e){return e.dispose()}))}function Kt(e){return Ie.keep(e)}function Yt(e){return Ie.time(e)}function Xt(e){return Ie.setBackend(e)}function Jt(){return Ie.ready()}function Qt(){return Ie.backendName}function Zt(e){Ie.removeBackend(e)}function en(e){return Ie.findBackend(e)}function tn(e){return Ie.findBackendFactory(e)}function nn(e,t,n){return void 0===n&&(n=1),Ie.registerBackend(e,t,n)}function rn(){return Ie.backend}function an(e,t){l().setPlatform(e,t)}function on(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l().getBool("IS_TEST")||console.warn.apply(console,e)}function sn(e,t){var n=e;if(M(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||M(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&l().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||M(t)){v(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),v(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var i=n.slice(1),a=0;a<t.length;++a)e(t[a],i,r.concat(a))}else v(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function un(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function cn(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof he)return un(r,e.dtype,t,n),e;var i=V(e);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),un(r,i,t,n),null==e||!M(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var a=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=sn(e,i);M(e)||Array.isArray(e)||(e=[e]);var s="string"!==i?G(e,i,l().getBool("DEBUG")):b(e,[],!0);return he.make(o,{values:s},i)}function ln(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return cn(e,t+"["+r+"]",n)}),r)}function dn(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function pn(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(e[a++]):i.push(t[o++]);return i}function hn(e,t){for(var n=[],r=e.length,i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map((function(t){return e[t]}))]}function fn(e,t){return pn(e,t.map((function(e){return 1})),t)}function mn(e,t,n){v(dn(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function vn(e,t){if(dn(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function gn(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function yn(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function bn(e,t){var n=e[0].length;e.forEach((function(e,t){v(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),v(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,i){for(var a=0;a<n;a++)v(a===t||e[a]===r[a],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function _n(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function wn(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ie.startScope(n);try{var i=r.apply(void 0,e);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ie.endScope(i),i}catch(e){throw Ie.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}jt.registerFlag("HAS_WEBGL",(function(){return jt.getNumber("WEBGL_VERSION")>0})),jt.registerFlag("WEBGL_VERSION",(function(){return It(2)?2:It(1)?1:0})),jt.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===jt.get("WEBGL_VERSION")})),jt.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),jt.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),jt.registerFlag("WEBGL_PACK",(function(){return jt.getBool("HAS_WEBGL")})),jt.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_CLIP",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),jt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_PACK_REDUCE",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_CONV_IM2COL",(function(){return jt.getBool("WEBGL_PACK")})),jt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return kt(jt.getNumber("WEBGL_VERSION"))})),jt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Rt(jt.getNumber("WEBGL_VERSION"))})),jt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=jt.getNumber("WEBGL_VERSION");return 0===e?0:Ot(e)})),jt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return jt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),jt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Nt(jt.getNumber("WEBGL_VERSION"))})),jt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!jt.getBool("WEBGL_FORCE_F16_TEXTURES")&&jt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),jt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Dt(jt.getNumber("WEBGL_VERSION"))})),jt.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Mt(jt.getNumber("WEBGL_VERSION"))})),jt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return jt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),pe=Vt;var xn=wn({complex_:function(e,t){var n=cn(e,"real","complex"),r=cn(t,"imag","complex");return g(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Ie.runKernel((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),Tn=wn({real_:function(e){var t=cn(e,"input","real");return Ie.runKernel((function(e){return e.real(t)}),{$input:t})}}),Cn=wn({imag_:function(e){var t=cn(e,"input","imag");return Ie.runKernel((function(e){return e.imag(t)}),{$input:t})}});function Sn(e,t,n){return En(e,t,sn(e,n),n)}function En(e,t,n,r){if(null==r&&(r=V(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!M(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){X(t);var i=_(t),a=_(n);v(i===a,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==_(t.slice(o));v(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return M(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?G(e,r,l().getBool("DEBUG")):b(e,[],!0),he.make(t,{values:e},r)}function kn(e,t){if((M(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&M(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return En(e,[],[],t)}function Rn(e,t){y(e);var n=sn(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return En(e,null,n,t)}function On(e,t,n){if(y(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=sn(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return En(e,t,r,n)}function An(e,t,n){if(y(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=sn(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return En(e,t,r,n)}function In(e,t,n){if(y(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=sn(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return En(e,t,r,n)}function Nn(e,t,n){if(y(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=sn(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return En(e,t,r,n)}function Dn(e,t,n){if(y(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=sn(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return En(e,t=t||r,r,n)}function Pn(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=Pn(e,"float32"),r=Mn(e,"float32");return xn(n,r)}var i=$(_(e),t);return he.make(e,{values:i},t)}function Mn(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=Mn(e,"float32"),r=Mn(e,"float32");return xn(n,r)}var i=K(_(e),t);return he.make(e,{values:i},t)}function Ln(e,t,n){return Ie.runKernel((function(r){return r.fill(e,t,n)}),{})}function jn(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Ie.runKernel((function(r){return r.linspace(e,t,n)}),{})}function Bn(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Mn([0],r);var i=K(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return Rn(i,r)}var Un=wn({onesLike_:function(e){var t=cn(e,"x","onesLike");if("complex64"===t.dtype){var n=Un(Tn(t)),r=Fn(Cn(t));return xn(n,r)}return Ie.runKernel((function(e){return e.onesLike(t)}),{$x:t},(function(e,t){return{$x:function(){return Fn(e)}}}))}}),Fn=wn({zerosLike_:function(e){var t=cn(e,"x","zerosLike");return Ie.runKernel((function(e){return e.zerosLike(t)}),{$x:t},(function(e,t){return{$x:function(){return Fn(e)}}}))}}),Vn=wn({concat_:function(e,t){void 0===t&&(t=0),v(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=ln(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=R(t,n[0].shape)[0];var r=_n(n.map((function(e){return e.shape})),t);if(0===_(r))return Sn([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var i=n.map((function(e){return e.shape}));bn(i,t);var a=n;return Ie.runKernel((function(e){return e.concat(n,t)}),a,(function(e){var n=i.map((function(e){return e[t]}));return Hn(e,n,t).map((function(e){return function(){return e}}))}))}}),qn=wn({concat1d_:function(e){return Vn(e,0)}}),Wn=wn({concat2d_:function(e,t){return Vn(e,t)}}),zn=wn({concat3d_:function(e,t){return Vn(e,t)}}),Gn=wn({concat4d_:function(e,t){return Vn(e,t)}}),Hn=wn({split_:function(e,t,n){void 0===n&&(n=0);var r,i=cn(e,"x","split");return n=R(n,i.shape)[0],"number"==typeof t?(v(i.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(i.shape[n]/t)):(v(i.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),Ie.runKernel((function(e){return e.split(i,r,n)}),{$x:i},(function(e){return{$x:function(){return Vn(e,n)}}}))}});function $n(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e||"undefined"!=typeof self&&self;var Kn=$n((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var n=new r(e),a=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.alea=a}(0,e,!1)})),Yn=$n((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.xor128=a}(0,e,!1)})),Xn=$n((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.xorwow=a}(0,e,!1)})),Jn=$n((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,a&&(a.x&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.xorshift7=a}(0,e,!1)})),Qn=$n((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,a=t.i;return t.w=r=r+1640531527|0,n=i[a+34&127],e=i[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,i,a,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),i=0,a=-32;a<u;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=o,e.X=s,e.i=i}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){null==e&&(e=+new Date);var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,a&&(a.X&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.xor4096=a}(0,e,!1)})),Zn=$n((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n((function(){return a})):this.tychei=a}(0,e,!1)})),er=$n((function(e){!function(t,r){var i,a=this,o=256,s=6,u="random",c=r.pow(o,s),l=r.pow(2,52),d=2*l,p=o-1;function h(e,n,p){var h=[],y=v(function e(t,n){var r,i=[],a=typeof t;if(n&&"object"==a)for(r in t)try{i.push(e(t[r],n-1))}catch(e){}return i.length?i:"string"==a?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,g(t)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(o):(e=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(e)),g(e)}catch(e){var n=a.navigator,r=n&&n.plugins;return[+new Date,a,r,a.screen,g(t)]}}():e,3),h),b=new f(h),_=function(){for(var e=b.g(s),t=c,n=0;e<l;)e=(e+n)*o,t*=o,n=b.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return _.int32=function(){return 0|b.g(4)},_.quick=function(){return b.g(4)/4294967296},_.double=_,v(g(b.S),t),(n.pass||p||function(e,t,n,i){return i&&(i.S&&m(i,b),e.state=function(){return m(b,{})}),n?(r[u]=e,t):e})(_,y,"global"in n?n.global:this==r,n.state)}function f(e){var t,n=e.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=p&a+e[i%n]+(t=s[i])],s[a]=t;(r.g=function(e){for(var t,n=0,i=r.i,a=r.j,s=r.S;e--;)t=s[i=p&i+1],n=n*o+s[p&(s[i]=s[a=p&a+t])+(s[a]=t)];return r.i=i,r.j=a,n})(o)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var n,r=e+"",i=0;i<r.length;)t[p&i]=p&(n^=19*t[p&i])+r.charCodeAt(i++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(r["seed"+u]=h,v(r.random(),t),e.exports){e.exports=h;try{i=n(3)}catch(e){}}}([],Math)}));er.alea=Kn,er.xor128=Yn,er.xorwow=Xn,er.xorshift7=Jn,er.xor4096=Qn,er.tychei=Zn;var tr=er.alea,nr=function(){function e(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=tr(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),rr=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var i=r||Math.random();this.randu=tr(i.toString()),this.randn=new nr(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-a+Math.log(a)),(i=this.randu())<t||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),ir=function(){function e(e,t,n,r){var i=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=tr(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function ar(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",X(e),new ce(e,t,n)}function or(e,t){void 0===t&&(t=!1),console.log(e.toString(t))}var sr=wn({batchToSpaceND_:function(e,t,n){var r=cn(e,"x","batchToSpaceND"),i=t.reduce((function(e,t){return e*t}));return v(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),v(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),v(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i})),Ie.runKernel((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),ur=wn({cast_:function(e,t){var n=cn(e,"x","cast");if(!D(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return Ie.runKernel((function(e){return e.cast(n,t)}),{$x:n},(function(e){return{$x:function(){return e.clone()}}}))}}),cr=wn({clone_:function(e){var t=cn(e,"x","clone",null);return Ie.runKernel((function(e){return he.make(t.shape,{dataId:t.dataId},t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),lr=wn({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=cn(e,"x","cumsum"),a=vn([t|=0],i.rank),o=i;null!=a&&(o=i.transpose(a));var s=yn(1,i.rank)[0],u=Ie.runKernel((function(e){return e.cumsum(o,s,n,r)}),{permutedX:o},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=a&&(u=u.transpose(a)),u}}),dr=wn({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=cn(e,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return v(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),v(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),v(o%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape})),Ie.runKernel((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),pr=wn({expandDims_:function(e,t){void 0===t&&(t=0);var n=cn(e,"x","expandDims",null);v(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(v(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),Sr(n,r)}}),hr=wn({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var i=ar([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return Or(pr(s,0),[n[0],1,1]);if(2===n.length)return Or(pr(pr(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Or(pr(pr(pr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),fr=wn({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var i=cn(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?i.as2D(1,-1):i,u=Ie.runKernel((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===o?u.as1D():u}}),mr=wn({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=cn(e,"indices","oneHot","int32"),a=i.shape.concat([t]);return i=i.flatten(),Ie.runKernel((function(e){return e.oneHot(i,t,n,r)}),{$indices:i},(function(e){return{$indices:function(){return Mn(i.shape,"float32")}}})).reshape(a)}}),vr=wn({pad_:function(e,t,n){void 0===n&&(n=0);var r=cn(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=t.map((function(e){return e[0]}));return Ie.runKernel((function(e){return e.pad(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.slice(i,r.shape)}}}))}}),gr=wn({pad1d_:function(e,t,n){return void 0===n&&(n=0),v(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),vr(e,[t],n)}}),yr=wn({pad2d_:function(e,t,n){return void 0===n&&(n=0),v(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),vr(e,t,n)}}),br=wn({pad3d_:function(e,t,n){return void 0===n&&(n=0),v(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),vr(e,t,n)}}),_r=wn({pad4d_:function(e,t,n){return void 0===n&&(n=0),v(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),vr(e,t,n)}}),wr=wn({rand_:function(e,t,n){var r=_(e),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return he.make(e,{values:i},n)}}),xr=wn({randomNormal_:function(e,t,n,r,i){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var a=new nr(t,n,r,!1,i),o=ar(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Tr=wn({randomGamma_:function(e,t,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var a=new rr(t,n,r,i),o=ar(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Cr=wn({randomUniform_:function(e,t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var a=ar(e,r),o=new ir(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Sr=wn({reshape_:function(e,t){var n=cn(e,"x","reshape",null);return t=k(t,n.size),v(n.size===_(t),(function(){return"new shape and old shape must have the same number of elements."})),Ie.runKernel((function(e){return e.reshape(n,t)}),{$x:n},(function(e){return{$x:function(){return e.reshape(n.shape)}}}))}}),Er=wn({spaceToBatchND_:function(e,t,n){var r=cn(e,"x","spaceToBatchND");return v(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),v(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),v(r.shape.reduce((function(e,r,i){return i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),Ie.runKernel((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),kr=wn({squeeze_:function(e,t){var n=cn(e,"x","squeeze");return Sr(n,O(n.shape,t).newShape)}}),Rr=wn({stack_:function(e,t){void 0===t&&(t=0);var n=ln(e,"tensors","stack");if(v(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;v(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){g(i,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){v(a===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(e){return e.expandDims(t)}));return Vn(o,t)}}),Or=wn({tile_:function(e,t){var n=cn(e,"x","tile",null);return v(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."})),Ie.runKernel((function(e,r){var i=e.tile(n,t);return r([n]),i}),{$x:n},(function(e,n){var r=n[0];return{$x:function(){var n=Fn(r);if(1===r.rank)for(var i=0;i<t[0];++i)n=n.add(e.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<t[0];++i)for(var a=0;a<t[1];++a)n=n.add(e.slice([i*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<t[0];++i)for(a=0;a<t[1];++a)for(var o=0;o<t[2];++o)n=n.add(e.slice([i*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<t[0];++i)for(a=0;a<t[1];++a)for(o=0;o<t[2];++o)for(var s=0;s<t[3];++s)n=n.add(e.slice([i*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),Ar=wn({truncatedNormal_:function(e,t,n,r,i){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var a=new nr(t,n,r,!0,i),o=ar(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Ir=wn({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=cn(e,"x","unstack");return v(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length),Ie.runKernel((function(e){return e.unstack(n,t)}),{$x:n},(function(e){return{$x:function(){return Rr(e,t)}}}))}}),Nr=function(e,t){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l,d,p;return u(this,(function(u){switch(u.label){case 0:return n=cn(e,"x","setdiff1d"),r=cn(t,"y","setdiff1d"),v(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),v(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),v(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=u.sent(),[4,r.data()];case 2:for(a=u.sent(),o=new Set(a),s=0,d=0;d<i.length;d++)o.has(i[d])||s++;for(c=new ce([s],n.dtype),l=new ce([s],"int32"),d=0,p=0;d<i.length;d++)o.has(i[d])||(c.values[p]=i[d],l.values[p]=d,p++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function Dr(e,t,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function Pr(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function Mr(e,t,n,r){void 0===r&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function Lr(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function jr(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}function Br(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var c=z(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,i,u,c]}var Ur=30;function Fr(e){return e<=Ur?e:W(e,Math.floor(Math.sqrt(e)))}function Vr(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}(n,t,e)}function qr(e,t,n){for(var r=t.rank>1?t.shape[t.rank-1]:1,i=n.length,a=1,o=r;o<i;++o)a*=n[o];var s=r<1?1:r;return{sliceRank:r,numUpdates:t.size/s,sliceSize:a,strides:z(n.slice(0,r)).concat([1]),outputSize:_(n)}}function Wr(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function zr(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function Gr(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||null==a)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),h(0,a,s-1)}function Hr(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||null==a)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),o>0?h(0,a,s):h(-1,a,s-1)}function $r(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function Kr(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function Yr(e){return v(q(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=cn(t,"x","tf.grad",null),i=null!=n?cn(n,"dy","tf.grad"):null;return Ie.tidy((function(){var t=Ie.gradients((function(){return e(r)}),[r],i),n=t.value,a=t.grads;return null!=i&&g(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ti(a),a[0]}))}}function Xr(e){return v(q(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){v(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=ln(t,"args","tf.grads",null),i=null!=n?cn(n,"dy","tf.grads"):null;return Ie.tidy((function(){var t=Ie.gradients((function(){return e.apply(void 0,r)}),r,i),n=t.value,a=t.grads;return null!=i&&g(n.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ti(a),a}))}}function Jr(e){return v(q(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){v(t instanceof he,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),v(null==n||n instanceof he,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=Ie.gradients((function(){return e(t)}),[t],n),i=r.grads,a=r.value;return ti(i),{grad:i[0],value:a}}}function Qr(e){return v(q(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){v(Array.isArray(t)&&t.every((function(e){return e instanceof he})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),v(null==n||n instanceof he,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=Ie.gradients((function(){return e.apply(void 0,t)}),t,n);return null!=n&&g(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ti(r.grads),r}}function Zr(e,t){v(q(e),(function(){return"The f passed in variableGrads(f) must be a function"})),v(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof fe})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],Ie.registeredVariables)t.push(Ie.registeredVariables[r]);var i=n?t.filter((function(e){return!e.trainable})):null,a=t.length;v((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."}));var o=Ie.gradients(e,t,null,!0),s=o.value,u=o.grads;v(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),v(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=i&&i.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}function ei(e){return Ie.customGrad(e)}function ti(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var ni=wn({softmax_:function(e,t){void 0===t&&(t=-1);var n=cn(e,"logits","softmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return ei((function(e,n){var r=e.logSumExp([t],!0),i=e.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(e,n){var r=n[0],i=e.mul(r);return i.sub(i.sum([t],!0).mul(r))}}}))(n)}}),ri=wn({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=cn(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return ei((function(e,n){var r=e.max(t,!0),i=e.sub(r),a=i.toFloat().sub(i.exp().sum(t,!0).log());return n([a]),{value:a,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),ii=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.data.delete(e)},e}(),ai=function(){function e(){}return e.prototype.time=function(e){throw new Error("Not yet implemented.")},e.prototype.read=function(e){throw new Error("Not yet implemented.")},e.prototype.readSync=function(e){throw new Error("Not yet implemented.")},e.prototype.disposeData=function(e){throw new Error("Not yet implemented.")},e.prototype.write=function(e,t){throw new Error("Not yet implemented.")},e.prototype.fromPixels=function(e,t){throw new Error("Not yet implemented.")},e.prototype.register=function(e,t,n){throw new Error("Not yet implemented.")},e.prototype.memory=function(){throw new Error("Not yet implemented.")},e.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.fusedBatchMatMul=function(e){throw e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,new Error("Not yet implemented")},e.prototype.slice=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.stridedSlice=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.unstack=function(e,t){throw new Error("Not yet implemented")},e.prototype.reverse=function(e,t){throw new Error("Not yet implemented")},e.prototype.concat=function(e,t){throw new Error("Not yet implemented")},e.prototype.neg=function(e){throw new Error("Not yet implemented")},e.prototype.add=function(e,t){throw new Error("Not yet implemented")},e.prototype.addN=function(e){throw new Error("Not yet implemented")},e.prototype.subtract=function(e,t){throw new Error("Not yet implemented")},e.prototype.multiply=function(e,t){throw new Error("Not yet implemented")},e.prototype.realDivide=function(e,t){throw new Error("Not yet implemented")},e.prototype.floorDiv=function(e,t){throw new Error("Not yet implemented")},e.prototype.sum=function(e,t){throw new Error("Not yet implemented")},e.prototype.prod=function(e,t){throw new Error("Not yet implemented")},e.prototype.unsortedSegmentSum=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.argMin=function(e,t){throw new Error("Not yet implemented")},e.prototype.argMax=function(e,t){throw new Error("Not yet implemented")},e.prototype.equal=function(e,t){throw new Error("Not yet implemented")},e.prototype.notEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.less=function(e,t){throw new Error("Not yet implemented")},e.prototype.lessEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.greater=function(e,t){throw new Error("Not yet implemented")},e.prototype.greaterEqual=function(e,t){throw new Error("Not yet implemented")},e.prototype.logicalNot=function(e){throw new Error("Not yet implemented")},e.prototype.logicalAnd=function(e,t){throw new Error("Not yet implemented")},e.prototype.logicalOr=function(e,t){throw new Error("Not yet implemented")},e.prototype.where=function(e){throw new Error("Not yet implemented")},e.prototype.select=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.topk=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.min=function(e,t){throw new Error("Not yet implemented")},e.prototype.minimum=function(e,t){throw new Error("Not yet implemented")},e.prototype.mod=function(e,t){throw new Error("Not yet implemented")},e.prototype.max=function(e,t){throw new Error("Not yet implemented")},e.prototype.maximum=function(e,t){throw new Error("Not yet implemented")},e.prototype.all=function(e,t){throw new Error("Not yet implemented")},e.prototype.any=function(e,t){throw new Error("Not yet implemented")},e.prototype.squaredDifference=function(e,t){throw new Error("Not yet implemented")},e.prototype.ceil=function(e){throw new Error("Not yet implemented")},e.prototype.floor=function(e){throw new Error("Not yet implemented")},e.prototype.round=function(e){throw new Error("Not yet implemented")},e.prototype.sign=function(e){throw new Error("Not yet implemented")},e.prototype.isNaN=function(e){throw new Error("Not yet implemented")},e.prototype.isInf=function(e){throw new Error("Not yet implemented")},e.prototype.isFinite=function(e){throw new Error("Not yet implemented")},e.prototype.pow=function(e,t){throw new Error("Not yet implemented")},e.prototype.exp=function(e){throw new Error("Not yet implemented")},e.prototype.expm1=function(e){throw new Error("Not yet implemented")},e.prototype.log=function(e){throw new Error("Not yet implemented")},e.prototype.log1p=function(e){throw new Error("Not yet implemented")},e.prototype.sqrt=function(e){throw new Error("Not yet implemented")},e.prototype.rsqrt=function(e){throw new Error("Not yet implemented")},e.prototype.square=function(e){throw new Error("Not yet implemented")},e.prototype.reciprocal=function(e){throw new Error("Not yet implemented")},e.prototype.relu=function(e){throw new Error("Not yet implemented")},e.prototype.relu6=function(e){throw new Error("Not yet implemented")},e.prototype.prelu=function(e,t){throw new Error("Not yet implemented")},e.prototype.elu=function(e){throw new Error("Not yet implemented")},e.prototype.eluDer=function(e,t){throw new Error("Not yet implemented")},e.prototype.selu=function(e){throw new Error("Not yet implemented")},e.prototype.int=function(e){throw new Error("Not yet implemented")},e.prototype.clip=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.abs=function(e){throw new Error("Not yet implemented")},e.prototype.complexAbs=function(e){throw new Error("Not yet implemented")},e.prototype.sigmoid=function(e){throw new Error("Not yet implemented")},e.prototype.softplus=function(e){throw new Error("Not yet implemented")},e.prototype.sin=function(e){throw new Error("Not yet implemented")},e.prototype.cos=function(e){throw new Error("Not yet implemented")},e.prototype.tan=function(e){throw new Error("Not yet implemented")},e.prototype.asin=function(e){throw new Error("Not yet implemented")},e.prototype.acos=function(e){throw new Error("Not yet implemented")},e.prototype.atan=function(e){throw new Error("Not yet implemented")},e.prototype.atan2=function(e,t){throw new Error("Not yet implemented")},e.prototype.sinh=function(e){throw new Error("Not yet implemented")},e.prototype.cosh=function(e){throw new Error("Not yet implemented")},e.prototype.tanh=function(e){throw new Error("Not yet implemented")},e.prototype.asinh=function(e){throw new Error("Not yet implemented")},e.prototype.acosh=function(e){throw new Error("Not yet implemented")},e.prototype.atanh=function(e){throw new Error("Not yet implemented")},e.prototype.erf=function(e){throw new Error("Not yet implemented")},e.prototype.step=function(e,t){throw new Error("Not yet implemented")},e.prototype.fusedConv2d=function(e){throw e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,new Error("Not yet implemented")},e.prototype.conv2d=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv2dDerInput=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv2dDerFilter=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.fusedDepthwiseConv2D=function(e){throw e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,new Error("Not yet implemented")},e.prototype.depthwiseConv2D=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv3d=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv3dDerInput=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.conv3dDerFilter=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.maxPool=function(e,t){throw new Error("Not yet implemented")},e.prototype.maxPoolBackprop=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.avgPool=function(e,t){throw new Error("Not yet implemented")},e.prototype.avgPoolBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.avgPool3d=function(e,t){throw new Error("Not yet implemented")},e.prototype.avgPool3dBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.maxPool3d=function(e,t){throw new Error("Not yet implemented")},e.prototype.maxPool3dBackprop=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.reshape=function(e,t){throw new Error("Not yet implemented")},e.prototype.cast=function(e,t){throw new Error("Not yet implemented")},e.prototype.tile=function(e,t){throw new Error("Not yet implemented")},e.prototype.pad=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.transpose=function(e,t){throw new Error("Not yet implemented")},e.prototype.gather=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.gatherND=function(e,t){throw new Error("Not yet implemented")},e.prototype.scatterND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.batchToSpaceND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.spaceToBatchND=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.resizeBilinear=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.resizeBilinearBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.batchNormalization=function(e,t,n,r,i,a){throw new Error("Not yet implemented")},e.prototype.localResponseNormalization4D=function(e,t,n,r,i){throw new Error("Not yet implemented")},e.prototype.LRNGrad=function(e,t,n,r,i,a,o){throw new Error("Not yet implemented")},e.prototype.multinomial=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.oneHot=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.cumsum=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.nonMaxSuppression=function(e,t,n,r,i){throw new Error("Not yet implemented")},e.prototype.fft=function(e){throw new Error("Not yet implemented")},e.prototype.ifft=function(e){throw new Error("Not yet implemented")},e.prototype.complex=function(e,t){throw new Error("Not yet implemented")},e.prototype.real=function(e){throw new Error("Not yet implemented")},e.prototype.imag=function(e){throw new Error("Not yet implemented")},e.prototype.cropAndResize=function(e,t,n,r,i,a){throw new Error("Not yet implemented")},e.prototype.depthToSpace=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.split=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.sparseToDense=function(e,t,n,r){throw new Error("Not yet implemented")},e.prototype.diag=function(e){throw new Error("Not yet implemented")},e.prototype.fill=function(e,t,n){throw new Error("Not yet implemented.")},e.prototype.onesLike=function(e){throw new Error("Not yet implemented")},e.prototype.zerosLike=function(e){throw new Error("Not yet implemented")},e.prototype.linspace=function(e,t,n){throw new Error("Not yet implemented")},e.prototype.dispose=function(){throw new Error("Not yet implemented")},e}();function oi(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&1===o&&r.unshift(a)}return r}function si(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(null==i||1===i&&o>1)&&n.unshift(a)}return n}function ui(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];null==a&&(a=1);var o=t[t.length-i-1];if(null==o&&(o=1),1===a)n.unshift(o);else if(1===o)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}function ci(e,t,n,r,i,a,o){void 0===o&&(o="channelsLast");var s,u=fi(t),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,e[1],e[1]]}return di(e,s,n,r,i,a,!1,o)}function li(e,t,n,r,i,a,o){void 0===o&&(o="NDHWC");var s,u,c=mi(t),l=c[0],d=c[1],p=c[2];if("NDHWC"===o)u="channelsLast",s=[l,d,p,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,d,p,e[1],e[1]]}return pi(e,s,n,r,i,!1,u,a)}function di(e,t,n,r,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],p=u[3];if("channelsLast"===s)c=e[0],l=e[1],d=e[2],p=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],p=e[1],l=e[2],d=e[3]}var h,f=t[0],m=t[1],g=t[3],y=fi(n),b=y[0],_=y[1],w=fi(r),T=w[0],C=w[1],S=vi(f,T),E=vi(m,C),k=function(e,t,n,r,i,a,o,s){var u,c,l;if("number"==typeof e){var d=0===e?"VALID":"NUMBER";u={top:e,bottom:e,left:e,right:e,type:d};var p=function(e,t,n,r,i){null==r&&(r=hi(e,t,n));var a=e[0],o=e[1],s=gi((a-t+2*r)/n+1,i);v(x(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var u=gi((o-t+2*r)/n+1,i);return v(x(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[s,u]}([t,n],a,r,e,s);c=p[0],l=p[1]}else if("same"===e){c=Math.ceil(t/r),l=Math.ceil(n/i);var h=Math.max(0,(c-1)*r+a-t),f=Math.max(0,(l-1)*i+o-n),m=Math.floor(h/2),g=h-m,y=Math.floor(f/2),b=f-y;u={top:m,bottom:g,left:y,right:b,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-a+1)/r),l=Math.ceil((n-o+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,d,b,_,S,E,a),R=k.padInfo,O=k.outHeight,A=k.outWidth,I=o?g*p:g;return"channelsFirst"===s?h=[c,I,O,A]:"channelsLast"===s&&(h=[c,O,A,I]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:p,outHeight:O,outWidth:A,outChannels:I,padInfo:R,strideHeight:b,strideWidth:_,filterHeight:f,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:E,dilationHeight:T,dilationWidth:C,inShape:e,outShape:h,filterShape:t}}function pi(e,t,n,r,i,a,o,s){void 0===a&&(a=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],p=u[3],h=u[4];if("channelsLast"===o)c=e[0],l=e[1],d=e[2],p=e[3],h=e[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=e[0],h=e[1],l=e[2],d=e[3],p=e[4]}var f,m=t[0],g=t[1],y=t[2],b=t[4],_=mi(n),w=_[0],T=_[1],C=_[2],S=mi(r),E=S[0],k=S[1],R=S[2],O=vi(m,E),A=vi(g,k),I=vi(y,R),N=function(e,t,n,r,i,a,o,s,u,c,l){var d,p,h,f;if("number"==typeof e){var m=0===e?"VALID":"NUMBER";d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:m};var g=function(e,t,n,r,i,a){null==i&&(i=hi(e,t,r));var o=e[0],s=e[1],u=e[2],c=gi((o-t+2*i)/r+1,a);v(x(c),(function(){return"The output # of depths ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=gi((s-t+2*i)/r+1,a);v(x(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var d=gi((u-t+2*i)/r+1,a);return v(x(d),(function(){return"The output # of columns ("+d+") must be an integer. Change the stride and/or zero pad parameters"})),[c,l,d,n]}([t,n,r,1],s,1,i,e,l);p=g[0],h=g[1],f=g[2]}else if("same"===e){p=Math.ceil(t/i),h=Math.ceil(n/a),f=Math.ceil(r/o);var y=(p-1)*i+s-t,b=(h-1)*a+u-n,_=(f-1)*o+c-r,w=Math.floor(y/2),T=y-w,C=Math.floor(b/2),S=b-C,E=Math.floor(_/2),k=_-E;d={top:C,bottom:S,left:E,right:k,front:w,back:T,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-s+1)/i),h=Math.ceil((n-u+1)/a),f=Math.ceil((r-c+1)/o)}return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}(i,l,d,p,w,T,C,O,A,I,s),D=N.padInfo,P=N.outDepth,M=N.outHeight,L=N.outWidth,j=a?b*h:b;return"channelsFirst"===o?f=[c,j,P,M,L]:"channelsLast"===o&&(f=[c,P,M,L,j]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:d,inWidth:p,inChannels:h,outDepth:P,outHeight:M,outWidth:L,outChannels:j,padInfo:D,strideDepth:w,strideHeight:T,strideWidth:C,filterDepth:m,filterHeight:g,filterWidth:y,effectiveFilterDepth:O,effectiveFilterHeight:A,effectiveFilterWidth:I,dilationDepth:E,dilationHeight:k,dilationWidth:R,inShape:e,outShape:f,filterShape:t}}function hi(e,t,n,r){void 0===r&&(r=1);var i=vi(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function fi(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function mi(e){return"number"==typeof e?[e,e,e]:e}function vi(e,t){return t<=1?e:e+(e-1)*(t-1)}function gi(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function yi(e){var t=fi(e),n=t[0],r=t[1],i=t[2];return 1===n&&1===r&&1===i}function bi(e,t){return yi(e)||yi(t)}function _i(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function wi(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Mn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!P(e.dtype,t))return he.make(e.shape,{dataId:e.dataId},t);if("complex64"===e.dtype){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if("int32"===t)return n.int(e);if("bool"===t){var s=kn(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function xi(e,t){return he.make(t,{dataId:e.dataId},e.dtype)}function Ti(e,t,n){var r=(t-e)/(n-1),i=K(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return Rn(i,"float32")}var Ci=Object.freeze({castTensor:wi,reshapeTensor:xi,linspaceImpl:Ti,upcastType:xe,axesAreInnerMostDims:dn,combineLocations:pn,computeOutAndReduceShapes:hn,expandShapeToKeepDim:fn,assertAxesAreInnerMostDims:mn,getAxesPermutation:vn,getUndoAxesPermutation:gn,getInnerMostAxes:yn,getBroadcastDims:oi,getReductionAxes:si,assertAndGetBroadcastShape:ui,assertParamsConsistent:bn,computeOutShape:_n,computePool2DInfo:ci,computePool3DInfo:li,computeConv2DInfo:di,computeConv3DInfo:pi,computeDefaultPad:hi,tupleValuesAreOne:yi,eitherStridesOrDilationsAreOne:bi,convertConv2DDataFormat:_i});function Si(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ei(e,t){return{real:e[2*t],imag:e[2*t+1]}}function ki(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Ri(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Oi(e,t,n,r,i){for(var a=Array.from(t).map((function(e,t){return{score:e,boxIndex:t}})).filter((function(e){return e.score>i})).sort((function(e,t){return t.score-e.score})),o=[],s=0;s<a.length;s++){var u=a[s],c=u.score,l=u.boxIndex;if(c<i)break;for(var d=!1,p=o.length-1;p>=0;--p)if(Ai(e,l,o[p])>=r){d=!0;break}if(!d&&(o.push(l),o.length>=n))break}return Rn(o,"int32")}function Ai(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),h=(s-a)*(u-o),f=(d-c)*(p-l);if(h<=0||f<=0)return 0;var m=Math.max(a,c),v=Math.max(o,l),g=Math.min(s,d),y=Math.min(u,p),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(h+f-b)}function Ii(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map((function(t){i[n]=t;var a=e.slice(r,i);return r[n]+=t,a}))}function Ni(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=ar(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function Di(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],c=A(n,s*r),l=A("int32",s*r),d=0;d<s;d++){for(var p=d*u,h=e.subarray(p,p+u),f=[],m=0;m<h.length;m++)f.push({value:h[m],index:m});f.sort((function(e,t){return t.value-e.value}));var v=d*r,g=c.subarray(v,v+r),y=l.subarray(v,v+r);for(m=0;m<r;m++)g[m]=f[m].value,y[m]=f[m].index}var b=t.slice();return b[b.length-1]=r,[Sn(c,b,n),Sn(l,b,"int32")]}function Pi(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=ar(e,"int32"),a=ar([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var Mi=function(){return function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "}}(),Li=function(){return function(e,t){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "}}(),ji=function(){return function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}}();function Bi(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function Ui(e,t){return 1===t?[e]:Bi(e,t)}function Fi(){var e,t,n,r,i,a,o,s,u,c;return 2===l().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Vi(e,t,n){void 0===n&&(n="index");var r=z(t);return r.map((function(t,i){return"int "+e[i]+" = "+n+" / "+t+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+t:"index -= "+e[i]+" * "+t)+";"})).join("")}function qi(e){var t=z(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var Wi="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function zi(e,t,n,r){var i=[];e.forEach((function(e){var t=_(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?i.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(i.push("uniform sampler2D "+e.name+";"),i.push("uniform int offset"+e.name+";"))}));var a,o,s=i.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?Hi(e):Gi(e);var i=e.shapeInfo.logicalShape,a=t.logicalShape;return i.length<=a.length&&(r+=n?function(e,t){var n,r=e.name,i=r.charAt(0).toUpperCase()+r.slice(1),a="get"+i+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=oi(e.shapeInfo.logicalShape,t.logicalShape),c=Zi(s),l=s-o,d=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+d[e+l]+" = 0;"})).join("\n");var p="";p=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+d[t+l]})).join(", ");var h="return outputValue;",f=1===_(e.shapeInfo.logicalShape),m=1===_(t.logicalShape);if(1!==o||f||m){if(f&&!m)h=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=o-2,g=o-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?h="return vec4(outputValue.x);":u.indexOf(v)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+a+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+i+"("+p+");\n      "+h+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&w(o,a))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=Zi(u),d=oi(e.shapeInfo.logicalShape,t.logicalShape),p=u-s,h=["x","y","z","w","u","v"];c=0===s?"":u<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords."+h[e+p]+" = 0;"})).join("\n");var f="";return f=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+h[t+p]})).join(", "),"\n    float "+i+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+f+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=Fi(),d=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),p=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+$i+"\n    "+Ki+"\n    "+Yi+"\n  "}(l);return t.isPacked?(a=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(w(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=Math.ceil(n[2]/2),o=a*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+a+");\n      int c = imod(index, "+a+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),i=r*Math.ceil(e[e.length-2]/2),a=i,o="",s="b, r, c",u=2;u<e.length-1;u++)a*=e[e.length-u-1],o="\n      int b"+u+" = index / "+a+";\n      index -= b"+u+" * "+a+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,i,a,o}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(l)):(a=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return w(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=Vi(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=Vi(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=Vi(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=Vi(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(p+=Xi),[p,d,o,s,a,u,n].join("\n")}function Gi(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,i=r[0],a=r[1];if(1===i&&1===a)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=e.shapeInfo.texShape,s=o[0],u=o[1],c=Ji(t);return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+s+", "+u+", "+c+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Qi(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=Ji(t);return 1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+i+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+a+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+a+", index + "+o+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape;if(null!=i&&w(t,i)){var a=i[0],o=i[1];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+a+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var s=O(t),u=s.newShape,c=s.keptDims,l=u;if(l.length<t.length){var d=ea(e,l);return"\n      "+Gi(d)+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+ta(["row","col"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+Qi(e)+"\n      }\n    ";var p=i[0],h=i[1],f=Ji(n);return 1===h?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+p+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===p?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+f+";\n    vec2 uv = uvFromFlat("+p+", "+h+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[1]*t[2],a=t[2],o=O(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length){var l=ea(e,c);return"\n        "+Gi(l)+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+ta(["row","col","depth"],u)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+i+", "+a+", 1)));\n        "+Qi(e)+"\n      }\n    ";var d=e.shapeInfo.texShape,p=d[0],h=d[1],f=e.shapeInfo.flatOffset;if(h===i&&null==f)return"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+p+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ";if(h===a&&null==f)return"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+p+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ";var m=Ji(n);return"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+i+" + col * "+a+" + depth + "+m+";\n        vec2 uv = uvFromFlat("+p+", "+h+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[3],a=t[2]*i,o=t[1]*a,s=O(t),u=s.newShape,c=s.keptDims;if(u.length<t.length){var l=ea(e,u);return"\n      "+Gi(l)+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+ta(["row","col","depth","depth2"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+a+", "+i+", 1)));\n        "+Qi(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],f=p[1];if(f===o&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+a+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(f===i&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var m=Ji(n);return"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+a+" +\n          depth * "+i+" + depth2;\n      vec2 uv = uvFromFlat("+h+", "+f+", index + "+m+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],a=t[3]*i,o=t[2]*a,s=t[1]*o,u=O(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var d=ea(e,c);return"\n      "+Gi(d)+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+ta(["row","col","depth","depth2","depth3"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+a+", "+i+")) +\n          depth3;\n        "+Qi(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,f=h[0],m=h[1];if(m===s&&null==p)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+a+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(m===i&&null==p)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var v=Ji(n);return"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+a+" +\n          depth2 * "+i+" + depth3 + "+v+";\n      vec2 uv = uvFromFlat("+f+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=O(t),a=i.newShape,o=i.keptDims;if(a.length<t.length){var s=ea(e,a);return"\n      "+Gi(s)+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+ta(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    "}var u=t[5],c=t[4]*u,l=t[3]*c,d=t[2]*l,p=t[1]*d;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+p+", "+d+", "+l+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+u+", 1)));\n        "+Qi(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,m=f[0],v=f[1];if(v===p&&null==h)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+d+", "+l+", "+c+", "+u+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(v===u&&null==h)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var g=Ji(n);return"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+p+" + col * "+d+" + depth * "+l+" +\n          depth2 * "+c+" + depth3 * "+u+" + depth4 + "+g+";\n      vec2 uv = uvFromFlat("+m+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function Hi(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Fi(),"\n    vec4 "+n+"() {\n      return "+r.texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=Fi();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+a.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,a=i[0],o=i[1],s=Fi();if(null!=i&&w(t,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+a+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(t[1]/2);return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+c+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===t[0]){var o=t.slice(1),s=ea(e,o);return"\n        "+Hi(s)+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+ta(["b","row","col"],[1,2])+");\n        }\n      "}var u=a[0],c=a[1],l=Math.ceil(t[2]/2),d=l*Math.ceil(t[1]/2),p=Fi();return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+d+", "+l+", b, row, col);\n      return "+p.texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),d="int b, int row, int col",p="b * "+l+" + (row / 2) * "+c+" + (col / 2)",h=2;h<n-1;h++)d="int b"+h+", "+d,l*=t[n-h-1],p="b"+h+" * "+l+" + "+p;var f=Fi();return"\n    vec4 "+i+"("+d+") {\n      int index = "+p+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+f.texture2D+"("+r+", uv);\n    }\n  "}(e)}}var $i="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ki="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Yi="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Xi="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Ji(e){return"offset"+e}function Qi(e){var t=e.name,n=_(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function Zi(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function ea(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function ta(e,t){return t.map((function(t){return e[t]})).join(", ")}var na=function(){return function(e,t,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,v(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=Zi(c),d=Ui("coords",c);if(1===a){var p=Zi(s=c+1);o="\n        "+p+" sourceLocR = "+p+"("+d.join()+", 0);\n        ++"+d[c-1]+";\n        "+p+" sourceLocG = "+p+"("+d.join()+", 0);\n        ++"+d[c-2]+";\n        "+p+" sourceLocA = "+p+"("+d.join()+", 0);\n        --"+d[c-1]+";\n        "+p+" sourceLocB = "+p+"("+d.join()+", 0);\n        --"+d[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+d[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+d[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+d[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+d[c-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),f="."+h[s-1],m=h.map((function(e){return"int "+e})),g=Ui("sourceLocR",s-1).concat("inIdx.r"),y=Ui("sourceLocG",s-1).concat("inIdx.g"),b=Ui("sourceLocB",s-1).concat("inIdx.b"),_=Ui("sourceLocA",s-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+"),\n                             getBestIndicesAChannel("+_.join()+")));",T="vec4(\n            getAChannel("+g.join()+"),\n            hasNextCol ? getAChannel("+y.join()+") : 0.,\n            hasNextRow ? getAChannel("+b.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+_.join()+") : 0.)",C=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+h.join()+"),\n                                          vec2("+h.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+h.join()+"),\n                               vec2("+h.slice(-2).join()+"));\n      }\n      "+C+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+d[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+d[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+f+", sourceLocG"+f+",\n          sourceLocB"+f+", sourceLocA"+f+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+T+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+x+"\n          vec4 candidate = "+T+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+w+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "}}(),ra=function(){return function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,d=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+d+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+a+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),ia=function(){return function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=l-1-e.padInfo.front,f=d-1-e.padInfo.top,m=p-1-e.padInfo.left,v=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+h+", "+f+", "+m+");\n      const float avgMultiplier = float("+v+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+i+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+a+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+p+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),aa=function(){return function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],ui(e,t),ui(e,n);var o="0.0";null!=r&&(ui(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=i&&(ui(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+a+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "}}(),oa=function(){return function(e,t,n,r,i,a){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],ui(e,t),ui(e,n);var o="vec4(0.0)";null!=r&&(ui(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(ui(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+a+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "}}(),sa="return areal * breal - aimag * bimag;",ua="return areal * bimag + aimag * breal;",ca=function(){return function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ui(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "}}(),la="return a + b;",da="return a - b;",pa="return a * b;",ha="return (a < 0.) ? b * a : a;",fa=function(){return function(e,t,n){this.variableNames=["A","B"],this.outputShape=ui(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "}}(),ma="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",va=function(){return function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=ui(t,n);var i=this.outputShape.length,a="";if(r)if(0===i||1===_(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(a="\n          "+Zi(i)+" coords = getOutputCoords();\n        ",1===i)a+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=Ui("coords",i);a+="\n            bool nextRowOutOfBounds =\n              ("+o[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+o[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+a+"\n\n        setOutput(result);\n      }\n    "}}(),ga=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),ya=function(){function e(e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),ba=function(){return function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}(),_a=function(){return function(e){this.outputShape=[],this.outputShape=_n(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "}}(),wa=function(){return function(e,t){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=_n(e,t);var n=this.outputShape,r=n.length,i=Zi(r),a=Ui("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=o[t],l=o.slice(-2),d=o.join(),p="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var h=s[u-1];p+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+xa(o,c,h)+"),\n            vec2("+xa(l,c,h)+"));\n        }"}var f=s.length,m=s[s.length-1];p+="\n        return getChannel(\n          getT"+f+"("+xa(o,c,m)+"),\n          vec2("+xa(l,c,m)+"));",this.userCode="\n      float getValue("+o.map((function(e){return"int "+e}))+") {\n        "+p+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+a+"), 0., 0., 0.);\n\n        "+a[r-1]+" = "+a[r-1]+" + 1;\n        if ("+a[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+a+");\n        }\n\n        "+a[r-2]+" = "+a[r-2]+" + 1;\n        if ("+a[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+a+");\n        }\n\n        "+a[r-1]+" = "+a[r-1]+" - 1;\n        if ("+a[r-2]+" < "+n[r-2]+" &&\n            "+a[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+a+");\n        }\n        setOutput(result);\n      }\n    "}}();function xa(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var Ta=function(){return function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+a+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Ca=function(){return function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,c=a?2:3,l=a?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+a+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Sa=function(){return function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+i+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+a+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Ea=function(){return function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+i+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+a+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),ka=function(){return function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+a+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Ra=function(){return function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Oa=function(){return function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,d=e.filterWidth,p=4*Math.floor(e.inChannels/4),h=e.inChannels%4,f="channelsLast"===e.dataFormat,m=f?1:2,v=f?2:3,g=f?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var _=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+f+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===h)+") {\n\n              if ("+f+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+p+") *\n                    getW(wR, wC, "+p+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+p+", xR, xC) *\n                    getW(wR, wC, "+p+", d2);\n              }\n\n            } else if ("+(2===h)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2)\n              );\n\n              if ("+f+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===h)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2),\n                getW(wR, wC, "+p+" + 2, d2)\n              );\n\n              if ("+f+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1),\n                  getX(batch, xR, xC, "+p+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC),\n                  getX(batch, "+p+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+_+"\n        "+b+"\n        setOutput(result);\n      }\n    "}}(),Aa=function(){return function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,d=e.filterHeight,p=e.filterWidth,h=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+a+", "+o+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+p+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===f)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+h+") *\n                  getW(wF, wR, wC, "+h+", d2);\n              } else if ("+(2===f)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===f)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+h+"),\n                  getX(batch, xF, xR, xC, "+h+" + 1),\n                  getX(batch, xF, xR, xC, "+h+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+h+", d2),\n                  getW(wF, wR, wC, "+h+" + 1, d2),\n                  getW(wF, wR, wC, "+h+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Ia=function(){return function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,h=e.filterWidth,f=e.outChannels/e.inChannels,m="",v="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",v="result = activation(result);");var g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+f+";\n        int q = d2 - d1 * "+f+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+p+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+a+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+v+"\n        setOutput(result);\n      }\n    "}}(),Na=function(){return function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,h=e.filterWidth,m=h,v="int xR; int xC; int xCOffset;",g=0;g<p;g++)for(var y=0;y<h;y++)v+="\n          vec4 xTexelR"+g+"C"+2*y+" = vec4(0.);\n          vec4 wR"+g+"C"+y+" = vec4(0.);\n          vec4 xR"+g+"C"+y+" = vec4(0.);";for(g=0;g<p;g++)for(var b=0;b<m;b++){if(v+="\n          xR = xRCorner + "+g*l+";\n          xC = xCCorner + "+(y=2*b)*d+";\n        ",1===c){if(y<h&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+g+"C"+y+" = vec4(previous.zw, xTexelR"+g+"C"+y+".xy);\n                } else {\n                  xR"+g+"C"+y+" = vec4(0, 0, xTexelR"+g+"C"+y+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = xTexelR"+g+"C"+y+";\n              ",y+1<h)){var _=s%2==0?f(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+_+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+a+") {\n                      xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+g+"C"+y+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+g+"C"+(y+1)+" = vec4(\n                    xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+_+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+g+"C"+(y+1)+" = xTexelR"+g+"C"+(y+2)+";\n                "}}else y<h&&(v+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+a+") {\n                  xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+g+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = vec4(\n                  xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".zw);\n              ",y+1<h&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+a+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+g+"C"+(y+1)+" = vec4(xTexelR"+g+"C"+(y+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = vec4(\n                  xTexelR"+g+"C"+y+".xy, xTexelR"+g+"C"+(y+2)+".xy);\n              ",y+1<h&&(v+="\n                  xR"+g+"C"+(y+1)+" = vec4(\n                    xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".zw);\n                ")),v+="}");y<h&&(v+="\n            vec4 wTexelR"+g+"C"+y+" = getW("+g+", "+y+", d1, q);\n            wR"+g+"C"+y+" = vec4(wTexelR"+g+"C"+y+".xz, wTexelR"+g+"C"+y+".xz);\n          ",y+1<h&&(v+="\n              vec4 wTexelR"+g+"C"+(y+1)+" = getW("+g+", "+(y+1)+", d1, q);\n              wR"+g+"C"+(y+1)+" =\n                vec4(wTexelR"+g+"C"+(y+1)+".xz, wTexelR"+g+"C"+(y+1)+".xz);"))}for(g=0;g<p;g++)for(y=0;y<h;y++)v+="dotProd += xR"+g+"C"+y+" * wR"+g+"C"+y+";";var w="",x="";n&&(w=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",x="result = activation(result);");var T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+w+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+T+"\n        "+x+"\n        setOutput(result);\n      }\n    "}}(),Da=function(){return function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],c=t[0],l=n[0],d=n[1];this.outputShape=[c,l,d,u];var p="bilinear"===r?1:0,h=[o-1+".0",s-1+".0"],f=h[0],m=h[1],v=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+f+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+f],g=v[0],y=v[1],b=v[2],_=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=_[0],x=_[1],T=_[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+a+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+x+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+f+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+T+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+p+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "}}(),Pa=function(){return function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Zi(r)+" coords = getOutputCoords();\n        int end = "+Ma(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+a+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+Ma(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "}}();function Ma(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var La=function(){return function(e,t){this.variableNames=["A"];var n=Fi();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Vi(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "}}(),ja=function(){return function(e,t){this.variableNames=["A"],this.usesPackedTextures=!0;var n=Fi();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Vi(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "}}(),Ba=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Ua=function(){return function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}(),Fa=function(){return function(e){this.variableNames=["A"];var t=Fi();this.outputShape=e,this.userCode="\n      "+Wi+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "}}(),Va=function(){return function(e){this.variableNames=["A"],this.usesPackedTextures=!0;var t=Fi();this.outputShape=e,this.userCode="\n      "+Wi+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "}}(),qa=function(){return function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Fi(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+qi(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+a+";\n        int c = imod(flatIndex, "+a+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "}}(),Wa=function(){return function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Fi(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+a+";\n              c = imod(flatIndex, "+a+");\n              uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+qi(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "}}(),za="return real * expR - imag * expI;",Ga="return real * expI + imag * expR;",Ha=function(){return function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+a+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "}}(),$a=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),Ka=function(){return function(e){this.variableNames=["A"];var t=Fi(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "}}(),Ya=function(){return function(e){this.variableNames=["A"];var t=Fi(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "}}(),Xa=function(){return function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Zi(this.rank),a=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],a=0;a<e.length;a++)a===t?i.push("int(getIndices("+r[a]+"))"):i.push(""+r[a]);return i.join()}(e,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "}}(),Ja=function(){return function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Zi(t.length),i=Zi(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+a+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "}}();function Qa(e,t){var n=Fi();return Je(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Za(e,t){return at(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function eo(e,t){return ot(e,t,new Uint16Array([0,1,2,2,1,3]))}function to(e,t,n,r,i,a,o){ut(n,r);var s=st(e,t),u=e.TEXTURE_2D;return Ge(e,t,(function(){return e.bindTexture(u,s)})),Ge(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),Ge(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),Ge(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),Ge(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),Ge(e,t,(function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)})),Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function no(e,t,n,r,i){var a=Ve(n,r);return to(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function ro(e,t,n,r,i){var a=Ve(n,r);return to(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function io(e,t,n,r,i){var a=Ve(n,r);return to(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function ao(e,t,n,r,i){var a=We(n,r);return to(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function oo(e,t,n,r,i){var a=We(n,r);return to(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function so(e,t,n,r){return Ge(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),lt(e,t,n,"clipSpacePos",r,3,20,0)&&lt(e,t,n,"uv",r,2,20,12)}function uo(e,t,n,r,i,a,o){var s,u,c;Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,c=o.internalFormatPackedFloat),s.set(a),Ge(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,i,0,e.RGBA,u,s)})),Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function co(e,t,n,r){Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Ge(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):Ge(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),Ge(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function lo(e,t,n,r,i){var a=e.createBuffer();Ge(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var o=16*n*r;return Ge(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)})),Ge(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),Ge(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}function po(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function ho(e,t,n,r,i){var a=Ve(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Ge(e,t,(function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function fo(e,t,n,r,i,a,o,s){var u=e,c=new Float32Array(function(e,t){var n=We(e,t);return n[0]*n[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function mo(e,t,n,r){var i=new Float32Array(n*r*4);return Ge(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)})),i}var vo=Object.freeze({createVertexShader:Qa,createVertexBuffer:Za,createIndexBuffer:eo,createFloat32MatrixTexture:no,createFloat16MatrixTexture:ro,createUnsignedBytesMatrixTexture:io,createPackedMatrixTexture:ao,createFloat16PackedMatrixTexture:oo,bindVertexProgramAttributeStreams:so,uploadDenseMatrixToTexture:uo,uploadPixelDataToTexture:co,createBufferFromOutputTexture:lo,downloadFloat32MatrixFromBuffer:po,downloadByteEncodedFloatMatrixFromOutputTexture:ho,downloadPackedMatrixFromBuffer:fo,downloadMatrixFromPackedOutputTexture:mo}),go=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=l().getNumber("WEBGL_VERSION");if(null!=e?(this.gl=e,Be(t,e)):this.gl=Ue(t),1===l().getNumber("WEBGL_VERSION"))this.textureFloatExtension=Xe(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=Xe(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(At(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!At(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Za(this.gl,this.debug),this.indexBuffer=eo(this.gl,this.debug),this.framebuffer=ct(this.gl,this.debug),this.textureConfig=ze(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return l().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Ge(t,this.debug,(function(){return t.finish()})),Ge(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Ge(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Ge(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Ge(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Ge(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),no(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),ro(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),io(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),co(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),uo(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),oo(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),ao(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(vt(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Ge(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return ho(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,i,a){return fo(this.gl,e,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return po(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=lo(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(l().getBool("WEBGL_FENCE_API_ENABLED")){var i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=i.clientWaitSync(a,0,0);return e===i.ALREADY_SIGNALED||e===i.CONDITION_SATISFIED},t=a}else l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return mo(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=Qe(t,this.debug,e),r=Qa(t,this.debug),i=nt(t,this.debug);return Ge(t,this.debug,(function(){return t.attachShader(i,r)})),Ge(t,this.debug,(function(){return t.attachShader(i,n)})),rt(t,this.debug,i),this.debug&&it(t,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=so(t,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&Ge(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&it(this.gl,this.debug,this.program),Ge(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?pt(this.gl,this.debug,e,t):ht(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),Ge(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),ft(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=We(t,n),i=r[0],a=r[1];this.setOutputMatrixTextureDriver(e,i,a)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&it(this.gl,this.debug,this.program),gt(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Ge(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),Ge(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Xe(this.gl,this.debug,2===l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(2!==l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(n){switch(n.label){case 0:return[4,E((function(){return t.disposed||t.isQueryAvailable(e,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length;++t){var n=e[t]();if(!n)break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||E((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),mt(this.gl,this.debug,e,this.framebuffer),this.debug&&gt(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(mt(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&gt(this.gl)):vt(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;mt(r,this.debug,e,this.framebuffer),this.debug&&gt(r),this.outputTexture=e,Ge(r,this.debug,(function(){return r.viewport(0,0,t,n)})),Ge(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var i=this;this.throwIfDisposed(),Ge(this.gl,this.debug,(function(){return i.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function yo(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,i=t[n],a=i.shape;if(!w(r,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+a+" must match");if(!e.isUniform||!i.isUniform){var o=e.texShape,s=i.isUniform?null:i.texData.texShape;if(!w(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var bo=function(){return function(e,t,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,d=n.dataFormat,p=s.left,h=s.top,f=i*r,m=Fi(),v="channelsLast"===d,g=v?0:1,y=v?1:2,b="",_=0;_<=1;_++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+_+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+h+";\n            d0 = offsetY + "+l+" * (pos / "+f+");\n\n            if(d0 < "+t[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+a+". - "+p+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+f+".) / "+i+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+i+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*_+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*_+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "}}(),_o=function(){return function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+a+";\n        setOutput(val);\n      }\n    "}}(),wo=function(){return function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "}}(),xo=function(){return function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+a+";\n        setOutput(result);\n      }\n    "}}(),To=function(){return function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+i+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+a+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+a+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),Co=function(){return function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,d=u-1-e.padInfo.top,p=c-1-e.padInfo.left,h=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+d+", "+p+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+i+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+h+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}}(),So=function(){return function(e,t,n,r,i,a,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",f="";a&&(h=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+a+"\n        }":"vec4 activation(vec4 x) {\n          "+a+"\n        }",f="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+h+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+p[0]+");\n          result += ("+d[1]+" * "+p[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "}}(),Eo=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),ko=function(){return function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "}}(),Ro=function(){return function(e){this.variableNames=["A"],this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Ui("rc",t),r=Zi(t),i=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",i=e-2;i<e;i++)r+=n[i]+" >= "+t[i],i<e-1&&(r+="||");return r}(t,e,n),a=function(e,t,n,r){if(1===e)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),o=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var a=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),o=2;o<e;o++)a=t[t.length-1-o]+","+a;n.push(a)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+a+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}}}(),Oo=function(){return function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,i=Zi(r),a=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+a+");\n      "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+a+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "}}(),Ao=function(){return function(e,t,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,i=Zi(r),a=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=Ui("rc",r),u=Ui("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",d=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",f=0,m=1===r?2:4;f<m;f++)h+="\n        "+d[f]+"\n        if ("+p+") {\n          result["+f+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+f+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";h+=1===r?"} ":"}}",this.userCode="\n      const "+i+" start = "+i+"("+a+");\n      const "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+h+"\n        setOutput(result);\n      }\n    "}}(),Io=function(){return function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var p="avg"===t,h="0.0";if(p||(h="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+a+");\n        const ivec2 pads = ivec2("+l+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+o+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var f=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(f="avgValue / count");var m=4*Math.floor(r/4),v=r%4,g="\n      if ("+p+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+a+");\n      const ivec2 pads = ivec2("+l+", "+d+");\n      const float initializationValue = "+h+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+h+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+o+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+f+");\n      }\n    "}}}(),No=function(){return function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var v="avg"===t,g="0.0";if(v||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+a+", "+o+");\n        const ivec3 pads = ivec3("+h+", "+f+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+p+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+d+" * "+p+" +\n                      wR * "+p+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),_=r%4,w="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+a+", "+o+");\n      const ivec3 pads = ivec3("+h+", "+f+", "+m+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===_)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}}}(),Do=function(){return function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,d="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===t?(o="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===t&&(o="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+h+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===l)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+u+");\n      }\n    "}}(),Po=function(){return function(e,t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Vi(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+qi(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "}}(),Mo=function(){return function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?i-1:i,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],p=c[1]/l[1],h=1/d,f=1/p,m=2*Math.ceil(h)+2,v=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(a-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "}}(),Lo=function(){return function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}}(),jo=function(){return function(e,t,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+a+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "}}(),Bo=function(){return function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?i-1:i,n&&u>1?a-1:a],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],p=c[1]/l[1],h=1/d,f=1/p,m=2*Math.ceil(h)+2,v=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+h+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "}}(),Uo=function(){return function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "}}(),Fo=function(){return function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=Zi(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "}}(),Vo=function(){return function(e,t){this.variableNames=["x"],this.usesPackedTextures=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=Ui("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Zi(n);function s(n){var r=e.map((function(r,i){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+a+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "}}(),qo=function(){return function(e,t,n,r,i,a,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Zi(i.length),u=Zi(a.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",d="";1===r?d="i":2===r&&(d="i, coords[1]");var p="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+h+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+p+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "}}(),Wo=function(){return function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var d="";i%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+a+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+a+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "}}(),zo=function(){return function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var c=Zi(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "}}(),Go=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=Zi(this.rank),r="uniform int start["+this.rank+"];",i=function(e){if(1===e)return"sourceLoc";if(e<=6)return Ho.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+Ho[t]+" = start["+t+"] + coords."+Ho[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+i+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Ho=["x","y","z","w","u","v"],$o=function(){function e(e){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=e,this.rank=e.length;var t=Zi(this.rank),n=Ui("coords",this.rank),r=Ui("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",a="getChannel(getSource("+r.join()+"), "+i+")",o="\n      result.x = "+a+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+a+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+a+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+a+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Ko=function(){return function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Zi(n.length),a=Zi(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+e+");\n      "+i+" strides = "+i+"("+t+");\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "}}(),Yo=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,i=Xo(t,n),a=Jo(e,i,n);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[a].shift();return this.usedTextures[a].push(o),o}return this.numUsedTextures++,this.log(),i===Me.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===Me.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===Me.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===Me.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===Me.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var i=Jo(t,Xo(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(e),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],o=a.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function Xo(e,t){if(e===Pe.UPLOAD)return Me.PACKED_2X2_FLOAT32;if(e===Pe.RENDER||null==e)return function(e){return l().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Me.PACKED_2X2_FLOAT32:Me.UNPACKED_FLOAT32:e?Me.PACKED_2X2_FLOAT16:Me.UNPACKED_FLOAT16}(t);if(e===Pe.DOWNLOAD||e===Pe.PIXELS)return Me.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Jo(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var Qo=function(){return function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Zi(this.rank),a=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<e.length;i++)r.push("imod("+n[i]+", "+e[i]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "}}(),Zo=function(){return function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Zi(this.rank),a=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),i=0;i<e.length;i++)r[e[i]]=n[i];return r.join()}(t);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+a+"));\n    }\n    "}}(),es=function(){return function(e,t){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Zi(this.rank),a=Bi("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+a[this.rank-1]+";\n      if(++"+a[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }  \n      setOutput(result);\n    }\n    "}}(),ts=1.7580993408473768,ns=1.0507009873554805,rs=function(){return function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}}(),is="if (isnan(x)) return x;",as="return x;",os="return abs(x);",ss=is+"\n  return (x < 0.0) ? 0.0 : x;\n",us=is+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",cs="return (x >= 0.0) ? x : (exp(x) - 1.0);",ls="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+ts+";\n  float scale = "+ns+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",ds="return -x;",ps="return ceil(x);",hs="return floor(x);",fs="return exp(x);",ms="return exp(x) - 1.0;",vs=is+"\n  return sin(x);\n",gs=is+"\n  return cos(x);\n",ys=is+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",bs=is+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",_s=is+"\n  return atan(x);\n",ws=is+"return log(x + sqrt(x * x + 1.0));",xs=is+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Ts=is+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Cs="return x;",Ss="return x;",Es="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ks="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Rs="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Os=function(){return function(e,t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "}}(),As=function(){return function(e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=e;var t=e.length,n=Ui("rc",t),r=Zi(t),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "}}(),Is={};function Ns(e,t){if(void 0===t&&(t=!1),"linear"===e)return t?Ss:as;if("relu"===e)return t?Es:ss;if("elu"===e)return t?Rs:cs;if("relu6"===e)return t?ks:us;if("prelu"===e)return t?ma:ha;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var Ds=600,Ps=function(){function e(e){if(this.gpgpu=e,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!l().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var t=Ue(l().getNumber("WEBGL_VERSION"));this.binaryCache=((n=l().getNumber("WEBGL_VERSION"))in Is||(Is[n]={}),Is[n]),this.gpgpu=new go(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=e.gl.canvas;var n;this.textureManager=new Yo(this.gpgpu),this.numMBBeforeWarning=null==l().global.screen?1024:l().global.screen.height*l().global.screen.width*window.devicePixelRatio*Ds/1024/1024,this.texData=new ii(this,Ie)}return e.prototype.register=function(e,t,n){if(this.texData.has(e))throw new Error("Data buffer is already registered");this.texData.set(e,{shape:t,dtype:n})},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n="undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement,r=e.data instanceof Uint8Array,i="undefined"!=typeof ImageData&&e instanceof ImageData,a="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement,o="undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,s=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],u=s[0],c=s[1],d=[c,u],p=[c,u,t];if(!(n||r||i||a||o))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);(o||a)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=Fe(l().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=u,this.fromPixels2DContext.canvas.height=c,this.fromPixels2DContext.drawImage(e,0,0,u,c),e=this.fromPixels2DContext.canvas);var h,f,m=this.makeTensorHandle(d,"int32");if(this.texData.get(m.dataId).usage=Pe.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(m.dataId),e),l().getBool("WEBGL_PACK")){h=new Ya(p);var v=this.makePackedTensor(h.outputShape,m.dtype);f=this.compileAndRun(h,[m],v)}else h=new Ka(p),f=this.compileAndRun(h,[m]);return this.disposeData(m.dataId),f},e.prototype.makeTensorHandle=function(e,t){var n={};return this.register(n,e,t),{dataId:n,shape:e,dtype:t}},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendWebGL.write(): values can not be null");if(l().getBool("DEBUG"))for(var n=0;n<t.length;n++){var r=t[n];if(!Ke(r)){if(l().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+r+" cannot be represented on this device.")}}var i=this.texData.get(e);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(e),i.usage=Pe.UPLOAD,i.values=t},e.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,i=t.complexTensors,a=t.slice,o=t.shape,s=t.isPacked;if(null!=a){var u=void 0;u=s?new Os(o,Cs):new rs(o,Cs);var c=this.compileAndRun(u,[{dataId:e,shape:o,dtype:r}]),l=this.readSync(c.dataId);return c.dispose(),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var d,p,h=null!=this.activeTimers;return h&&(d=Y()),p="complex64"===r?Si(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(e),h&&(this.downloadWaitMs+=Y()-d),this.convertAndCacheOnCPU(e,p)},e.prototype.read=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i,a,o,s,c,d,p,h,f,m,v,g,y,b,w,x,T,C,S;return u(this,(function(u){switch(u.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,i=n.shape,a=n.slice,o=n.dtype,s=n.complexTensors,c=n.isPacked,null!=a)return d=void 0,d=c?new Os(i,Cs):new rs(i,Cs),p=this.compileAndRun(d,[{dataId:e,shape:i,dtype:o}]),h=this.read(p.dataId),p.dispose(),[2,h];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!l().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===l().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return f=null,"complex64"!==o&&l().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(e),v=this.texData.get(m.dataId),f=(S=this.gpgpu).createBufferFromTexture.apply(S,[v.texture].concat(qe(i)))),this.pendingRead.set(e,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:u.sent(),u.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=u.sent(),b=y[0],w=y[1],g=Si(b,w),[3,5];case 4:null==f?g=this.getValuesFromTexture(e):(x=_(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(f,x)),u.label=5;case 5:return null!=m&&this.disposeData(m.dataId),T=this.convertAndCacheOnCPU(e,g),C=this.pendingRead.get(e),this.pendingRead.delete(e),C.forEach((function(e){return e(T)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)),[2,T]}}))}))},e.prototype.getValuesFromTexture=function(e){var t,n=this,r=this.texData.get(e),i=r.shape,a=r.dtype,o=r.isPacked,s=_(i);if(l().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u=this.decode(e),c=this.texData.get(u.dataId),d=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[c.texture].concat(qe(i))).subarray(0,s);return this.disposeData(u.dataId),d}var p=l().getBool("WEBGL_PACK")&&!0===o,h=p?Tt(i):i,f=this.makeTensorHandle(h,"float32");f.size=_(i),this.texData.get(f.dataId).usage=Pe.DOWNLOAD;var m=Ht((function(){var t=p?new Va(h):new Fa(h);return n.compileAndRun(t,[{shape:h,dtype:a,dataId:e}],f,null)})),v=this.texData.get(m.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,s);return this.disposeData(f.dataId),g},e.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),i=b(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),a=b(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return o=u.sent(),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:m(o),getExtraProfileInfo:function(){return o.map((function(e,t){return{name:a[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,s]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:Y(),endMs:null}},e.prototype.endTimer=function(e){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),e):(e.endMs=Y(),e)},e.prototype.getQueryTime=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return l().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},e.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e))if(this.pendingRead.has(e))this.pendingDisposal.add(e);else if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}},e.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,i=t.texShape,a=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},e.prototype.getDataInfo=function(e){return this.texData.get(e)},e.prototype.getCPUBackend=function(){return l().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Ie.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&e.size<t}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(e,t){var n=this.makeOutputArray(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Ie.keep(e.clone()),imag:Ie.keep(t.clone())},n},e.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},e.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},e.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===_(n))return Sn([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,i=$r(e.shape,t,n);if(r||!i){var a=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $o(n):new Go(n),o=a.getCustomSetupFunc(t);return this.compileAndRun(a,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},e.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),i=he.make(n,{},e.dtype,this),a=this.texData.get(i.dataId);Object.assign(a,r),a.shape=n,a.dtype=e.dtype;var o=Kr(t,e.strides);r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,s+1),i},e.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var i=zr(t,n,r);if(i.some((function(e){return 0===e})))return Sn([],i);var a=new Ko(t,r,i);return this.compileAndRun(a,[e])},e.prototype.reverse=function(e,t){var n=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vo(e.shape,t):new Fo(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return Tn(e)})),r=e.map((function(e){return Cn(e)}));return xn(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>l().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(e.length/2),a=this.concat(e.slice(0,i),t),o=this.concat(e.slice(i),t);return this.concat([a,o],t)}if(l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new wa(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=_n(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,_(e.shape.slice(t)))})),d=new _a(c.map((function(e){return e.shape})));return this.compileAndRun(d,c).reshape(u)},e.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ds,e.dtype);var t=new rs(e.shape,ds);return this.compileAndRun(t,[e])},e.prototype.batchMatMul=function(e,t,n,r){var i=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===i||1===a)&&o>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===a?e:e.as3D(s,o,1),c=1===a?2:1,l=1===a?t.as3D(s,1,o):t;return this.multiply(u,l).sum(c,!0)}var d=xe(e.dtype,t.dtype),p=new So(e.shape,[s,i,a],n,r),h=this.makePackedTensor(p.outputShape,d);return this.compileAndRun(p,[e,t],h)},e.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,i=e.transposeB,a=e.bias,o=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=i?n.shape[1]:n.shape[2],l=t.shape[0],d=xe(t.dtype,n.dtype),p=null!=a,h=null!=s,f=o?Ns(o,!0):null,m=new So(t.shape,[l,u,c],r,i,p,f,h),v=this.makePackedTensor(m.outputShape,d),g=[t,n];return a&&g.push(a),s&&g.push(s),this.compileAndRun(m,g,v)},e.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),i=new ca(sa,e.shape,t.shape),a=new ca(ua,e.shape,t.shape),o=[this.makeComplexComponentTensorHandle(e,n.complexTensors.real),this.makeComplexComponentTensorHandle(e,n.complexTensors.imag),this.makeComplexComponentTensorHandle(t,r.complexTensors.real),this.makeComplexComponentTensorHandle(t,r.complexTensors.imag)],s=this.compileAndRun(i,o),u=this.compileAndRun(a,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,pa,e.dtype);var d=new fa(pa,e.shape,t.shape),p=this.makeOutputArray(d.outputShape,e.dtype);return this.compileAndRun(d,[e,t],p)},e.prototype.batchNormalization=function(e,t,n,r,i,a){var o=[e,t,n],s=null;null!=a&&(s=a.shape,o.push(a));var u=null;if(null!=i&&(u=i.shape,o.push(i)),l().getBool("WEBGL_PACK_NORMALIZATION")){var c=new oa(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,o)}var d=new aa(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(d,o)},e.prototype.localResponseNormalization4D=function(e,t,n,r,i){var a=l().getBool("WEBGL_PACK_NORMALIZATION")?new xo(e.shape,t,n,r,i):new _o(e.shape,t,n,r,i);return this.compileAndRun(a,[e])},e.prototype.LRNGrad=function(e,t,n,r,i,a,o){var s=new wo(t.shape,r,i,a,o);return this.compileAndRun(s,[t,n,e])},e.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return Q(e)}));return Ni(ar(e.shape,e.dtype,n),t)}var r=new Qo(e.shape,t);return this.compileAndRun(r,[e])},e.prototype.pad=function(e,t,n){var r=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ao(e.shape,t,n):new Oo(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=l().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new es(e.shape,t):new Zo(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new Xa(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},e.prototype.batchToSpaceND=function(e,t,n){v(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),i=Dr(e.shape,t,r),a=Pr(i.length,t.length),o=Mr(e.shape,t,r),s=Lr(n,t.length),u=jr(o,n,t.length);return e.reshape(i).transpose(a).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(e,t,n){v(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),i=[[0,0]];i.push.apply(i,n);for(var a=1+t.length;a<e.shape.length;++a)i.push([0,0]);var o=e.pad(i),s=Dr(o.shape,t,r,!1),u=Pr(s.length,t.length,!1),c=Mr(o.shape,t,r,!1);return o.reshape(s).transpose(u).reshape(c)},e.prototype.reduce=function(e,t,n){var r=e.shape[0],i=e.shape[1],a=Fr(i),o=new Do({windowSize:a,inSize:i,batchSize:r},t),s=o.outputShape,u=s[0],c=s[1],l=this.makeOutputArray([u,c],n);return this.compileAndRun(o,[e],l),1===l.shape[1]?l:this.reduce(l,t,n)},e.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],i=e.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var a=Fr(i),o=new ji({windowSize:a,inSize:i,batchSize:r},t,null==n),s=o.outputShape,u=s[0],c=s[1],l=this.makeOutputArray([u,c],"int32"),d=[e];return null!=n&&d.push(n),this.compileAndRun(o,d,l),1===l.shape[1]?l:this.argReduce(e,t,l)},e.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,i=Fr(r[r.length-1]),a=new na(r,i,t,null==n),o=this.makePackedTensor(a.outputShape,"int32"),s=null==n?[e]:[e,n];return this.compileAndRun(a,s,o),o.rank===e.rank?this.argReducePacked(e,t,o):o},e.prototype.sum=function(e,t){mn("sum",t,e.rank);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i),o=Te(e.dtype);return this.reduce(a,"sum",o).reshape(r)},e.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i),o=Te(e.dtype);return this.reduce(a,"prod",o).reshape(r)},e.prototype.unsortedSegmentSum=function(e,t,n){var r=0,i=vn([r],e.rank),a=e;null!=i&&(a=e.transpose(i),r=yn(1,e.rank)[0]);var o=function(e,t,n){for(var r=[],i=e.length,a=0;a<i;a++)a!==t?r.push(e[a]):r.push(n);return r}(a.shape,r,n),s=_([a.shape[r]]),u=a.as2D(-1,s),c=Te(e.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",t,c,n).reshape(o);return null!=i&&(l=l.transpose(gn(i))),l},e.prototype.segOpCompute=function(e,t,n,r,i){var a=e.shape[0],o=e.shape[1],s=function(e,t){var n,r=!1;for(e<=Ur?(n=e,r=!0):n=W(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=W(e,n+1);return n}(o,i),u=new Wo({windowSize:s,inSize:o,batchSize:a,numSegments:i},t),c=u.outputShape,l=c[0],d=c[1],p=this.makeOutputArray([l,d],r);return this.compileAndRun(u,[e,n],p),p.shape[1]===i?p:(n=Bn(0,i).tile([o/s]),this.segOpCompute(p,t,n,r,i))},e.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(mn("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!l().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var i=hn(e.shape,r),a=i[0],o=_(i[1]),s=e.as2D(-1,o);return this.argReduce(s,n).reshape(a)}return this.argReducePacked(e,n)},e.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},e.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},e.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var i=new Pa(e.shape,n,r);return this.compileAndRun(i,[e])},e.prototype.equal=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new fa("return float(a == b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.notEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new fa("return float(a != b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new fa("return float(a < b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.lessEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new fa("return float(a <= b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new fa("return float(a > b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.greaterEqual=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new fa("return float(a >= b);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalNot=function(e){var t=new rs(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},e.prototype.logicalAnd=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new fa("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalOr=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new fa("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[e,t],r)},e.prototype.select=function(e,t,n){var r=new zo(e.rank,t.shape,t.rank),i=this.makeOutputArray(r.outputShape,xe(t.dtype,n.dtype));return this.compileAndRun(r,[e,t,n],i)},e.prototype.where=function(e){on("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Pi(e.shape,t)},e.prototype.topk=function(e,t,n){return Di(e.dataSync(),e.shape,e.dtype,t)},e.prototype.min=function(e,t){mn("min",t,e.rank);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i);return this.reduce(a,"min",a.dtype).reshape(r)},e.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.mod=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fa("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);mn("max",t,e.rank);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i);return this.reduce(a,"max",a.dtype).reshape(r)},e.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.all=function(e,t){mn("all",t,e.rank);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i);return this.reduce(a,"all",a.dtype).reshape(r)},e.prototype.any=function(e,t){mn("any",t,e.rank);var n=hn(e.shape,t),r=n[0],i=_(n[1]),a=e.as2D(-1,i);return this.reduce(a,"any",a.dtype).reshape(r)},e.prototype.squaredDifference=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("return (a - b) * (a - b);",e.shape,t.shape):new fa("return (a - b) * (a - b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.realDivide=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new fa("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e,t],r)},e.prototype.floorDiv=function(e,t){if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new fa("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[e,t],r)},e.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,la);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=xe(e.dtype,t.dtype);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,la,n);var r=new fa(la,e.shape,t.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[e,t],i)},e.prototype.packedUnaryOp=function(e,t,n){var r=new Os(e.shape,t),i=this.makePackedTensor(r.outputShape,n);return this.compileAndRun(r,[e],i)},e.prototype.packedBinaryOp=function(e,t,n,r,i){void 0===i&&(i=!1);var a=new va(n,e.shape,t.shape,i),o=this.makePackedTensor(a.outputShape,r);return this.compileAndRun(a,[e,t],o)},e.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,i=this.texData.get(e.dataId),a=this.texData.get(t.dataId),o=[[i.complexTensors.real,a.complexTensors.real],[i.complexTensors.imag,a.complexTensors.imag]].map((function(i){var a=i[0],o=i[1],s=r.makeComplexComponentTensorHandle(e,a),u=r.makeComplexComponentTensorHandle(t,o),c=new fa(n,e.shape,t.shape),l=r.makeOutputArray(c.outputShape,xe(a.dtype,o.dtype));return r.compileAndRun(c,[s,u],l)})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},e.prototype.makeComplexComponentTensorHandle=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},e.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>l().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var i=e.map((function(e){return e.dtype})).reduce((function(e,t){return xe(e,t)})),a=e.map((function(e){return e.shape})),o=l().getBool("WEBGL_PACK"),s=o?new Li(e[0].shape,a):new Mi(e[0].shape,a),u=o?this.makePackedTensor(s.outputShape,i):this.makeOutputArray(s.outputShape,i);return this.compileAndRun(s,e,u)},e.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,da);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=xe(e.dtype,t.dtype);if(l().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,da,e.dtype);var r=new fa(da,e.shape,t.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[e,t],i)},e.prototype.pow=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new va("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fa("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),i=xe(e.dtype,t.dtype),a=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[e,t],a)},e.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ps,e.dtype);var t=new rs(e.shape,ps);return this.compileAndRun(t,[e])},e.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,hs,e.dtype);var t=new rs(e.shape,hs);return this.compileAndRun(t,[e])},e.prototype.sign=function(e){var t=new rs(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},e.prototype.isNaN=function(e){var t=new rs(e.shape,"return float(isnan(x));"),n=this.makeOutputArray(t.outputShape,"bool");return this.compileAndRun(t,[e],n)},e.prototype.isInf=function(e){var t=new rs(e.shape,"return float(isinf(x));"),n=this.makeOutputArray(t.outputShape,"bool");return this.compileAndRun(t,[e],n)},e.prototype.isFinite=function(e){var t=new rs(e.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(t.outputShape,"bool");return this.compileAndRun(t,[e],n)},e.prototype.round=function(e){var t=new rs(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},e.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,fs,e.dtype);var t=new rs(e.shape,fs);return this.compileAndRun(t,[e])},e.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ms,e.dtype);var t=new rs(e.shape,ms);return this.compileAndRun(t,[e])},e.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new rs(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},e.prototype.log1p=function(e){var t=new rs(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},e.prototype.sqrt=function(e){var t=new rs(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},e.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new rs(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},e.prototype.square=function(e){var t=new rs(e.shape,"return x * x;");return this.compileAndRun(t,[e])},e.prototype.reciprocal=function(e){var t=new rs(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},e.prototype.relu=function(e){var t;return t=l().getBool("WEBGL_PACK")?new Os(e.shape,Es):new rs(e.shape,ss),this.compileAndRun(t,[e])},e.prototype.relu6=function(e){var t;return t=l().getBool("WEBGL_PACK")?new Os(e.shape,ks):new rs(e.shape,us),this.compileAndRun(t,[e])},e.prototype.prelu=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va(ma,e.shape,t.shape):new fa(ha,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.elu=function(e){if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Rs,e.dtype);var t=new rs(e.shape,cs);return this.compileAndRun(t,[e])},e.prototype.eluDer=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new fa("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.selu=function(e){var t=new rs(e.shape,ls);return this.compileAndRun(t,[e])},e.prototype.int=function(e){var t=new rs(e.shape,"return float(int(x));"),n=this.makeOutputArray(t.outputShape,"int32");return this.compileAndRun(t,[e],n)},e.prototype.clip=function(e,t,n){var r,i=(r=l().getBool("WEBGL_PACK_CLIP")?new ya(e.shape):new ga(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,i)},e.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(l().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,os,e.dtype);var t=new rs(e.shape,os);return this.compileAndRun(t,[e])},e.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new ba(e.shape),r=[this.makeComplexComponentTensorHandle(e,t.complexTensors.real),this.makeComplexComponentTensorHandle(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(e){var t=new rs(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},e.prototype.softplus=function(e){var t=new rs(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},e.prototype.sin=function(e){var t=new rs(e.shape,vs);return this.compileAndRun(t,[e])},e.prototype.cos=function(e){var t=new rs(e.shape,gs);return this.compileAndRun(t,[e])},e.prototype.tan=function(e){var t=new rs(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},e.prototype.asin=function(e){var t=new rs(e.shape,ys);return this.compileAndRun(t,[e])},e.prototype.acos=function(e){var t=new rs(e.shape,bs);return this.compileAndRun(t,[e])},e.prototype.atan=function(e){var t=new rs(e.shape,_s);return this.compileAndRun(t,[e])},e.prototype.atan2=function(e,t){var n=l().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new va("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new fa("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.sinh=function(e){var t=new rs(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},e.prototype.cosh=function(e){var t=new rs(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},e.prototype.tanh=function(e){var t=new rs(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},e.prototype.asinh=function(e){var t=new rs(e.shape,ws);return this.compileAndRun(t,[e])},e.prototype.acosh=function(e){var t=new rs(e.shape,xs);return this.compileAndRun(t,[e])},e.prototype.atanh=function(e){var t=new rs(e.shape,Ts);return this.compileAndRun(t,[e])},e.prototype.erf=function(e){var t=new rs(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},e.prototype.step=function(e,t){var n=new rs(e.shape,function(e){return void 0===e&&(e=0),is+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},e.prototype.conv2dByMatMul=function(e,t,n,r,i,a){var o=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,c=o[0]*o[1]*o[2],d=n.outChannels,p="channelsLast"===n.dataFormat,h=(1===c||1===d)&&u>1e3,f=o[2]%2!=0&&!!s.isPacked;if(h||!l().getBool("WEBGL_LAZILY_UNPACK")||!l().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!f){var m=p?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],g=this.reshape(e,[1,m,n.inChannels]),y=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:y,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),n.outShape)}var b=p?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),_=he.make([1,b,n.inChannels],{dataId:e.dataId},e.dtype,this),w=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,v(Et(s.shape,_.shape),(function(){return"packed reshape "+s.shape+" to "+_.shape+" isn't free"}));var x=this.reshape(t,[1,n.inChannels,n.outChannels]),T=this.fusedBatchMatMul({a:_,b:x,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),C=this.texData.get(T.dataId);return v(C.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=w,C.shape=n.outShape,he.make(n.outShape,{dataId:T.dataId},T.dtype,this)},e.prototype.conv2dWithIm2Row=function(e,t,n,r,i,a){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,d="channelsLast"===n.dataFormat,p=o*s*u,h=l*c,f=[p,h],m=e.squeeze([0]),v=t.reshape([1,p,-1]),g=new bo(f,m.shape,n),y=this.compileAndRun(g,[m]).reshape([1,f[0],f[1]]),b=null!=r,_=null!=a,w=i?Ns(i,!0):null,x=new So(y.shape,[1,h,n.outChannels],!0,!1,b,w,_),T=[y,v];r&&T.push(r),_&&T.push(a);var C=this.compileAndRun(x,T);return d?C.reshape([1,l,c,n.outChannels]):C.reshape([1,n.outChannels,l,c])},e.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,a=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,i,a,o);if(l().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,i,a,o);var s=null!=i,u=null!=o,c=a?Ns(a,!1):null,d=new Oa(r,s,c,u),p=[t,n];return i&&p.push(i),o&&p.push(o),this.compileAndRun(d,p)},e.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(l().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Oa(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerInput=function(e,t,n){var r=new Ca(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerFilter=function(e,t,n){var r=new Ta(n);return this.compileAndRun(r,[e,t])},e.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,i=e.convInfo,a=e.bias,o=e.activation,s=e.preluActivationWeights,u=l().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,c=o?Ns(o,u):null,d=[n,r],p=null!=a,h=null!=s;return p&&d.push(a),h&&d.push(s),u?(t=new Na(i,p,c,h),this.compileAndRun(t,d,this.makePackedTensor(i.outShape,n.dtype))):(t=new Ia(i,p,c,h),this.compileAndRun(t,d))},e.prototype.depthwiseConv2D=function(e,t,n){var r;return l().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Na(n),this.compileAndRun(r,[e,t],this.makePackedTensor(n.outShape,e.dtype))):(r=new Ia(n),this.compileAndRun(r,[e,t]))},e.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new Ra(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new ka(n);return this.compileAndRun(r,[e,t])},e.prototype.conv3d=function(e,t,n){var r=new Aa(n);return this.compileAndRun(r,[e,t])},e.prototype.conv3dDerInput=function(e,t,n){var r=new Ea(n);return this.compileAndRun(r,[e,t])},e.prototype.conv3dDerFilter=function(e,t,n){var r=new Sa(n);return this.compileAndRun(r,[e,t])},e.prototype.maxPool=function(e,t){var n=new Io(t,"max",!1),r=this.makeOutputArray(n.outputShape,e.dtype);return this.compileAndRun(n,[e],r)},e.prototype.avgPool=function(e,t){var n=new Io(t,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e],r)},e.prototype.maxPoolBackprop=function(e,t,n,r){var i=new Io(r,"max",!0),a=this.compileAndRun(i,[t]),o=new To(r),s=this.makeOutputArray(o.outputShape,t.dtype),u=this.compileAndRun(o,[e,a],s);return a.dispose(),u},e.prototype.avgPoolBackprop=function(e,t,n){var r=new ra(n),i=this.makeOutputArray(r.outputShape,t.dtype);return this.compileAndRun(r,[e],i)},e.prototype.cast=function(e,t){return wi(e,t,this)},e.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),i=0,a=0;a<e.rank;a++)a!==t&&(r[i++]=e.shape[a]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(a=0;a<u.length;a++)o[t]=a,u[a]=this.slice(e,o,s).reshape(r);return u},e.prototype.avgPool3d=function(e,t){var n=new No(t,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e],r)},e.prototype.avgPool3dBackprop=function(e,t,n){var r=new ia(n),i=this.makeOutputArray(r.outputShape,t.dtype);return this.compileAndRun(r,[e],i)},e.prototype.maxPool3d=function(e,t){var n=new No(t,"max",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[e],r)},e.prototype.maxPool3dBackprop=function(e,t,n,r){var i=new No(r,"max",!0),a=this.compileAndRun(i,[t]),o=new Co(r),s=this.makeOutputArray(o.outputShape,t.dtype),u=this.compileAndRun(o,[e,a],s);return a.dispose(),u},e.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);return!n.isPacked||Et(e.shape,t)||null!==n.texture&&Et(n.shape,t)?xi(e,t):this.packedReshape(e,t)},e.prototype.resizeBilinear=function(e,t,n,r){var i=l().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new jo(e.shape,t,n,r):new Lo(e.shape,t,n,r);return this.compileAndRun(i,[e])},e.prototype.resizeBilinearBackprop=function(e,t,n){var r=new Mo(e,t,n);return this.compileAndRun(r,[e])},e.prototype.resizeNearestNeighbor=function(e,t,n,r){var i=new Uo(e.shape,t,n,r);return this.compileAndRun(i,[e])},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new Bo(e,t,n);return this.compileAndRun(r,[e])},e.prototype.multinomial=function(e,t,n,r){var i=t?e:ni(e),a=i.shape[0],o=i.shape[1],s=new Eo(a,o,n),u=this.makeOutputArray(s.outputShape,"int32"),c=s.getCustomSetupFunc(r);return this.compileAndRun(s,[i],u,c)},e.prototype.oneHot=function(e,t,n,r){var i=new ko(e.size,t,n,r);return this.compileAndRun(i,[e])},e.prototype.diag=function(e){var t=new Ua(e.size);return this.compileAndRun(t,[e])},e.prototype.nonMaxSuppression=function(e,t,n,r,i){return on("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Oi(e.dataSync(),t.dataSync(),n,r,i)},e.prototype.cropAndResize=function(e,t,n,r,i,a){var o=new Da(e.shape,t.shape,r,i,a);return this.compileAndRun(o,[e,t,n])},e.prototype.depthToSpace=function(e,t,n){v(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],i="NHWC"===n?e.shape[1]:e.shape[2],a="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],s=i*t,u=a*t,c=o/(t*t),l=new Ba("NHWC"===n?[r,s,u,c]:[r,c,s,u],t,n);return this.compileAndRun(l,[e])},e.prototype.split=function(e,t,n){return Ii(e,t,n)},e.prototype.scatterND=function(e,t,n){var r=qr(0,e,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=e.reshape([a,i]),d=t.reshape([a,o]);if(0===u)return xi(Sn([]),n);var p=kn(0),h=new qo(a,i,l.rank,d.rank,s,c);return this.compileAndRun(h,[d,l,p]).reshape(n)},e.prototype.sparseToDense=function(e,t,n,r){var i=qr(0,e,n),a=i.sliceRank,o=i.numUpdates,s=i.strides,u=i.outputSize,c=new qo(o,a,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},e.prototype.fft=function(e){return this.fftImpl(e,!1)},e.prototype.ifft=function(e){return this.fftImpl(e,!0)},e.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Ha(za,e.shape,t),i=new Ha(Ga,e.shape,t),a=[this.makeComplexComponentTensorHandle(e,n.complexTensors.real),this.makeComplexComponentTensorHandle(e,n.complexTensors.imag)],o=this.compileAndRun(r,a),s=this.compileAndRun(i,a),u=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),u},e.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],i=Br(e,t),a=i[0],o=i[1],s=i[2],u=i[3],c=t.reshape([o,r]),l=e.reshape([e.size/s,s]),d=new Ja(r,u,[o,s]);return this.compileAndRun(d,[l,c]).reshape(a)},e.prototype.fill=function(e,t,n){if("string"===(n=n||V(t))){var r=I(n,_(e));return r.fill(t),he.make(e,{values:r},n)}var i=new $a(e,t),a=i.getCustomSetupFunc(t),o=this.makeOutputArray(e,n);return this.compileAndRun(i,[],o,a)},e.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},e.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},e.prototype.linspace=function(e,t,n){return Ti(e,t,n)},e.prototype.makeOutputArray=function(e,t){return he.make(e,{},t,this)},e.prototype.makePackedTensor=function(e,t){var n=he.make(e,{},t,this);return this.texData.get(n.dataId).isPacked=!0,n},e.prototype.unpackTensor=function(e){var t=new As(e.shape);return this.compileAndRun(t,[e],he.make(t.outputShape,{},e.dtype,this))},e.prototype.packTensor=function(e){var t=new Ro(e.shape);return this.compileAndRun(t,[e],this.makePackedTensor(e.shape,e.dtype),null,!0)},e.prototype.packedReshape=function(e,t){var n=e.reshape([wt(e.shape)].concat(xt(e.shape))),r=[wt(t)].concat(xt(t)),i=new Po(r,n.shape);return this.compileAndRun(i,[n],null,null,!0).reshape(t)},e.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,i=n.shape,a=n.dtype,o=Tt(i),s=qe(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=a,this.texData.get(u.dataId).texShape=s.map((function(e){return 2*e})),t=r?new ja(o,s):new La(o,s),this.compileAndRun(t,[{shape:o,dtype:a,dataId:e}],u,null,!0),u},e.prototype.compileAndRun=function(e,t,n,r,i){var a=this;if(void 0===i&&(i=!1),null==n&&(n=e.usesPackedTextures?this.makePackedTensor(e.outputShape,t[0].dtype):this.makeOutputArray(e.outputShape,t[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=A(n.dtype,0),n;var o=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.usesPackedTextures&&_(t.shape)<=l().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.usesPackedTextures&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.usesPackedTextures)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!Et(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),n=a.texData.get(t.dataId),r.shape=i}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var s,u={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var i=e.userCode,a=e.constructor.name;return a+"_"+r+"_"+i}(e,o,u),d=this.getAndSaveBinary(c,(function(){return function(e,t,n,r){var i=t.userCode,a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=a.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=zi(a,s,i,t.usesPackedTextures),c=e.createProgram(u),d=null,p=e.getUniformLocation(c,"NAN",!1);1===l().getNumber("WEBGL_VERSION")&&(d=e.getUniformLocation(c,"INFINITY",!1));for(var h={},f=0;f<t.variableNames.length;f++){var m=t.variableNames[f];h[m]=e.getUniformLocation(c,m,!1),h["offset"+m]=e.getUniformLocation(c,"offset"+m,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:h,inShapeInfos:o,outShapeInfo:s,infLoc:d,nanLoc:p}}(a.gpgpu,e,o,u)})),p=null!=this.activeTimers;return p&&(s=this.startTimer()),function(e,t,n,r,i){yo(t.inShapeInfos,n),yo([t.outShapeInfo],[r]);var a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a,o[0],o[1]):e.setOutputMatrixTexture(a,o[0],o[1]),e.setProgram(t.webGLProgram),1===l().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var i=t.program.variableNames[r],a=t.uniformLocations[i],o=t.uniformLocations["offset"+i];if(null!=a)if(n.isUniform)if(_(n.shape)<2)e.gl.uniform1f(a,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(a,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,a,r)})),null!=i&&i(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,d,o,u,r),p&&(s=this.endTimer(s),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(s)})),!l().getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},e.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ht((function(){if(!l().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=l().getBool("DEBUG");l().set("DEBUG",!1);var n=e.abs(kn(1e-8)).dataSync()[0];if(l().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,i=n.dtype,a=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=Y());var d=n.texShape;if(null==d&&(d=Ct(r,u),n.texShape=d),null!=a){var p=Tt(r),h=void 0,f=d[1],m=d[0],v=a instanceof Uint8Array;u?(f=(t=We(d[0],d[1]))[0],m=t[1],h=new Wa(p,[m,f],v)):h=new qa(p,[m,f],v);var g=this.makeTensorHandle([m,f],i);this.texData.get(g.dataId).usage=v?Pe.PIXELS:Pe.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),f,m,a);var y=this.makeTensorHandle(h.outputShape,g.dtype);y.size=_(h.outputShape),this.texData.get(y.dataId).isPacked=u,this.compileAndRun(h,[g],y);var b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=Y()-c)}else{var w=this.acquireTexture(d,s,i,u);n.texture=w}}},e.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},e.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},e.prototype.computeBytes=function(e,t){return e[0]*e[1]*L(t)},e}();Ne()&&Ie.registerBackend("webgl",(function(){return new Ps}),2);var Ms=wn({abs_:function(e){var t=cn(e,"x","abs");return"complex64"===t.dtype?Ie.runKernel((function(e){return e.complexAbs(t)}),{$x:t}):Ie.runKernel((function(e,n){var r=e.abs(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.toFloat().step(-1))}}}))}}),Ls=wn({acos_:function(e){var t=cn(e,"x","acos");return Ie.runKernel((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(kn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),js=wn({acosh_:function(e){var t=cn(e,"x","acosh");return Ie.runKernel((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Bs=wn({asin_:function(e){var t=cn(e,"x","asin");return Ie.runKernel((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(kn(1).sub(n.toFloat().square()).sqrt())}}}))}}),Us=wn({asinh_:function(e){var t=cn(e,"x","asinh");return Ie.runKernel((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(kn(1).add(n.toFloat().square()).sqrt())}}}))}}),Fs=wn({atan_:function(e){var t=cn(e,"x","atan");return Ie.runKernel((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),Vs=wn({atanh_:function(e){var t=cn(e,"x","atanh");return Ie.runKernel((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(kn(1).sub(n.toFloat().square()))}}}))}}),qs=wn({ceil_:function(e){var t=cn(e,"x","ceil");return Ie.runKernel((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),Ws=wn({clipByValue_:function(e,t,n){var r=cn(e,"x","clipByValue");return v(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."})),Ie.runKernel((function(e,i){var a=e.clip(r,t,n);return i([r]),a}),{$x:r},(function(e,r){var i=r[0];return{$x:function(){return e.where(i.greaterEqual(t).logicalAnd(i.lessEqual(n)),Fn(e))}}}))}}),zs=wn({cos_:function(e){var t=cn(e,"x","cos");return Ie.runKernel((function(e,n){var r=e.cos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sin().neg().mul(e)}}}))}}),Gs=wn({cosh_:function(e){var t=cn(e,"x","cosh");return Ie.runKernel((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),Hs=wn({erf_:function(e){var t=cn(e,"x","erf");return v("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),Ie.runKernel((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),$s=wn({exp_:function(e){var t=cn(e,"x","exp");return Ie.runKernel((function(e,n){var r=e.exp(t);return n([r]),r}),{$x:t},(function(e,t){return{$x:function(){return e.mulStrict(t[0])}}}))}}),Ks=wn({expm1_:function(e){var t=cn(e,"x","expm1");return Ie.runKernel((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),Ys=wn({floor_:function(e){var t=cn(e,"x","floor");return Ie.runKernel((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),Xs=wn({log_:function(e){var t=cn(e,"x","log");return Ie.runKernel((function(e,n){var r=e.log(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat())}}}))}}),Js=wn({log1p_:function(e){var t=cn(e,"x","log1p");return Ie.runKernel((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),Qs=wn({logSigmoid_:function(e){var t=cn(e,"x","logSigmoid");return Ie.runKernel((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),Zs=wn({neg_:function(e){var t=cn(e,"x","neg");return Ie.runKernel((function(e){return e.neg(t)}),{$x:t},(function(e){return{$x:function(){return e.neg()}}}))}}),eu=wn({reciprocal_:function(e){var t=cn(e,"x","reciprocal");return Ie.runKernel((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),tu=wn({round_:function(e){var t=cn(e,"x","round");return Ie.runKernel((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),nu=wn({rsqrt_:function(e){var t=cn(e,"x","rsqrt");return Ie.runKernel((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}))}}),ru=wn({sigmoid_:function(e){var t=cn(e,"x","sigmoid");return Ie.runKernel((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.mul(kn(1).sub(n)))}}}))}}),iu=wn({sign_:function(e){var t=cn(e,"x","sign");return Ie.runKernel((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),au=wn({isNaN_:function(e){var t=cn(e,"x","isNaN");return Ie.runKernel((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),ou=wn({isInf_:function(e){var t=cn(e,"x","isInf");return Ie.runKernel((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),su=wn({isFinite_:function(e){var t=cn(e,"x","isFinite");return Ie.runKernel((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return Fn(e)}}}))}}),uu=wn({sin_:function(e){var t=cn(e,"x","sin");return Ie.runKernel((function(e,n){var r=e.sin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cos().mul(e)}}}))}}),cu=wn({sinh_:function(e){var t=cn(e,"x","sinh");return Ie.runKernel((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),lu=wn({softplus_:function(e){var t=cn(e,"x","softplus");return Ie.runKernel((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),du=wn({sqrt_:function(e){var t=cn(e,"x","sqrt");return Ie.runKernel((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),pu=wn({square_:function(e){var t=cn(e,"x","square");return Ie.runKernel((function(e,n){return n([t]),e.square(t)}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.toFloat().mul(2))}}}))}}),hu=wn({step_:function(e,t){void 0===t&&(t=0);var n=cn(e,"x","step");return Ie.runKernel((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return Fn(e)}}}))}}),fu=wn({tan_:function(e){var t=cn(e,"x","tan");return Ie.runKernel((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),mu=wn({tanh_:function(e){var t=cn(e,"x","tanh");return Ie.runKernel((function(e,n){var r=e.tanh(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return kn(1).sub(n.square()).mulStrict(e)}}}))}});function vu(e,t,n,r,i,a){var o,s,u=cn(e,"x","batchNorm"),c=cn(t,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=i&&(o=cn(i,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),v(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),v(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),v(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&v(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&v(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),bu(u,c,l,s,o,a)}function gu(e,t,n,r,i,a){var o,s,u=cn(e,"x","batchNorm"),c=cn(t,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=i&&(o=cn(i,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),v(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),v(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),v(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&v(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&v(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),bu(u,c,l,s,o,a)}function yu(e,t,n,r,i,a){var o,s,u=cn(e,"x","batchNorm"),c=cn(t,"mean","batchNorm"),l=cn(n,"variance","batchNorm");return null!=i&&(o=cn(i,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),v(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),v(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),v(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&v(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&v(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),bu(u,c,l,s,o,a)}function bu(e,t,n,r,i,a){null==a&&(a=.001);var o,s,u,c=cn(e,"x","batchNorm"),l=cn(t,"mean","batchNorm"),d=cn(n,"variance","batchNorm");return null!=i&&(o=cn(i,"scale","batchNorm")),null!=r&&(s=cn(r,"offset","batchNorm")),v(l.rank===d.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),v(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),v(null==o||l.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,Ie.runKernel((function(e,t){var n=e.batchNormalization(u,_u(l),_u(d),a,_u(o),_u(s));return t([c,l,d,o]),n}),{$x:c,$mean:l,$variance:d,$scale:o,$offset:s},(function(e,t){var n=t,r=n[0],i=n[1],o=n[2],s=n[3],c=null==s?kn(1):s,l=si(i.shape,u.shape),d=[];if(1===i.rank){for(var p=0;p<u.shape.length-1;++p)d.push(u.shape[p]);d.push(1)}var h=r.sub(i),f=e.mul(c),m=nu(o.add(kn(a))),v=m.mul(m).mul(m).mul(kn(-.5));return{$x:function(){return 1===i.rank?e.mul(Or(m.as4D(1,1,1,i.shape[0]),d)).mul(c).reshape(r.shape):e.mul(m).mul(c).reshape(r.shape)},$mean:function(){var e=m.mul(kn(-1)).mul(f);return 1===i.rank&&(e=e.sum(l)),e.reshape(i.shape)},$variance:function(){var e=v.mul(h).mul(f);return 1===i.rank&&(e=e.sum(l)),e.reshape(i.shape)},$scale:function(){var t=h.mul(m),n=e.mul(t);return 1===i.rank&&(n=n.sum(l)),n.reshape(i.shape)},$offset:function(){var t=e;return 1===i.rank&&(t=t.sum(l)),t.reshape(i.shape)}}})).reshape(c.shape)}function _u(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function wu(){Vt("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var xu=wn({batchNormalization2d_:function(e,t,n,r,i,a){return void 0===r&&(r=.001),wu(),vu(e,t,n,a,i,r)}}),Tu=wn({batchNormalization3d_:function(e,t,n,r,i,a){return void 0===r&&(r=.001),wu(),gu(e,t,n,a,i,r)}}),Cu=wn({batchNormalization4d_:function(e,t,n,r,i,a){return void 0===r&&(r=.001),wu(),yu(e,t,n,a,i,r)}}),Su=wn({batchNormalization_:function(e,t,n,r,i,a){return void 0===r&&(r=.001),wu(),bu(e,t,n,a,i,r)}}),Eu=wn({batchNorm_:bu}),ku=wn({batchNorm2d_:vu}),Ru=wn({batchNorm3d_:gu}),Ou=wn({batchNorm4d_:yu}),Au=wn({logicalAnd_:function(e,t){var n=cn(e,"a","logicalAnd","bool"),r=cn(t,"b","logicalAnd","bool");return ui(n.shape,r.shape),Ie.runKernel((function(e){return e.logicalAnd(n,r)}),{$a:n,$b:r})}}),Iu=wn({logicalNot_:function(e){var t=cn(e,"x","logicalNot","bool");return Ie.runKernel((function(e){return e.logicalNot(t)}),{$x:t})}}),Nu=wn({logicalOr_:function(e,t){var n=cn(e,"a","logicalOr","bool"),r=cn(t,"b","logicalOr","bool");return ui(n.shape,r.shape),Ie.runKernel((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),Du=wn({logicalXor_:function(e,t){var n=cn(e,"a","logicalXor","bool"),r=cn(t,"b","logicalXor","bool");return ui(n.shape,r.shape),Nu(e,t).logicalAnd(Au(e,t).logicalNot())}}),Pu=wn({where_:function(e,t,n){var r=cn(t,"a","where"),i=cn(n,"b","where"),a=cn(e,"condition","where","bool");return g(r.shape,i.shape,"Error in where: "),1===a.rank?v(a.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):g(a.shape,i.shape,"Error in where: "),Ie.runKernel((function(e,t){var n=e.select(a,r,i);return t([a]),n}),{$condition:a,$a:r,$b:i},(function(e,t){var n=t[0];return{$condition:function(){return Fn(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),Mu=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(i){switch(i.label){case 0:return[4,(t=cn(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=Pi(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},Lu=wn({add_:function(e,t){var n,r=cn(e,"a","add"),i=cn(t,"b","add");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e){return e.add(r,i)}),{$a:r,$b:i},(function(e){return{$a:function(){var t=e,n=si(r.shape,a);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},$b:function(){var t=e,n=si(i.shape,a);return n.length>0&&(t=t.sum(n)),t.reshape(i.shape)}}}))}}),ju=wn({addN_:function(e){v(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),v(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return cn(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!w(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return Ie.runKernel((function(e){return e.addN(t)}),r,(function(e){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}))}}),Bu=wn({addStrict_:function(e,t){var n=cn(e,"a","addStrict"),r=cn(t,"b","addStrict");return g(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Uu=wn({atan2_:function(e,t){var n,r=cn(e,"a","atan2"),i=cn(t,"b","atan2");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e,t){var n=e.atan2(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=Lu(n.square(),r.square()),i=e.mul(r.div(t)),o=si(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},$b:function(){var t=Lu(n.square(),r.square()),i=Zs(e.mul(n.div(t))),o=si(r.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(r.shape)}}}))}}),Fu=wn({div_:function(e,t){var n,r=cn(e,"a","div"),i=cn(t,"b","div");if(n=Ce(r,i),r=n[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return qu(r,i);var a=ui(r.shape,i.shape);return Ie.runKernel((function(e,t){var n=e.realDivide(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=e.div(r.toFloat()),i=si(n.shape,a);return i.length>0?t.sum(i).reshape(n.shape):t},$b:function(){var t=e.mul(n.toFloat()),i=si(r.shape,a);i.length>0&&(t=t.sum(i).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}}))}}),Vu=wn({divStrict_:function(e,t){var n=cn(e,"a","div"),r=cn(t,"b","div");return g(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),qu=wn({floorDiv_:function(e,t){var n,r=cn(e,"a","floorDiv"),i=cn(t,"b","floorDiv");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e,t){var n=e.floorDiv(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=e.div(r.toFloat()),i=si(n.shape,a);return i.length>0?t.sum(i).reshape(n.shape):t},$b:function(){var t=e.mul(n.toFloat()),i=si(r.shape,a);i.length>0&&(t=t.sum(i).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}}))}}),Wu=wn({maximum_:function(e,t){var n,r=cn(e,"a","maximum"),i=cn(t,"b","maximum");return n=Ce(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),ui(r.shape,i.shape),Ie.runKernel((function(e,t){var n=e.maximum(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){return e.mul(n.greaterEqual(r).toFloat())},$b:function(){return e.mul(n.less(r).toFloat())}}}))}}),zu=wn({maximumStrict_:function(e,t){var n=cn(e,"a","maximumStrict"),r=cn(t,"b","maximumStrict");return g(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Gu=wn({minimum_:function(e,t){var n,r=cn(e,"a","minimum"),i=cn(t,"b","minimum");return n=Ce(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),ui(r.shape,i.shape),Ie.runKernel((function(e,t){var n=e.minimum(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){return e.mul(n.lessEqual(r).toFloat())},$b:function(){return e.mul(n.greater(r).toFloat())}}}))}}),Hu=wn({minimumStrict_:function(e,t){var n=cn(e,"a","minimumStrict"),r=cn(t,"b","minimumStrict");return g(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),$u=wn({mod_:function(e,t){var n,r=cn(e,"a","mod"),i=cn(t,"b","mod");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e,t){var n=e.mod(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=si(n.shape,a);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),i=si(r.shape,a);return i.length>0?t.sum(i).reshape(r.shape):t}}}))}}),Ku=wn({modStrict_:function(e,t){var n=cn(e,"a","modStrict"),r=cn(t,"b","modStrict");return g(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Yu=wn({mul_:function(e,t){var n,r=cn(e,"a","mul"),i=cn(t,"b","mul");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e,t){var n=e.multiply(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=e.mul(r.toFloat()),i=si(n.shape,a);return i.length>0?t.sum(i).reshape(n.shape):t},$b:function(){var t=e.mul(n.toFloat()),i=si(r.shape,a);return i.length>0?t.sum(i).reshape(r.shape):t}}}))}}),Xu=wn({mulStrict_:function(e,t){var n=cn(e,"a","mul"),r=cn(t,"b","mul");return g(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Ju=wn({pow_:function(e,t){var n=cn(e,"base","pow"),r=cn(t,"exp","pow"),i=ui(n.shape,r.shape);return e=n.cast(xe(n.dtype,r.dtype)),t=r.cast(xe(n.dtype,r.dtype)),Ie.runKernel((function(e,t){var i=e.pow(n,r);return t([n,r,i]),i}),{$base:n,$exp:r},(function(e,t){var n=t[0],r=t[1],a=t[2];return{$base:function(){var t=r.toFloat(),a=e.mul(t.mul(n.pow(t.sub(kn(1))))),o=si(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$exp:function(){var t=n.greater(0),o=n.log().where(t,Fn(n)),s=e.mul(a.mul(o)),u=si(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}))}}),Qu=wn({powStrict_:function(e,t){return g(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),Zu=wn({squaredDifference_:function(e,t){var n,r=cn(e,"a","squaredDifference"),i=cn(t,"b","squaredDifference");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e,t){var n=e.squaredDifference(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1],i=kn(2);return{$a:function(){return e.mul(n.sub(r).mul(i))},$b:function(){return e.mul(r.sub(n).mul(i))}}}))}}),ec=wn({squaredDifferenceStrict_:function(e,t){var n=cn(e,"a","squaredDifferenceStrict"),r=cn(t,"b","squaredDifferenceStrict");return g(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),tc=wn({sub_:function(e,t){var n,r=cn(e,"a","sub"),i=cn(t,"b","sub");n=Ce(r,i),r=n[0],i=n[1];var a=ui(r.shape,i.shape);return Ie.runKernel((function(e){return e.subtract(r,i)}),{$a:r,$b:i},(function(e){return{$a:function(){var t=e,n=si(r.shape,a);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},$b:function(){var t=e,n=si(i.shape,a);return n.length>0&&(t=t.sum(n)),t.neg().reshape(i.shape)}}}))}}),nc=wn({subStrict_:function(e,t){var n=cn(e,"a","subStrict"),r=cn(t,"b","subStrict");return g(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),rc=wn({equal_:function(e,t){var n,r=cn(e,"a","equal"),i=cn(t,"b","equal");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e){return e.equal(r,i)}),{$a:r,$b:i})}}),ic=wn({equalStrict_:function(e,t){var n=cn(e,"a","equalStrict"),r=cn(t,"b","equalStrict");return g(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),ac=wn({greater_:function(e,t){var n,r=cn(e,"a","greater"),i=cn(t,"b","greater");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e){return e.greater(r,i)}),{$a:r,$b:i})}}),oc=wn({greaterEqual_:function(e,t){var n,r=cn(e,"a","greaterEqual"),i=cn(t,"b","greaterEqual");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e,t){var n=e.greaterEqual(r,i);return t([r,i]),n}),{$a:r,$b:i},(function(e,t){var n=t[0],r=t[1];return{$a:function(){return Fn(n)},$b:function(){return Fn(r)}}}))}}),sc=wn({greaterEqualStrict_:function(e,t){var n=cn(e,"a","greaterEqualStrict"),r=cn(t,"b","greaterEqualStrict");return g(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),uc=wn({greaterStrict_:function(e,t){var n=cn(e,"a","greaterStrict"),r=cn(t,"b","greaterStrict");return g(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),cc=wn({less_:function(e,t){var n,r=cn(e,"a","less"),i=cn(t,"b","less");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e){return e.less(r,i)}),{$a:r,$b:i})}}),lc=wn({lessEqual_:function(e,t){var n,r=cn(e,"a","lessEqual"),i=cn(t,"b","lessEqual");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e){return e.lessEqual(r,i)}),{$a:r,$b:i})}}),dc=wn({lessEqualStrict_:function(e,t){var n=cn(e,"a","lessEqualStrict"),r=cn(t,"b","lessEqualStrict");return g(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),pc=wn({lessStrict_:function(e,t){var n=cn(e,"a","lessStrict"),r=cn(t,"b","lessStrict");return g(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),hc=wn({notEqual_:function(e,t){var n,r=cn(e,"a","notEqual"),i=cn(t,"b","notEqual");return n=Ce(r,i),r=n[0],i=n[1],ui(r.shape,i.shape),Ie.runKernel((function(e){return e.notEqual(r,i)}),{$a:r,$b:i})}}),fc=wn({notEqualStrict_:function(e,t){var n=cn(e,"a","notEqualStrict"),r=cn(t,"b","notEqualStrict");return g(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function mc(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function vc(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var gc=wn({gather_:function(e,t,n){void 0===n&&(n=0);var r=cn(e,"x","gather"),i=cn(t,"indices","gather","int32");n=R(n,r.shape)[0];var a=function(e,t,n){for(var r=e.shape[n],i=[],a=1,o=1,s=0;s<n;s++)i.push(e.shape[s]),a*=e.shape[s];for(s=0;s<t.rank;s++)i.push(t.shape[s]);for(s=n+1;s<e.rank;s++)i.push(e.shape[s]),o*=e.shape[s];return{batchSize:a,sliceSize:o,dimSize:r,outputShape:i}}(r,i,n);return Ie.runKernel((function(e,t){var a=e.gather(r,i.flatten(),n);return t([i]),a}),{$x:r},(function(e,t){var i=t[0];return{$x:function(){var t=r.shape,a=i.size,o=t.slice(0,n),s=o.length,u=t.slice(n,t.length).slice(1),c=u.length,l=mc(0,s),d=mc(s+1,s+1+c),p=vc([o,[a],u]),h=e.reshape(p),f=i.reshape([a]),m=vc([[s],l,d]),v=h.transpose(m),g=yc(v,f,r.shape[n]),y=gn(m);return g.transpose(y)}}})).reshape(a.outputShape)}}),yc=wn({unsortedSegmentSum_:function(e,t,n){var r=cn(e,"x","unsortedSegmentSum"),i=cn(t,"segmentIds","unsortedSegmentSum","int32");return v(x(n),(function(){return"numSegments must be of dtype int"})),Ie.runKernel((function(e,t){var a=e.unsortedSegmentSum(r,i,n);return t([i]),a}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=Wu(t,Fn(t)),r=gc(e,n),i=oc(t,kn(0,"int32")),a=r.rank-i.rank,o=0;o<a;++o)i=pr(i,o+1);i=Au(i,Pn(r.shape,"bool"));var s=Fn(r);return Pu(i,r,s)}(e,n)}}}))}}),bc=function(e,t,n){return s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,d,p,h,f,m,y;return u(this,(function(u){switch(u.label){case 0:for(r=cn(e,"tensor","boolMask"),i=cn(t,"mask","boolMask","bool"),a=null==n?0:n,o=i.rank,s=r.shape,v(o>0,(function(){return"mask cannot be scalar"})),g(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=a;l<a+o;l++)c*=s[l];return d=s.slice(0,a).concat([c],s.slice(a+o)),p=r.reshape(d),h=i.reshape([-1]),[4,Mu(h)];case 1:return f=u.sent(),m=f.squeeze([1]),y=gc(p,m,a),e!==r&&r.dispose(),t!==i&&i.dispose(),m.dispose(),p.dispose(),h.dispose(),f.dispose(),[2,y]}}))}))};function _c(e,t,n,r,i,a,o){void 0===a&&(a="NHWC"),v(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),v(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),v(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),v(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===a?s[3]:s[1],d="NHWC"===a?u.shape[3]:u.shape[1];v(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),v(d===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&v(x(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var p=_i(a),h=di(s,n.shape,r,1,i,o,!1,p),f=Ie.runKernel((function(e,t){var r=e.conv2dDerInput(u,n,h);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return Cc(e,n,r,i,a,1,o)},filter:function(){return Ec(e,s,n.shape,r,i,a,o)}}}));return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function wc(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],i=t[2];return 1===n&&1===r&&1===i}function xc(e,t,n,r,i){v(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var a=e,o=t,s=!1;4===t.rank&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],c=o.shape[4];v(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."})),v(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),v(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),v(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),v(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=pi(a,n.shape,r,1,i),d=Ie.runKernel((function(e){return e.conv3dDerInput(o,n,l)}),{dy5D:o});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var Tc=wn({conv1d_:function(e,t,n,r,i,a,o){void 0===i&&(i="NWC"),void 0===a&&(a=1);var s=cn(e,"x","conv1d"),u=cn(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),v(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),v(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&v(x(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),v(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),v(bi(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"})),v("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),h=Cc(p,d,[1,n],r,"NHWC",[1,a],o);return l?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Cc=wn({conv2d_:function(e,t,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=cn(e,"x","conv2d"),u=cn(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),v(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),v(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&v(x(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var d="NHWC"===i?c.shape[3]:c.shape[1];v(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),v(bi(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}));var p=_i(i),h=di(c.shape,u.shape,n,a,r,o,!1,p),f=Ie.runKernel((function(e,t){var n=e.conv2d(c,u,h);return t([u,c]),n}),{x:c,$filter:u},(function(e,t){var o=t,s=o[0],u=o[1];return v(yi(a),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"})),{x:function(){return kc(u.shape,e,s,n,r,i)},$filter:function(){return Ec(u,e,s.shape,n,r,i)}}}));return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),Sc=wn({conv3d_:function(e,t,n,r,i,a){void 0===i&&(i="NDHWC"),void 0===a&&(a=[1,1,1]);var o=cn(e,"x","conv3d"),s=cn(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),v(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),v(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),v(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),v(function(e,t){return wc(e)||wc(t)}(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),v("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=pi(u.shape,s.shape,n,a,r),d=Ie.runKernel((function(e,t){var n=e.conv3d(u,s,l);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){v(wc(a),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}));var i=t[0],o=t[1];return{x:function(){return xc(i.shape,e,o,n,r)},$filter:function(){return function(e,t,n,r,i){var a=e;4===e.rank&&(a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var o=t;4===o.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),v(5===a.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+a.shape+"."})),v(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),v(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),v(a.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+a.shape[4]+") must match input depth in filter ("+n[3]+"."})),v(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=pi(a.shape,n,r,1,i);return Ie.runKernel((function(e){return e.conv3dDerFilter(a,o,s)}),{x5D:a,dy5D:o})}(i,e,o.shape,n,r)}}}));return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Ec=wn({conv2dDerFilter_:function(e,t,n,r,i,a,o){void 0===a&&(a="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),v(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),v(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),v(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===a?s.shape[3]:s.shape[1],l="NHWC"===a?u.shape[3]:u.shape[1];v(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),v(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&v(x(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var d=_i(a),p=di(s.shape,n,r,1,i,o,!1,d);return Ie.runKernel((function(e){return e.conv2dDerFilter(s,u,p)}),{x4D:s,dy4D:u})}}),kc=wn({conv2dDerInput_:_c}),Rc=wn({depthwiseConv2d_:function(e,t,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=cn(e,"x","depthwiseConv2d"),u=cn(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),v(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),v(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),v(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==a&&(a=[1,1]),v(bi(n,a),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&v(x(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var d=di(c.shape,u.shape,n,a,r,o,!0),p=Ie.runKernel((function(e,t){var n=e.depthwiseConv2D(c,u,d);return t([c,u]),n}),{x:c,$filter:u},(function(e,t){v(yi(a),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"}));var n=t[0],r=t[1];return{x:function(){return Oc(n.shape,e,r,d)},$filter:function(){return Ac(n,e,r.shape,d)}}}));return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Oc=wn({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;3===t.rank&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=Ie.runKernel((function(e){return e.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),Ac=wn({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;3===e.rank&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return 3===a.rank&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Ie.runKernel((function(e){return e.depthwiseConv2DDerFilter(i,a,r)}),{x4D:i,dy4D:a})}}),Ic=wn({separableConv2d_:function(e,t,n,r,i,a,o){void 0===a&&(a=[1,1]),void 0===o&&(o="NHWC");var s=cn(e,"x","separableConv2d"),u=cn(t,"depthwiseFilter","separableConv2d"),c=cn(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(3===s.rank&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");v(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),v(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),v(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),v(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),v(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var p=u.shape[2],h=u.shape[3];v(c.shape[2]===p*h,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*h+", but got "+c.shape[2]+"."}));var f=Rc(l,u,r,i,o,a),m=Cc(f,c,1,"valid",o);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Nc=wn({conv2dTranspose_:function(e,t,n,r,i,a){return _c(n,cn(e,"x","conv2dTranspose"),cn(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),Dc=wn({conv3dTranspose_:function(e,t,n,r,i){return xc(n,cn(e,"x","conv3dTranspose"),cn(t,"filter","conv3dTranspose"),r,i)}}),Pc=wn({matMul_:function(e,t,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=cn(e,"a","matMul"),o=cn(t,"b","matMul");i=Ce(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?a.shape[a.rank-1]:a.shape[a.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],d=a.shape.slice(0,-2),p=o.shape.slice(0,-2),h=_(d),f=_(p);v(a.rank>=2&&o.rank>=2&&a.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."})),v(w(d,p),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+p+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."})),v(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=a.shape.slice(0,-2).concat([c,l]),g=n?a.as3D(h,s,c):a.as3D(h,c,s),y=r?o.as3D(f,l,u):o.as3D(f,u,l);return Ie.runKernel((function(e,t){var i=e.batchMatMul(g,y,n,r);return t([g,y]),i}),{$a:g,$b:y},(function(e,t){var i=t,a=i[0],o=i[1];return n||r?!n&&r?{$a:function(){return e.matMul(o,!1,!1)},$b:function(){return e.matMul(a,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(e,!1,!0)},$b:function(){return a.matMul(e,!1,!1)}}:{$a:function(){return o.matMul(e,!0,!0)},$b:function(){return e.matMul(a,!0,!0)}}:{$a:function(){return e.matMul(o,!1,!0)},$b:function(){return a.matMul(e,!0,!1)}}})).reshape(m)}}),Mc=wn({dot_:function(e,t){var n=cn(e,"t1","dot"),r=cn(t,"t2","dot");v(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];return v(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Lc=wn({outerProduct_:function(e,t){var n=cn(e,"v1","outerProduct"),r=cn(t,"v2","outerProduct");return v(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),jc=wn({reverse_:function(e,t){var n=cn(e,"x","reverse");if(0===n.rank)return n.clone();var r=R(t,n.shape);return Ie.runKernel((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),Bc=wn({reverse1d_:function(e){var t=cn(e,"x","reverse");return v(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),jc(t,0)}}),Uc=wn({reverse2d_:function(e,t){var n=cn(e,"x","reverse");return v(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),jc(n,t)}}),Fc=wn({reverse3d_:function(e,t){var n=cn(e,"x","reverse");return v(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),jc(n,t)}}),Vc=wn({reverse4d_:function(e,t){var n=cn(e,"x","reverse");return v(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),jc(n,t)}});function qc(e,t,n,r,i,a){var o=cn(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),v(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),v(bi(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=a&&v(x(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var c=ci(s.shape,t,n,r,i,a),l=Ie.runKernel((function(e,t){var n=e.maxPool(s,c);return t([s,n]),n}),{x:s},(function(e,a){var o=a[0],s=a[1];return{x:function(){return function(e,t,n,r,i,a,o,s){var u=cn(e,"dy","maxPoolBackprop"),c=cn(t,"input","maxPoolBackprop"),l=cn(n,"output","maxPoolBackprop");v(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==a&&(a=[1,1]),v(bi(i,a),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),v(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),v(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."})),null!=s&&v(x(o),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var d=ci(c.shape,r,i,a,o,s);return Ie.runKernel((function(e){return e.maxPoolBackprop(u,c,l,d)}),{$dy:u,$input:c})}(e,o,s,t,n,r,i)}}}));return u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}function Wc(e,t,n,r,i,a){var o=cn(e,"x","avgPool","float32");null==r&&(r=[1,1]),v(bi(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),v(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=a&&v(x(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var c=ci(s.shape,t,n,r,i,a),l=Ie.runKernel((function(e){return e.avgPool(s,c)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,i,a){var o=cn(e,"dy","avgPoolBackprop"),s=cn(t,"input","avgPoolBackprop");v(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==i&&(i=[1,1]),v(bi(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),v(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),v(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var d=ci(u.shape,n,r,i,a),p=Ie.runKernel((function(e){return e.avgPoolBackprop(c,u,d)}),{dy4D:c,input4D:u});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}(e,s,t,n,r,i)}}}));return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var zc=wn({maxPool_:function(e,t,n,r,i){return qc(e,t,n,1,r,i)}}),Gc=wn({avgPool_:function(e,t,n,r,i){return Wc(e,t,n,1,r,i)}}),Hc=wn({pool_:function(e,t,n,r,i,a){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var o=cn(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),v(bi(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}));var c,l=ci(s.shape,t,a,i,r),d=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),i=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],i[t]]}))}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var p=1===d[0]&&1===d[1],h=function(e,t,n){var r=n.map((function(e){return e[0]})),i=n.map((function(e){return e[1]})),a=e.concat(r,i),o=t.map((function(e,t){return(e-a[t]%e)%e})),s=i.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([l.inHeight,l.inWidth],d,c),f=h[0],m=h[1],g=p?r:"valid",y=p?s:Er(s,d,f),b=("avg"===n?function(){return Wc(y,t,a,1,g)}:function(){return qc(y,t,a,1,g)})(),_=p?b:sr(b,d,m);return u?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),$c=wn({maxPool3d_:function(e,t,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=cn(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),v(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),v("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),v(bi(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&v(x(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=li(u.shape,t,n,o,r,i,a),d=Ie.runKernel((function(e,t){var n=e.maxPool3d(u,l);return t([u,n]),n}),{x:u},(function(e,a){var s=a[0],u=a[1];return{x:function(){return function(e,t,n,r,i,a,o,s){var u=cn(e,"dy","maxPool3dBackprop"),c=cn(t,"input","maxPool3dBackprop"),l=cn(n,"output","maxPool3dBackprop"),d=u,p=c,h=l,f=!1;4===c.rank&&(f=!0,d=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),p=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),h=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),v(5===d.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+d.rank+"."})),v(5===p.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+p.rank+"."})),v(5===h.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+h.rank+"."})),null==a&&(a=[1,1,1]),v(bi(i,a),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),null!=s&&v(x(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var m=li(p.shape,r,i,a,o,s),g=Ie.runKernel((function(e){return e.maxPool3dBackprop(d,p,h,m)}),{dy5D:d,input5D:p});return f?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(e,s,u,t,n,o,r,i)}}}));return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Kc=wn({avgPool3d_:function(e,t,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=cn(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),v(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),v("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),v(bi(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&v(x(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=li(u.shape,t,n,o,r,i,a),d=Ie.runKernel((function(e){return e.avgPool3d(u,l)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,i,a,o){var s=cn(e,"dy","avgPool3dBackprop"),u=cn(t,"input","avgPool3dBackprop"),c=s,l=u,d=!1;4===u.rank&&(d=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),v(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),v(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==i&&(i=[1,1,1]),v(bi(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=o&&v(x(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var p=li(l.shape,n,r,i,a,o),h=Ie.runKernel((function(e){return e.avgPool3dBackprop(c,l,p)}),{dy5D:c,input5D:l});return d?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}(e,u,t,n,o,r,i)}}}));return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Yc=wn({slice_:function(e,t,n){var r,i,a=cn(e,"x","slice");if(0===a.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach((function(e){v(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a.rank).fill(-1):"number"==typeof n?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(v(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),a.shape[t]-r[t])})),function(e,t,n){v(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),v(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){v(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},i=0;i<e.rank;++i)r(i)}(a,r,i);var o=a.shape;return Ie.runKernel((function(e){return e.slice(a,r,i)}),{$x:a},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-i[n]]);return{$x:function(){return e.pad(t)}}}))}}),Xc=wn({slice1d_:function(e,t,n){var r=cn(e,"x","slice1d");return v(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Yc(r,[t],[n])}}),Jc=wn({slice2d_:function(e,t,n){var r=cn(e,"x","slice2d");return v(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Yc(r,t,n)}}),Qc=wn({slice3d_:function(e,t,n){var r=cn(e,"x","slice3d");return v(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Yc(r,t,n)}}),Zc=wn({slice4d_:function(e,t,n){var r=cn(e,"x","slice4d");return v(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Yc(r,t,n)}});function el(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(fn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(fn(e.shape,r))),{$x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==i?r:r.transpose(i)}}}var tl=wn({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","all","bool"),i=R(t,r.shape),a=i,o=vn(a,r.rank);null!=o&&(r=r.transpose(o),a=yn(a.length,r.rank));var s=Ie.runKernel((function(e){return e.all(r,a)}),{$x:r});if(n){var u=fn(s.shape,i);return s.reshape(u)}return s}}),nl=wn({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","any","bool"),i=R(t,r.shape),a=i,o=vn(a,r.rank);null!=o&&(r=r.transpose(o),a=yn(a.length,r.rank));var s=Ie.runKernel((function(e){return e.any(r,a)}),{$x:r});if(n){var u=fn(s.shape,i);return s.reshape(u)}return s}}),rl=wn({argMax_:function(e,t){void 0===t&&(t=0);var n=cn(e,"x","argMax");null==t&&(t=0);var r=R(t,n.shape),i=vn(r,n.rank);return null!=i&&(n=n.transpose(i),r=yn(r.length,n.rank)),Ie.runKernel((function(e,t){var i=e.argMax(n,r[0]);return t([n]),i}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return Fn(n)}}}))}}),il=wn({argMin_:function(e,t){void 0===t&&(t=0);var n=cn(e,"x","argMin");null==t&&(t=0);var r=R(t,n.shape),i=vn(r,n.rank);return null!=i&&(n=n.transpose(i),r=yn(r.length,n.rank)),Ie.runKernel((function(e,t){var i=e.argMin(n,r[0]);return t([n]),i}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return Fn(n)}}}))}}),al=wn({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","logSumExp"),i=R(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=fn(s.shape,i);return s.reshape(u)}return s}}),ol=wn({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","max"),i=r,a=R(t,r.shape),o=a,s=vn(o,r.rank);null!=s&&(r=r.transpose(s),o=yn(o.length,r.rank));var u=Ie.runKernel((function(e,t){var n=e.max(r,o);return t([i,n]),n}),{$x:r},(function(e,t){return el(e,t[1],t[0],a,s)}));if(n){var c=fn(u.shape,a);u=u.reshape(c)}return u}}),sl=wn({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","mean"),i=R(t,r.shape),a=_(hn(r.shape,i)[1]);return ei((function(e){var r=kn(a);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return i.forEach((function(e){n[e]=1})),t.reshape(n).mul(Pn(e.shape,"float32")).div(a)}}}))(r)}}),ul=wn({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","min"),i=r,a=R(t,r.shape),o=a,s=vn(o,r.rank);null!=s&&(r=r.transpose(s),o=yn(o.length,r.rank));var u=Ie.runKernel((function(e,t){var n=e.min(r,o);return t([i,n]),n}),{$x:r},(function(e,t){return el(e,t[1],t[0],a,s)}));if(n){var c=fn(u.shape,a);u=u.reshape(c)}return u}}),cl=wn({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=R(t,(e=cn(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=fn(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),ll=wn({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=R(t,r.shape);return ei((function(e){var t=vn(i,e.rank),r=i,a=e;null!=t&&(a=e.transpose(t),r=yn(r.length,e.rank));var o=Ie.runKernel((function(e){return e.sum(a,r)}),{permutedX:a});if(n){var s=fn(o.shape,i);o=o.reshape(s)}return{value:o,gradFunc:function(t){var n=e.shape.slice();return i.forEach((function(e){n[e]=1})),t.reshape(n).mul(Pn(e.shape,"float32"))}}}))(r)}}),dl=wn({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=cn(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=R(t,r.shape),a=vn(i,r.rank),o=i,s=r;null!=a&&(s=r.transpose(a),o=yn(o.length,r.rank));var u=Ie.runKernel((function(e){return e.prod(s,o)}),{permutedX:s});if(n){var c=fn(u.shape,i);u=u.reshape(c)}return u}}),pl=wn({elu_:function(e){var t=cn(e,"x","elu");return Ie.runKernel((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return Ie.runKernel((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),hl=wn({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=cn(e,"x","leakyRelu");return Wu(kn(t).mul(n),n)}}),fl=wn({prelu_:function(e,t){var n=cn(e,"x","prelu"),r=cn(t,"alpha","prelu");return Ie.runKernel((function(e,t){var i=e.prelu(n,r);return t([n,r]),i}),{$x:n,$alpha:r},(function(e,t){var n=t[0],r=t[1],i=n.greater(0);return{$x:function(){return Pu(i,e,e.mul(r))},$alpha:function(){var t=Pu(i,Fn(e),e.mul(n)),a=si(r.shape,e.shape);return a.length>0&&(t=t.sum(a)),t.reshape(r.shape)}}}))}}),ml=wn({relu_:function(e){var t=cn(e,"x","relu");return"bool"===t.dtype?t.toInt():Ie.runKernel((function(e,n){var r=e.relu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mulStrict(n.step().toFloat())}}}))}}),vl=wn({relu6_:function(e){var t=cn(e,"x","relu6");return"bool"===t.dtype?t.toInt():Ie.runKernel((function(e,n){var r=e.relu6(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{$x:function(){return e.mulStrict(r.toFloat())}}}))}}),gl=wn({selu_:function(e){var t=cn(e,"x","selu");return Ie.runKernel((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(kn(0)),r=kn(ts),i=kn(ns),a=e.mul(i),o=e.mul(r).mul(n.toFloat().exp());return Pu(t,a,o)}}}))}}),yl=wn({transpose_:function(e,t){var n=cn(e,"x","transpose");return null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),v(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){v(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1?n.clone():Ie.runKernel((function(e){return e.transpose(n,t)}),{$x:n},(function(e){var n=gn(t);return{$x:function(){return e.transpose(n)}}}))}}),bl=wn({localResponseNormalization_:function(e,t,n,r,i){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var a=cn(e,"x","localResponseNormalization");v(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+a.rank+"."})),v(x(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var o=a,s=!1;3===a.rank&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=Ie.runKernel((function(e,a){var s=e.localResponseNormalization4D(o,t,n,r,i);return a([o,s]),s}),{x4D:o},(function(e,a){var o=a[0],s=a[1];return{x4D:function(){return Ie.runKernel((function(a){return a.LRNGrad(e,o,s,t,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_l=wn({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(kn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=cn(e,"x","norm"),t,n),a=i.shape;if(r){var o=R(n,e.shape);a=fn(i.shape,o)}return i.reshape(a)}}),wl=wn({basicLSTMCell_:function(e,t,n,r,i,a){var o=cn(e,"forgetBias","basicLSTMCell"),s=cn(t,"lstmKernel","basicLSTMCell"),u=cn(n,"lstmBias","basicLSTMCell"),c=cn(r,"data","basicLSTMCell"),l=cn(i,"c","basicLSTMCell"),d=cn(a,"h","basicLSTMCell"),p=c.concat(d,1).matMul(s).add(u),h=p.shape[0],f=p.shape[1]/4,m=[h,f],v=p.slice([0,0],m),g=p.slice([0,f],m),y=p.slice([0,2*f],m),b=p.slice([0,3*f],m),_=v.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(o.add(y).sigmoid())),w=_.tanh().mulStrict(b.sigmoid());return[_,w]}}),xl=wn({multiRNNCell_:function(e,t,n,r){for(var i=cn(t,"data","multiRNNCell"),a=ln(n,"c","multiRNNCell"),o=ln(r,"h","multiRNNCell"),s=i,u=[],c=0;c<e.length;c++){var l=e[c](s,a[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],p=[];for(c=0;c<u.length;c+=2)d.push(u[c]),p.push(u[c+1]);return[d,p]}}),Tl=wn({movingAverage_:function(e,t,n,r,i){void 0===i&&(i=!0);var a=cn(e,"v","movingAverage"),o=cn(t,"x","movingAverage"),s=cn(n,"decay","movingAverage");Se(a,o),v(w(a.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=kn(1),c=u.sub(s),l=o.sub(a).mul(c);if(i){v(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=cn(r,"step","movingAverage");l=l.div(u.sub(Ju(s,d)))}return a.add(l)}}),Cl=wn({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=cn(e,"x","stridedSlice"),l=Wr(s),d=c.shape.slice();l.forEach((function(e){t[e]=0,n[e]=1,d.splice(e,0,1)})),c=c.reshape(d);for(var p=0;p<c.rank;p++)t[p]=Gr(i,t,r,c.shape,p),n[p]=Hr(a,n,r,c.shape,p),r[p]=r[p]||1;var h=Wr(u);h.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var f=zr(t,n,r),m=f.filter((function(e,t){return-1===h.indexOf(t)}));return r.every((function(e){return 1===e}))?Yc(c,t,f).reshape(m):Ie.runKernel((function(e){return e.stridedSlice(c,t,n,r)}),{$x:c}).reshape(m)}}),Sl=wn({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=cn(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=Ie.runKernel((function(e){return e.topk(r,t,n)}),{$x:r});return{values:a[0],indices:a[1]}}}),El=wn({scatterND_:function(e,t,n){var r=cn(e,"indices","scatterND","int32"),i=cn(t,"updates","scatterND");return Vr(i,r,n),Ie.runKernel((function(e){return e.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),kl=wn({fft_:function(e){v("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Ie.runKernel((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),Rl=wn({ifft_:function(e){v("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return Ie.runKernel((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),Ol=wn({rfft_:function(e,t){v("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],i=e.size/r;if(null!=t&&t<r){var a=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(Mn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=xn(n,u).as2D(i,r),l=kl(c),d=Math.floor(r/2)+1,p=Tn(l),h=Cn(l),f=p.split([d,r-d],p.shape.length-1),m=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,xn(f[0],m[0]).reshape(g)}}),Al=wn({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=Rl(r);return Tn(i)}var a=[n,2*(t-1)],o=Tn(e).as2D(n,t),s=Cn(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(kn(-1)),l=o.concat(u,1),d=s.concat(c,1);return r=xn(l,d).as2D(a[0],a[1]),i=Rl(r),Tn(i)}}),Il=Object.freeze({fft:kl,ifft:Rl,rfft:Ol,irfft:Al}),Nl=wn({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var i=cn(e,"sparseIndices","sparseToDense","int32"),a=cn(t,"sparseValues","sparseToDense"),o=cn(r,"defaultValue","sparseToDense",a.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var i=e.rank>0?e.shape[0]:1,a=e.rank>1?e.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+a+".");var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==i))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+i+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),Ie.runKernel((function(e){return e.sparseToDense(i,a,n,o)}),{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),Dl=wn({gatherND_:function(e,t){var n=cn(t,"indices","gatherND","int32"),r=cn(e,"x","gatherND");return Ie.runKernel((function(e){return e.gatherND(r,n)}),{$x:r,$indices:n})}}),Pl=wn({diag_:function(e){var t=cn(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return Ie.runKernel((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),Ml=wn({dropout_:function(e,t,n,r){var i=cn(e,"x","dropout");if(v("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),v(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof he?i.clone():i;var a=function(e,t){if(null==t)return e.shape.slice();if(w(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(i,n),o=1-t,s=Cr(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function Ll(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return Rn(i,"float32")}var jl,Bl=wn({hannWindow_:function(e){return Ll(e,.5,.5)}}),Ul=wn({hammingWindow_:function(e){return Ll(e,.54,.46)}}),Fl=wn({frame_:function(e,t,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Yc(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Vn([Yc(e,a,t-s),Ln([s],i)]);o.push(u),a+=n}return 0===o.length?On([],[0,t]):Vn(o).as2D(o.length,t)}}),Vl=wn({stft_:function(e,t,n,r,i){var a;void 0===i&&(i=Bl),null==r&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=Fl(e,t,n),s=Yu(o,i(t)),u=[],c=0;c<o.shape[0];c++)u.push(Ol(s.slice([c,0],[1,t]),r));return Vn(u)}}),ql=Object.freeze({hannWindow:Bl,hammingWindow:Ul,frame:Fl,stft:Vl}),Wl=function(e,t,n){return void 0===n&&(n=1),s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,d,p,h,f,m,y,b;return u(this,(function(u){switch(u.label){case 0:return r=cn(e,"predictions","inTopK"),i=cn(t,"targets","inTopK"),v(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),v(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),g(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],v(n>0&&n<=a,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n})),[4,r.data()];case 1:return o=u.sent(),[4,i.data()];case 2:for(s=u.sent(),c=[o.length/a,a],d=c[1],p=A("bool",l=c[0]),h=0;h<l;h++){for(f=h*d,m=o.subarray(f,f+d),y=[],b=0;b<m.length;b++)y.push({value:m[b],index:b});for(y.sort((function(e,t){return t.value-e.value})),p[h]=0,b=0;b<n;b++)if(y[b].index===s[h]){p[h]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Sn(p,i.shape,"bool")]}}))}))};!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(jl||(jl={}));var zl=wn({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=jl.SUM_BY_NONZERO_WEIGHTS);var i=cn(e,"labels","absoluteDifference"),a=cn(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=cn(n,"weights","absoluteDifference")),g(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return Gl(s,o,r)}}),Gl=wn({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=jl.SUM_BY_NONZERO_WEIGHTS);var r=cn(e,"losses","computeWeightedLoss"),i=null;null!=t&&(i=cn(t,"weights","computeWeightedLoss"));var a=null==i?r:r.mul(i);if(n===jl.NONE)return a;if(n===jl.SUM)return a.sum();if(n===jl.MEAN){if(null==i)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(kn(o)):s}if(n===jl.SUM_BY_NONZERO_WEIGHTS){if(null==i)return a.sum().div(kn(r.size));var u=i.mul(Pn(r.shape)).notEqual(kn(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Hl=wn({cosineDistance_:function(e,t,n,r,i){void 0===i&&(i=jl.SUM_BY_NONZERO_WEIGHTS);var a=cn(e,"labels","cosineDistance"),o=cn(t,"predictions","cosineDistance"),s=null;null!=r&&(s=cn(r,"weights","cosineDistance")),g(a.shape,o.shape,"Error in cosineDistance: ");var u=kn(1).sub(a.mul(o).sum(n,!0));return Gl(u,s,i)}}),$l=wn({hingeLoss_:function(e,t,n,r){void 0===r&&(r=jl.SUM_BY_NONZERO_WEIGHTS);var i=cn(e,"labels","hingeLoss"),a=cn(t,"predictions","hingeLoss"),o=null;null!=n&&(o=cn(n,"weights","hingeLoss")),g(i.shape,a.shape,"Error in hingeLoss: ");var s=kn(1);i=kn(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return Gl(u,o,r)}}),Kl=wn({huberLoss_:function(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=jl.SUM_BY_NONZERO_WEIGHTS);var a=cn(e,"labels","huberLoss"),o=cn(t,"predictions","huberLoss"),s=null;null!=n&&(s=cn(n,"weights","huberLoss")),g(a.shape,o.shape,"Error in huberLoss: ");var u=kn(r),c=o.sub(a).abs(),l=Gu(c,u),d=c.sub(l),p=kn(.5).mul(l.square()).add(u.mul(d));return Gl(p,s,i)}}),Yl=wn({logLoss_:function(e,t,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=jl.SUM_BY_NONZERO_WEIGHTS);var a=cn(e,"labels","logLoss"),o=cn(t,"predictions","logLoss"),s=null;null!=n&&(s=cn(n,"weights","logLoss")),g(a.shape,o.shape,"Error in logLoss: ");var u=kn(1),c=kn(r),l=a.mul(o.add(c).log()).neg().sub(u.sub(a).mul(u.sub(o).add(c).log()));return Gl(l,s,i)}}),Xl=wn({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=jl.SUM_BY_NONZERO_WEIGHTS);var i=cn(e,"labels","meanSquaredError"),a=cn(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=cn(n,"weights","meanSquaredError")),g(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return Gl(s,o,r)}}),Jl=wn({sigmoidCrossEntropy_:function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=jl.SUM_BY_NONZERO_WEIGHTS);var a=cn(e,"multiClassLabels","sigmoidCrossEntropy"),o=cn(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=cn(n,"weights","sigmoidCrossEntropy")),g(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=kn(r),c=kn(1),l=kn(.5);a=a.mul(c.sub(u)).add(l.mul(u))}var d=function(e,t){var n=cn(e,"labels","sigmoidCrossEntropyWithLogits"),r=cn(t,"logits","sigmoidCrossEntropyWithLogits");g(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),a=r.mul(n),o=r.abs().neg().exp().log1p();return i.sub(a).add(o)}(a,o);return Gl(d,s,i)}}),Ql=wn({softmaxCrossEntropy_:function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=jl.SUM_BY_NONZERO_WEIGHTS);var a=cn(e,"onehotLabels","softmaxCrossEntropy"),o=cn(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=cn(n,"weights","softmaxCrossEntropy")),g(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=kn(r),c=kn(1),l=kn(a.shape[1]);a=a.mul(c.sub(u)).add(u.div(l))}var d=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return ei((function(e,t,r){var i=t.logSumExp([n],!0),a=t.toFloat().sub(i);return r([e,a]),{value:a.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],i=t[1],a=fn(e.shape,[n]);return[e.reshape(a).mul(r.toFloat().sub(i.exp())),e.reshape(a).mul(i.exp().sub(r.toFloat()))]}}}))(e,t)}(a,o);return Gl(d,s,i)}}),Zl=Object.freeze({get Reduction(){return jl},absoluteDifference:zl,computeWeightedLoss:Gl,cosineDistance:Hl,hingeLoss:$l,huberLoss:Kl,logLoss:Yl,meanSquaredError:Xl,sigmoidCrossEntropy:Jl,softmaxCrossEntropy:Ql});function ed(e,t){return void 0===t&&(t=!1),Ie.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=hr(n),a=e.clone(),o=On([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(e){var t,u=a,c=s,l=i;t=Ie.tidy((function(){var t=a.slice([e,e],[n-e,1]),u=t.norm(),c=a.slice([e,e],[1,1]),l=On([[-1]]).where(c.greater(0),On([[1]])),d=c.sub(l.mul(u)),p=t.div(d);s=1===p.shape[0]?o.clone():o.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0);var h=l.matMul(d).div(u).neg(),f=a.slice([e,0],[n-e,r]),m=h.mul(s);if(0===e)a=f.sub(m.matMul(s.transpose().matMul(f)));else{var v=f.sub(m.matMul(s.transpose().matMul(f)));a=a.slice([0,0],[e,r]).concat(v,0)}var g=i.slice([0,e],[n,i.shape[1]-e]);if(0===e)i=g.sub(g.matMul(s).matMul(m.transpose()));else{var y=g.sub(g.matMul(s).matMul(m.transpose()));i=i.slice([0,0],[n,e]).concat(y,1)}return[s,a,i]})),s=t[0],a=t[1],i=t[2],$t([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]}))}var td=wn({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,v(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){v(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},i=1;i<e.length;++i)r(i)}else t=!0,e=Hn(e,e.shape[0],0).map((function(e){return kr(e,[0])}));v(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var a=[],o=e,s=function(e){a.push(Ie.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=ll(a[n].mulStrict(t)).mul(a[n]);t=t.sub(r)}return t.div(_l(t,"euclidean"))})))};for(i=0;i<e.length;++i)s(i);return t?Rr(a,0):a}}),nd=wn({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return ed(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Ir(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach((function(e){var n=ed(e,t),r=n[0],o=n[1];i.push(r),a.push(o)})),[Rr(i,0).reshape(e.shape),Rr(a,0).reshape(e.shape)]}}),rd=Object.freeze({gramSchmidt:td,qr:nd});function id(e,t,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var a=e.shape[0];return n=Math.min(n,a),v(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),v(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),v(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),v(1===t.rank,(function(){return"scores must be a 1D tensor"})),v(t.shape[0]===a,(function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var ad=wn({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=cn(e,"images","resizeBilinear");v(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),v(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=Ie.runKernel((function(e,t){return t([i]),e.resizeBilinear(i,o,s,n)}),{batchImages:i},(function(e,t){return{batchImages:function(){return Ie.runKernel((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),od=wn({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=cn(e,"images","resizeNearestNeighbor");v(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),v(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),v("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=Ie.runKernel((function(e,t){return t([i]),e.resizeNearestNeighbor(i,o,s,n)}),{batchImages:i},(function(e,t){return{batchImages:function(){return Ie.runKernel((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),sd=wn({nonMaxSuppression_:function(e,t,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var a=cn(e,"boxes","nonMaxSuppression"),o=cn(t,"scores","nonMaxSuppression"),s=id(a,o,n,r,i);return n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,Ie.runKernel((function(e){return e.nonMaxSuppression(a,o,n,r,i)}),{$boxes:a})}}),ud=function(e,t,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),s(this,void 0,void 0,(function(){var a,o,s,c,l,d,p;return u(this,(function(u){switch(u.label){case 0:return a=cn(e,"boxes","nonMaxSuppressionAsync"),o=cn(t,"scores","nonMaxSuppressionAsync"),s=id(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return c=u.sent(),l=c[0],d=c[1],p=Oi(l,d,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,p]}}))}))},cd=wn({cropAndResize_:function(e,t,n,r,i,a){var o=cn(e,"image","cropAndResize","float32"),s=cn(t,"boxes","cropAndResize","float32"),u=cn(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var c=s.shape[0];return v(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),v(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),v(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),v(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),v(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),v("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),Ie.runKernel((function(e,t){return e.cropAndResize(o,s,u,r,i,a)}),{$image:o,$boxes:s})}}),ld=Object.freeze({resizeBilinear:ad,resizeNearestNeighbor:od,nonMaxSuppression:sd,nonMaxSuppressionAsync:ud,cropAndResize:cd}),dd=wn({matMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=void 0!==i&&i,o=e.transposeB,s=void 0!==o&&o,u=e.bias,c=e.activation,l=void 0===c?"linear":c,d=e.preluActivationWeights,p=cn(n,"a","fused matMul"),h=cn(r,"b","fused matMul");t=Ce(p,h),p=t[0],h=t[1];var f=a?p.shape[p.rank-2]:p.shape[p.rank-1],m=s?h.shape[h.rank-1]:h.shape[h.rank-2],g=a?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=p.shape.slice(0,-2),x=h.shape.slice(0,-2),T=_(b),C=_(x);v(p.rank>=2&&h.rank>=2&&p.rank===h.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+h.rank+"."})),v(w(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+h.shape+" must match."})),v(f===m,(function(){return"Error in fused matMul: inner shapes ("+f+") and ("+m+") of Tensors with shapes "+p.shape+" and "+h.shape+" and transposeA="+a+" and transposeB="+s+" must match."}));var S,E,k=p.shape.slice(0,-2).concat([g,y]),R=a?p.as3D(T,f,g):p.as3D(T,g,f),O=s?h.as3D(C,y,m):h.as3D(C,m,y);null!=u&&ui(k,(S=Ce(S=cn(u,"bias","fused matMul"),p)[0]).shape),null!=d&&(E=cn(d,"prelu weights","fused matMul"));var A={$a:R,$b:O};return null!=u&&(A.$bias=S),null!=d&&(A.$preluActivationWeights=E),Ie.runKernel((function(e,t){var n=e.fusedBatchMatMul({a:R,b:O,transposeA:a,transposeB:s,bias:S,activation:l,preluActivationWeights:E});return t([R,O,n]),n}),A,(function(e,t){var n,r=t[0],i=t[1],o=t[2];if(null==l||"linear"===l)n=e;else{if("relu"!==l)throw new Error("Gradient for activation "+l+" has not been implemented yet.");n=e.mul(o.step())}var c={};return null!=u&&(c={$bias:function(){var e=n,t=si(S.shape,n.shape);return t.length>0&&(e=e.sum(t)),e.reshape(S.shape)}}),a||s?!a&&s?Object.assign({$a:function(){return n.matMul(i,!1,!1)},$b:function(){return n.matMul(r,!0,!1)}},c):a&&!s?Object.assign({$a:function(){return i.matMul(n,!1,!0)},$b:function(){return r.matMul(n,!1,!1)}},c):Object.assign({$a:function(){return i.matMul(n,!0,!0)},$b:function(){return n.matMul(r,!0,!0)}},c):Object.assign({$a:function(){return n.matMul(i,!1,!0)},$b:function(){return r.matMul(n,!0,!1)}},c)})).reshape(k)}}),pd=wn({conv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=void 0===a?"NHWC":a,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,d=e.activation,p=void 0===d?"linear":d,h=e.preluActivationWeights,f=cn(t,"x","conv2d"),m=cn(n,"filter","conv2d"),g=f,y=!1;3===f.rank&&(y=!0,g=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),v(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),v(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=c&&v(x(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+i+"."})),v(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),v(bi(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),v("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var b,_,w=di(g.shape,m.shape,r,u,i,c);null!=l&&(b=Ce(b=cn(l,"bias","fused conv2d"),f)[0],ui(w.outShape,b.shape)),null!=h&&(_=cn(h,"prelu weights","fused conv2d"));var T={x:g,$filter:m};null!=l&&(T.$bias=b),null!=h&&(T.$preluActivationWeights=_);var C=Ie.runKernel((function(e,t){var n=e.fusedConv2d({input:g,filter:m,convInfo:w,bias:b,activation:p,preluActivationWeights:_});return t([m,g,n]),n}),T,(function(e,t){var n,a=t,o=a[0],s=a[1],c=a[2];if(null==p||"linear"===p)n=e;else{if("relu"!==p)throw new Error("Gradient for activation "+p+" has not been implemented yet.");n=e.mul(c.step())}v(yi(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var d={};return null!=l&&(d={$bias:function(){var e=n,t=si(b.shape,n.shape);return t.length>0&&(e=e.sum(t)),e.reshape(b.shape)}}),Object.assign({x:function(){return kc(s.shape,n,o,r,i)},$filter:function(){return Ec(s,n,o.shape,r,i)}},d)}));return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),hd=wn({depthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=(e.dataFormat,e.dilations),o=void 0===a?[1,1]:a,s=e.dimRoundingMode,u=e.bias,c=e.activation,l=void 0===c?"linear":c,d=e.preluActivationWeights,p=cn(t,"x","depthwiseConv2d"),h=cn(n,"filter","depthwiseConv2d"),f=p,m=!1;3===p.rank&&(m=!0,f=p.as4D(1,p.shape[0],p.shape[1],p.shape[2])),v(4===f.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."})),v(4===h.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+h.rank+"."})),v(f.shape[3]===h.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+h.shape[2]+"."})),null==o&&(o=[1,1]),v(bi(r,o),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),null!=s&&v(x(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+s+" but got pad "+i+"."}));var g,y,b=di(f.shape,h.shape,r,o,i,s,!0);null!=u&&(g=Ce(g=cn(u,"bias","fused conv2d"),p)[0],ui(b.outShape,g.shape)),null!=d&&(y=cn(d,"prelu weights","fused depthwiseConv2d"));var _={x:f,$filter:h};null!=u&&(_.$bias=g),null!=d&&(_.$preluActivationWeights=y);var w=Ie.runKernel((function(e,t){var n=e.fusedDepthwiseConv2D({input:f,filter:h,convInfo:b,bias:g,activation:l,preluActivationWeights:y});return t([f,h,n]),n}),_,(function(e,t){v(yi(o),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n,r=t[0],i=t[1],a=t[2];if(null==l||"linear"===l)n=e;else{if("relu"!==l)throw new Error("Gradient for activation "+l+" has not been implemented yet.");n=e.mul(a.step())}var s={};return null!=u&&(s={$bias:function(){var e=n,t=si(g.shape,n.shape);return t.length>0&&(e=e.sum(t)),e.reshape(g.shape)}}),Object.assign({x:function(){return Oc(r.shape,n,i,b)},$filter:function(){return Ac(r,n,i.shape,b)}},s)}));return m?w.as3D(w.shape[1],w.shape[2],w.shape[3]):w}}),fd=Object.freeze({matMul:dd,conv2d:pd,depthwiseConv2d:hd}),md=Object.freeze({image:ld,linalg:rd,losses:Zl,spectral:Il,fused:fd,signal:ql,conv1d:Tc,conv2d:Cc,conv3d:Sc,depthwiseConv2d:Rc,separableConv2d:Ic,conv2dTranspose:Nc,conv3dTranspose:Dc,op:wn,batchNormalization2d:xu,batchNormalization3d:Tu,batchNormalization4d:Cu,batchNormalization:Su,batchNorm:Eu,batchNorm2d:ku,batchNorm3d:Ru,batchNorm4d:Ou,booleanMaskAsync:bc,complex:xn,real:Tn,imag:Cn,concat:Vn,concat1d:qn,concat2d:Wn,concat3d:zn,concat4d:Gn,split:Hn,matMul:Pc,dot:Mc,outerProduct:Lc,reverse:jc,reverse1d:Bc,reverse2d:Uc,reverse3d:Fc,reverse4d:Vc,maxPool:zc,avgPool:Gc,pool:Hc,maxPool3d:$c,avgPool3d:Kc,slice:Yc,slice1d:Xc,slice2d:Jc,slice3d:Qc,slice4d:Zc,abs:Ms,acos:Ls,acosh:js,asin:Bs,asinh:Us,atan:Fs,atanh:Vs,ceil:qs,clipByValue:Ws,cos:zs,cosh:Gs,erf:Hs,exp:$s,expm1:Ks,floor:Ys,log:Xs,log1p:Js,logSigmoid:Qs,neg:Zs,reciprocal:eu,round:tu,rsqrt:nu,sigmoid:ru,sign:iu,isNaN:au,isInf:ou,isFinite:su,sin:uu,sinh:cu,softplus:lu,sqrt:du,square:pu,step:hu,tan:fu,tanh:mu,all:tl,any:nl,argMax:rl,argMin:il,logSumExp:al,max:ol,mean:sl,min:ul,moments:cl,sum:ll,prod:dl,equal:rc,equalStrict:ic,greater:ac,greaterEqual:oc,greaterEqualStrict:sc,greaterStrict:uc,less:cc,lessEqual:lc,lessEqualStrict:dc,lessStrict:pc,notEqual:hc,notEqualStrict:fc,add:Lu,addN:ju,addStrict:Bu,atan2:Uu,div:Fu,divStrict:Vu,floorDiv:qu,maximum:Wu,maximumStrict:zu,minimum:Gu,minimumStrict:Hu,mod:$u,modStrict:Ku,mul:Yu,mulStrict:Xu,pow:Ju,powStrict:Qu,squaredDifference:Zu,squaredDifferenceStrict:ec,sub:tc,subStrict:nc,elu:pl,leakyRelu:hl,prelu:fl,relu:ml,relu6:vl,selu:gl,logicalAnd:Au,logicalNot:Iu,logicalOr:Nu,logicalXor:Du,where:Pu,whereAsync:Mu,buffer:ar,print:or,batchToSpaceND:sr,cast:ur,clone:cr,cumsum:lr,depthToSpace:dr,expandDims:pr,eye:hr,multinomial:fr,oneHot:mr,pad:vr,pad1d:gr,pad2d:yr,pad3d:br,pad4d:_r,rand:wr,randomNormal:xr,randomGamma:Tr,randomUniform:Cr,reshape:Sr,spaceToBatchND:Er,squeeze:kr,stack:Rr,tile:Or,truncatedNormal:Ar,unstack:Ir,setdiff1dAsync:Nr,fill:Ln,linspace:jn,ones:Pn,range:Bn,scalar:kn,tensor:Sn,tensor1d:Rn,tensor2d:On,tensor3d:An,tensor4d:In,tensor5d:Nn,tensor6d:Dn,zeros:Mn,onesLike:Un,zerosLike:Fn,transpose:yl,softmax:ni,logSoftmax:ri,localResponseNormalization:bl,norm:_l,gather:gc,unsortedSegmentSum:yc,basicLSTMCell:wl,multiRNNCell:xl,movingAverage:Tl,stridedSlice:Cl,topk:Sl,scatterND:El,fft:kl,ifft:Rl,rfft:Ol,irfft:Al,sparseToDense:Nl,gatherND:Dl,diag:Pl,dropout:Ml,hannWindow:Bl,hammingWindow:Ul,frame:Fl,stft:Vl,inTopKAsync:Wl});function vd(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var gd=function(){function e(){if(this.blockSize=48,this.firstUse=!0,l().get("IS_BROWSER")){var e="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==e&&(this.fromPixels2DContext=e.getContext("2d"))}this.data=new ii(this,Ie)}return e.prototype.register=function(e,t,n){if(this.firstUse&&(this.firstUse=!1,l().get("IS_NODE")&&on("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(e))throw new Error("Data buffer is already registered");this.data.set(e,{dtype:n})},e.prototype.write=function(e,t){if(null==t)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(e).values=t},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,i=e.data instanceof Uint8Array,a="undefined"!=typeof ImageData&&e instanceof ImageData,o="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement,u=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=u[0],d=u[1];if(l().get("IS_NODE")&&null==e.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=e.getContext)n=e.getContext("2d").getImageData(0,0,c,d).data;else if(a||i)n=e.data;else{if(!s&&!o)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=d,this.fromPixels2DContext.drawImage(e,0,0,c,d),n=this.fromPixels2DContext.getImageData(0,0,c,d).data}if(4===t)r=new Int32Array(n);else{var p=c*d;r=new Int32Array(p*t);for(var h=0;h<p;h++)for(var f=0;f<t;++f)r[h*t+f]=n[4*h+f]}return An(r,[d,c,t],"int32")},e.prototype.read=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.readSync(e)]}))}))},e.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?Si(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},e.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Q(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return ar(e.shape,e.dtype,n)},e.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},e.prototype.time=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return t=Y(),e(),[2,{kernelMs:Y()-t}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(e,t){var n=he.make(e.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:Ie.keep(e.clone()),imag:Ie.keep(t.clone())},n},e.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},e.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},e.prototype.assertNotComplex=function(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&v("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))},e.prototype.slice=function(e,t,n){if(this.assertNotComplex(e,"slice"),$r(e.shape,t,n)){var r=Kr(t,e.strides),i=_(n);return Sn(this.readSync(e.dataId).subarray(r,r+i),n,e.dtype)}for(var a=ar(n,e.dtype),o=this.bufferSync(e),s=0;s<a.size;++s){var u=a.indexToLoc(s).map((function(e,n){return e+t[n]}));a.values[s]=o.get.apply(o,u)}return a.toTensor()},e.prototype.stridedSlice=function(e,t,n,r){this.assertNotComplex(e,"stridedSlice");var i=zr(t,n,r);if(i.some((function(e){return 0===e})))return Sn([],i);for(var a=ar(i,e.dtype),o=this.bufferSync(e),s=0;s<a.size;s++){for(var u=a.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+t[l];a.set.apply(a,[o.get.apply(o,c)].concat(u))}return a.toTensor()},e.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=ar([e.size,e.size],e.dtype),r=n.values,i=0;i<t.length;i++)r[i*e.size+i]=t[i];return n.toTensor()},e.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),i=0,a=0;a<e.rank;a++)a!==t&&(r[i++]=e.shape[a]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(a=0;a<u.length;a++)o[t]=a,u[a]=this.slice(e,o,s).reshape(r);return u},e.prototype.reverse=function(e,t){this.assertNotComplex(e,"reverse");for(var n=ar(e.shape,e.dtype),r=this.bufferSync(e),i=function(i){var a=n.indexToLoc(i),o=a.slice();t.forEach((function(t){return o[t]=e.shape[t]-1-o[t]})),n.set.apply(n,[r.get.apply(r,o)].concat(a))},a=0;a<n.size;a++)i(a);return n.toTensor()},e.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return Tn(e)})),i=e.map((function(e){return Cn(e)}));return xn(this.concat(r,t),this.concat(i,t))}var a=e.map((function(e){var n=_(e.shape.slice(t));return e.as2D(-1,n)})),o=_n(a.map((function(e){return e.shape})),1),s=ar(o,e[0].dtype).values;if(1===a[0].shape[0]){var u=0;a.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var c=0;a.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,i=0;i<e.shape[0];++i)for(var a=i*o[1]+c,u=0;u<e.shape[1];++u)s[a+u]=t[r++];c+=e.shape[1]}))}var l=_n(e.map((function(e){return e.shape})),t);return Sn(s,l,e[0].dtype)},e.prototype.neg=function(e){return this.assertNotComplex(e,"neg"),this.multiply(kn(-1),e)},e.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,xe(e.dtype,t.dtype),(function(e,t){return e+t}))},e.prototype.addN=function(e){var t=this;this.assertNotComplex(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=ar(e[0].shape,e[0].dtype),i=r.values,a=0;a<e.length;a++)for(var o=n[a],s=0;s<i.length;s++)i[s]+=o[s];return r.toTensor()},e.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,xe(e.dtype,t.dtype),(function(e,t){return e-t}))},e.prototype.pow=function(e,t){return this.assertNotComplex([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},e.prototype.batchMatMul=function(e,t,n,r){this.assertNotComplex([e,t],"matMul");for(var i=n?e.shape[1]:e.shape[2],a=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],d=l[0],p=l[1],h=l[2],f=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],m=f[0],v=f[1],g=f[2],y=a*o,b=ar([s,a,o],e.dtype),_=b.values,w=this.blockSize,x=0;x<s;x++)for(var T=0;T<a;T+=w)for(var C=0;C<o;C+=w)for(var S=0;S<i;S+=w)for(var E=Math.min(T+w,a),k=Math.min(C+w,o),R=Math.min(S+w,i),O=T;O<E;O++)for(var A=C;A<k;A++){for(var I=0,N=S;N<R;N++)I+=u[x*d+O*p+N*h]*c[N*m+A*v+x*g];_[x*y+(O*o+A)]+=I}return b.toTensor()},e.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,i=e.transposeB,a=e.bias,o=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,i);return a&&(u=this.add(u,a)),o&&(u=vd(this,u,o,s)),u},e.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,xe(e.dtype,t.dtype),(function(e,t){return e*t}))},e.prototype.realDivide=function(e,t){return this.assertNotComplex([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",(function(e,t){return e/t}))},e.prototype.floorDiv=function(e,t){return this.assertNotComplex([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},e.prototype.sum=function(e,t){this.assertNotComplex(e,"sum"),mn("sum",t,e.rank);for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,xe(e.dtype,"int32")),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=0,p=0;p<o;++p)d+=u[l+p];s[c]=d}return a},e.prototype.prod=function(e,t){this.assertNotComplex(e,"sum");for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,xe(e.dtype,"int32")),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=1,p=0;p<o;++p)d*=u[l+p];s[c]=d}return a},e.prototype.unsortedSegmentSum=function(e,t,n){this.assertNotComplex(e,"unsortedSegmentSum");for(var r=[],i=e.rank-t.rank,a=0;a<i;++a)t=t.expandDims(a+1);for(a=0;a<n;++a){var o=kn(a,"int32"),s=rc(o,t).asType("float32").mul(e).sum(0);r.push(s)}return Rr(r)},e.prototype.argMin=function(e,t){this.assertNotComplex(e,"argMin");var n=[t];mn("argMin",n,e.rank);for(var r=hn(e.shape,n),i=r[0],a=r[1],o=Mn(i,"int32"),s=_(a),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var d=l*s,p=c[d],h=0,f=0;f<s;++f){var m=c[d+f];m<p&&(p=m,h=f)}u[l]=h}return o},e.prototype.argMax=function(e,t){this.assertNotComplex(e,"argMax");var n=[t];mn("argMax",n,e.rank);for(var r=hn(e.shape,n),i=r[0],a=r[1],o=Mn(i,"int32"),s=_(a),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var d=l*s,p=c[d],h=0,f=0;f<s;++f){var m=c[d+f];m>p&&(p=m,h=f)}u[l]=h}return o},e.prototype.cumsum=function(e,t,n,r){if(this.assertNotComplex(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var i=xe(e.dtype,"int32"),a=Mn(e.shape,i),o=this.readSync(a.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var d=0;d<u;d++){var p=c(l,d);if(0===d)o[p]=n?0:s[p];else{var h=c(l,d-1);o[p]=n?s[h]+o[h]:s[p]+o[h]}}return a},e.prototype.equal=function(e,t){return this.assertNotComplex([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},e.prototype.notEqual=function(e,t){return this.assertNotComplex([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},e.prototype.less=function(e,t){return this.assertNotComplex([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},e.prototype.lessEqual=function(e,t){return this.assertNotComplex([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},e.prototype.greater=function(e,t){return this.assertNotComplex([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},e.prototype.greaterEqual=function(e,t){return this.assertNotComplex([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},e.prototype.logicalNot=function(e){this.assertNotComplex(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return he.make(e.shape,{values:n},"bool")},e.prototype.logicalAnd=function(e,t){return this.assertNotComplex([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},e.prototype.logicalOr=function(e,t){return this.assertNotComplex([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},e.prototype.select=function(e,t,n){this.assertNotComplex([e,t,n],"select");for(var r=this.readSync(e.dataId),i=this.readSync(t.dataId),a=this.readSync(n.dataId),o=Mn(t.shape,xe(t.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===e.rank||e.rank>1||1===t.rank?1:_(t.shape.slice(1)),l=0;l<r.length;l++)for(var d=0;d<c;d++)1===r[l]?s[u++]=i[l]:s[u++]=a[l];return o},e.prototype.where=function(e){this.assertNotComplex([e],"where");var t=this.readSync(e.dataId);return Pi(e.shape,t)},e.prototype.topk=function(e,t,n){return this.assertNotComplex(e,"topk"),Di(this.readSync(e.dataId),e.shape,e.dtype,t)},e.prototype.min=function(e,t){this.assertNotComplex(e,"min"),mn("min",t,e.rank);for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,e.dtype),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],p=0;p<o;++p){var h=u[l+p];h<d&&(d=h)}s[c]=d}return a},e.prototype.minimum=function(e,t){return this.assertNotComplex([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},e.prototype.mod=function(e,t){return this.assertNotComplex([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},e.prototype.max=function(e,t){this.assertNotComplex(e,"max"),mn("max",t,e.rank);for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,e.dtype),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],p=0;p<o;++p){var h=u[l+p];h>d&&(d=h)}s[c]=d}return a},e.prototype.maximum=function(e,t){return this.assertNotComplex([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},e.prototype.all=function(e,t){this.assertNotComplex(e,"all"),mn("all",t,e.rank);for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,e.dtype),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],p=0;p<o;++p){var h=u[l+p];d=d&&h}s[c]=d}return a},e.prototype.any=function(e,t){this.assertNotComplex(e,"any"),mn("any",t,e.rank);for(var n=hn(e.shape,t),r=n[0],i=n[1],a=Mn(r,e.dtype),o=_(i),s=this.readSync(a.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],p=0;p<o;++p){var h=u[l+p];d=d||h}s[c]=d}return a},e.prototype.squaredDifference=function(e,t){return this.assertNotComplex([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},e.prototype.ceil=function(e){this.assertNotComplex(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return he.make(e.shape,{values:n})},e.prototype.floor=function(e){this.assertNotComplex(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return he.make(e.shape,{values:n})},e.prototype.sign=function(e){this.assertNotComplex(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return he.make(e.shape,{values:n})},e.prototype.isNaN=function(e){this.assertNotComplex(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return he.make(e.shape,{values:n},"bool")},e.prototype.isInf=function(e){this.assertNotComplex(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return he.make(e.shape,{values:n},"bool")},e.prototype.isFinite=function(e){this.assertNotComplex(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return he.make(e.shape,{values:n},"bool")},e.prototype.round=function(e){this.assertNotComplex(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=Math.floor(t[r]);t[r]-i<.5?n[r]=Math.floor(t[r]):t[r]-i>.5?n[r]=Math.ceil(t[r]):n[r]=i%2==0?i:i+1}return he.make(e.shape,{values:n})},e.prototype.exp=function(e){this.assertNotComplex(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return he.make(e.shape,{values:n})},e.prototype.expm1=function(e){this.assertNotComplex(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return he.make(e.shape,{values:n})},e.prototype.log=function(e){this.assertNotComplex(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.log(i)}return he.make(e.shape,{values:n})},e.prototype.log1p=function(e){this.assertNotComplex(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.log1p(i)}return he.make(e.shape,{values:n})},e.prototype.sqrt=function(e){this.assertNotComplex(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=Math.sqrt(i)}return he.make(e.shape,{values:n})},e.prototype.rsqrt=function(e){this.assertNotComplex(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=1/Math.sqrt(i)}return he.make(e.shape,{values:n})},e.prototype.square=function(e){this.assertNotComplex(e,"square");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var i=t[r];n[r]=i*i}return he.make(e.shape,{values:n})},e.prototype.reciprocal=function(e){this.assertNotComplex(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return he.make(e.shape,{values:n})},e.prototype.linear=function(e){return e},e.prototype.relu=function(e){this.assertNotComplex(e,"relu");for(var t=Mn(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return t},e.prototype.relu6=function(e){this.assertNotComplex(e,"relu");for(var t=Mn(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return t},e.prototype.prelu=function(e,t){return this.assertNotComplex([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},e.prototype.elu=function(e){this.assertNotComplex(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var i=n[r];t[r]=i>=0?i:Math.exp(i)-1}return he.make(e.shape,{values:t})},e.prototype.eluDer=function(e,t){this.assertNotComplex([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=this.readSync(e.dataId),a=0;a<r.length;++a){var o=r[a];n[a]=o>=1?i[a]:i[a]*(o+1)}return he.make(t.shape,{values:n})},e.prototype.selu=function(e){this.assertNotComplex(e,"selu");for(var t=ts,n=ns,r=new Float32Array(e.size),i=this.readSync(e.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?n*o:t*(Math.exp(o)-1)}return he.make(e.shape,{values:r})},e.prototype.clip=function(e,t,n){this.assertNotComplex(e,"clip");for(var r=new Float32Array(e.size),i=this.readSync(e.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>n?n:o<t?t:o}return he.make(e.shape,{values:r})},e.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return he.make(e.shape,{values:t})},e.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var i=n[2*r],a=n[2*r+1];t[r]=Math.hypot(i,a)}return he.make(e.shape,{values:t})},e.prototype.int=function(e){this.assertNotComplex(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return he.make(e.shape,{values:t},"int32")},e.prototype.sigmoid=function(e){this.assertNotComplex(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return he.make(e.shape,{values:t})},e.prototype.softplus=function(e){this.assertNotComplex(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),i=0;i<r.length;++i){var a=r[i]>-t,o=r[i]<t,s=Math.exp(r[i]),u=void 0;u=o?s:a?r[i]:Math.log(1+s),n[i]=u}return he.make(e.shape,{values:n})},e.prototype.sin=function(e){this.assertNotComplex(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return he.make(e.shape,{values:t})},e.prototype.cos=function(e){this.assertNotComplex(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return he.make(e.shape,{values:t})},e.prototype.tan=function(e){this.assertNotComplex(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return he.make(e.shape,{values:t})},e.prototype.asin=function(e){this.assertNotComplex(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return he.make(e.shape,{values:t})},e.prototype.acos=function(e){this.assertNotComplex(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return he.make(e.shape,{values:t})},e.prototype.atan=function(e){this.assertNotComplex(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return he.make(e.shape,{values:t})},e.prototype.atan2=function(e,t){return this.assertNotComplex([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},e.prototype.sinh=function(e){this.assertNotComplex(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return he.make(e.shape,{values:t})},e.prototype.cosh=function(e){this.assertNotComplex(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return he.make(e.shape,{values:t})},e.prototype.tanh=function(e){this.assertNotComplex(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=T(n[r]);return he.make(e.shape,{values:t})},e.prototype.asinh=function(e){this.assertNotComplex(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return he.make(e.shape,{values:t})},e.prototype.acosh=function(e){this.assertNotComplex(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return he.make(e.shape,{values:t})},e.prototype.atanh=function(e){this.assertNotComplex(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return he.make(e.shape,{values:t})},e.prototype.erf=function(e){this.assertNotComplex(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),a=Math.abs(n[r]),o=1/(1+.3275911*a);t[r]=i*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-a*a))}return he.make(e.shape,{values:t})},e.prototype.step=function(e,t){void 0===t&&(t=0),this.assertNotComplex(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=0;i<r.length;++i){var a=r[i];isNaN(a)?n[i]=NaN:n[i]=a>0?1:t}return he.make(e.shape,{values:n})},e.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,a=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return i&&(s=this.add(s,i)),a&&(s=vd(this,s,a,o)),s},e.prototype.conv2d=function(e,t,n){this.assertNotComplex([e,t],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=ar(n.outShape,e.dtype),d=e.strides[0],p=c?e.strides[1]:e.strides[2],h=c?e.strides[2]:1,f=c?1:e.strides[1],m=l.strides[0],v=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(e.dataId),_=this.readSync(t.dataId),w=l.values,x=0;x<n.batchSize;++x)for(var T=x*d,C=x*m,S=0;S<n.outHeight;++S)for(var E=C+S*v,k=S*n.strideHeight-u,R=0;R<r;R++){var O=k+R*a;if(!(O<0||O>=n.inHeight))for(var A=R*t.strides[0],I=T+O*p,N=0;N<n.outWidth;++N)for(var D=E+N*g,P=N*n.strideWidth-s,M=0;M<i;M++){var L=P+M*o;if(!(L<0||L>=n.inWidth))for(var j=I+L*h,B=A+M*t.strides[1],U=0;U<n.inChannels;++U){for(var F=b[j+U*f],V=0;V<n.outChannels;++V)w[D+V*y]+=F*_[B+V];B+=n.outChannels}}}return l.toTensor()},e.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,i=n.filterHeight,a=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,d=n.padInfo.top,p=ar(n.outShape,e.dtype),h=this.readSync(e.dataId),f=this.readSync(t.dataId),m=p.values,v=0;v<n.batchSize;++v)for(var g=v*e.strides[0],y=v*p.strides[0],b=0;b<n.outDepth;++b)for(var _=y+b*p.strides[1],w=b*n.strideDepth-c,x=0;x<r;x++){var T=w+x*o;if(!(T<0||T>=n.inDepth))for(var C=x*t.strides[0],S=g+T*e.strides[1],E=0;E<n.outHeight;++E)for(var k=_+E*p.strides[2],R=E*n.strideHeight-d,O=0;O<i;O++){var A=R+O*s;if(!(A<0||A>=n.inHeight))for(var I=C+O*t.strides[1],N=S+A*e.strides[2],D=0;D<n.outWidth;++D)for(var P=k+D*n.outChannels,M=D*n.strideWidth-l,L=0;L<a;L++){var j=M+L*u;if(!(j<0||j>=n.inWidth))for(var B=I+L*t.strides[2],U=N+j*n.inChannels,F=B,V=0;V<n.inChannels;++V){for(var q=h[U+V],W=0;W<n.outChannels;++W)m[P+W]+=q*f[F+W];F+=n.outChannels}}}}return p.toTensor()},e.prototype.conv2dDerInput=function(e,t,n){this.assertNotComplex([e,t],"conv2dDerInput");for(var r=ar(n.inShape,"float32"),i=r.values,a=this.readSync(e.dataId),o=this.readSync(t.dataId),s=t.strides,u=s[0],c=s[1],l=s[2],d=n.batchSize,p=n.filterHeight,h=n.filterWidth,f=n.inChannels,m=n.inHeight,v=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,_=n.strideHeight,w=n.strideWidth,x=n.dataFormat,T=p-1-n.padInfo.top,C=h-1-n.padInfo.left,S="channelsLast"===x,E=r.strides[0],k=S?r.strides[1]:r.strides[2],R=S?r.strides[2]:1,O=S?1:r.strides[1],A=e.strides[0],I=S?e.strides[1]:e.strides[2],N=S?e.strides[2]:1,D=S?1:e.strides[1],P=0;P<d;++P)for(var M=0;M<f;++M)for(var L=0;L<m;++L)for(var j=L-T,B=Math.max(0,Math.ceil(j/_)),U=Math.min(y,(p+j)/_),F=0;F<v;++F){for(var V=F-C,q=Math.max(0,Math.ceil(V/w)),W=Math.min(b,(h+V)/w),z=0,G=B;G<U;++G)for(var H=G*_-j,$=q;$<W;++$)for(var K=A*P+I*G+N*$,Y=u*(p-1-H)+c*(h-1-($*w-V))+l*M,X=0;X<g;++X)z+=a[K+D*X]*o[Y+X];i[E*P+k*L+R*F+O*M]=z}return r.toTensor()},e.prototype.conv3dDerInput=function(e,t,n){for(var r=ar(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],u=a[2],c=a[3],l=this.readSync(e.dataId),d=e.strides,p=d[0],h=d[1],f=d[2],m=d[3],v=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=n.batchSize,T=n.filterDepth,C=n.filterHeight,S=n.filterWidth,E=n.inChannels,k=n.inDepth,R=n.inHeight,O=n.inWidth,A=n.outChannels,I=n.outDepth,N=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,L=n.strideWidth,j=T-1-n.padInfo.front,B=C-1-n.padInfo.top,U=S-1-n.padInfo.left,F=0;F<x;++F)for(var V=0;V<E;++V)for(var q=0;q<k;++q)for(var W=q-j,z=Math.max(0,Math.ceil(W/P)),G=Math.min(I,(T+W)/P),H=0;H<R;++H)for(var $=H-B,K=Math.max(0,Math.ceil($/M)),Y=Math.min(N,(C+$)/M),X=0;X<O;++X){for(var J=X-U,Q=Math.max(0,Math.ceil(J/L)),Z=Math.min(D,(S+J)/L),ee=0,te=z;te<G;++te)for(var ne=te*P-W,re=K;re<Y;++re)for(var ie=re*M-$,ae=Q;ae<Z;++ae)for(var oe=p*F+h*te+f*re+m*ae,se=y*(T-1-ne)+b*(C-1-ie)+_*(S-1-(ae*L-J))+w*V,ue=0;ue<A;++ue)ee+=l[oe+ue]*v[se+ue];i[o*F+s*q+u*H+c*X+V]=ee}return r.toTensor()},e.prototype.conv2dDerFilter=function(e,t,n){this.assertNotComplex([e,t],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=ar(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,d=this.bufferSync(e),p=this.bufferSync(t),h=0;h<a;++h)for(var f=Math.max(0,Math.ceil((l-h)/r)),m=Math.min(n.outHeight,(n.inHeight+l-h)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((c-v)/i)),y=Math.min(n.outWidth,(n.inWidth+c-v)/i),b=0;b<n.inChannels;++b)for(var _=0;_<n.outChannels;++_){for(var w=0,x=0;x<n.batchSize;++x)for(var T=f;T<m;++T)for(var C=h+T*r-l,S=g;S<y;++S){var E=v+S*i-c;w+=s?d.get(x,C,E,b)*p.get(x,T,S,_):d.get(x,b,C,E)*p.get(x,_,T,S)}u.set(w,h,v,b,_)}return u.toTensor()},e.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=ar(n.filterShape,"float32"),l=c.values,d=c.strides,p=d[0],h=d[1],f=d[2],m=d[3],v=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],_=g[2],w=g[3],x=this.readSync(e.dataId),T=e.strides,C=T[0],S=T[1],E=T[2],k=T[3],R=n.padInfo.front,O=n.padInfo.left,A=n.padInfo.top,I=0;I<o;++I)for(var N=Math.max(0,Math.ceil((R-I)/r)),D=Math.min(n.outDepth,(n.inDepth+R-I)/r),P=I*p,M=0;M<s;++M)for(var L=Math.max(0,Math.ceil((A-M)/i)),j=Math.min(n.outHeight,(n.inHeight+A-M)/i),B=M*h+P,U=0;U<u;++U)for(var F=Math.max(0,Math.ceil((O-U)/a)),V=Math.min(n.outWidth,(n.inWidth+O-U)/a),q=U*f+B,W=0;W<n.inChannels;++W)for(var z=W*m+q,G=0;G<n.outChannels;++G){for(var H=0,$=0;$<n.batchSize;++$)for(var K=$*C,Y=$*y,X=N;X<D;++X)for(var J=(I+X*r-R)*S+K,Q=X*b+Y,Z=L;Z<j;++Z)for(var ee=(M+Z*i-A)*E+J,te=Z*_+Q,ne=F;ne<V;++ne){var re=ne*w+te;H+=x[(U+ne*a-O)*k+ee+W]*v[re+G]}l[z+G]=H}return c.toTensor()},e.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,i=e.bias,a=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return i&&(s=this.add(s,i)),a&&(s=vd(this,s,a,o)),s},e.prototype.depthwiseConv2D=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=ar(n.outShape,e.dtype),d=this.readSync(e.dataId),p=this.readSync(t.dataId),h=l.values,f=0;f<n.batchSize;++f)for(var m=f*e.strides[0],v=f*l.strides[0],g=0;g<n.outHeight;++g)for(var y=v+g*l.strides[1],b=g*n.strideHeight-s,_=0;_<r;++_){var w=b+_*a;if(!(w<0||w>=n.inHeight))for(var x=_*t.strides[0],T=m+w*e.strides[1],C=0;C<n.outWidth;++C)for(var S=y+C*l.strides[2],E=C*n.strideWidth-u,k=0;k<i;++k){var R=E+k*o;if(!(R<0||R>=n.inWidth))for(var O=x+k*t.strides[1],A=T+R*n.inChannels,I=S,N=O,D=0;D<n.inChannels;++D){for(var P=d[A+D],M=0;M<c;++M)h[I+M]+=P*p[N+M];I+=c,N+=c}}}return l.toTensor()},e.prototype.depthwiseConv2DDerInput=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2DDerInput");for(var r=ar(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],u=a[2],c=this.readSync(e.dataId),l=e.strides,d=l[0],p=l[1],h=l[2],f=this.readSync(t.dataId),m=t.strides,v=m[0],g=m[1],y=m[2],b=n.batchSize,_=n.filterHeight,w=n.filterWidth,x=n.inChannels,T=n.inHeight,C=n.inWidth,S=n.outChannels,E=n.outHeight,k=n.outWidth,R=n.strideHeight,O=n.strideWidth,A=_-1-n.padInfo.top,I=w-1-n.padInfo.left,N=S/x,D=0;D<b;++D)for(var P=0;P<x;++P)for(var M=0;M<T;++M)for(var L=M-A,j=Math.max(0,Math.ceil(L/R)),B=Math.min(E,(_+L)/R),U=0;U<C;++U){for(var F=U-I,V=Math.max(0,Math.ceil(F/O)),q=Math.min(k,(w+F)/O),W=0,z=j;z<B;++z)for(var G=z*R-L,H=V;H<q;++H)for(var $=d*D+p*z+h*H,K=v*(_-1-G)+g*(w-1-(H*O-F))+y*P,Y=0;Y<N;++Y)W+=c[$+(P*N+Y)]*f[K+Y];i[o*D+s*M+u*U+P]=W}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){this.assertNotComplex([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=ar(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,d=this.bufferSync(e),p=this.bufferSync(t),h=0;h<a;++h)for(var f=Math.max(0,Math.ceil((c-h)/r)),m=Math.min(n.outHeight,(n.inHeight+c-h)/r),v=0;v<o;++v)for(var g=Math.max(0,Math.ceil((u-v)/i)),y=Math.min(n.outWidth,(n.inWidth+u-v)/i),b=0;b<n.outChannels;++b){for(var _=Math.trunc(b/l),w=b%l,x=0,T=0;T<n.batchSize;++T)for(var C=f;C<m;++C)for(var S=h+C*r-c,E=g;E<y;++E){var k=v+E*i-u;x+=d.get(T,S,k,_)*p.get(T,C,E,b)}s.set(x,h,v,_,w)}return s.toTensor()},e.prototype.tile=function(e,t){return this.assertNotComplex(e,"tile"),Ni(this.bufferSync(e),t)},e.prototype.pad=function(e,t,n){this.assertNotComplex(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),i=t.map((function(e){return e[0]})),a=this.bufferSync(e),o=ar(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var u=a.indexToLoc(s),c=u.map((function(e,t){return e+i[t]}));o.set.apply(o,[a.get.apply(a,u)].concat(c))}return o.toTensor()},e.prototype.transpose=function(e,t){this.assertNotComplex(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var i=this.readSync(e.dataId),a=ar(n,e.dtype),o=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=o.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[t[c]];var l=a.locToIndex(u);a.values[l]=i[r]}return a.toTensor()},e.prototype.gather=function(e,t,n){this.assertNotComplex([e,t],"gather");var r=e.shape.slice(),i=this.readSync(t.dataId);r[n]=i.length;for(var a=ar(r,e.dtype),o=this.bufferSync(e),s=0;s<a.size;++s){var u=a.indexToLoc(s),c=u.slice();c[n]=i[u[n]];var l=o.locToIndex(c);a.values[s]=o.values[l]}return a.toTensor()},e.prototype.batchToSpaceND=function(e,t,n){this.assertNotComplex([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),i=Dr(e.shape,t,r),a=Pr(i.length,t.length),o=Mr(e.shape,t,r),s=Lr(n,t.length),u=jr(o,n,t.length);return e.reshape(i).transpose(a).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(e,t,n){this.assertNotComplex([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),i=[[0,0]];i.push.apply(i,n);for(var a=1+t.length;a<e.shape.length;++a)i.push([0,0]);var o=e.pad(i),s=Dr(o.shape,t,r,!1),u=Pr(s.length,t.length,!1),c=Mr(o.shape,t,r,!1);return o.reshape(s).transpose(u).reshape(c)},e.prototype.pool=function(e,t,n){this.assertNotComplex(e,"pool");for(var r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,d="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(e.dataId),h=ar(t.outShape,e.dtype),f=h.values,m=t.outShape[1]*t.outShape[2]*t.outShape[3],v=t.outShape[2]*t.outShape[3],g=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*m,_=y*e.strides[0],w=0;w<t.inChannels;++w)for(var x=0;x<t.outHeight;++x)for(var T=x*r-c,C=Math.max(0,T),S=Math.min(t.inHeight,s+T),E=b+x*v,k=0;k<t.outWidth;++k){for(var R=k*i-l,O=Math.max(0,R),A=Math.min(t.inWidth,u+R),I=d,N=0,D=0,P=C;P<S;P+=a){for(var M=_+P*e.strides[1],L=O;L<A;L+=o){var j=p[M+L*e.strides[2]+w];"max"===n&&j>I?I=j:"avg"===n&&(N+=j,D++)}if(isNaN(I))break}f[E+k*g+w]="avg"===n?N/D:I}return h.toTensor()},e.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},e.prototype.maxPoolPositions=function(e,t){for(var n=ar(t.outShape,"int32"),r=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,d=this.bufferSync(e),p=0;p<t.batchSize;++p)for(var h=0;h<t.inChannels;++h)for(var f=0;f<t.outHeight;++f){for(var m=f*r-c,v=m;v<0;)v+=a;for(var g=Math.min(t.inHeight,s+m),y=0;y<t.outWidth;++y){for(var b=y*i-l,_=b;_<0;)_+=o;for(var w=Math.min(t.inWidth,u+b),x=Number.NEGATIVE_INFINITY,T=-1,C=v;C<g;C+=a)for(var S=C-m,E=_;E<w;E+=o){var k=E-b,R=d.get(p,C,E,h);R>x&&(x=R,T=S*u+k)}n.set(T,p,f,y,h)}}return n.toTensor()},e.prototype.maxPoolBackprop=function(e,t,n,r){this.assertNotComplex([t,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(t,r),a=r.strideHeight,o=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,d=l-1-r.padInfo.left,p=c-1-r.padInfo.top,h=ar(t.shape,"float32"),f=this.bufferSync(i),m=this.bufferSync(e),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var _=y-p,w=b-d,x=0,T=0;T<c;T+=s){var C=(_+T)/a;if(!(C<0||C>=r.outHeight||Math.floor(C)!==C))for(var S=0;S<l;S+=u){var E=(w+S)/o;if(!(E<0||E>=r.outWidth||Math.floor(E)!==E)){var k=c*l-1-f.get(v,C,E,g)===T*l+S?1:0;0!==k&&(x+=m.get(v,C,E,g)*k)}}}h.set(x,v,y,b,g)}return h.toTensor()},e.prototype.avgPoolBackprop=function(e,t,n){this.assertNotComplex([e,t],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,d=l-1-n.padInfo.left,p=c-1-n.padInfo.top,h=ar(t.shape,"float32"),f=1/(a*o),m=this.bufferSync(e),v=0;v<n.batchSize;++v)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var _=y-p,w=b-d,x=0,T=0;T<c;T+=s){var C=(_+T)/r;if(!(C<0||C>=n.outHeight||Math.floor(C)!==C))for(var S=0;S<l;S+=u){var E=(w+S)/i;E<0||E>=n.outWidth||Math.floor(E)!==E||(x+=m.get(v,C,E,g))}}h.set(x*f,v,y,b,g)}return h.toTensor()},e.prototype.pool3d=function(e,t,n){this.assertNotComplex(e,"pool3d");for(var r=t.strideDepth,i=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(e.dataId),g=ar(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],_=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],x=t.outShape[4],T=0;T<t.batchSize;++T)for(var C=T*b,S=T*e.strides[0],E=0;E<t.inChannels;++E)for(var k=0;k<t.outDepth;++k){for(var R=k*r-p,O=R;O<0;)O+=o;for(var A=Math.min(t.inDepth,c+R),I=C+k*_,N=0;N<t.outHeight;++N){for(var D=N*i-h,P=D;P<0;)P+=s;for(var M=Math.min(t.inHeight,l+D),L=I+N*w,j=0;j<t.outWidth;++j){for(var B=j*a-f,U=B;U<0;)U+=u;for(var F=Math.min(t.inWidth,d+B),V=L+j*x,q=m,W=0,z=0,G=O;G<A;G+=o){for(var H=S+G*e.strides[1],$=P;$<M;$+=s){for(var K=H+$*e.strides[2],Y=U;Y<F;Y+=u){var X=v[K+Y*e.strides[3]+E];if("max"===n&&X>q?q=X:"avg"===n&&(W+=X,z++),isNaN(q))break}if(isNaN(q))break}if(isNaN(q))break}y[V+E]="avg"===n?W/z:q}}}return g.toTensor()},e.prototype.avgPool3d=function(e,t){return this.assertNotComplex(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(e,t,n){this.assertNotComplex([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,d=n.dilationWidth,p=n.effectiveFilterDepth,h=n.effectiveFilterHeight,f=n.effectiveFilterWidth,m=p-1-n.padInfo.front,v=f-1-n.padInfo.left,g=h-1-n.padInfo.top,y=ar(t.shape,"float32"),b=1/(o*s*u),_=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var x=0;x<n.inChannels;++x)for(var T=0;T<n.inDepth;++T)for(var C=0;C<n.inHeight;++C)for(var S=0;S<n.inWidth;++S){for(var E=T-m,k=C-g,R=S-v,O=0,A=0;A<p;A+=c){var I=(E+A)/r;if(!(I<0||I>=n.outDepth||Math.floor(I)!==I))for(var N=0;N<h;N+=l){var D=(k+N)/i;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var P=0;P<f;P+=d){var M=(R+P)/a;M<0||M>=n.outWidth||Math.floor(M)!==M||(O+=_.get(w,I,D,M,x))}}}y.set(O*b,w,T,C,S,x)}return y.toTensor()},e.prototype.maxPool3d=function(e,t){return this.assertNotComplex(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},e.prototype.maxPool3dPositions=function(e,t){for(var n=ar(t.outShape,"int32"),r=t.strideDepth,i=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=t.padInfo.front,h=t.padInfo.top,f=t.padInfo.left,m=this.bufferSync(e),v=0;v<t.batchSize;++v)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-p,_=b;_<0;)_+=o;for(var w=Math.min(t.inDepth,c+b),x=0;x<t.outHeight;++x){for(var T=x*i-h,C=T;C<0;)C+=s;for(var S=Math.min(t.inHeight,l+T),E=0;E<t.outWidth;++E){for(var k=E*a-f,R=k;R<0;)R+=u;for(var O=Math.min(t.inWidth,d+k),A=Number.NEGATIVE_INFINITY,I=-1,N=_;N<w;N+=o)for(var D=N-b,P=C;P<S;P+=s)for(var M=P-T,L=R;L<O;L+=u){var j=L-k,B=m.get(v,N,P,L,g);B>=A&&(A=B,I=D*l*d+M*l+j)}n.set(I,v,y,x,E,g)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(e,t,n,r){this.assertNotComplex([t,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(t,r),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=d-1-r.padInfo.front,m=h-1-r.padInfo.left,v=p-1-r.padInfo.top,g=ar(t.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(e),_=0;_<r.batchSize;++_)for(var w=0;w<r.inChannels;++w)for(var x=0;x<r.inDepth;++x)for(var T=0;T<r.inHeight;++T)for(var C=0;C<r.inWidth;++C){for(var S=x-f,E=T-v,k=C-m,R=0,O=0;O<d;O+=u){var A=(S+O)/a;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var I=0;I<p;I+=c){var N=(E+I)/o;if(!(N<0||N>=r.outHeight||Math.floor(N)!==N))for(var D=0;D<h;D+=l){var P=(k+D)/s;if(!(P<0||P>=r.outWidth||Math.floor(P)!==P)){var M=d*p*h-1-y.get(_,A,N,P,w)===O*p*h+I*h+D?1:0;0!==M&&(R+=b.get(_,A,N,P,w)*M)}}}}g.set(R,_,x,T,C,w)}return g.toTensor()},e.prototype.cast=function(e,t){return wi(e,t,this)},e.prototype.reshape=function(e,t){return xi(e,t)},e.prototype.avgPool=function(e,t){return this.assertNotComplex(e,"avgPool"),this.pool(e,t,"avg").toFloat()},e.prototype.resizeBilinear=function(e,t,n,r){this.assertNotComplex(e,"resizeBilinear");for(var i=e.shape,a=i[0],o=i[1],s=i[2],u=i[3],c=this.readSync(e.dataId),l=new Float32Array(_([a,t,n,u])),d=[r&&t>1?o-1:o,r&&n>1?s-1:s],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=0,f=d[0]/p[0],m=d[1]/p[1],v=0;v<a;v++)for(var g=0;g<t;g++)for(var y=f*g,b=Math.floor(y),w=y-b,x=Math.min(o-1,Math.ceil(y)),T=v*e.strides[0]+b*e.strides[1],C=v*e.strides[0]+x*e.strides[1],S=0;S<n;S++)for(var E=m*S,k=Math.floor(E),R=E-k,O=Math.min(s-1,Math.ceil(E)),A=T+k*e.strides[2],I=C+k*e.strides[2],N=T+ +O*e.strides[2],D=C+O*e.strides[2],P=0;P<u;P++){var M=c[A+P],L=c[I+P],j=M+(c[N+P]-M)*R,B=j+(L+(c[D+P]-L)*R-j)*w;l[h++]=B}return Sn(l,[a,t,n,u])},e.prototype.resizeBilinearBackprop=function(e,t,n){this.assertNotComplex([e,t],"resizeBilinearBackprop");for(var r=t.shape,i=r[0],a=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],d=new Float32Array(i*a*o*s),p=[n&&c>1?a-1:a,n&&l>1?o-1:o],h=[n&&c>1?c-1:c,n&&l>1?l-1:l],f=p[0]/h[0],m=p[1]/h[1],v=this.readSync(e.dataId),g=0,y=0;y<i;y++)for(var b=y*t.strides[0],_=0;_<c;_++)for(var w=_*f,x=Math.floor(w),T=Math.min(Math.ceil(w),a-1),C=b+x*t.strides[1],S=b+T*t.strides[1],E=w-x,k=1-E,R=0;R<l;R++)for(var O=R*m,A=Math.floor(O),I=Math.min(Math.ceil(O),o-1),N=O-A,D=1-N,P=C+A*t.strides[2],M=C+I*t.strides[2],L=S+A*t.strides[2],j=S+I*t.strides[2],B=k*D,U=k*N,F=E*D,V=E*N,q=0;q<s;q++){var W=v[g++];d[P+q]+=W*B,d[M+q]+=W*U,d[L+q]+=W*F,d[j+q]+=W*V}return In(d,[i,o,a,s],t.dtype)},e.prototype.resizeNearestNeighbor=function(e,t,n,r){this.assertNotComplex(e,"resizeNearestNeighbor");for(var i=e.shape,a=i[0],o=i[1],s=i[2],u=i[3],c=this.readSync(e.dataId),l=new Float32Array(a*t*n*u),d=[r&&t>1?o-1:o,r&&n>1?s-1:s],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=d[0]/p[0],f=d[1]/p[1],m=0,v=0;v<a;v++)for(var g=v*e.strides[0],y=0;y<t;y++)for(var b=h*y,_=g+Math.min(o-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var x=f*w,T=_+Math.min(s-1,r?Math.round(x):Math.floor(x))*e.strides[2],C=0;C<u;C++){var S=c[T+C];l[m++]=S}return Sn(l,[a,t,n,u],e.dtype)},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){this.assertNotComplex([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,i=r[0],a=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],d=new Float32Array(i*a*o*s),p=this.readSync(e.dataId),h=[n&&c>1?a-1:a,n&&l>1?o-1:o],f=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=h[0]/f[0],v=h[1]/f[1],g=1/m,y=1/v,b=2*Math.ceil(g)+2,_=2*Math.ceil(y)+2,w=0;w<i;w++)for(var x=w*t.strides[0],T=0;T<a;T++)for(var C=x+T*t.strides[1],S=Math.floor(T*g),E=Math.floor(S-b/2),k=0;k<o;k++)for(var R=C+k*t.strides[2],O=Math.floor(k*y),A=Math.floor(O-_/2),I=0;I<s;I++){for(var N=0,D=0;D<b;D++){var P=D+E;if(!(P<0||P>=c)){var M=x+P*e.strides[1],L=P*m;if(T===Math.min(a-1,n?Math.round(L):Math.floor(L)))for(var j=0;j<_;j++){var B=j+A;if(!(B<0||B>=l)){var U=M+B*e.strides[2],F=B*v;k===Math.min(o-1,n?Math.round(F):Math.floor(F))&&(N+=p[U+I])}}}}d[R+I]=N}return In(d,t.shape,t.dtype)},e.prototype.batchNormalization=function(e,t,n,r,i,a){this.assertNotComplex([e,t,n,i,a],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=a?this.readSync(a.dataId):new Float32Array([0]),d=new Float32Array(o.length),p=l.length,h=c.length,f=u.length,m=s.length,v=0,g=0,y=0,b=0,_=0;_<o.length;++_)d[_]=l[v++]+(o[_]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),v>=p&&(v=0),g>=m&&(g=0),y>=h&&(y=0),b>=f&&(b=0);return In(d,e.shape)},e.prototype.localResponseNormalization4D=function(e,t,n,r,i){this.assertNotComplex(e,"localResponseNormalization4D");var a=e.shape[3],o=a-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%a,r=e-n+Math.max(0,n-t),i=e-n+Math.min(n+t,o),u=0;r<=i;r++){var c=s[r];u+=c*c}return u}for(var d=0;d<u;d++){var p=l(d),h=s[d]*Math.pow(n+r*p,-i);c[d]=h}return In(c,e.shape)},e.prototype.LRNGrad=function(e,t,n,r,i,a,o){this.assertNotComplex(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),d=new Float32Array(e.size),p=e.size,h=0;h<p;h++){for(var f=h%s,m=h-f+Math.max(0,f-r),v=h-f+Math.min(s,f+r+1),g=0,y=m;y<v;y++)g+=Math.pow(c[y],2);for(g=a*g+i,y=m;y<v;y++){var b=-2*a*o*c[y]*l[h]/g;h===y&&(b+=Math.pow(g,-o)),b*=u[h],d[y]+=b}}return In(d,e.shape)},e.prototype.multinomial=function(e,t,n,r){this.assertNotComplex(e,"multinomial");for(var i=t?e:ni(e),a=i.shape[0],o=i.shape[1],s=Mn([a,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(i.dataId),l=0;l<a;++l){var d=l*o,p=new Float32Array(o-1);p[0]=c[d];for(var h=1;h<p.length;++h)p[h]=p[h-1]+c[d+h];for(var f=tr(r.toString()),m=l*n,v=0;v<n;++v){var g=f();u[m+v]=p.length;for(var y=0;y<p.length;y++)if(g<p[y]){u[m+v]=y;break}}}return s},e.prototype.oneHot=function(e,t,n,r){this.assertNotComplex(e,"oneHot");var i=new Float32Array(e.size*t);i.fill(r);for(var a=this.readSync(e.dataId),o=0;o<e.size;++o)a[o]>=0&&a[o]<t&&(i[o*t+a[o]]=n);return On(i,[e.size,t],"int32")},e.prototype.nonMaxSuppression=function(e,t,n,r,i){return this.assertNotComplex(e,"nonMaxSuppression"),Oi(this.readSync(e.dataId),this.readSync(t.dataId),n,r,i)},e.prototype.fft=function(e){return this.fftBatch(e,!1)},e.prototype.ifft=function(e){return this.fftBatch(e,!0)},e.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],i=ar(e.shape,"float32"),a=ar(e.shape,"float32"),o=Tn(e).as2D(n,r),s=Cn(e).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),d=xn(c,l),p=this.readSync(this.fftImpl(d,t).dataId),h=0;h<r;h++){var f=Ei(p,h);i.values[u*r+h]=f.real,a.values[u*r+h]=f.imag}return xn(i.toTensor(),a.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(i=xn(Tn(i).div(kn(r)),Cn(i).div(kn(r)))),i}var a=this.readSync(e.dataId),o=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(a,r,t));return xn(o.real,o.imag).as2D(e.shape[0],e.shape[1])},e.prototype.isExponentOf2=function(e){return 0==(e&e-1)},e.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),i=t/2,a=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),i=0;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}(r),o=xn(a.real,a.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),i=2;i<e.length;i+=4)n[Math.floor(i/4)]=e[i],r[Math.floor(i/4)]=e[i+1];return{real:n,imag:r}}(r),u=xn(s.real,s.imag).as1D();o=this.fftRadix2(o,i,n),u=this.fftRadix2(u,i,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),i=0;i<Math.ceil(e/2);i++){var a=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}(t,n),l=xn(c.real,c.imag).mul(u),d=o.add(l),p=o.sub(l),h=Tn(d).concat(Tn(p)),f=Cn(d).concat(Cn(p));return xn(h,f).as1D()},e.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),i=0;i<t;i++){for(var a=0,o=0,s=0;s<t;s++){var u=Ri(i*s,t,n),c=Ei(e,s);a+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(a/=t,o/=t),ki(r,a,o,i)}return r},e.prototype.depthToSpace=function(e,t,n){v("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),v(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],i=e.shape[1],a=e.shape[2],o=e.shape[3],s=i*t,u=a*t,c=o/(t*t),l=this.readSync(e.dataId),d=new Float32Array(r*s*u*c),p=0,h=0;h<r;++h)for(var f=0;f<s;++f)for(var m=Math.floor(f/t),g=f%t,y=0;y<u;++y)for(var b=Math.floor(y/t),_=(g*t+y%t)*c,w=0;w<c;++w){var x=w+_+o*(b+a*(m+i*h));d[p++]=l[x]}return In(d,[r,s,u,c])},e.prototype.broadcastedBinaryOp=function(e,t,n,r){var i=ui(e.shape,t.shape),a=ar(i,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=oi(e.shape,i),c=oi(t.shape,i),l=a.values;if(u.length+c.length===0)for(var d=0;d<l.length;++d)l[d]=r(o[d%o.length],s[d%s.length]);else{var p=this.bufferSync(e),h=this.bufferSync(t),f=function(n){var i=a.indexToLoc(n),d=i.slice(-e.rank);u.forEach((function(e){return d[e]=0}));var f=p.locToIndex(d),m=i.slice(-t.rank);c.forEach((function(e){return m[e]=0}));var v=h.locToIndex(m);l[n]=r(o[f],s[v])};for(d=0;d<l.length;++d)f(d)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=ui(e.shape,t.shape),i=ar(r,"float32"),a=ar(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=oi(e.shape,r),c=oi(t.shape,r),l=i.values,d=a.values;if(u.length+c.length===0)for(var p=0;p<l.length;p++){var h=p%o.length,f=p%s.length,m=n(o[2*h],o[2*h+1],s[2*f],s[2*f+1]);l[p]=m.real,d[p]=m.imag}else{var v=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var a=i.indexToLoc(r),p=a.slice(-e.rank);u.forEach((function(e){return p[e]=0}));var h=v.locToIndex(p),f=a.slice(-t.rank);c.forEach((function(e){return f[e]=0}));var m=g.locToIndex(f),y=n(o[2*h],o[2*h+1],s[2*m],s[2*m+1]);l[r]=y.real,d[r]=y.imag};for(p=0;p<l.length;p++)y(p)}return this.complex(i.toTensor(),a.toTensor())},e.prototype.split=function(e,t,n){return Ii(e,t,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(e,t,n,r,i,a){for(var o=e.shape,s=o[0],u=o[1],c=o[2],l=o[3],d=t.shape[0],p=r[0],h=r[1],f=ar([d,p,h,l],e.dtype),m=this.readSync(t.dataId),v=this.readSync(n.dataId),g=this.readSync(e.dataId),y=e.strides,b=f.strides,_=0;_<d;_++){var w=4*_,x=m[w],T=m[w+1],C=m[w+2],S=m[w+3],E=v[_];if(!(E>=s))for(var k=p>1?(C-x)*(u-1)/(p-1):0,R=h>1?(S-T)*(c-1)/(h-1):0,O=0;O<p;O++){var A=p>1?x*(u-1)+O*k:.5*(x+C)*(u-1);if(A<0||A>u-1)for(var I=0;I<h;I++)for(var N=0;N<l;N++){var D=N+I*b[2]+O*b[1]+_*b[0];f.values[D]=a}else if("bilinear"===i){var P=Math.floor(A),M=Math.ceil(A),L=A-P;for(I=0;I<h;I++)if((G=h>1?T*(c-1)+I*R:.5*(T+S)*(c-1))<0||G>c-1)for(N=0;N<l;N++)D=N+I*b[2]+O*b[1]+_*b[0],f.values[D]=a;else{var j=Math.floor(G),B=Math.ceil(G),U=G-j;for(N=0;N<l;N++){var F=g[D=N+j*y[2]+P*y[1]+E*y[0]],V=g[D=N+B*y[2]+P*y[1]+E*y[0]],q=g[D=N+j*y[2]+M*y[1]+E*y[0]],W=F+(V-F)*U,z=q+(g[D=N+B*y[2]+M*y[1]+E*y[0]]-q)*U;D=N+I*b[2]+O*b[1]+_*b[0],f.values[D]=W+(z-W)*L}}}else for(I=0;I<h;++I){var G;if((G=h>1?T*(c-1)+I*R:.5*(T+S)*(c-1))<0||G>c-1)for(N=0;N<l;N++)D=N+I*b[2]+O*b[1]+_*b[0],f.values[D]=a;else{var H=Math.round(G),$=Math.round(A);for(N=0;N<l;N++){var K=N+H*y[2]+$*y[1]+E*y[0],Y=N+I*b[2]+O*b[1]+_*b[0];f.values[Y]=g[K]}}}}}return f.toTensor()},e.prototype.sparseToDense=function(e,t,n,r){var i=qr(0,e,n),a=i.sliceRank,o=i.numUpdates,s=i.sliceSize,u=i.strides,c=i.outputSize;return this.scatter(e,t,n,c,s,o,a,u,r,!1)},e.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],i=Br(e,t),a=i[0],o=i[1],s=i[2],u=i[3];if(0===o)return Sn([],a,e.dtype);for(var c=new ce([o,s],e.dtype),l=this.readSync(t.dataId),d=this.readSync(e.dataId),p=0;p<o;p++){for(var h=[],f=0,m=0;m<r;m++){var v=l[p*r+m];f+=v*u[m],h.push(v)}if(f<0||f>=e.size/s)throw new Error("Invalid indices: "+h+" does not index into "+e.shape);for(var g=0;g<s;g++)c.values[p*s+g]=d[f*s+g]}return c.toTensor().reshape(a)},e.prototype.scatterND=function(e,t,n){var r=qr(0,e,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=kn(0);return this.scatter(e,t,n,u,o,a,i,s,c,!0)},e.prototype.fill=function(e,t,n){var r=I(n=n||V(t),_(e));return r.fill(t),he.make(e,{values:r},n)},e.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},e.prototype.zerosLike=function(e){var t=I(e.dtype,_(e.shape));return he.make(e.shape,{values:t},e.dtype)},e.prototype.linspace=function(e,t,n){return Ti(e,t,n)},e.prototype.scatter=function(e,t,n,r,i,a,o,s,u,c){var l=[r/i,i],d=this.readSync(e.dataId),p=this.readSync(t.dataId);if(0===r)return Sn([],n,t.dtype);var h=new ce(l,t.dtype);h.values.fill(this.readSync(u.dataId)[0]);for(var f=0;f<a;f++){for(var m=[],v=0,g=0;g<o;g++){var y=d[f*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)c?h.values[v*i+b]+=p[f*i+b]:h.values[v*i+b]=0===t.rank?p[0]:p[f*i+b]}return h.toTensor().reshape(n)},e}();Ie.registerBackend("cpu",(function(){return new gd}),1);var yd=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();l().get("IS_BROWSER")&&l().setPlatform("browser",new yd);var bd,_d=function(){return n(4)},wd=function(){function e(){this.util=n(5),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=l().global.fetch?l().global.fetch(e,t):(null==bd&&(bd=_d()),bd(e,t))},e.prototype.now=function(){var e=r.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();l().get("IS_NODE")&&l().setPlatform("node",new wd);var xd={float32:4,int32:4,uint16:2,uint8:1,bool:1},Td=4;function Cd(e,t){for(var n={},r=0,i=function(t){var i=t.name,a=t.dtype,o=t.shape,s=_(o),u=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=xd[c.dtype],d=e.slice(r,r+s*l),p="uint8"===c.dtype?new Uint8Array(d):new Uint16Array(d);if("float32"===a)u=Float32Array.from(p,(function(e){return e*c.scale+c.min}));else{if("int32"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);u=Int32Array.from(p,(function(e){return Math.round(e*c.scale+c.min)}))}r+=s*l}else if("string"===a){var h=_(t.shape);u=[];for(var f=0;f<h;f++){var m=new Uint32Array(e.slice(r,r+Td))[0];r+=Td;var v=new Uint8Array(e.slice(r,r+m));u.push(v),r+=m}}else{var g=xd[a];if(d=e.slice(r,r+s*g),"float32"===a)u=new Float32Array(d);else if("int32"===a)u=new Int32Array(d);else{if("bool"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);u=new Uint8Array(d)}r+=s*g}n[i]=Sn(u,o,a)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function Sd(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),i=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),i),i+=e.byteLength})),r.buffer}var Ed="undefined"!=typeof i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function kd(e){return Ed?i.byteLength(e):new Blob([e]).size}function Rd(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Od(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Ad(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:kd(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:kd(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var Id=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&i.push(n)})),i},e}(),Nd="://",Dd=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){v(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(Nd)&&(t=t.slice(0,t.indexOf(Nd))),v(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();v(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Pd(e){if(-1===e.indexOf(Nd))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Dd.getSchemes().join(","));return{scheme:e.split(Nd)[0],path:e.split(Nd)[1]}}function Md(e,t,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var r,i,a,o,s,c,l,d,p;return u(this,(function(u){switch(u.label){case 0:return v(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),v((r=Id.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),v(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),i=r[0],v((a=Id.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),v(a.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),o=a[0],s=Pd(e).scheme,c=Pd(e).path,l=s===Pd(e).scheme,[4,i.load()];case 1:return d=u.sent(),n&&l?[4,Dd.getManager(s).removeModel(c)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[4,o.save(d)];case 4:return p=u.sent(),!n||l?[3,6]:[4,Dd.getManager(s).removeModel(c)];case 5:u.sent(),u.label=6;case 6:return[2,p.modelArtifactsInfo]}}))}))}var Ld="models_store",jd="model_info_store";function Bd(){if(!l().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Ud(e){var t=e.result;t.createObjectStore(Ld,{keyPath:"modelPath"}),t.createObjectStore(jd,{keyPath:"modelPath"})}var Fd=function(){function e(e){if(this.indexedDB=Bd(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Ud(i)},i.onsuccess=function(){var a=i.result;if(null==t){var o=a.transaction(Ld,"readonly"),s=o.objectStore(Ld).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{var u,c=Ad(t),l=a.transaction(jd,"readwrite"),d=l.objectStore(jd),p=d.put({modelPath:n.modelPath,modelArtifactsInfo:c});p.onsuccess=function(){var i=(u=a.transaction(Ld,"readwrite")).objectStore(Ld).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});i.onsuccess=function(){return e({modelArtifactsInfo:c})},i.onerror=function(e){var t=(d=l.objectStore(jd)).delete(n.modelPath);t.onsuccess=function(){return a.close(),r(i.error)},t.onerror=function(e){return a.close(),r(i.error)}}},p.onerror=function(e){return a.close(),r(p.error)},l.oncomplete=function(){null==u?a.close():u.oncomplete=function(){return a.close()}}}},i.onerror=function(e){return r(i.error)}}))},e.URL_SCHEME="indexeddb://",e}(),Vd=function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Fd.URL_SCHEME)?(t=e.slice(Fd.URL_SCHEME.length),new Fd(t)):null;var t};Id.registerSaveRouter(Vd),Id.registerLoadRouter(Vd);var qd=function(){function e(){this.indexedDB=Bd()}return e.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Ud(r)},r.onsuccess=function(){var e=r.result,i=e.transaction(jd,"readonly"),a=i.objectStore(jd).getAll();a.onsuccess=function(){for(var e={},n=0,r=a.result;n<r.length;n++){var i=r[n];e[i.modelPath]=i.modelArtifactsInfo}t(e)},a.onerror=function(t){return e.close(),n(a.error)},i.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(n){var r;return e=(r=e).startsWith(Fd.URL_SCHEME)?r.slice(Fd.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Ud(i)},i.onsuccess=function(){var t,a=i.result,o=a.transaction(jd,"readwrite"),s=o.objectStore(jd),u=s.get(e);u.onsuccess=function(){if(null==u.result)return a.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var i=s.delete(e),o=function(){var i=(t=a.transaction(Ld,"readwrite")).objectStore(Ld).delete(e);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(e){return r(u.error)}};i.onsuccess=o,i.onerror=function(e){return o(),a.close(),r(u.error)}},u.onerror=function(e){return a.close(),r(u.error)},o.oncomplete=function(){null==t?a.close():t.oncomplete=function(){return a.close()}}},i.onerror=function(e){return r(i.error)}}))]}))}))},e}();if(l().getBool("IS_BROWSER"))try{Dd.registerManager(Fd.URL_SCHEME,new qd)}catch(a){}var Wd="/",zd="tensorflowjs_models",Gd="info",Hd="model_topology",$d="weight_specs",Kd="weight_data",Yd="model_metadata";function Xd(e){return{info:[zd,e,Gd].join(Wd),topology:[zd,e,Hd].join(Wd),weightSpecs:[zd,e,$d].join(Wd),weightData:[zd,e,Kd].join(Wd),modelMetadata:[zd,e,Yd].join(Wd)}}function Jd(e){var t=e.split(Wd);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Wd)}var Qd=function(){function e(e){if(!l().getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Xd(this.modelPath)}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(a){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Ad(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=e.weightData,Ed?i.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,a,o,s;return u(this,(function(u){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(a),t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(Ed){var t=i.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),Zd=function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Qd.URL_SCHEME)?(t=e.slice(Qd.URL_SCHEME.length),new Qd(t)):null;var t};Id.registerSaveRouter(Zd),Id.registerLoadRouter(Zd);var ep=function(){function e(){v(l().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),v(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,i,a;return u(this,(function(o){for(e={},t=zd+Wd,n=Wd+Gd,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(t)&&i.endsWith(n)&&(a=Jd(i),e[a]=JSON.parse(this.LS.getItem(i)));return[2,e]}))}))},e.prototype.removeModel=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){var i;if(e=(i=e).startsWith(Qd.URL_SCHEME)?i.slice(Qd.URL_SCHEME.length):i,t=Xd(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(l().getBool("IS_BROWSER"))try{Dd.registerManager(Qd.URL_SCHEME,new ep)}catch(a){}var tp="model",np=".json",rp=".weights.bin";function ip(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var ap=function(){function e(t){if(!l().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t=tp),this.modelTopologyFileName=t+np,this.weightDataFileName=t+rp}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i,a,o;return u(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(a=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,ip((function(){return a.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=t,[4,ip((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:Ad(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),op=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n=this;return u(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,i){var a=new FileReader;a.onload=function(a){var o=JSON.parse(a.target.result),s=o.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,t)}catch(e){return void i(e)}var l=[],d=[],p=[];u.forEach((function(e){e.paths.forEach((function(e){d.push(e),p.push(null)})),l.push.apply(l,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,i=d.indexOf(e);p[i]=n,-1===p.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:Rd(p)})},t.onerror=function(t){return i("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])}))}))}else i(new Error("weightManifest field is missing from file "+e.name))}else i(new Error("modelTopology field is missing from file "+e.name))},a.onerror=function(t){return i("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return Od(e.name)})),i={},a=0,o=e;a<o.length;a++)o[a].paths.forEach((function(e){var a=Od(e);if(-1!==n.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: '"+a+"'");if(n.push(a),-1===r.indexOf(a))throw new Error("Weight file with basename '"+a+"' is not provided.");i[e]=t[r.indexOf(a)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return i},e}();function sp(e,t,n,r){!function(e){v(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){v(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),v(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),v(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(e.map((function(a){return a.then((function(a){var o=n+ ++i/e.length*(r-n);return t(o),a})),a})))}function up(e,t){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,d,p;return u(this,(function(u){switch(u.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?l().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),i=0,a=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=u.sent(),[3,4];case 2:return[4,sp(r,t.onProgress,i,a)];case 3:o=u.sent(),u.label=4;case 4:return s=o.map((function(e){return e.arrayBuffer()})),c=.5,d=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return p=u.sent(),[3,8];case 6:return[4,sp(s,t.onProgress,c,d)];case 7:p=u.sent(),u.label=8;case 8:return[2,p]}}))}))}function cp(e){var t=this;return function(n,r,i){return void 0===r&&(r=""),s(t,void 0,void 0,(function(){var t,a,o,s,c,l,d,p,h,f;return u(this,(function(u){switch(u.label){case 0:if(t=n.map((function(){return!1})),a={},o=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,c=xd[u]*_(e.shape),l=function(){t[n]=!0,null==a[n]&&(a[n]=[]),a[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=i?i.forEach((function(t,n){t===e.name&&(l(),o[n]=!0)})):l(),s.push(e.name),r+=c}))})),!o.every((function(e){return e})))throw c=i.filter((function(e,t){return!o[t]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),d=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;d.push(t)}))})),[4,e(d)];case 1:return p=u.sent(),h={},f=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,i=0;i<t;i++)r+=p[f+i].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<t;c++){var l=new Uint8Array(p[f+c]);s.set(l,u),u+=l.byteLength}a[e].forEach((function(e){var t=Cd(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),f+=t})),[2,h]}}))}))}}Id.registerSaveRouter((function(e){return l().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ap.URL_SCHEME)?(t=e.slice(ap.URL_SCHEME.length),void 0===t&&(t="model"),new ap(t)):null;var t}));var lp=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(v("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=l().platform.fetch,v(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&v(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i;return u(this,(function(a){switch(a.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Ad(e),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}}))}))},e.prototype.load=function(){return s(this,void 0,void 0,(function(){var e,t,n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,e.json()];case 3:return t=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,i=t.weightsManifest,null==r&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:s=u.sent(),a=s[0],o=s[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:a,weightData:o}]}}))}))},e.prototype.loadWeights=function(e){return s(this,void 0,void 0,(function(){var t,n,r,i,a,o,s,c,l,d,p;return u(this,(function(u){switch(u.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),r=e.substring(0,t),i=n>t?e.substring(n):"";return[r+"/",i]}(t),r=n[0],i=n[1],a=this.weightPathPrefix||r,o=[],s=0,c=e;s<c.length;s++)l=c[s],o.push.apply(o,l.weights);return d=[],e.forEach((function(e){e.paths.forEach((function(e){d.push(a+e+i)}))})),[4,up(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=u.sent(),[2,[o,Rd(p)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function dp(e){return null!=e.match(lp.URL_SCHEME_REGEX)}var pp=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return dp(e)})):dp(e))?hp(e,{onProgress:t}):null};function hp(e,t){return new lp(e,t)}Id.registerSaveRouter(pp),Id.registerLoadRouter(pp);var fp=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),mp=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),vp=Object.freeze({browserFiles:function(e){return new op(e)},browserHTTPRequest:function(e,t){return hp(e,t)},concatenateArrayBuffers:Rd,decodeWeights:Cd,encodeWeights:function(e,t){return s(this,void 0,void 0,(function(){var n,r,i,a,o,c=this;return u(this,(function(l){switch(l.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),a=function(a){var o=i[a],l=Array.isArray(e)?e[a].tensor:e[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+l.dtype);var d={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var p=new Promise((function(e){return s(c,void 0,void 0,(function(){var t,n,r,i,a,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(t=u.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+Td*t.length,r=new Uint8Array(n),i=0,a=0;a<t.length;a++)o=t[a],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,i),i+=Td,r.set(o,i),i+=o.length;return e(r),[2]}}))}))}));r.push(p)}else r.push(l.data());null!=t&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:Sd(l.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new fp(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new fp({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new fp({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Id.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Ad,getSaveHandlers:function(e){return Id.getSaveHandlers(e)},http:hp,isHTTPScheme:dp,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),s(this,void 0,void 0,(function(){return u(this,(function(i){return[2,cp((function(e){return up(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return Id.registerLoadRouter(e)},registerSaveRouter:function(e){return Id.registerSaveRouter(e)},weightsLoaderFactory:cp,withSaveHandler:function(e){return new mp(e)},copyModel:function(e,t){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Md(e,t,!1)]}))}))},listModels:function(){return s(this,void 0,void 0,(function(){var e,t,n,r,i,a,o;return u(this,(function(s){switch(s.label){case 0:e=Dd.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,Dd.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+Nd+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Md(e,t,!0)]}))}))},removeModel:function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){return t=Pd(e),[2,Dd.getManager(t.scheme).removeModel(t.path)]}))}))}}),gp=wn({confusionMatrix_:function(e,t,n){var r=cn(e,"labels","confusionMatrix"),i=cn(t,"predictions","confusionMatrix");v(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),v(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),v(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),v(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),v(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var a=mr(r.asType("int32"),n),o=mr(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),yp=Object.freeze({confusionMatrix:gp}),bp=wn({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&n&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return Ie.fromPixels(e,t)}}),_p=Object.freeze({toPixels:function(e,t){return s(this,void 0,void 0,(function(){var n,r,i,a,o,s,c,l,d,p,h,f,m,v,g,y,b,_,w,x,T,C,S;return u(this,(function(u){switch(u.label){case 0:if(n=cn(e,"img","toPixels"),e instanceof he||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=u.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(d=u.sent(),p=d[0],h=d[1],f=p[0],m=h[0],c.dispose(),l.dispose(),"float32"===n.dtype){if(f<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+m+"].")}for(v="float32"===n.dtype?255:1,g=new Uint8ClampedArray(a*i*4),y=0;y<i*a;++y)b=void 0,_=void 0,w=void 0,x=void 0,1===o?(b=s[y]*v,_=s[y]*v,w=s[y]*v,x=255):3===o?(b=s[3*y]*v,_=s[3*y+1]*v,w=s[3*y+2]*v,x=255):4===o&&(b=s[4*y]*v,_=s[4*y+1]*v,w=s[4*y+2]*v,x=s[4*y+3]*v),g[0+(T=4*y)]=Math.round(b),g[T+1]=Math.round(_),g[T+2]=Math.round(w),g[T+3]=Math.round(x);return null!=t&&(t.width=a,t.height=i,C=t.getContext("2d"),S=new ImageData(g,a,i),C.putImageData(S,0,0)),n!==e&&n.dispose(),[2,g]}}))}))},fromPixels:bp}),wp=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),xp=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Tp(e){v(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),v("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),v(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),xp.register(e)}var Cp=Object.freeze({Serializable:wp,SerializationMap:xp,registerClass:Tp}),Sp=.001,Ep=.1;function kp(){return 32===Ie.backend.floatPrecision()?Sp:Ep}function Rp(e,t,n){var r=!0;if((M(e)||M(t))&&(r=!1),M(e)&&M(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=sn(e),s=sn(t);if(!w(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=M(e)?e:b(e),c=M(t)?t:b(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var d=u[l],p=c[l];if(!n(d,p))throw new Error("Arrays differ: actual["+l+"] = "+d+", expected["+l+"] = "+p+".\nActual:   "+u+".\nExpected: "+c+".")}}function Op(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var Ap=Object.freeze({TEST_EPSILON_FLOAT16:Ep,expectArraysClose:function(e,t,n){return null==n&&(n=kp()),Rp(e,t,(function(e,t){return Op(e,t,n)}))},testEpsilon:kp,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return B(e)||B(e[0])||B(t)||B(t[0])?Rp(e,n,(function(e,t){return e==t})):Rp(e,t,(function(e,t){return Op(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=kp()),!Op(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Ip="1.2.11",Np=Object.freeze({gpgpu_util:vo,webgl_util:Lt,forceHalfFloat:function(){l().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Ps,setWebGLContext:Be,GPGPUContext:go}),Dp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:a[e.name]}}));this.applyGradients(o)}else this.applyGradients(a);return $t(a),t?i:(i.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return Zr(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&$t(this.iterations_)},t.prototype.saveIterations=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:kn(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(wp);Object.defineProperty(Dp,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Pp=function(e){function t(t,n,r){void 0===r&&(r=null);var i=e.call(this)||this;return i.learningRate=t,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=Ie.backend.epsilon()),i}return o(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var i=Ie.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Ht((function(){return Fn(i).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Ht((function(){return Fn(i).variable(!1)}))});var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Ht((function(){var e=o.mul(t.rho).add(a.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(a),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&($t(this.accumulatedGrads.map((function(e){return e.variable}))),$t(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(Dp);Tp(Pp);var Mp=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return o(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var i=Ie.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Ht((function(){return Ln(i.shape,t.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var o=t.accumulatedGrads[r].variable;Ht((function(){var e=o.add(a.square());o.assign(e);var n=a.div(e.add(Ie.backend.epsilon()).sqrt()).mul(-t.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&$t(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(Dp);Tp(Mp);var Lp=function(e){function t(t,n,r,i){void 0===i&&(i=null);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Ht((function(){a.accBeta1=kn(n).variable(),a.accBeta2=kn(r).variable()})),null==i&&(a.epsilon=Ie.backend.epsilon()),a}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Ht((function(){var r=tc(1,t.accBeta1),i=tc(1,t.accBeta2);n.forEach((function(n,a){var o=Ie.registeredVariables[n];null==t.accumulatedFirstMoment[a]&&(t.accumulatedFirstMoment[a]={originalName:n+"/m",variable:Ht((function(){return Fn(o).variable(!1)}))}),null==t.accumulatedSecondMoment[a]&&(t.accumulatedSecondMoment[a]={originalName:n+"/v",variable:Ht((function(){return Fn(o).variable(!1)}))});var s=Array.isArray(e)?e[a].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[a].variable,c=t.accumulatedSecondMoment[a].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),d=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),p=l.div(r),h=d.div(i);u.assign(l),c.assign(d);var f=p.div(h.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(f)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&$t(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&$t(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t,n=this;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),Ht((function(){n.accBeta1.assign(Ju(n.beta1,n.iterations_+1)),n.accBeta2.assign(Ju(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(Dp);Tp(Lp);var jp=function(e){function t(t,n,r,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=i,o.decay=a,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Ht((function(){o.iteration=kn(0).variable(),o.accBeta1=kn(n).variable()})),null==i&&(o.epsilon=Ie.backend.epsilon()),o}return o(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Ht((function(){var r=tc(1,t.accBeta1),i=Fu(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,a){var o=Ie.registeredVariables[n];null==t.accumulatedFirstMoment[a]&&(t.accumulatedFirstMoment[a]={originalName:n+"/m",variable:Fn(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[a]&&(t.accumulatedWeightedInfNorm[a]={originalName:n+"/v",variable:Fn(o).variable(!1)});var s=Array.isArray(e)?e[a].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[a].variable,c=t.accumulatedWeightedInfNorm[a].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),d=c.mul(t.beta2),p=s.abs(),h=d.maximum(p);u.assign(l),c.assign(h);var f=i.div(r).mul(l.div(h.add(t.epsilon))).add(o);o.assign(f)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&$t(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&$t(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(Dp);Tp(jp);var Bp=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return o(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=Ie.registeredVariables[n];Ht((function(){var e=t.c.mul(i).add(a);a.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Kt(kn(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(Dp);Tp(Bp);var Up=function(e){function t(t,n,r){void 0===r&&(r=!1);var i=e.call(this,t)||this;return i.learningRate=t,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=kn(i.momentum),i}return o(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var i=Ie.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:Ht((function(){return Fn(i).variable(!1)}))});var a=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Ht((function(){var e,n=t.m.mul(a).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(i):t.c.mul(n).add(i),a.assign(n),i.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&$t(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(Bp);Tp(Up);var Fp=function(e){function t(t,n,r,i,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===a&&(a=!1);var o=e.call(this)||this;return o.learningRate=t,o.decay=n,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=a,null==i&&(o.epsilon=Ie.backend.epsilon()),o}return o(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var i=Ie.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Ht((function(){return Fn(i).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:Ht((function(){return Fn(i).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Ht((function(){return Fn(i).variable(!1)}))});var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;Ht((function(){var e=o.mul(t.decay).add(a.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(a.mul(1-t.decay)),c=s.mul(t.momentum).add(a.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(u),s.assign(c);var l=i.sub(c);i.assign(l)}else{var d=o.mul(t.decay).add(a.square().mul(1-t.decay));c=s.mul(t.momentum).add(a.mul(t.learningRate).div(d.add(t.epsilon).sqrt())),o.assign(d),s.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&$t(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&$t(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&$t(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return s(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(Dp);Tp(Fp);var Vp=function(){function e(){}return e.sgd=function(e){return new Bp(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new Up(e,t,n)},e.rmsprop=function(e,t,n,r,i){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new Fp(e,t,n,r,i)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Lp(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new Pp(e,t,n)},e.adamax=function(e,t,n,r,i){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new jp(e,t,n,r,i)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new Mp(e,t)},e}(),qp={sgd:Vp.sgd,momentum:Vp.momentum,adadelta:Vp.adadelta,adagrad:Vp.adagrad,rmsprop:Vp.rmsprop,adamax:Vp.adamax,adam:Vp.adam},Wp="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(e){return e()};function zp(){return new Promise((function(e){return Wp((function(){return e()}))}))}de=md}.call(this,n("c8ba"),n("4362"),n("b639").Buffer)},"46cc":function(e,t,n){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var r,i;n.d(t,"a",(function(){return r})),function(e){e[e["DT_INVALID"]=0]="DT_INVALID",e[e["DT_FLOAT"]=1]="DT_FLOAT",e[e["DT_DOUBLE"]=2]="DT_DOUBLE",e[e["DT_INT32"]=3]="DT_INT32",e[e["DT_UINT8"]=4]="DT_UINT8",e[e["DT_INT16"]=5]="DT_INT16",e[e["DT_INT8"]=6]="DT_INT8",e[e["DT_STRING"]=7]="DT_STRING",e[e["DT_COMPLEX64"]=8]="DT_COMPLEX64",e[e["DT_INT64"]=9]="DT_INT64",e[e["DT_BOOL"]=10]="DT_BOOL",e[e["DT_QINT8"]=11]="DT_QINT8",e[e["DT_QUINT8"]=12]="DT_QUINT8",e[e["DT_QINT32"]=13]="DT_QINT32",e[e["DT_BFLOAT16"]=14]="DT_BFLOAT16",e[e["DT_FLOAT_REF"]=101]="DT_FLOAT_REF",e[e["DT_DOUBLE_REF"]=102]="DT_DOUBLE_REF",e[e["DT_INT32_REF"]=103]="DT_INT32_REF",e[e["DT_UINT8_REF"]=104]="DT_UINT8_REF",e[e["DT_INT16_REF"]=105]="DT_INT16_REF",e[e["DT_INT8_REF"]=106]="DT_INT8_REF",e[e["DT_STRING_REF"]=107]="DT_STRING_REF",e[e["DT_COMPLEX64_REF"]=108]="DT_COMPLEX64_REF",e[e["DT_INT64_REF"]=109]="DT_INT64_REF",e[e["DT_BOOL_REF"]=110]="DT_BOOL_REF",e[e["DT_QINT8_REF"]=111]="DT_QINT8_REF",e[e["DT_QUINT8_REF"]=112]="DT_QUINT8_REF",e[e["DT_QINT32_REF"]=113]="DT_QINT32_REF",e[e["DT_BFLOAT16_REF"]=114]="DT_BFLOAT16_REF"}(r||(r={})),function(e){let t;(function(e){e[e["LEGACY"]=0]="LEGACY",e[e["V1"]=1]="V1",e[e["V2"]=2]="V2"})(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(i||(i={}))},4840:function(e,t,n){var r=n("825a"),i=n("1c0b"),a=n("b622"),o=a("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[o])?t:i(n)}},4930:function(e,t,n){var r=n("d039");e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},"4a4b":function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},"4ae1":function(e,t,n){var r=n("23e7"),i=n("d066"),a=n("1c0b"),o=n("825a"),s=n("861d"),u=n("7c73"),c=n("0538"),l=n("d039"),d=i("Reflect","construct"),p=l((function(){function e(){}return!(d((function(){}),[],e)instanceof e)})),h=!l((function(){d((function(){}))})),f=p||h;r({target:"Reflect",stat:!0,forced:f,sham:f},{construct:function(e,t){a(e),o(t);var n=arguments.length<3?e:a(arguments[2]);if(h&&!p)return d(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(c.apply(e,r))}var i=n.prototype,l=u(s(i)?i:Object.prototype),f=Function.apply.call(e,l,t);return s(f)?f:l}})},"4d64":function(e,t,n){var r=n("fc6a"),i=n("50c4"),a=n("23cb"),o=function(e){return function(t,n,o){var s,u=r(t),c=i(u.length),l=a(o,c);if(e&&n!=n){while(c>l)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},"4e69":function(e,t,n){"use strict";var r=n("4329"),i=n("dc6d"),a=function(){a.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new d(0,0),new d(0,1),new d(1,0),new d(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};a.prototype=new r,a.prototype.push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=i.parseSei(e.escapedRBSP),t.payloadType===i.USER_DATA_REGISTERED_ITU_T_T35&&(n=i.parseUserData(t),n)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=i.parseCaptionPackets(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},a.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},a.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},a.prototype.flush=function(){return this.flushStream("flush")},a.prototype.partialFlush=function(){return this.flushStream("partialFlush")},a.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},a.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},a.prototype.setsChannel1Active=function(e){return 4096===(30720&e.ccData)},a.prototype.setsChannel2Active=function(e){return 6144===(30720&e.ccData)},a.prototype.setsTextOrXDSActive=function(e){return 256===(28928&e.ccData)||4138===(30974&e.ccData)||6186===(30974&e.ccData)};var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},s=function(e){return null===e?"":(e=o[e]||e,String.fromCharCode(e))},u=14,c=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],l=function(){var e=[],t=u+1;while(t--)e.push("");return e},d=function(e,t){d.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if(t=32639&e.ccData,t!==this.lastControlCode_){if(4096===(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=l();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=l();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=l()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))r=(3&r)<<8,a=s(r|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),r=(3&r)<<8,a=s(r|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14===(14&i)&&this.addFormatting(e.pts,["i"]),1===(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=c.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16===(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14===(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=s(r),a+=s(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};d.prototype=new r,d.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(t){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},d.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=l(),this.nonDisplayed_=l(),this.lastControlCode_=null,this.column_=0,this.row_=u,this.rollUpRows_=2,this.formatting_=[]},d.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},d.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},d.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},d.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},d.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},d.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},d.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},d.prototype.isNormalChar=function(e){return e>=32&&e<=127},d.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=u,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=l(),this.displayed_=l()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},d.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},d.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},d.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},d.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},d.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<u+1;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},d.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},e.exports={CaptionStream:a,Cea608Stream:d}},"50c4":function(e,t,n){var r=n("a691"),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},5135:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"526c":function(e,t,n){"use strict";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(e,t,n,r){const a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){const e=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?e+1:a.inputIndexEnd;if("tensor"===a.type)return i(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type){const a=t.inputNames.slice(e,o);return a.map(e=>i(e,n,r))}const s=Array.prototype.slice.call(i(t.inputNames.slice(e)[0],n,r).dataSync());return"number"===a.type?s[0]:s}const o=t.attrParams[e];return o&&o.value}function i(e,t,n){const[r,i]=u(e),a=n.currentContextIds.find(e=>!!t[s(r,e)]);return void 0!==a?t[s(r,a)][i]:void 0}function a(e,t,n){return t[s(e,n.currentContextId)]}function o(e,t){const[n,r]=u(e);return[s(n,t&&t.currentContextId),r]}function s(e,t){return t?`${e}-${t}`:e}function u(e){const t=e.split(":");if(1===t.length)return[e,0];const n=t[0];return[n,Number(t[t.length-1])]}function c(e,t){const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c}))},5479:function(e,t,n){"use strict";n.d(t,"c",(function(){return Et})),n.d(t,"a",(function(){return zt})),n.d(t,"b",(function(){return qt})),n.d(t,"d",(function(){return Ft}));var r=n("45ef"),i=n("f8bb"),a=n("526c");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class o{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(e=>this.getInput(e)),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((e,t)=>(e[t]=this.getAttr(t),e),{}))}getInput(e){return Object(a["c"])(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return Object(a["c"])(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(i["f"])(this.node.rawAttrs,e,t);if(null!=n.s)return Object(i["i"])(this.node.rawAttrs,e,t);if(null!=n.b)return Object(i["c"])(this.node.rawAttrs,e,t);if(null!=n.shape)return Object(i["k"])(this.node.rawAttrs,e,t);if(null!=n.type)return Object(i["e"])(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(i["g"])(this.node.rawAttrs,e,t);if(null!=n.list.s)return Object(i["h"])(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Object(i["j"])(this.node.rawAttrs,e,t);if(null!=n.list.b)return Object(i["b"])(this.node.rawAttrs,e,t);if(null!=n.list.type)return Object(i["d"])(this.node.rawAttrs,e,t)}return t}}var s=n("d303");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u=(e,t,n)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[r["add"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"AddN":return[r["addN"](Object(a["b"])("tensors",e,t,n))];case"FloorMod":case"Mod":return[r["mod"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Mul":return[r["mul"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"RealDiv":case"Div":return[r["div"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"DivNoNan":return[r["divNoNan"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"FloorDiv":return[r["floorDiv"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Sub":return[r["sub"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Minimum":return[r["minimum"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Maximum":return[r["maximum"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Pow":return[r["pow"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"SquaredDifference":return[r["squaredDifference"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},c=(e,t,n)=>{switch(e.op){case"Abs":case"ComplexAbs":return[r["abs"](Object(a["b"])("x",e,t,n))];case"Acos":return[r["acos"](Object(a["b"])("x",e,t,n))];case"Acosh":return[r["acosh"](Object(a["b"])("x",e,t,n))];case"Asin":return[r["asin"](Object(a["b"])("x",e,t,n))];case"Asinh":return[r["asinh"](Object(a["b"])("x",e,t,n))];case"Atan":return[r["atan"](Object(a["b"])("x",e,t,n))];case"Atan2":return[r["atan2"](Object(a["b"])("x",e,t,n),Object(a["b"])("y",e,t,n))];case"Atanh":return[r["atanh"](Object(a["b"])("x",e,t,n))];case"Ceil":return[r["ceil"](Object(a["b"])("x",e,t,n))];case"Complex":return[r["complex"](Object(a["b"])("real",e,t,n),Object(a["b"])("imag",e,t,n))];case"Cos":return[r["cos"](Object(a["b"])("x",e,t,n))];case"Cosh":return[r["cosh"](Object(a["b"])("x",e,t,n))];case"Elu":return[r["elu"](Object(a["b"])("x",e,t,n))];case"Erf":return[r["erf"](Object(a["b"])("x",e,t,n))];case"Exp":return[r["exp"](Object(a["b"])("x",e,t,n))];case"Expm1":return[r["expm1"](Object(a["b"])("x",e,t,n))];case"Floor":return[r["floor"](Object(a["b"])("x",e,t,n))];case"Log":return[r["log"](Object(a["b"])("x",e,t,n))];case"Log1p":return[r["log1p"](Object(a["b"])("x",e,t,n))];case"Imag":return[r["imag"](Object(a["b"])("x",e,t,n))];case"Neg":return[r["neg"](Object(a["b"])("x",e,t,n))];case"Reciprocal":return[r["reciprocal"](Object(a["b"])("x",e,t,n))];case"Real":return[r["real"](Object(a["b"])("x",e,t,n))];case"Relu":return[r["relu"](Object(a["b"])("x",e,t,n))];case"Round":return[r["round"](Object(a["b"])("x",e,t,n))];case"Selu":return[r["selu"](Object(a["b"])("x",e,t,n))];case"Sigmoid":return[r["sigmoid"](Object(a["b"])("x",e,t,n))];case"Sin":return[r["sin"](Object(a["b"])("x",e,t,n))];case"Sign":return[r["sign"](Object(a["b"])("x",e,t,n))];case"Sinh":return[r["sinh"](Object(a["b"])("x",e,t,n))];case"Softplus":return[r["softplus"](Object(a["b"])("x",e,t,n))];case"Sqrt":return[r["sqrt"](Object(a["b"])("x",e,t,n))];case"Square":return[r["square"](Object(a["b"])("x",e,t,n))];case"Tanh":return[r["tanh"](Object(a["b"])("x",e,t,n))];case"Tan":return[r["tan"](Object(a["b"])("x",e,t,n))];case"Relu6":case"ClipByValue":return[r["clipByValue"](Object(a["b"])("x",e,t,n),Object(a["b"])("clipValueMin",e,t,n),Object(a["b"])("clipValueMax",e,t,n))];case"Rsqrt":return[r["rsqrt"](Object(a["c"])(e.inputNames[0],t,n))];case"Prod":return[r["prod"](Object(a["b"])("x",e,t,n),Object(a["b"])("axes",e,t,n))];case"LeakyRelu":return[r["leakyRelu"](Object(a["b"])("x",e,t,n),Object(a["b"])("alpha",e,t,n))];case"Prelu":return[r["prelu"](Object(a["b"])("x",e,t,n),Object(a["b"])("alpha",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function l(e,t,n=""){r["util"].assert(d(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function d(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p{constructor(e,t,n,r,i,a,o){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.id=p.nextId++}get closed(){return this.closed_}clearAndClose(){this.tensors.forEach(e=>e.tensor.dispose()),this.tensors=[],this.closed_=!0}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(e=>this.read(e))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),l(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n&&n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n&&n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((e,n)=>this.write(e,t[n]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return Object(r["tensor"])([],[0].concat(this.elementShape));const n=this.readMany(e);return l(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Object(r["stack"])(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return Object(r["tensor"])([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const n=this.readMany(t);return l(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Object(r["concat"])(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,Object(r["unstack"])(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const i=e.map(e=>(n+=e,n));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=0===n?0:t.size/n,o=[];Object(r["tidy"])(()=>{t=t.reshape([1,n,a]);for(let n=0;n<e.length;++n){const s=0===n?0:i[n-1],u=[0,s,0],c=[1,e[n],a];o[n]=Object(r["slice"])(t,u,c).reshape(this.elementShape)}return o});const s=[];for(let r=0;r<e.length;r++)s[r]=r;this.writeMany(s,o)}}p.nextId=0;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const h=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=Object(a["b"])("thenBranch",e,t,n),i=Object(a["b"])("elseBranch",e,t,n),o=Object(a["b"])("cond",e,t,n),s=Object(a["b"])("args",e,t,n),u=await o.data();return u[0]?n.functionMap[r].executeFunctionAsync(s):n.functionMap[i].executeFunctionAsync(s)}case"While":case"StatelessWhile":{const r=Object(a["b"])("body",e,t,n),i=Object(a["b"])("cond",e,t,n),o=Object(a["b"])("args",e,t,n),s=(await n.functionMap[i].executeFunctionAsync(o))[0];let u=await s.data(),c=o;while(u[0]){c=await n.functionMap[r].executeFunctionAsync(c);const e=(await n.functionMap[i].executeFunctionAsync(c))[0];u=await e.data()}return c}case"LoopCond":return[Object(a["b"])("pred",e,t,n).clone()];case"Switch":{const r=Object(a["b"])("pred",e,t,n),i=Object(a["b"])("data",e,t,n);return(await r.data())[0]?[void 0,i.clone()]:[i.clone(),void 0]}case"Merge":const i=e.inputNames.find(e=>void 0!==Object(a["c"])(e,t,n));return i?[Object(a["c"])(i,t,n).clone()]:void 0;case"Enter":const o=Object(a["b"])("frameName",e,t,n),s=Object(a["b"])("tensor",e,t,n);return n.enterFrame(o),[s.clone()];case"Exit":const u=Object(a["b"])("tensor",e,t,n);return n.exitFrame(),[u.clone()];case"NextIteration":const c=Object(a["b"])("tensor",e,t,n);return n.nextIteration(),[c.clone()];case"TensorArrayV3":const l=Object(a["b"])("size",e,t,n),d=Object(a["b"])("dtype",e,t,n),h=Object(a["b"])("elementShape",e,t,n),f=Object(a["b"])("dynamicSize",e,t,n),m=Object(a["b"])("clearAfterRead",e,t,n),v=Object(a["b"])("identicalElementShapes",e,t,n),g=Object(a["b"])("name",e,t,n),y=new p(g,d,l,h,v,f,m);return n.addTensorArray(y),[Object(r["scalar"])(y.id),Object(r["scalar"])(1)];case"TensorArrayWriteV3":const b=Object(a["b"])("tensorArrayId",e,t,n),_=Object(a["b"])("index",e,t,n),w=Object(a["b"])("tensor",e,t,n),x=n.getTensorArray(b);return x.write(_,w),[Object(r["scalar"])(1)];case"TensorArrayReadV3":const T=Object(a["b"])("tensorArrayId",e,t,n),C=Object(a["b"])("index",e,t,n),S=n.getTensorArray(T);return[S.read(C)];case"TensorArrayGatherV3":const E=Object(a["b"])("tensorArrayId",e,t,n),k=Object(a["b"])("indices",e,t,n),R=Object(a["b"])("dtype",e,t,n),O=n.getTensorArray(E);return[O.gather(k,R)];case"TensorArrayScatterV3":const A=Object(a["b"])("tensorArrayId",e,t,n),I=Object(a["b"])("indices",e,t,n),N=Object(a["b"])("tensor",e,t,n),D=n.getTensorArray(A);return D.scatter(I,N),[Object(r["scalar"])(1)];case"TensorArrayConcatV3":const P=Object(a["b"])("tensorArrayId",e,t,n),M=n.getTensorArray(P),L=Object(a["b"])("dtype",e,t,n);return[M.concat(L)];case"TensorArraySplitV3":const j=Object(a["b"])("tensorArrayId",e,t,n),B=Object(a["b"])("tensor",e,t,n),U=Object(a["b"])("lengths",e,t,n),F=n.getTensorArray(j);return F.split(U,B),[Object(r["scalar"])(1)];case"TensorArraySizeV3":const V=Object(a["b"])("tensorArrayId",e,t,n),q=n.getTensorArray(V);return[Object(r["scalar"])(q.size(),"int32")];case"TensorArrayCloseV3":const W=Object(a["b"])("tensorArrayId",e,t,n),z=n.getTensorArray(W);return z.clearAndClose(),[Object(r["scalar"])(0)];default:throw TypeError(`Node type ${e.op} is not implemented`)}},f=(e,t,n)=>{switch(e.op){case"Conv1D":{const i=Object(a["b"])("stride",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("dataFormat",e,t,n).toUpperCase(),u=Object(a["b"])("dilation",e,t,n);return[r["conv1d"](Object(a["b"])("x",e,t,n),Object(a["b"])("filter",e,t,n),i,o,s,u)]}case"Conv2D":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("dataFormat",e,t,n).toUpperCase(),u=Object(a["b"])("dilations",e,t,n);return[r["conv2d"](Object(a["b"])("x",e,t,n),Object(a["b"])("filter",e,t,n),[i[1],i[2]],o,s,[u[1],u[2]])]}case"_FusedConv2D":case"FusedDepthwiseConv2dNative":{const[i,o]=Object(a["b"])("fusedOps",e,t,n),s="biasadd"===i,u="prelu"===o,c="fusedbatchnorm"===i,l=Object(a["b"])("numArgs",e,t,n);if(s){if(u&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const d=Object(a["b"])("strides",e,t,n),p=Object(a["b"])("pad",e,t,n),h=Object(a["b"])("dataFormat",e,t,n).toUpperCase(),f=Object(a["b"])("dilations",e,t,n),[m,v]=Object(a["b"])("args",e,t,n),g="_FusedConv2D"===e.op?r["fused"].conv2d:r["fused"].depthwiseConv2d;return[g({x:Object(a["b"])("x",e,t,n),filter:Object(a["b"])("filter",e,t,n),strides:[d[1],d[2]],pad:p,dataFormat:h,dilations:[f[1],f[2]],bias:m,activation:o,preluActivationWeights:v})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=Object(a["b"])("outputShape",e,t,n),o=Object(a["b"])("strides",e,t,n),s=Object(a["b"])("pad",e,t,n);return[r["conv2dTranspose"](Object(a["b"])("x",e,t,n),Object(a["b"])("filter",e,t,n),i,[o[1],o[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("dilations",e,t,n),u=Object(a["b"])("dataFormat",e,t,n).toUpperCase();return[r["depthwiseConv2d"](Object(a["b"])("input",e,t,n),Object(a["b"])("filter",e,t,n),[i[1],i[2]],o,u,[s[1],s[2]])]}case"Conv3D":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("dataFormat",e,t,n).toUpperCase(),u=Object(a["b"])("dilations",e,t,n);return[r["conv3d"](Object(a["b"])("x",e,t,n),Object(a["b"])("filter",e,t,n),[i[1],i[2],i[3]],o,s,[u[1],u[2],u[3]])]}case"AvgPool":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("kernelSize",e,t,n);return[r["avgPool"](Object(a["b"])("x",e,t,n),[s[1],s[2]],[i[1],i[2]],o)]}case"MaxPool":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("kernelSize",e,t,n);return[r["maxPool"](Object(a["b"])("x",e,t,n),[s[1],s[2]],[i[1],i[2]],o)]}case"MaxPoolWithArgmax":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("kernelSize",e,t,n),u=Object(a["b"])("includeBatchInIndex",e,t,n),{result:c,indexes:l}=r["maxPoolWithArgmax"](Object(a["b"])("x",e,t,n),[s[1],s[2]],[i[1],i[2]],o,u);return[c,l]}case"AvgPool3D":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("kernelSize",e,t,n);return[r["avgPool3d"](Object(a["b"])("x",e,t,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],o)]}case"MaxPool3D":{const i=Object(a["b"])("strides",e,t,n),o=Object(a["b"])("pad",e,t,n),s=Object(a["b"])("kernelSize",e,t,n);return[r["maxPool3d"](Object(a["b"])("x",e,t,n),[s[1],s[2],s[3]],[i[1],i[2],i[3]],o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},m=(e,t,n)=>{switch(e.op){case"Fill":{const i=Object(a["b"])("shape",e,t,n),o=Object(a["b"])("dtype",e,t,n),s=Object(a["b"])("value",e,t,n);return[r["fill"](i,s,o)]}case"LinSpace":{const i=Object(a["b"])("start",e,t,n),o=Object(a["b"])("stop",e,t,n),s=Object(a["b"])("num",e,t,n);return[r["linspace"](i,o,s)]}case"Multinomial":{const i=Object(a["b"])("logits",e,t,n),o=Object(a["b"])("numSamples",e,t,n),s=Object(a["b"])("seed",e,t,n);return[r["multinomial"](i,o,s)]}case"OneHot":{const i=Object(a["b"])("indices",e,t,n),o=Object(a["b"])("depth",e,t,n),s=Object(a["b"])("onValue",e,t,n),u=Object(a["b"])("offValue",e,t,n);return[r["oneHot"](i,o,s,u)]}case"Ones":return[r["ones"](Object(a["b"])("shape",e,t,n),Object(a["b"])("dtype",e,t,n))];case"OnesLike":return[r["onesLike"](Object(a["b"])("x",e,t,n))];case"RandomUniform":return[r["randomUniform"](Object(a["b"])("shape",e,t,n),Object(a["b"])("minval",e,t,n),Object(a["b"])("maxval",e,t,n),Object(a["b"])("dtype",e,t,n))];case"Range":{const i=Object(a["b"])("start",e,t,n),o=Object(a["b"])("stop",e,t,n),s=Object(a["b"])("step",e,t,n);return[r["range"](i,o,s,Object(a["b"])("dtype",e,t,n))]}case"TruncatedNormal":{const i=Object(a["b"])("shape",e,t,n),o=Object(a["b"])("mean",e,t,n),s=Object(a["b"])("stdDev",e,t,n),u=Object(a["b"])("seed",e,t,n);return[r["truncatedNormal"](i,o,s,Object(a["b"])("dtype",e,t,n),u)]}case"Zeros":return[r["zeros"](Object(a["b"])("shape",e,t,n),Object(a["b"])("dtype",e,t,n))];case"ZerosLike":return[r["zerosLike"](Object(a["b"])("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},v=async(e,t,n)=>{switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const i=Object(a["b"])("boxes",e,t,n),o=Object(a["b"])("scores",e,t,n),s=Object(a["b"])("maxOutputSize",e,t,n),u=Object(a["b"])("iouThreshold",e,t,n),c=Object(a["b"])("scoreThreshold",e,t,n);if("NonMaxSuppressionV5"===e.op){const l=Object(a["b"])("softNmsSigma",e,t,n),d=await r["image"].nonMaxSuppressionWithScoreAsync(i,o,s,u,c,l);return[d.selectedIndices,d.selectedScores]}return[await r["image"].nonMaxSuppressionAsync(i,o,s,u,c)]}case"Where":{const i=Object(a["b"])("condition",e,t,n).asType("bool"),o=[await r["whereAsync"](i)];return i.dispose(),o}case"ListDiff":return r["setdiff1dAsync"](Object(a["b"])("x",e,t,n),Object(a["b"])("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}},g=(e,t,n)=>{switch(e.op){case"TopKV2":{const i=Object(a["b"])("x",e,t,n),o=Object(a["b"])("k",e,t,n),s=Object(a["b"])("sorted",e,t,n),u=r["topk"](i,o,s);return[u.values,u.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},y=(e,t,n)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const i=Object(a["b"])("default",e,t,n);return[Object(a["c"])(e.name,t,n)||i];case"Placeholder":return[Object(a["c"])(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[Object(a["b"])("x",e,t,n).clone()];case"IdentityN":return Object(a["b"])("x",e,t,n).map(e=>e.clone());case"Snapshot":const o=Object(a["b"])("x",e,t,n);return[o.clone()];case"Shape":return[r["tensor1d"](Object(a["b"])("x",e,t,n).shape,"int32")];case"ShapeN":return Object(a["b"])("x",e,t,n).map(e=>r["tensor1d"](e.shape));case"Size":return[r["scalar"](Object(a["b"])("x",e,t,n).size,"int32")];case"Rank":return[r["scalar"](Object(a["b"])("x",e,t,n).rank,"int32")];case"NoOp":return[r["scalar"](1)];case"Print":const s=Object(a["b"])("x",e,t,n),u=Object(a["b"])("data",e,t,n),c=Object(a["b"])("message",e,t,n),l=Object(a["b"])("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let e=0;e<u.length;e++)console.log(Array.prototype.slice.call(u[e].dataSync()).slice(0,l));return[s];default:throw TypeError(`Node type ${e.op} is not implemented`)}},b=(e,t,n)=>{switch(e.op){case"ResizeBilinear":{const i=Object(a["b"])("images",e,t,n),o=Object(a["b"])("size",e,t,n),s=Object(a["b"])("alignCorners",e,t,n);return[r["image"].resizeBilinear(i,[o[0],o[1]],s)]}case"ResizeNearestNeighbor":{const i=Object(a["b"])("images",e,t,n),o=Object(a["b"])("size",e,t,n),s=Object(a["b"])("alignCorners",e,t,n);return[r["image"].resizeNearestNeighbor(i,[o[0],o[1]],s)]}case"CropAndResize":{const i=Object(a["b"])("image",e,t,n),o=Object(a["b"])("boxes",e,t,n),s=Object(a["b"])("boxInd",e,t,n),u=Object(a["b"])("cropSize",e,t,n),c=Object(a["b"])("method",e,t,n),l=Object(a["b"])("extrapolationValue",e,t,n);return[r["image"].cropAndResize(i,o,s,u,c,l)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},_=(e,t,n)=>{switch(e.op){case"Equal":return[r["equal"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"NotEqual":return[r["notEqual"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Greater":return[r["greater"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"GreaterEqual":return[r["greaterEqual"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Less":return[r["less"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"LessEqual":return[r["lessEqual"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"LogicalAnd":return[r["logicalAnd"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"LogicalNot":return[r["logicalNot"](Object(a["b"])("a",e,t,n))];case"LogicalOr":return[r["logicalOr"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];case"Select":case"SelectV2":return[r["where"](Object(a["b"])("condition",e,t,n),Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},w=(e,t,n)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r["matMul"](Object(a["b"])("a",e,t,n),Object(a["b"])("b",e,t,n),Object(a["b"])("transposeA",e,t,n),Object(a["b"])("transposeB",e,t,n))];case"Transpose":return[r["transpose"](Object(a["b"])("x",e,t,n),Object(a["b"])("perm",e,t,n))];case"_FusedMatMul":const[i,o]=Object(a["b"])("fusedOps",e,t,n),s="biasadd"===i,u="prelu"===o,c=Object(a["b"])("numArgs",e,t,n);if(s){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,d]=Object(a["b"])("args",e,t,n);return[r["fused"].matMul({a:Object(a["b"])("a",e,t,n),b:Object(a["b"])("b",e,t,n),transposeA:Object(a["b"])("transposeA",e,t,n),transposeB:Object(a["b"])("transposeB",e,t,n),bias:l,activation:o,preluActivationWeights:d})];default:throw TypeError(`Node type ${e.op} is not implemented`)}},x=(e,t,n)=>{switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[r["batchNorm"](Object(a["b"])("x",e,t,n),Object(a["b"])("mean",e,t,n),Object(a["b"])("variance",e,t,n),Object(a["b"])("offset",e,t,n),Object(a["b"])("scale",e,t,n),Object(a["b"])("epsilon",e,t,n))];case"FusedBatchNormV3":return[r["batchNorm"](Object(a["b"])("x",e,t,n),Object(a["b"])("mean",e,t,n),Object(a["b"])("variance",e,t,n),Object(a["b"])("offset",e,t,n),Object(a["b"])("scale",e,t,n),Object(a["b"])("epsilon",e,t,n))];case"LRN":return[r["localResponseNormalization"](Object(a["b"])("x",e,t,n),Object(a["b"])("radius",e,t,n),Object(a["b"])("bias",e,t,n),Object(a["b"])("alpha",e,t,n),Object(a["b"])("beta",e,t,n))];case"Softmax":return[r["softmax"](Object(a["b"])("x",e,t,n))];case"LogSoftmax":return[r["logSoftmax"](Object(a["b"])("x",e,t,n))];case"SparseToDense":return[r["sparseToDense"](Object(a["b"])("sparseIndices",e,t,n),Object(a["b"])("outputShape",e,t,n),Object(a["b"])("sparseValues",e,t,n),Object(a["b"])("defaultValue",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},T=(e,t,n)=>{switch(e.op){case"Max":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["max"](Object(a["b"])("x",e,t,n),i,o)]}case"Mean":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["mean"](Object(a["b"])("x",e,t,n),i,o)]}case"Min":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["min"](Object(a["b"])("x",e,t,n),i,o)]}case"Sum":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["sum"](Object(a["b"])("x",e,t,n),i,o)]}case"All":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["all"](Object(a["b"])("x",e,t,n),i,o)]}case"Any":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["any"](Object(a["b"])("x",e,t,n),i,o)]}case"ArgMax":{const i=Object(a["b"])("axis",e,t,n);return[r["argMax"](Object(a["b"])("x",e,t,n),i)]}case"ArgMin":{const i=Object(a["b"])("axis",e,t,n);return[r["argMin"](Object(a["b"])("x",e,t,n),i)]}case"Prod":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("keepDims",e,t,n);return[r["prod"](Object(a["b"])("x",e,t,n),i,o)]}case"Cumsum":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("exclusive",e,t,n),s=Object(a["b"])("reverse",e,t,n);return[r["cumsum"](Object(a["b"])("x",e,t,n),i,o,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},C=(e,t,n)=>{switch(e.op){case"ConcatV2":case"Concat":{const i=Object(a["b"])("n",e,t,n),o=Object(a["b"])("axis",e,t,n);let s=Object(a["b"])("tensors",e,t,n);return s=s.slice(0,i),[r["concat"](s,o)]}case"GatherV2":case"Gather":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("x",e,t,n),s=Object(a["b"])("indices",e,t,n);return[r["gather"](o,s.asType("int32"),i)]}case"ReverseV2":case"Reverse":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("x",e,t,n);return[r["reverse"](o,i)]}case"Slice":{const i=Object(a["b"])("begin",e,t,n),o=Object(a["b"])("size",e,t,n);return[r["slice"](Object(a["b"])("x",e,t,n),i,o)]}case"StridedSlice":{const i=Object(a["b"])("begin",e,t,n),o=Object(a["b"])("end",e,t,n),s=Object(a["b"])("strides",e,t,n),u=Object(a["b"])("beginMask",e,t,n),c=Object(a["b"])("endMask",e,t,n),l=Object(a["b"])("ellipsisMask",e,t,n),d=Object(a["b"])("newAxisMask",e,t,n),p=Object(a["b"])("shrinkAxisMask",e,t,n),h=Object(a["b"])("x",e,t,n);if(1===i.length&&h.shape.length>1)for(let e=1;e<h.shape.length;e++)i.push(0),o.push(h.shape[e]),s.push(s[0]);return[r["stridedSlice"](h,i,o,s,u,c,l,d,p)]}case"Pack":return r["tidy"](()=>{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("tensors",e,t,n),s=o[0].shape,u=o[0].squeeze().shape,c=o.map(e=>{const t=r["util"].arraysEqual(e.shape,s);if(!t&&!r["util"].arraysEqual(e.squeeze().shape,u))throw new Error("the input tensors shape does not match");return t?e:e.reshape(s)});return[r["stack"](c,i)]});case"Unpack":return r["tidy"](()=>{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("tensor",e,t,n);return r["unstack"](o,i)});case"Tile":{const i=Object(a["b"])("reps",e,t,n);return[r["tile"](Object(a["b"])("x",e,t,n),i)]}case"Split":case"SplitV":{const i=Object(a["b"])("axis",e,t,n),o=Object(a["b"])("numOrSizeSplits",e,t,n);return r["split"](Object(a["b"])("x",e,t,n),o,i)}case"ScatterNd":{const i=Object(a["b"])("indices",e,t,n),o=Object(a["b"])("values",e,t,n),s=Object(a["b"])("shape",e,t,n);return[r["scatterND"](i,o,s)]}case"GatherNd":{const i=Object(a["b"])("x",e,t,n),o=Object(a["b"])("indices",e,t,n);return[r["gatherND"](i,o)]}case"SparseToDense":{const i=Object(a["b"])("sparseIndices",e,t,n),o=Object(a["b"])("outputShape",e,t,n),s=Object(a["b"])("sparseValues",e,t,n),u=Object(a["b"])("defaultValue",e,t,n);return[r["sparseToDense"](i,s,o,s.dtype===u.dtype?u:u.asType(s.dtype))]}default:throw TypeError(`Node type ${e.op} is not implemented`)}},S=(e,t,n)=>{switch(e.op){case"FFT":return[r["fft"](Object(a["b"])("x",e,t,n))];case"IFFT":return[r["ifft"](Object(a["b"])("x",e,t,n))];case"RFFT":return[r["rfft"](Object(a["b"])("x",e,t,n))];case"IRFFT":return[r["irfft"](Object(a["b"])("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}},E=(e,t,n)=>{switch(e.op){case"Cast":return[r["cast"](Object(a["b"])("x",e,t,n),Object(a["b"])("dtype",e,t,n))];case"ExpandDims":{const i=Object(a["b"])("axis",e,t,n);return[r["expandDims"](Object(a["b"])("x",e,t,n),i)]}case"Squeeze":{const i=Object(a["b"])("axis",e,t,n);return[r["squeeze"](Object(a["b"])("x",e,t,n),i)]}case"Reshape":return[r["reshape"](Object(a["b"])("x",e,t,n),Object(a["b"])("shape",e,t,n))];case"PadV2":case"Pad":return[r["pad"](Object(a["b"])("x",e,t,n),Object(a["f"])(Object(a["b"])("padding",e,t,n),2),Object(a["b"])("constantValue",e,t,n))];case"SpaceToBatchND":{const i=Object(a["b"])("blockShape",e,t,n),o=Object(a["f"])(Object(a["b"])("paddings",e,t,n),2);return[r["spaceToBatchND"](Object(a["b"])("x",e,t,n),i,o)]}case"BatchToSpaceND":{const i=Object(a["b"])("blockShape",e,t,n),o=Object(a["f"])(Object(a["b"])("crops",e,t,n),2);return[r["batchToSpaceND"](Object(a["b"])("x",e,t,n),i,o)]}case"DepthToSpace":{const i=Object(a["b"])("blockSize",e,t,n),o=Object(a["b"])("dataFormat",e,t,n).toUpperCase();return[r["depthToSpace"](Object(a["b"])("x",e,t,n),i,o)]}case"BroadcastTo":return[r["broadcastTo"](Object(a["b"])("x",e,t,n),Object(a["b"])("shape",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function k(e,t,n){const i=((e,t,n)=>{switch(e.category){case"arithmetic":return r["tidy"](()=>u(e,t,n));case"basic_math":return r["tidy"](()=>c(e,t,n));case"control":return h(e,t,n);case"convolution":return r["tidy"](()=>f(e,t,n));case"creation":return r["tidy"](()=>m(e,t,n));case"dynamic":return v(e,t,n);case"evaluation":return r["tidy"](()=>g(e,t,n));case"image":return r["tidy"](()=>b(e,t,n));case"graph":return r["tidy"](()=>y(e,t,n));case"logical":return r["tidy"](()=>_(e,t,n));case"matrices":return r["tidy"](()=>w(e,t,n));case"normalization":return r["tidy"](()=>x(e,t,n));case"reduction":return r["tidy"](()=>T(e,t,n));case"slice_join":return r["tidy"](()=>C(e,t,n));case"spectral":return r["tidy"](()=>S(e,t,n));case"transformation":return r["tidy"](()=>E(e,t,n));case"custom":const i=Object(s["a"])(e.op);if(i&&i.customExecutor)return i.customExecutor(new o(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return i instanceof Promise?i.then(e=>[].concat(e)):[].concat(i)}class R{constructor(e,t,n={}){this.weightMap=e,this.tensorArrayMap=t,this.functionMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O(e,t,n){const r=new Set,i=[];let o=null,s=null;const u=new Set,c=Object.keys(e).map(e=>Object(a["e"])(e)[0]),l=[...t];while(l.length>0){const e=l.pop();(D(e)||P(e))&&null==o&&(o=e,s=o.children.map(e=>e.name).filter(e=>r.has(e))),r.add(e.name),null==n[e.name]&&(-1===c.indexOf(e.name)&&(0!==e.inputs.length?e.inputs.forEach(e=>{u.has(e.name)||(u.add(e.name),l.push(e))}):i.push(e.name)))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:s}}function A(e,t,n){const{usedNodes:r,inputs:i}=n,o=[],s=Object.keys(i).map(e=>Object(a["e"])(e)[0]).map(t=>e.nodes[t]);s.forEach(e=>{r.has(e.name)&&o.push(e)}),e.weights.forEach(e=>{r.has(e.name)&&o.push(e)});const u=new Set,c=[];while(o.length>0){const e=o.pop();u.add(e.name),t[e.name]||c.push(e),e.children.forEach(e=>{!u.has(e.name)&&r.has(e.name)&&e.inputs.every(e=>u.has(e.name))&&o.push(e)})}return c}const I=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile"],N=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function D(e){return I.indexOf(e.op)>=0}function P(e){return N.indexOf(e.op)>=0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=e.outputs,this._inputs=e.inputs,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach(t=>{this._functionExecutorMap[t]=new M(e.functions[t],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(t=>e[t].map(e=>e.id));this._weightIds=[].concat(...t),this._weightMap=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams["shape"]?e.attrParams["shape"].value:void 0,dtype:e.attrParams["dtype"]?e.attrParams["dtype"].value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams["shape"]?e.attrParams["shape"].value:void 0,dtype:e.attrParams["dtype"]?e.attrParams["dtype"].value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const n=e.map(e=>e.name).sort(),r=t.map(e=>e.name).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const n=O(e,t,this.weightMap),{missingInputs:r,dynamicNode:i,syncInputs:a}=n;if(null!=i)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const n=t.map(e=>e.name),i=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${i}]. Missing the following inputs: [${r}]`)}return A(this.graph,this.weightMap,n)}execute(e,t){e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const i=n.map(e=>this.graph.nodes[Object(a["e"])(e)[0]]),o=t.map(e=>this.graph.nodes[Object(a["e"])(e)[0]]),s=this.getCompilationKey(i,o);let u=this.compiledMap.get(s);null==u&&(u=this.compile(e,o),this.compiledMap.set(s,u));const c={};return Object(r["tidy"])(()=>{const n=new R(this.weightMap,c,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{const[n,i]=Object(a["e"])(t),o=[];o[i]=e[t],r[n]=o});const i=this.getFrozenTensorIds(r),o={};for(let e=0;e<u.length;e++){const a=u[e];if(!r[a.name]){const e=k(a,r,n);if(e instanceof Promise)throw new Error(`The execution of the op '${a.op}' returned a promise. Please use model.executeAsync() instead.`);r[a.name]=e,this.checkTensorForDisposal(a.name,a,r,n,i,t,o)}}return t.map(e=>Object(a["c"])(e,r,n))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(t=>e[t]).map(e=>e.map(e=>e.id)));return new Set(t)}checkTensorForDisposal(e,t,n,r,i,o,s){"control"!==t.category&&-1===o.indexOf(e)&&(n[e].forEach(e=>{null!=e&&(s[e.id]=(s[e.id]||0)+t.children.length)}),t.inputs.forEach(e=>{if("control"!==e.category){const t=Object(a["d"])(e.name,n,r);null!=t&&t.forEach(e=>{if(e&&!i.has(e.id)){const t=s[e.id];1===t?(e.dispose(),delete s[e.id]):null!=t&&s[e.id]--}})}}))}async executeAsync(e,t,n=!1){e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r={},i=new R(this.weightMap,r,this.functionExecutorMap),o=await this.executeWithControlFlow(e,i,t,n),s=t.map(e=>Object(a["c"])(e,o,i)),u=new Set(s.map(e=>e.id)),c=new Set(Object.keys(e).map(t=>e[t].id));return Object.keys(o).forEach(e=>{const t=o[e];t.forEach(e=>{!e||e.isDisposed||u.has(e.id)||c.has(e.id)||-1!==this.weightIds.indexOf(e.id)||e.dispose()})}),s}async executeFunctionAsync(e){const t=e.reduce((e,t,n)=>(e[this.inputs[n].name]=t,e),{});return this.executeAsync(t,this.outputNodes,!0)}async executeWithControlFlow(e,t,n,r){const i=Object.keys(e),o=i.map(e=>this.graph.nodes[Object(a["e"])(e)[0]]),s=n.map(e=>this.graph.nodes[Object(a["e"])(e)[0]]),{usedNodes:u,missingInputs:c,dynamicNode:l,syncInputs:d}=O(e,s,this.weightMap),p=[...o,...this.graph.weights].map(e=>({node:e,contexts:t.currentContext})),h=Object.assign({},this.weightMap);Object.keys(e).forEach(t=>{const[n,r]=Object(a["e"])(t),i=[];i[r]=e[t],h[n]=i});const f={},m=this.getFrozenTensorIds(h),v={};while(p.length>0){const e=this.processStack(o,p,t,h,v,m,n,f,u);await Promise.all(e)}null!=l||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const g=s.filter(e=>!D(e)&&!Object(a["c"])(e.name,h,t)).map(e=>e.name);if(g.length>0){let e="";throw null!=l&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${g}] from the provided inputs [${i}]. Consider providing the following inputs: [${c}]. ${e}`)}return h}processStack(e,t,n,r,i,o,s,u,c){const l=[];while(t.length>0){const d=t.pop();n.currentContext=d.contexts;let p="";if("Enter"===d.node.op&&Object(a["b"])("isConstant",d.node,r,n)&&([p]=Object(a["a"])(d.node.name,n)),-1===e.indexOf(d.node)){const e=k(d.node,r,n);p||([p]=Object(a["a"])(d.node.name,n));const h=n.currentContext;e instanceof Promise?l.push(e.then(e=>(r[p]=e,n.currentContext=h,this.checkTensorForDisposal(p,d.node,r,n,o,s,u),this.processChildNodes(d.node,t,n,r,i,c),e))):(r[p]=e,this.checkTensorForDisposal(p,d.node,r,n,o,s,u),this.processChildNodes(d.node,t,n,r,i,c))}else this.processChildNodes(d.node,t,n,r,i,c)}return l}processChildNodes(e,t,n,r,i,o){e.children.forEach(e=>{const[s]=Object(a["a"])(e.name,n);!i[s]&&o.has(e.name)&&("Merge"===e.op?e.inputNames.some(e=>!!Object(a["c"])(e,r,n))&&(i[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every(e=>!!Object(a["c"])(e,r,n))&&(i[s]=!0,t.push({contexts:n.currentContext,node:e})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(e=>e.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const n=e[t],[i]=Object(a["e"])(t),o=this.graph.nodes[i];if(o.attrParams["shape"]&&o.attrParams["shape"].value){const e=o.attrParams["shape"].value,t=e.length===n.shape.length&&n.shape.every((t,n)=>-1===e[n]||e[n]===t);r["util"].assert(t,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`)}o.attrParams["dtype"]&&o.attrParams["dtype"].value&&r["util"].assert(n.dtype===o.attrParams["dtype"].value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams["dtype"].value}, but was ${n.dtype}`)})}mapInputs(e){const t={};for(const n in e)if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]){const r=this._signature.inputs[n];t[r.name]=e[n]}else t[n]=e[n];return t}checkInputs(e){const t=Object.keys(e).filter(e=>{const[t]=Object(a["e"])(e);return null==this.graph.nodes[t]});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(e=>{if(null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[e]){const t=this._signature.outputs[e];return t.name}return e},{})}checkOutputs(e){e.forEach(e=>{const[t]=Object(a["e"])(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)})}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L="?tfjs-format=file",j="model.json";class B{constructor(e,t={}){this.modelUrl=e,this.loadOptions=t,this.version="n/a",null==t&&(this.loadOptions={})}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=r["io"].browserHTTPRequest(e,this.loadOptions);else{const t=r["io"].getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(r["io"].browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=await this.handler.load();return this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let n={};null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const a=r["io"].decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);return this.executor=new M(i["a"].Instance.transformGraph(t,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),!0}async save(e,t){if("string"===typeof e){const t=r["io"].getSaveHandlers(e);if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){return this.execute(e,this.outputNodes)}normalizeInputs(e){if(!(e instanceof r["Tensor"])&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,n,r)=>(t[n]=e[r],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,n)=>(t[n]=[e[n]],t),{})}dispose(){this.executor.dispose()}}async function U(e,t={}){if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&null==e.load&&(e.endsWith("/")||(e+="/"),e=`${e}${j}${L}`);const n=new B(e,t);return await n.load(),n}
/** @license See the LICENSE file. */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
    * @license
    * Copyright 2020 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */
var F=function(e,t){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function V(e,t){function n(){this.constructor=e}F(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var q=function(){return(q=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function W(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function z(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function G(e){var t=e.shape[2],n=e.argMax(2).reshape([-1]);return Object(r["oneHot"])(n,t)}function H(e,t){return e.mul(t)}function $(e,t){return Object(r["tidy"])((function(){return e.greater(Object(r["scalar"])(t)).toInt()}))}function K(e,t){var n=t.shape,i=n[0],a=n[1],o=n[2];return Object(r["tidy"])((function(){var n=G(t),s=Object(r["range"])(0,o,1,"int32").expandDims(1);return H(n.matMul(s).toInt().reshape([i,a]).add(Object(r["scalar"])(1,"int32")),e).sub(Object(r["scalar"])(1,"int32"))}))}function Y(e){var t=e.shape,n=t[0],i=t[1],a=t[2];return Object(r["tidy"])((function(){var t=G(e),o=Object(r["range"])(0,a,1,"int32").expandDims(1);return t.matMul(o).toInt().reshape([n,i])}))}var X=function(){function e(e,t){this.model=e,this.outputStride=t;var n=this.model.inputs[0].shape;r["util"].assert(-1===n[1]&&-1===n[2],(function(){return"Input shape ["+n[1]+", "+n[2]+"] must both be equal to or -1"}))}return e.prototype.predict=function(e){var t=this;return Object(r["tidy"])((function(){var n=t.preprocessInput(e.toFloat()).expandDims(0),r=t.model.predict(n).map((function(e){return e.squeeze([0])})),i=t.nameOutputResults(r);return{heatmapScores:i.heatmap.sigmoid(),offsets:i.offsets,displacementFwd:i.displacementFwd,displacementBwd:i.displacementBwd,segmentation:i.segmentation,partHeatmaps:i.partHeatmaps,longOffsets:i.longOffsets,partOffsets:i.partOffsets}}))},e.prototype.dispose=function(){this.model.dispose()},e}(),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return V(t,e),t.prototype.preprocessInput=function(e){return Object(r["tidy"])((function(){return Object(r["div"])(e,127.5).sub(1)}))},t.prototype.nameOutputResults=function(e){return{offsets:e[0],segmentation:e[1],partHeatmaps:e[2],longOffsets:e[3],heatmap:e[4],displacementFwd:e[5],displacementBwd:e[6],partOffsets:e[7]}},t}(X),Q=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],Z=Q.length,ee=Q.reduce((function(e,t,n){return e[t]=n,e}),{}),te=[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]],ne=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]];te.map((function(e){var t=e[0],n=e[1];return[ee[t],ee[n]]}));function re(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1],s=n.top,u=n.bottom;return[o/(n.left+n.right+i),a/(s+u+r)]}function ie(e,t,n,r){return{y:r.get(e,t,n),x:r.get(e,t,n+Z)}}function ae(e,t,n){var r=ie(e.heatmapY,e.heatmapX,e.id,n),i=r.y,a=r.x;return{x:e.heatmapX*t+a,y:e.heatmapY*t+i}}function oe(e,t,n){return e<t?t:e>n?n:e}function se(e,t,n,r){var i=n-e,a=r-t;return i*i+a*a}function ue(e,t){return{x:e.x+t.x,y:e.y+t.y}}function ce(e,t,n){void 0===n&&(n=.3);for(var r=0,i=0,a=0;a<e.length;a++)t.keypoints[a].score>n&&(i+=1,r+=Math.pow(e[a].x-t.keypoints[a].position.x,2)+Math.pow(e[a].y-t.keypoints[a].position.y,2));return 0===i?r=1/0:r/=i,r}function le(e,t,n,r){var i=t[0],a=t[1],o=n[0],s=n[1],u=Math.round(((i+e.y+1)*s-1)/r);return{x:Math.round(((a+e.x+1)*o-1)/r),y:u}}function de(e,t,n,r,i,a,o){for(var s=o[0],u=o[1],c=n(e),l=c.y*r+c.x,d=i[Z*(2*l)+t],p=i[Z*(2*l+1)+t],h=e.y+d,f=e.x+p,m=0;m<a;m++){h=Math.min(h,s-1);var v=n({x:f=Math.min(f,u-1),y:h}),g=v.y*r+v.x;h+=d=i[Z*(2*g)+t],f+=p=i[Z*(2*g+1)+t]}return{x:f,y:h}}function pe(e,t,n,r,i,a,o,s,u,c){for(var l=i[0],d=i[1],p=a[0],h=a[1],f=s[0],m=s[1],v=[],g=function(e){return le(e,[l,d],[p,h],u)},y=0;y<r;y++){var b=de(e,y,g,o,t,c,[f,m]);v.push(b)}for(var _=-1,w=1/0,x=0;x<n.length;x++){var T=ce(v,n[x]);T<w&&(_=x,w=T)}return _}function he(e,t){var n=e[0],r=e[1];return[Math.round((r-1)/t+1),Math.round((n-1)/t+1)]}function fe(e,t,n,r,i,a,o,s,u,c){var l=o[0],d=o[1];void 0===c&&(c=5);for(var p=n.map((function(e){return new Uint8Array(r*i).fill(0)})),h=s.top,f=s.left,m=re([r,i],[l,d],s),v=m[0],g=m[1],y=he([l,d],a)[0],b=0;b<r;b+=1)for(var _=0;_<i;_+=1){var w=b*i+_;if(1===e[w]){var x=pe({x:_,y:b},t,n,c,[h,f],[v,g],y,[r,i],a,u);x>=0&&(p[x][w]=1)}}return p}function me(e,t,n,r,i,a,o,s,u,c,l){var d=s[0],p=s[1];void 0===l&&(l=5);for(var h=r.map((function(e){return new Int32Array(i*a).fill(-1)})),f=u.top,m=u.left,v=re([i,a],[d,p],u),g=v[0],y=v[1],b=he([d,p],o)[0],_=0;_<i;_+=1)for(var w=0;w<a;w+=1){var x=_*a+w;if(1===e[x]){var T=pe({x:w,y:_},t,r,l,[f,m],[g,y],b,[i,a],o,c);T>=0&&(h[T][x]=n[x])}}return h}function ve(e,t,n,i,a,o,s,u,c,l,d){for(var p=s[0],h=s[1],f=e.shape,m=f[0],v=f[1],g=t.shape.slice(0,2),y=g[0],b=g[1],_=t.reshape([y,b,2,Z]),w=new Float32Array(d*Z*3).fill(0),x=0;x<n.length;x++)for(var T=x*Z*3,C=n[x],S=0;S<Z;S++){var E=C.keypoints[S],k=T+3*S;w[k]=E.score,w[k+1]=E.position.y,w[k+2]=E.position.x}var R=re([i,a],[p,h],u),O=R[0],A=R[1],I=Object(r["tensor"])(w,[d,Z,3]),N=u.top,D=u.left,P={variableNames:["segmentation","longOffsets","poses"],outputShape:[m,v],userCode:"\n    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {\n      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));\n    }\n\n    float convertToPositionInOutputFloat(\n        int pos, int pad, float scale, int stride) {\n      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);\n    }\n\n    float dist(float x1, float y1, float x2, float y2) {\n      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);\n    }\n\n    float sampleLongOffsets(float h, float w, int d, int k) {\n      float fh = fract(h);\n      float fw = fract(w);\n      int clH = int(ceil(h));\n      int clW = int(ceil(w));\n      int flH = int(floor(h));\n      int flW = int(floor(w));\n      float o11 = getLongOffsets(flH, flW, d, k);\n      float o12 = getLongOffsets(flH, clW, d, k);\n      float o21 = getLongOffsets(clH, flW, d, k);\n      float o22 = getLongOffsets(clH, clW, d, k);\n      float o1 = mix(o11, o12, fw);\n      float o2 = mix(o21, o22, fw);\n      return mix(o1, o2, fh);\n    }\n\n    int findNearestPose(int h, int w) {\n      float prob = getSegmentation(h, w);\n      if (prob < 1.0) {\n        return -1;\n      }\n\n      // Done(Tyler): convert from output space h/w to strided space.\n      float stridedH = convertToPositionInOutputFloat(\n        h, "+N+", "+A+", "+o+");\n      float stridedW = convertToPositionInOutputFloat(\n        w, "+D+", "+O+", "+o+");\n\n      float minDist = 1000000.0;\n      int iMin = -1;\n      for (int i = 0; i < "+d+"; i++) {\n        float curDistSum = 0.0;\n        int numKpt = 0;\n        for (int k = 0; k < "+Z+"; k++) {\n          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);\n          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);\n\n          float y = float(h) + dy;\n          float x = float(w) + dx;\n\n          for (int s = 0; s < "+c+"; s++) {\n            int yRounded = round(min(y, float("+(i-1)+")));\n            int xRounded = round(min(x, float("+(a-1)+")));\n\n            float yStrided = convertToPositionInOutputFloat(\n              yRounded, "+N+", "+A+", "+o+");\n            float xStrided = convertToPositionInOutputFloat(\n              xRounded, "+D+", "+O+", "+o+");\n\n            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);\n            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);\n\n            y = y + dy;\n            x = x + dx;\n          }\n\n          float poseScore = getPoses(i, k, 0);\n          float poseY = getPoses(i, k, 1);\n          float poseX = getPoses(i, k, 2);\n          if (poseScore > "+l+") {\n            numKpt = numKpt + 1;\n            curDistSum = curDistSum + dist(x, y, poseX, poseY);\n          }\n        }\n        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {\n          minDist = curDistSum / float(numKpt);\n          iMin = i;\n        }\n      }\n      return iMin;\n    }\n\n    void main() {\n        ivec2 coords = getOutputCoords();\n        int nearestPose = findNearestPose(coords[0], coords[1]);\n        setOutput(float(nearestPose));\n      }\n  "};return Object(r["backend"])().compileAndRun(P,[e,_,I])}function ge(e,t){return Object(r["tidy"])((function(){return e.equal(Object(r["scalar"])(t)).toInt()}))}function ye(e,t,n){return Object(r["tidy"])((function(){return e.equal(Object(r["scalar"])(n)).toInt().mul(t.add(1)).sub(1)}))}function be(){return"webgl"===Object(r["getBackend"])()}function _e(e,t,n,i,a,o,s,u,c,l,d,p){var h=s[0],f=s[1];return void 0===c&&(c=.2),void 0===l&&(l=8),void 0===d&&(d=.3),void 0===p&&(p=10),W(this,void 0,void 0,(function(){var s,m,v,g,y;return z(this,(function(b){switch(b.label){case 0:return s=n.filter((function(e){return e.score>=c})),be()?(v=Object(r["tidy"])((function(){var n=ve(e,t,s,i,a,o,[h,f],u,l,d,p);return s.map((function(e,t){return ge(n,t)}))})),[4,Promise.all(v.map((function(e){return e.data()})))]):[3,2];case 1:return m=b.sent(),v.forEach((function(e){return e.dispose()})),[3,5];case 2:return[4,e.data()];case 3:return g=b.sent(),[4,t.data()];case 4:y=b.sent(),m=fe(g,y,s,i,a,o,[h,f],u,l),b.label=5;case 5:return[2,m.map((function(e,t){return{data:e,pose:s[t],width:a,height:i}}))]}}))}))}function we(e,t,n,i,a,o,s,u,c,l,d,p,h){var f=u[0],m=u[1];return void 0===l&&(l=.2),void 0===d&&(d=8),void 0===p&&(p=.3),void 0===h&&(h=10),W(this,void 0,void 0,(function(){var u,v,g,y,b,_;return z(this,(function(w){switch(w.label){case 0:return u=i.filter((function(e){return e.score>=l})),be()?(g=Object(r["tidy"])((function(){var r=ve(e,t,u,a,o,s,[f,m],c,d,p,h);return u.map((function(e,t){return ye(r,n,t)}))})),[4,Promise.all(g.map((function(e){return e.data()})))]):[3,2];case 1:return v=w.sent(),g.forEach((function(e){return e.dispose()})),[3,6];case 2:return[4,e.data()];case 3:return y=w.sent(),[4,t.data()];case 4:return b=w.sent(),[4,n.data()];case 5:_=w.sent(),v=me(y,b,_,u,a,o,s,[f,m],c,d),w.label=6;case 6:return[2,v.map((function(e,t){return{pose:u[t],data:e,height:a,width:o}}))]}}))}))}function xe(e){return Math.floor(e/2)}var Te=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(xe(e),e);)this.exchange(e,xe(e)),e=xe(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var n=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=n},e}();function Ce(e,t,n,r,i,a){for(var o=a.shape,s=o[0],u=o[1],c=!0,l=Math.max(n-i,0),d=Math.min(n+i+1,s),p=l;p<d;++p){for(var h=Math.max(r-i,0),f=Math.min(r+i+1,u),m=h;m<f;++m)if(a.get(p,m,e)>t){c=!1;break}if(!c)break}return c}function Se(e,t,n){for(var r=n.shape,i=r[0],a=r[1],o=r[2],s=new Te(i*a*o,(function(e){return e.score})),u=0;u<i;++u)for(var c=0;c<a;++c)for(var l=0;l<o;++l){var d=n.get(u,c,l);d<e||Ce(l,d,u,c,t,n)&&s.enqueue({score:d,part:{heatmapY:u,heatmapX:c,id:l}})}return s}var Ee=ne.map((function(e){var t=e[0],n=e[1];return[ee[t],ee[n]]})),ke=Ee.map((function(e){return e[1]})),Re=Ee.map((function(e){return e[0]}));function Oe(e,t,n){var r=n.shape[2]/2;return{y:n.get(t.y,t.x,e),x:n.get(t.y,t.x,r+e)}}function Ae(e,t,n,r){return{y:oe(Math.round(e.y/t),0,n-1),x:oe(Math.round(e.x/t),0,r-1)}}function Ie(e,t,n,r,i,a,o,s){void 0===s&&(s=2);for(var u=r.shape,c=u[0],l=u[1],d=Oe(e,Ae(t.position,a,c,l),o),p=ue(t.position,d),h=0;h<s;h++){var f=Ae(p,a,c,l),m=ie(f.y,f.x,n,i);p=ue({x:f.x*a,y:f.y*a},{x:m.x,y:m.y})}var v=Ae(p,a,c,l),g=r.get(v.y,v.x,n);return{position:p,part:Q[n],score:g}}function Ne(e,t,n,r,i,a){var o=t.shape[2],s=ke.length,u=new Array(o),c=e.part,l=e.score,d=ae(c,r,n);u[c.id]={score:l,part:Q[c.id],position:d};for(var p=s-1;p>=0;--p){var h=ke[p],f=Re[p];u[h]&&!u[f]&&(u[f]=Ie(p,u[h],f,t,n,r,a))}for(p=0;p<s;++p)h=Re[p],f=ke[p],u[h]&&!u[f]&&(u[f]=Ie(p,u[h],f,t,n,r,i));return u}function De(e,t,n,r){var i=n.x,a=n.y;return e.some((function(e){var n=e.keypoints[r].position;return se(a,i,n.y,n.x)<=t}))}function Pe(e,t,n){return n.reduce((function(n,r,i){var a=r.position,o=r.score;return De(e,t,a,i)||(n+=o),n}),0)/n.length}var Me=1;function Le(e,t,n,r,i,a,o,s){void 0===o&&(o=.5),void 0===s&&(s=20);for(var u=[],c=Se(o,Me,e),l=s*s;u.length<a&&!c.empty();){var d=c.dequeue();if(!De(u,l,ae(d.part,i,t),d.part.id)){var p=Ne(d,e,t,i,n,r),h=Pe(u,l,p);u.push({keypoints:p,score:h})}}return u}var je,Be=[-123.15,-115.9,-103.06],Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return V(t,e),t.prototype.preprocessInput=function(e){return e.add(Be)},t.prototype.nameOutputResults=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5];return{offsets:a,segmentation:e[6],partHeatmaps:o,longOffsets:i,heatmap:r,displacementFwd:n,displacementBwd:t,partOffsets:e[7]}},t}(X),Fe="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",Ve="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function qe(e,t){var n="model-stride"+e+".json";return 4===t?Fe+"float/"+n:Fe+"quant"+t+"/"+n}function We(e,t,n){var r={1:"100",.75:"075",.5:"050"},i="model-stride"+e+".json";return 4===n?Ve+"float/"+r[t]+"/"+i:Ve+"quant"+n+"/"+r[t]+"/"+i}function ze(e){if(0!==e.offsetHeight&&0!==e.offsetWidth)return[e.offsetHeight,e.offsetWidth];if(null!=e.height&&null!=e.width)return[e.height,e.width];throw new Error("HTMLImageElement must have height and width attributes set.")}function Ge(e){return null!=e.height&&null!=e.width?[e.height,e.width]:[e.videoHeight,e.videoWidth]}function He(e){if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return ze(e);if("undefined"!=typeof ImageData&&e instanceof ImageData)return[e.height,e.width];if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return Ge(e);if(e instanceof r["Tensor"])return[e.shape[0],e.shape[1]];throw new Error("error: Unknown input type: "+e+".")}function $e(e,t){return(e-1)%t==0}function Ke(e,t){return $e(e,t)?e:Math.floor(e/t)*t+1}var Ye={low:"low",medium:"medium",high:"high",full:"full"},Xe=((je={})[Ye.low]=.25,je[Ye.medium]=.5,je[Ye.high]=.75,je[Ye.full]=1,je),Je=.1,Qe=2;function Ze(e){if("string"==typeof e){var t=Xe[e];return r["util"].assert("number"==typeof t,(function(){return"string value of inputResolution must be one of "+Object.values(Ye).join(",")+" but was "+e+"."})),t}return r["util"].assert("number"==typeof e&&e<=Qe&&e>=Je,(function(){return"inputResolution must be a string or number between "+Je+" and "+Qe+", but was "+e})),e}function et(e,t,n){var r=n[0],i=n[1],a=Ze(e);return[Ke(r*a,t),Ke(i*a,t)]}function tt(e){return e instanceof r["Tensor"]?e:r["browser"].fromPixels(e)}function nt(e,t,n,i,a){var o=t[0],s=t[1],u=n[0],c=n[1],l=i[0],d=l[0],p=l[1],h=i[1],f=h[0],m=h[1];return void 0===a&&(a=!1),Object(r["tidy"])((function(){var t=e.resizeBilinear([u,c],!0);return a&&(t=t.sigmoid()),rt(t,[o,s],[[d,p],[f,m]])}))}function rt(e,t,n){var i=t[0],a=t[1],o=n[0],s=o[0],u=o[1],c=n[1],l=c[0],d=c[1];return Object(r["tidy"])((function(){return r["image"].cropAndResize(e.expandDims(),[[s/(i+s+u-1),l/(a+l+d-1),(s+i-1)/(i+s+u-1),(l+a-1)/(a+l+d-1)]],[0],[i,a]).squeeze([0])}))}function it(e,t){var n=t[0],i=t[1],a=He(e),o=a[0],s=a[1],u=i/n,c=[0,0,0,0],l=c[0],d=c[1],p=c[2],h=c[3];return s/o<u?(l=0,d=0,p=Math.round(.5*(u*o-s)),h=Math.round(.5*(u*o-s))):(l=Math.round(.5*(1/u*s-o)),d=Math.round(.5*(1/u*s-o)),p=0,h=0),{resized:Object(r["tidy"])((function(){var t=tt(e);return(t=Object(r["pad3d"])(t,[[l,d],[p,h],[0,0]])).resizeBilinear([n,i])})),padding:{top:l,left:p,right:h,bottom:d}}}function at(e){return W(this,void 0,void 0,(function(){return z(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))}function ot(e,t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=0),{score:e.score,keypoints:e.keypoints.map((function(e){var a=e.score,o=e.part,s=e.position;return{score:a,part:o,position:{x:s.x*n+i,y:s.y*t+r}}}))}}function st(e,t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=0),1===n&&1===t&&0===r&&0===i?e:e.map((function(e){return ot(e,t,n,r,i)}))}function ut(e,t){return{score:e.score,keypoints:e.keypoints.map((function(e){var n=e.score,r=e.part,i=e.position;return{score:n,part:r,position:{x:t-1-i.x,y:i.y}}}))}}function ct(e,t){return t<=0?e:e.map((function(e){return ut(e,t)}))}function lt(e,t,n,r,i){var a=t[0],o=t[1],s=n[0],u=n[1],c=st(e,(a+r.top+r.bottom)/s,(o+r.left+r.right)/u,-r.top,-r.left);return i?ct(c,o):c}var dt=!0,pt=!1,ht={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},ft=["MobileNetV1","ResNet50"],mt={MobileNetV1:[8,16,32],ResNet50:[32,16]},vt={MobileNetV1:[.5,.75,1],ResNet50:[1]},gt=[1,2,4];function yt(e){if(null==(e=e||ht).architecture&&(e.architecture="MobileNetV1"),ft.indexOf(e.architecture)<0)throw new Error("Invalid architecture "+e.architecture+". Should be one of "+ft);if(null==e.outputStride&&(e.outputStride=16),mt[e.architecture].indexOf(e.outputStride)<0)throw new Error("Invalid outputStride "+e.outputStride+". Should be one of "+mt[e.architecture]+" for architecture "+e.architecture+".");if(null==e.multiplier&&(e.multiplier=1),vt[e.architecture].indexOf(e.multiplier)<0)throw new Error("Invalid multiplier "+e.multiplier+". Should be one of "+vt[e.architecture]+" for architecture "+e.architecture+".");if(null==e.quantBytes&&(e.quantBytes=4),gt.indexOf(e.quantBytes)<0)throw new Error("Invalid quantBytes "+e.quantBytes+". Should be one of "+gt+" for architecture "+e.architecture+".");return e}var bt={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},_t={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function wt(e){var t=e.segmentationThreshold,n=e.maxDetections,r=e.scoreThreshold,i=e.nmsRadius;if(t<0||t>1)throw new Error("segmentationThreshold "+t+". Should be in range [0.0, 1.0]");if(n<=0)throw new Error("Invalid maxDetections "+n+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".")}function xt(e){var t=e.segmentationThreshold,n=e.maxDetections,r=e.scoreThreshold,i=e.nmsRadius,a=e.minKeypointScore,o=e.refineSteps;if(t<0||t>1)throw new Error("segmentationThreshold "+t+". Should be in range [0.0, 1.0]");if(n<=0)throw new Error("Invalid maxDetections "+n+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".");if(a<0||a>1)throw new Error("Invalid minKeypointScore "+a+".Should be in range [0.0, 1.0]");if(o<=0||o>20)throw new Error("Invalid refineSteps "+o+".Should be in range [1, 20]")}var Tt=function(){function e(e){this.baseModel=e}return e.prototype.predictForPersonSegmentation=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},e.prototype.predictForPersonSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,partHeatmapLogits:t.partHeatmaps,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},e.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,longOffsets:t.longOffsets,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd,partHeatmaps:t.partHeatmaps}},e.prototype.segmentPersonActivation=function(e,t,n){var i=this;void 0===n&&(n=.5);var a=He(e),o=a[0],s=a[1],u=et(t,this.baseModel.outputStride,[o,s]),c=it(e,u),l=c.resized,d=c.padding,p=Object(r["tidy"])((function(){var e=i.predictForPersonSegmentation(l),t=e.segmentLogits,r=e.heatmapScores,a=e.offsets,u=e.displacementFwd,c=e.displacementBwd,p=l.shape,h=p[0],f=p[1];return{segmentation:$(nt(t,[o,s],[h,f],[[d.top,d.bottom],[d.left,d.right]],dt).squeeze(),n),heatmapScores:r,offsets:a,displacementFwd:u,displacementBwd:c}})),h=p.segmentation,f=p.heatmapScores,m=p.offsets,v=p.displacementFwd,g=p.displacementBwd;return l.dispose(),{segmentation:h,heatmapScores:f,offsets:m,displacementFwd:v,displacementBwd:g,padding:d,internalResolutionHeightAndWidth:u}},e.prototype.segmentPerson=function(e,t){return void 0===t&&(t=bt),W(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c,l,d,p,h,f,m,v,g,y,b;return z(this,(function(_){switch(_.label){case 0:return wt(t=q({},bt,t)),n=this.segmentPersonActivation(e,t.internalResolution,t.segmentationThreshold),r=n.segmentation,i=n.heatmapScores,a=n.offsets,o=n.displacementFwd,s=n.displacementBwd,u=n.padding,c=n.internalResolutionHeightAndWidth,l=r.shape,d=l[0],p=l[1],[4,r.data()];case 1:return h=_.sent(),r.dispose(),[4,at([i,a,o,s])];case 2:return f=_.sent(),m=f[0],v=f[1],g=f[2],y=f[3],b=lt(b=Le(m,v,g,y,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[d,p],c,u,pt),i.dispose(),a.dispose(),o.dispose(),s.dispose(),[2,{height:d,width:p,data:h,allPoses:b}]}}))}))},e.prototype.segmentMultiPerson=function(e,t){return void 0===t&&(t=_t),W(this,void 0,void 0,(function(){var n,i,a,o,s,u,c,l,d,p,h,f,m,v,g,y,b,_,w,x,T,C=this;return z(this,(function(S){switch(S.label){case 0:return xt(t=q({},_t,t)),n=He(e),i=n[0],a=n[1],o=et(t.internalResolution,this.baseModel.outputStride,[i,a]),s=it(e,o),u=s.resized,c=s.padding,l=Object(r["tidy"])((function(){var e,n=C.predictForMultiPersonInstanceSegmentationAndPart(u),r=n.segmentLogits,s=n.longOffsets,l=n.heatmapScores,d=n.offsets,p=n.displacementFwd,h=n.displacementBwd;return e=s,{segmentation:$(nt(r,[i,a],o,[[c.top,c.bottom],[c.left,c.right]],dt).squeeze(),t.segmentationThreshold),longOffsets:e,heatmapScoresRaw:l,offsetsRaw:d,displacementFwdRaw:p,displacementBwdRaw:h}})),d=l.segmentation,p=l.longOffsets,h=l.heatmapScoresRaw,f=l.offsetsRaw,m=l.displacementFwdRaw,v=l.displacementBwdRaw,[4,at([h,f,m,v])];case 1:return g=S.sent(),y=g[0],b=g[1],_=g[2],w=g[3],x=lt(x=Le(y,b,_,w,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[i,a],o,c,pt),[4,_e(d,p,x,i,a,this.baseModel.outputStride,o,c,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return T=S.sent(),u.dispose(),d.dispose(),p.dispose(),h.dispose(),f.dispose(),m.dispose(),v.dispose(),[2,T]}}))}))},e.prototype.segmentPersonPartsActivation=function(e,t,n){var i=this;void 0===n&&(n=.5);var a=He(e),o=a[0],s=a[1],u=et(t,this.baseModel.outputStride,[o,s]),c=it(e,u),l=c.resized,d=c.padding,p=Object(r["tidy"])((function(){var e=i.predictForPersonSegmentationAndPart(l),t=e.segmentLogits,r=e.partHeatmapLogits,a=e.heatmapScores,u=e.offsets,c=e.displacementFwd,p=e.displacementBwd,h=l.shape,f=h[0],m=h[1],v=nt(t,[o,s],[f,m],[[d.top,d.bottom],[d.left,d.right]],dt),g=nt(r,[o,s],[f,m],[[d.top,d.bottom],[d.left,d.right]],dt);return{partSegmentation:K($(v.squeeze(),n),g),heatmapScores:a,offsets:u,displacementFwd:c,displacementBwd:p}})),h=p.partSegmentation,f=p.heatmapScores,m=p.offsets,v=p.displacementFwd,g=p.displacementBwd;return l.dispose(),{partSegmentation:h,heatmapScores:f,offsets:m,displacementFwd:v,displacementBwd:g,padding:d,internalResolutionHeightAndWidth:u}},e.prototype.segmentPersonParts=function(e,t){return void 0===t&&(t=bt),W(this,void 0,void 0,(function(){var n,r,i,a,o,s,u,c,l,d,p,h,f,m,v,g,y,b;return z(this,(function(_){switch(_.label){case 0:return wt(t=q({},bt,t)),n=this.segmentPersonPartsActivation(e,t.internalResolution,t.segmentationThreshold),r=n.partSegmentation,i=n.heatmapScores,a=n.offsets,o=n.displacementFwd,s=n.displacementBwd,u=n.padding,c=n.internalResolutionHeightAndWidth,l=r.shape,d=l[0],p=l[1],[4,r.data()];case 1:return h=_.sent(),r.dispose(),[4,at([i,a,o,s])];case 2:return f=_.sent(),m=f[0],v=f[1],g=f[2],y=f[3],b=lt(b=Le(m,v,g,y,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[d,p],c,u,pt),i.dispose(),a.dispose(),o.dispose(),s.dispose(),[2,{height:d,width:p,data:h,allPoses:b}]}}))}))},e.prototype.segmentMultiPersonParts=function(e,t){return void 0===t&&(t=_t),W(this,void 0,void 0,(function(){var n,i,a,o,s,u,c,l,d,p,h,f,m,v,g,y,b,_,w,x,T,C,S=this;return z(this,(function(E){switch(E.label){case 0:return xt(t=q({},_t,t)),n=He(e),i=n[0],a=n[1],o=et(t.internalResolution,this.baseModel.outputStride,[i,a]),s=it(e,o),u=s.resized,c=s.padding,l=Object(r["tidy"])((function(){var e=S.predictForMultiPersonInstanceSegmentationAndPart(u),n=e.segmentLogits,r=e.longOffsets,s=e.heatmapScores,l=e.offsets,d=e.displacementFwd,p=e.displacementBwd,h=e.partHeatmaps,f=nt(n,[i,a],o,[[c.top,c.bottom],[c.left,c.right]],dt),m=nt(h,[i,a],o,[[c.top,c.bottom],[c.left,c.right]],dt),v=r;return{segmentation:$(f.squeeze(),t.segmentationThreshold),longOffsets:v,heatmapScoresRaw:s,offsetsRaw:l,displacementFwdRaw:d,displacementBwdRaw:p,partSegmentation:Y(m)}})),d=l.segmentation,p=l.longOffsets,h=l.heatmapScoresRaw,f=l.offsetsRaw,m=l.displacementFwdRaw,v=l.displacementBwdRaw,g=l.partSegmentation,[4,at([h,f,m,v])];case 1:return y=E.sent(),b=y[0],_=y[1],w=y[2],x=y[3],T=lt(T=Le(b,_,w,x,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[i,a],o,c,pt),[4,we(d,p,g,T,i,a,this.baseModel.outputStride,o,c,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return C=E.sent(),u.dispose(),d.dispose(),p.dispose(),h.dispose(),f.dispose(),m.dispose(),v.dispose(),g.dispose(),[2,C]}}))}))},e.prototype.dispose=function(){this.baseModel.dispose()},e}();function Ct(e){return W(this,void 0,void 0,(function(){var t,n,i,a,o,s;return z(this,(function(u){switch(u.label){case 0:if(t=e.outputStride,n=e.quantBytes,i=e.multiplier,null==r)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return a=We(t,i,n),[4,U(e.modelUrl||a)];case 1:return o=u.sent(),s=new J(o,t),[2,new Tt(s)]}}))}))}function St(e){return W(this,void 0,void 0,(function(){var t,n,i,a,o;return z(this,(function(s){switch(s.label){case 0:if(t=e.outputStride,n=e.quantBytes,null==r)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this\n        model.");return i=qe(t,n),[4,U(e.modelUrl||i)];case 1:return a=s.sent(),o=new Ue(a,t),[2,new Tt(o)]}}))}))}function Et(e){return void 0===e&&(e=ht),W(this,void 0,void 0,(function(){return z(this,(function(t){return"ResNet50"===(e=yt(e)).architecture?[2,St(e)]:"MobileNetV1"===e.architecture?[2,Ct(e)]:[2,null]}))}))}function kt(e,t,n){for(var r=e.getContext("2d"),i=0,a=1/(2*Math.PI*5*5),o=n<3?1:2,s=-n;s<=n;s+=o)for(var u=-n;u<=n;u+=o)i+=a*Math.exp(-(u*u+s*s)/50);for(s=-n;s<=n;s+=o)for(u=-n;u<=n;u+=o)r.globalAlpha=a*Math.exp(-(u*u+s*s)/50)/i*n,r.drawImage(t,u,s);r.globalAlpha=1}var Rt={};function Ot(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function At(e,t,n,r){var i=e.width,a=e.height,o=t.width,s=t.height;if(i!==o||a!==s)throw new Error("error: dimensions must match. "+n+" has dimensions "+i+"x"+a+", "+r+" has dimensions "+o+"x"+s)}function It(e){var t=e.getContext("2d");t.scale(-1,1),t.translate(-e.width,0)}function Nt(e,t,n){e.globalCompositeOperation=n,e.drawImage(t,0,0)}function Dt(){return document.createElement("canvas")}function Pt(e){return Rt[e]||(Rt[e]=Dt()),Rt[e]}function Mt(e,t,n){var r=e.height,i=e.width,a=n.getContext("2d");n.width=i,n.height=r,a.clearRect(0,0,i,r),a.save(),Ot()?kt(n,e,t):(a.filter="blur("+t+"px)",a.drawImage(e,0,0,i,r)),a.restore()}function Lt(e,t,n){var r=Pt(n);return 0===t?jt(e,r):Mt(e,t,r),r}function jt(e,t){var n=e.width,r=e.height;t.width=n,t.height=r,t.getContext("2d").drawImage(e,0,0,n,r)}function Bt(e,t){t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0)}function Ut(e,t){var n=Pt(t);return Bt(e,n),n}function Ft(e,t,n,r,i){if(void 0===t&&(t={r:0,g:0,b:0,a:0}),void 0===n&&(n={r:0,g:0,b:0,a:255}),void 0===r&&(r=!1),void 0===i&&(i=[1]),Array.isArray(e)&&0===e.length)return null;var a,o=(a=Array.isArray(e)?e:[e])[0],s=o.width,u=o.height,c=new Uint8ClampedArray(s*u*4);function l(e,t,n,r,i,a){void 0===a&&(a={r:0,g:255,b:255,a:255});for(var o=-i;o<=i;o++)for(var s=-i;s<=i;s++)if(0!==o&&0!==s){var u=(t+o)*r+(n+s);e[4*u+0]=a.r,e[4*u+1]=a.g,e[4*u+2]=a.b,e[4*u+3]=a.a}}function d(e,t,n,r,i,a){void 0===i&&(i=[1]),void 0===a&&(a=1);for(var o=0,s=-a;s<=a;s++)for(var u=function(a){if(0!==s&&0!==a){var u=(t+s)*r+(n+a);i.some((function(t){return t===e[u]}))||(o+=1)}},c=-a;c<=a;c++)u(c);return o>0}for(var p=0;p<u;p+=1)for(var h=function(e){var o=p*s+e;c[4*o+0]=n.r,c[4*o+1]=n.g,c[4*o+2]=n.b,c[4*o+3]=n.a;for(var h=function(n){if(i.some((function(e){return e===a[n].data[o]}))){c[4*o]=t.r,c[4*o+1]=t.g,c[4*o+2]=t.b,c[4*o+3]=t.a;var h=d(a[n].data,p,e,s,i);r&&p-1>=0&&p+1<u&&e-1>=0&&e+1<s&&h&&l(c,p,e,s,1)}},f=0;f<a.length;f++)h(f)},f=0;f<s;f+=1)h(f);return new ImageData(c,s,u)}var Vt={blurred:"blurred",blurredMask:"blurred-mask",mask:"mask",lowresPartMask:"lowres-part-mask"};function qt(e,t,n,r,i,a){void 0===r&&(r=.7),void 0===i&&(i=0),void 0===a&&(a=!1);var o=He(t),s=o[0],u=o[1];e.width=u,e.height=s;var c=e.getContext("2d");if(c.save(),a&&It(e),c.drawImage(t,0,0),c.globalAlpha=r,n){At({width:u,height:s},n,"image","mask");var l=Lt(Ut(n,Vt.mask),i,Vt.blurredMask);c.drawImage(l,0,0,u,s)}c.restore()}function Wt(e,t){var n=Ut(Ft(e,{r:0,g:0,b:0,a:255},{r:0,g:0,b:0,a:0}),Vt.mask);return 0===t?n:Lt(n,t,Vt.blurredMask)}function zt(e,t,n,r,i,a){void 0===r&&(r=3),void 0===i&&(i=3),void 0===a&&(a=!1);var o=Lt(t,r,Vt.blurred);e.width=o.width,e.height=o.height;var s=e.getContext("2d");if(Array.isArray(n)&&0===n.length)s.drawImage(o,0,0);else{var u=Wt(n,i);s.save(),a&&It(e);var c=He(t),l=c[0],d=c[1];s.drawImage(t,0,0,d,l),Nt(s,u,"destination-in"),Nt(s,o,"destination-over"),s.restore()}}},"55b5":function(e,t){function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}e.exports=n},5692:function(e,t,n){var r=n("c430"),i=n("c6cd");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(e,t,n){var r=n("d066"),i=n("241c"),a=n("7418"),o=n("825a");e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(o(e)),n=a.f;return n?t.concat(n(e)):t}},5874:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]}]},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var r=n("1d80"),i=n("5899"),a="["+i+"]",o=RegExp("^"+a+a+"*"),s=RegExp(a+a+"*$"),u=function(e){return function(t){var n=String(r(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"5fcf":function(e,t,n){"use strict";
/*! @name @videojs/vhs-utils @version 1.3.0 @license MIT */function r(e){return e&&"object"===typeof e&&"default"in e?e["default"]:e}var i=r(n("d136")),a=r(n("be09")),o=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=i.buildAbsoluteURL(a.location&&a.location.href||"",e)),i.buildAbsoluteURL(e,t))};e.exports=o},"60da":function(e,t,n){"use strict";var r=n("83ab"),i=n("d039"),a=n("df75"),o=n("7418"),s=n("d1e7"),u=n("7b0b"),c=n("44ad"),l=Object.assign,d=Object.defineProperty;e.exports=!l||i((function(){if(r&&1!==l({b:1},l(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||a(l({},t)).join("")!=i}))?function(e,t){var n=u(e),i=arguments.length,l=1,d=o.f,p=s.f;while(i>l){var h,f=c(arguments[l++]),m=d?a(f).concat(d(f)):a(f),v=m.length,g=0;while(v>g)h=m[g++],r&&!p.call(f,h)||(n[h]=f[h])}return n}:l},6547:function(e,t,n){var r=n("a691"),i=n("1d80"),a=function(e){return function(t,n){var a,o,s=String(i(t)),u=r(n),c=s.length;return u<0||u>=c?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536)}};e.exports={codeAt:a(!1),charAt:a(!0)}},"65f0":function(e,t,n){var r=n("861d"),i=n("e8b5"),a=n("b622"),o=a("species");e.exports=function(e,t){var n;return i(e)&&(n=e.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[o],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},"672b":function(e,t,n){(function(t){var n;n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},e.exports=n}).call(this,n("c8ba"))},"673d":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},"69f3":function(e,t,n){var r,i,a,o=n("7f9a"),s=n("da84"),u=n("861d"),c=n("9112"),l=n("5135"),d=n("f772"),p=n("d012"),h=s.WeakMap,f=function(e){return a(e)?i(e):r(e,{})},m=function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}};if(o){var v=new h,g=v.get,y=v.has,b=v.set;r=function(e,t){return b.call(v,e,t),t},i=function(e){return g.call(v,e)||{}},a=function(e){return y.call(v,e)}}else{var _=d("state");p[_]=!0,r=function(e,t){return c(e,_,t),t},i=function(e){return l(e,_)?e[_]:{}},a=function(e){return l(e,_)}}e.exports={set:r,get:i,has:a,enforce:f,getterFor:m}},"6b58":function(e,t,n){var r=n("7037"),i=n("3c96");function a(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?i(e):t}e.exports=a},"6eeb":function(e,t,n){var r=n("da84"),i=n("9112"),a=n("5135"),o=n("ce4e"),s=n("8925"),u=n("69f3"),c=u.get,l=u.enforce,d=String(String).split("String");(e.exports=function(e,t,n,s){var u=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||i(n,"name",t),l(n).source=d.join("string"==typeof t?t:"")),e!==r?(u?!p&&e[t]&&(c=!0):delete e[t],c?e[t]=n:i(e,t,n)):c?e[t]=n:o(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},"6f8f":function(e,t,n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n("d3b7"),n("4ae1"),n("25f0"),e.exports=r},7037:function(e,t,n){function r(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),e.exports=r},7156:function(e,t,n){var r=n("861d"),i=n("d2bb");e.exports=function(e,t,n){var a,o;return i&&"function"==typeof(a=t.constructor)&&a!==n&&r(o=a.prototype)&&o!==n.prototype&&i(e,o),e}},7418:function(e,t){t.f=Object.getOwnPropertySymbols},"746f":function(e,t,n){var r=n("428f"),i=n("5135"),a=n("e538"),o=n("9bf2").f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||o(t,e,{value:a.f(e)})}},"749c":function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}if(!(r instanceof t)){function a(){}a.prototype=t.prototype,a=new a,n(r,a),e.prototype=r=a}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i="http://www.w3.org/1999/xhtml",a={},o=a.ELEMENT_NODE=1,s=a.ATTRIBUTE_NODE=2,u=a.TEXT_NODE=3,c=a.CDATA_SECTION_NODE=4,l=a.ENTITY_REFERENCE_NODE=5,d=a.ENTITY_NODE=6,p=a.PROCESSING_INSTRUCTION_NODE=7,h=a.COMMENT_NODE=8,f=a.DOCUMENT_NODE=9,m=a.DOCUMENT_TYPE_NODE=10,v=a.DOCUMENT_FRAGMENT_NODE=11,g=a.NOTATION_NODE=12,y={},b={},_=(y.INDEX_SIZE_ERR=(b[1]="Index size error",1),y.DOMSTRING_SIZE_ERR=(b[2]="DOMString size error",2),y.HIERARCHY_REQUEST_ERR=(b[3]="Hierarchy request error",3)),w=(y.WRONG_DOCUMENT_ERR=(b[4]="Wrong document",4),y.INVALID_CHARACTER_ERR=(b[5]="Invalid character",5),y.NO_DATA_ALLOWED_ERR=(b[6]="No data allowed",6),y.NO_MODIFICATION_ALLOWED_ERR=(b[7]="No modification allowed",7),y.NOT_FOUND_ERR=(b[8]="Not found",8)),x=(y.NOT_SUPPORTED_ERR=(b[9]="Not supported",9),y.INUSE_ATTRIBUTE_ERR=(b[10]="Attribute in use",10));y.INVALID_STATE_ERR=(b[11]="Invalid state",11),y.SYNTAX_ERR=(b[12]="Syntax error",12),y.INVALID_MODIFICATION_ERR=(b[13]="Invalid modification",13),y.NAMESPACE_ERR=(b[14]="Invalid namespace",14),y.INVALID_ACCESS_ERR=(b[15]="Invalid access",15);function T(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,b[e]),this.message=b[e],Error.captureStackTrace&&Error.captureStackTrace(this,T);return n.code=e,t&&(this.message=this.message+": "+t),n}function C(){}function S(e,t){this._node=e,this._refresh=t,E(this)}function E(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);oe(e,"length",r.length),n(r,e),e._inc=t}}function k(){}function R(e,t){var n=e.length;while(n--)if(e[n]===t)return n}function O(e,t,n,r){if(r?t[R(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&j(i,e,r),L(i,e,n))}}function A(e,t,n){var r=R(t,n);if(!(r>=0))throw T(w,new Error(e.tagName+"@"+n));var i=t.length-1;while(r<i)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(j(a,e,n),n.ownerElement=null)}}function I(e){if(this._features={},e)for(var t in e)this._features=e[t]}function N(){}function D(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function P(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(P(e,t))return!0}while(e=e.nextSibling)}function M(){}function L(e,t,n){e&&e._inc++;var r=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==r&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function j(e,t,n,r){e&&e._inc++;var i=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==i&&delete t._nsMap[n.prefix?n.localName:""]}function B(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{var i=t.firstChild,a=0;while(i)r[a++]=i,i=i.nextSibling;r.length=a}}}function U(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,B(e.ownerDocument,e),t}function F(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===v){var i=t.firstChild;if(null==i)return t;var a=t.lastChild}else i=a=t;var o=n?n.previousSibling:e.lastChild;i.previousSibling=o,a.nextSibling=n,o?o.nextSibling=i:e.firstChild=i,null==n?e.lastChild=a:n.previousSibling=a;do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));return B(e.ownerDocument||e,e),t.nodeType==v&&(t.firstChild=t.lastChild=null),t}function V(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);r=e.lastChild}r=e.lastChild;return t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,B(e.ownerDocument,e,t),t}function q(){this._nsMap={}}function W(){}function z(){}function G(){}function H(){}function $(){}function K(){}function Y(){}function X(){}function J(){}function Q(){}function Z(){}function ee(){}function te(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,i=r.prefix,a=r.namespaceURI;if(a&&null==i){i=r.lookupPrefix(a);if(null==i)var o=[{namespace:a,prefix:null}]}return re(this,n,e,t,o),n.join("")}function ne(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;var a=n.length;while(a--){var o=n[a];if(o.prefix==r)return o.namespace!=i}return!0}function re(e,t,n,r,a){if(r){if(e=r(e),!e)return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case o:a||(a=[]);a.length;var d=e.attributes,g=d.length,y=e.firstChild,b=e.tagName;n=i===e.namespaceURI||n,t.push("<",b);for(var _=0;_<g;_++){var w=d.item(_);"xmlns"==w.prefix?a.push({prefix:w.localName,namespace:w.value}):"xmlns"==w.nodeName&&a.push({prefix:"",namespace:w.value})}for(_=0;_<g;_++){w=d.item(_);if(ne(w,n,a)){var x=w.prefix||"",T=w.namespaceURI,C=x?" xmlns:"+x:" xmlns";t.push(C,'="',T,'"'),a.push({prefix:x,namespace:T})}re(w,t,n,r,a)}if(ne(e,n,a)){x=e.prefix||"",T=e.namespaceURI,C=x?" xmlns:"+x:" xmlns";t.push(C,'="',T,'"'),a.push({prefix:x,namespace:T})}if(y||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(b)){if(t.push(">"),n&&/^script$/i.test(b))while(y)y.data?t.push(y.data):re(y,t,n,r,a),y=y.nextSibling;else while(y)re(y,t,n,r,a),y=y.nextSibling;t.push("</",b,">")}else t.push("/>");return;case f:case v:y=e.firstChild;while(y)re(y,t,n,r,a),y=y.nextSibling;return;case s:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,D),'"');case u:return t.push(e.data.replace(/[<&]/g,D));case c:return t.push("<![CDATA[",e.data,"]]>");case h:return t.push("\x3c!--",e.data,"--\x3e");case m:var S=e.publicId,E=e.systemId;if(t.push("<!DOCTYPE ",e.name),S)t.push(' PUBLIC "',S),E&&"."!=E&&t.push('" "',E),t.push('">');else if(E&&"."!=E)t.push(' SYSTEM "',E,'">');else{var k=e.internalSubset;k&&t.push(" [",k,"]"),t.push(">")}return;case p:return t.push("<?",e.target," ",e.data,"?>");case l:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ie(e,t,n){var r;switch(t.nodeType){case o:r=t.cloneNode(!1),r.ownerDocument=e;case v:break;case s:n=!0;break}if(r||(r=t.cloneNode(!1)),r.ownerDocument=e,r.parentNode=null,n){var i=t.firstChild;while(i)r.appendChild(ie(e,i,n)),i=i.nextSibling}return r}function ae(e,t,n){var r=new t.constructor;for(var i in t){var a=t[i];"object"!=typeof a&&a!=r[i]&&(r[i]=a)}switch(t.childNodes&&(r.childNodes=new C),r.ownerDocument=e,r.nodeType){case o:var u=t.attributes,c=r.attributes=new k,l=u.length;c._ownerElement=r;for(var d=0;d<l;d++)r.setAttributeNode(ae(e,u.item(d),!0));break;case s:n=!0}if(n){var p=t.firstChild;while(p)r.appendChild(ae(e,p,n)),p=p.nextSibling}return r}function oe(e,t,n){e[t]=n}T.prototype=Error.prototype,n(y,T),C.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)re(this[r],n,e,t);return n.join("")}},S.prototype.item=function(e){return E(this),this[e]},r(S,C),k.prototype={length:0,item:C.prototype.item,getNamedItem:function(e){var t=this.length;while(t--){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new T(x);var n=this.getNamedItem(e.nodeName);return O(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new T(x);return t=this.getNamedItemNS(e.namespaceURI,e.localName),O(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return A(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return A(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){var n=this.length;while(n--){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},I.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new M;if(r.implementation=this,r.childNodes=new C,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new K;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},N.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return F(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return U(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return ae(this.ownerDocument||this,this,e)},normalize:function(){var e=this.firstChild;while(e){var t=e.nextSibling;t&&t.nodeType==u&&e.nodeType==u?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){var t=this;while(t){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){var t=this;while(t){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==s?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return null==t}},n(a,N),n(a,N.prototype),M.prototype={nodeName:"#document",nodeType:f,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==v){var n=e.firstChild;while(n){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==o&&(this.documentElement=e),F(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),U(this,e)},importNode:function(e,t){return ie(this,e,t)},getElementById:function(e){var t=null;return P(this.documentElement,(function(n){if(n.nodeType==o&&n.getAttribute("id")==e)return t=n,!0})),t},createElement:function(e){var t=new q;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new C;var n=t.attributes=new k;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new Q;return e.ownerDocument=this,e.childNodes=new C,e},createTextNode:function(e){var t=new G;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new Z;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new W;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new J;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new q,r=t.split(":"),i=n.attributes=new k;return n.childNodes=new C,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new W,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(M,N),q.prototype={nodeType:o,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===v?this.insertBefore(e,null):V(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new S(this,(function(t){var n=[];return P(t,(function(r){r===t||r.nodeType!=o||"*"!==e&&r.tagName!=e||n.push(r)})),n}))},getElementsByTagNameNS:function(e,t){return new S(this,(function(n){var r=[];return P(n,(function(i){i===n||i.nodeType!==o||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)})),r}))}},M.prototype.getElementsByTagName=q.prototype.getElementsByTagName,M.prototype.getElementsByTagNameNS=q.prototype.getElementsByTagNameNS,r(q,N),W.prototype.nodeType=s,r(W,N),z.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(b[_])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){var r=this.data.substring(0,e),i=this.data.substring(e+t);n=r+n+i,this.nodeValue=this.data=n,this.length=n.length}},r(z,N),G.prototype={nodeName:"#text",nodeType:u,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(G,z),H.prototype={nodeName:"#comment",nodeType:h},r(H,z),$.prototype={nodeName:"#cdata-section",nodeType:c},r($,z),K.prototype.nodeType=m,r(K,N),Y.prototype.nodeType=g,r(Y,N),X.prototype.nodeType=d,r(X,N),J.prototype.nodeType=l,r(J,N),Q.prototype.nodeName="#document-fragment",Q.prototype.nodeType=v,r(Q,N),Z.prototype.nodeType=p,r(Z,N),ee.prototype.serializeToString=function(e,t,n){return te.call(e,t,n)},N.prototype.toString=te;try{if(Object.defineProperty){function se(e){switch(e.nodeType){case o:case v:var t=[];e=e.firstChild;while(e)7!==e.nodeType&&8!==e.nodeType&&t.push(se(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(S.prototype,"length",{get:function(){return E(this),this.$$length}}),Object.defineProperty(N.prototype,"textContent",{get:function(){return se(this)},set:function(e){switch(this.nodeType){case o:case v:while(this.firstChild)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),oe=function(e,t,n){e["$$"+t]=n}}}catch(ue){}t.DOMImplementation=I,t.XMLSerializer=ee},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,t,n){var r=n("1d80");e.exports=function(e){return Object(r(e))}},"7c73":function(e,t,n){var r,i=n("825a"),a=n("37e8"),o=n("7839"),s=n("d012"),u=n("1be4"),c=n("cc12"),l=n("f772"),d=">",p="<",h="prototype",f="script",m=l("IE_PROTO"),v=function(){},g=function(e){return p+f+d+e+p+"/"+f+d},y=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},b=function(){var e,t=c("iframe"),n="java"+f+":";return t.style.display="none",u.appendChild(t),t.src=String(n),e=t.contentWindow.document,e.open(),e.write(g("document.F=Object")),e.close(),e.F},_=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(t){}_=r?y(r):b();var e=o.length;while(e--)delete _[h][o[e]];return _()};s[m]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(v[h]=i(e),n=new v,v[h]=null,n[m]=e):n=_(),void 0===t?n:a(n,t)}},"7dd0":function(e,t,n){"use strict";var r=n("23e7"),i=n("9ed3"),a=n("e163"),o=n("d2bb"),s=n("d44e"),u=n("9112"),c=n("6eeb"),l=n("b622"),d=n("c430"),p=n("3f8c"),h=n("ae93"),f=h.IteratorPrototype,m=h.BUGGY_SAFARI_ITERATORS,v=l("iterator"),g="keys",y="values",b="entries",_=function(){return this};e.exports=function(e,t,n,l,h,w,x){i(n,t,l);var T,C,S,E=function(e){if(e===h&&I)return I;if(!m&&e in O)return O[e];switch(e){case g:return function(){return new n(this,e)};case y:return function(){return new n(this,e)};case b:return function(){return new n(this,e)}}return function(){return new n(this)}},k=t+" Iterator",R=!1,O=e.prototype,A=O[v]||O["@@iterator"]||h&&O[h],I=!m&&A||E(h),N="Array"==t&&O.entries||A;if(N&&(T=a(N.call(new e)),f!==Object.prototype&&T.next&&(d||a(T)===f||(o?o(T,f):"function"!=typeof T[v]&&u(T,v,_)),s(T,k,!0,!0),d&&(p[k]=_))),h==y&&A&&A.name!==y&&(R=!0,I=function(){return A.call(this)}),d&&!x||O[v]===I||u(O,v,I),p[t]=I,h)if(C={values:E(y),keys:w?I:E(g),entries:E(b)},x)for(S in C)(m||R||!(S in O))&&c(O,S,C[S]);else r({target:t,proto:!0,forced:m||R},C);return C}},"7f9a":function(e,t,n){var r=n("da84"),i=n("8925"),a=r.WeakMap;e.exports="function"===typeof a&&/native code/.test(i(a))},"7fe1":function(e,t){var n=function(e){return e>>>0},r=function(e){return("00"+e.toString(16)).slice(-2)};e.exports={toUnsigned:n,toHexString:r}},"825a":function(e,t,n){var r=n("861d");e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},8362:function(e,t){e.exports=r;var n=Object.prototype.toString;function r(e){if(!e)return!1;var t=n.call(e);return"[object Function]"===t||"function"===typeof e&&"[object RegExp]"!==t||"undefined"!==typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}},"83ab":function(e,t,n){var r=n("d039");e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},8507:function(e,t,n){"use strict";(function(t){/*! @name @videojs/vhs-utils @version 1.3.0 @license MIT */
function r(e){return e&&"object"===typeof e&&"default"in e?e["default"]:e}var i=r(n("be09")),a=function(e){return i.atob?i.atob(e):t.from(e,"base64").toString("binary")};function o(e){for(var t=a(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}e.exports=o}).call(this,n("b639").Buffer)},"861d":function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},8925:function(e,t,n){var r=n("c6cd"),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return i.call(e)}),e.exports=r.inspectSource},"8c10":function(e,t){function n(e,t){var n,r=null;try{n=JSON.parse(e,t)}catch(i){r=i}return[r,n]}e.exports=n},"90e3":function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},9112:function(e,t,n){var r=n("83ab"),i=n("9bf2"),a=n("5c6c");e.exports=r?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},9152:function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,p=n?-1:1,h=e[t+d];for(d+=p,a=h&(1<<-l)-1,h>>=-l,l+=s;l>0;a=256*a+e[t+d],d+=p,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+e[t+d],d+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=c}return(h?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,d=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),t+=o+d>=1?p/u:p*Math.pow(2,1-d),t*u>=2&&(o++,u/=2),o+d>=l?(s=0,o=l):o+d>=1?(s=(t*u-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=f,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[n+h]=255&o,h+=f,o/=256,c-=8);e[n+h-f]|=128*m}},9489:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]},"94ca":function(e,t,n){var r=n("d039"),i=/#|\.prototype\./,a=function(e,t){var n=s[o(e)];return n==c||n!=u&&("function"==typeof t?r(t):!!t)},o=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=a.data={},u=a.NATIVE="N",c=a.POLYFILL="P";e.exports=a},"96cf":function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(N){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),o=new O(r||[]);return a._invoke=S(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=c;var d="suspendedStart",p="suspendedYield",h="executing",f="completed",m={};function v(){}function g(){}function y(){}var b={};b[a]=function(){return this};var _=Object.getPrototypeOf,w=_&&_(_(A([])));w&&w!==n&&r.call(w,a)&&(b=w);var x=y.prototype=v.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,a,o,s){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"===typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;function a(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}this._invoke=a}function S(e,t,n){var r=d;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw a;return I()}n.method=i,n.arg=a;while(1){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?f:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function A(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){while(++i<e.length)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return g.prototype=x.constructor=y,y.constructor=g,g.displayName=u(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},T(C.prototype),C.prototype[o]=function(){return this},e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(x),u(x,s,"Generator"),x[a]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},"9afa":function(e,t,n){"use strict";var r,i,a=n("7fe1").toUnsigned,o=function(e){return new Date(1e3*e-20828448e5)},s=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},u=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3]),t},c=function(e,t){var n,r,i,o,s,l=[];if(!t.length)return null;for(n=0;n<e.byteLength;)r=a(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),i=u(e.subarray(n+4,n+8)),o=r>1?n+r:e.byteLength,i===t[0]&&(1===t.length?l.push(e.subarray(n+8,o)):(s=c(e.subarray(n+8,o),t.slice(1)),s.length&&(l=l.concat(s)))),n=o;return l},l=function(e){var t,n,r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(t=0;t+4<e.length;t+=n)if(n=r.getUint32(t),t+=4,n<=0)i.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+e[t]&31);break}return i},d={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:r(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,r,i,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(r=6,i=0;i<s;i++)n=a.getUint16(r),r+=2,o.sps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;for(t=e[r],r++,i=0;i<t;i++)n=a.getUint16(r),r+=2,o.pps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:u(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},r=8;while(r<e.byteLength)n.compatibleBrands.push(u(e.subarray(r,r+4))),r+=4;return n},dinf:function(e){return{boxes:r(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:r(e.subarray(8))}},hdlr:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:u(e.subarray(8,12)),name:""},r=8;for(r=24;r<e.byteLength;r++){if(0===e[r]){r++;break}n.name+=String.fromCharCode(e[r])}return n.name=decodeURIComponent(escape(n.name)),n},mdat:function(e){return{byteLength:e.byteLength,nals:l(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===i.version?(r+=4,i.creationTime=o(n.getUint32(r)),r+=8,i.modificationTime=o(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=8,i.duration=n.getUint32(r)):(i.creationTime=o(n.getUint32(r)),r+=4,i.modificationTime=o(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=4,i.duration=n.getUint32(r)),r+=4,t=n.getUint16(r),i.language+=String.fromCharCode(96+(t>>10)),i.language+=String.fromCharCode(96+((992&t)>>5)),i.language+=String.fromCharCode(96+(31&t)),i},mdia:function(e){return{boxes:r(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:r(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=r(e.subarray(28))[0]),n},moof:function(e){return{boxes:r(e)}},moov:function(e){return{boxes:r(e)}},mvex:function(e){return{boxes:r(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=o(t.getUint32(n)),n+=8,r.modificationTime=o(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=8,r.duration=t.getUint32(n)):(r.creationTime=o(t.getUint32(n)),n+=4,r.modificationTime=o(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=4,r.duration=t.getUint32(n)),n+=4,r.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,r.nextTrackId=t.getUint32(n),r},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},i=n.getUint16(22);for(t=24;i;t+=12,i--)r.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return r},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:r(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},i=n.getUint32(4);for(t=8;i;t+=4,i--)r.chunkOffsets.push(n.getUint32(t));return r},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=n.getUint32(4),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;r;t+=12,r--)i.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return i},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:r(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)r.entries.push(n.getUint32(t));return r},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},i=n.getUint32(4);for(t=8;i;t+=8,i--)r.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return r},styp:function(e){return d.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:a(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=a(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},i=1&r.flags[2],a=2&r.flags[2],o=8&r.flags[2],s=16&r.flags[2],u=32&r.flags[2],c=65536&r.flags[0],l=131072&r.flags[0];return t=8,i&&(t+=4,r.baseDataOffset=n.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(r.defaultSampleDuration=n.getUint32(t),t+=4),s&&(r.defaultSampleSize=n.getUint32(t),t+=4),u&&(r.defaultSampleFlags=n.getUint32(t)),c&&(r.durationIsEmpty=!0),!i&&l&&(r.baseDataOffsetIsMoof=!0),r},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=o(t.getUint32(n)),n+=8,r.modificationTime=o(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=8,r.duration=t.getUint32(n)):(r.creationTime=o(t.getUint32(n)),n+=4,r.modificationTime=o(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=4,r.duration=t.getUint32(n)),n+=4,n+=8,r.layer=t.getUint16(n),n+=2,r.alternateGroup=t.getUint16(n),n+=2,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,r.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.height=t.getUint16(n)+t.getUint16(n+2)/16,r},traf:function(e){return{boxes:r(e)}},trak:function(e){return{boxes:r(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],u=2&n.flags[1],c=4&n.flags[1],l=8&n.flags[1],d=r.getUint32(4),p=8;i&&(n.dataOffset=r.getInt32(p),p+=4),a&&d&&(t={flags:s(e.subarray(p,p+4))},p+=4,o&&(t.duration=r.getUint32(p),p+=4),u&&(t.size=r.getUint32(p),p+=4),l&&(t.compositionTimeOffset=r.getUint32(p),p+=4),n.samples.push(t),d--);while(d--)t={},o&&(t.duration=r.getUint32(p),p+=4),u&&(t.size=r.getUint32(p),p+=4),c&&(t.flags=s(e.subarray(p,p+4)),p+=4),l&&(t.compositionTimeOffset=r.getUint32(p),p+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};r=function(e){for(var t,n,r,i,a,o=0,s=[],c=new ArrayBuffer(e.length),l=new Uint8Array(c),p=0;p<e.length;++p)l[p]=e[p];t=new DataView(c);while(o<e.byteLength)n=t.getUint32(o),r=u(e.subarray(o+4,o+8)),i=n>1?o+n:e.byteLength,a=(d[r]||function(e){return{data:e}})(e.subarray(o+8,i)),a.size=n,a.type=r,s.push(a),o=i;return s},i=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map((function(e,r){return n+e.type+"\n"+Object.keys(e).filter((function(e){return"type"!==e&&"boxes"!==e})).map((function(t){var r=n+"  "+t+": ",i=e[t];if(i instanceof Uint8Array||i instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(i.buffer,i.byteOffset,i.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return a?1===a.length?r+"<"+a.join("").slice(1)+">":r+"<\n"+a.map((function(e){return n+"  "+e})).join("\n")+"\n"+n+"  >":r+"<>"}return r+JSON.stringify(i,null,2).split("\n").map((function(e,t){return 0===t?e:n+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+i(e.boxes,t+1):"")})).join("\n")},e.exports={inspect:r,textify:i,parseType:u,findBox:c,parseTraf:d.traf,parseTfdt:d.tfdt,parseHdlr:d.hdlr,parseTfhd:d.tfhd,parseTrun:d.trun,parseSidx:d.sidx}},"9bdd":function(e,t,n){var r=n("825a");e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(o){var a=e["return"];throw void 0!==a&&r(a.call(e)),o}}},"9bf2":function(e,t,n){var r=n("83ab"),i=n("0cfb"),a=n("825a"),o=n("c04e"),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(a(e),t=o(t,!0),a(n),i)try{return s(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},"9e7b":function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},"9ed3":function(e,t,n){"use strict";var r=n("ae93").IteratorPrototype,i=n("7c73"),a=n("5c6c"),o=n("d44e"),s=n("3f8c"),u=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=i(r,{next:a(1,n)}),o(e,c,!1,!0),s[c]=u,e}},a4d3:function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),a=n("d066"),o=n("c430"),s=n("83ab"),u=n("4930"),c=n("fdbf"),l=n("d039"),d=n("5135"),p=n("e8b5"),h=n("861d"),f=n("825a"),m=n("7b0b"),v=n("fc6a"),g=n("c04e"),y=n("5c6c"),b=n("7c73"),_=n("df75"),w=n("241c"),x=n("057f"),T=n("7418"),C=n("06cf"),S=n("9bf2"),E=n("d1e7"),k=n("9112"),R=n("6eeb"),O=n("5692"),A=n("f772"),I=n("d012"),N=n("90e3"),D=n("b622"),P=n("e538"),M=n("746f"),L=n("d44e"),j=n("69f3"),B=n("b727").forEach,U=A("hidden"),F="Symbol",V="prototype",q=D("toPrimitive"),W=j.set,z=j.getterFor(F),G=Object[V],H=i.Symbol,$=a("JSON","stringify"),K=C.f,Y=S.f,X=x.f,J=E.f,Q=O("symbols"),Z=O("op-symbols"),ee=O("string-to-symbol-registry"),te=O("symbol-to-string-registry"),ne=O("wks"),re=i.QObject,ie=!re||!re[V]||!re[V].findChild,ae=s&&l((function(){return 7!=b(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=K(G,t);r&&delete G[t],Y(e,t,n),r&&e!==G&&Y(G,t,r)}:Y,oe=function(e,t){var n=Q[e]=b(H[V]);return W(n,{type:F,tag:e,description:t}),s||(n.description=t),n},se=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof H},ue=function(e,t,n){e===G&&ue(Z,t,n),f(e);var r=g(t,!0);return f(n),d(Q,r)?(n.enumerable?(d(e,U)&&e[U][r]&&(e[U][r]=!1),n=b(n,{enumerable:y(0,!1)})):(d(e,U)||Y(e,U,y(1,{})),e[U][r]=!0),ae(e,r,n)):Y(e,r,n)},ce=function(e,t){f(e);var n=v(t),r=_(n).concat(fe(n));return B(r,(function(t){s&&!de.call(n,t)||ue(e,t,n[t])})),e},le=function(e,t){return void 0===t?b(e):ce(b(e),t)},de=function(e){var t=g(e,!0),n=J.call(this,t);return!(this===G&&d(Q,t)&&!d(Z,t))&&(!(n||!d(this,t)||!d(Q,t)||d(this,U)&&this[U][t])||n)},pe=function(e,t){var n=v(e),r=g(t,!0);if(n!==G||!d(Q,r)||d(Z,r)){var i=K(n,r);return!i||!d(Q,r)||d(n,U)&&n[U][r]||(i.enumerable=!0),i}},he=function(e){var t=X(v(e)),n=[];return B(t,(function(e){d(Q,e)||d(I,e)||n.push(e)})),n},fe=function(e){var t=e===G,n=X(t?Z:v(e)),r=[];return B(n,(function(e){!d(Q,e)||t&&!d(G,e)||r.push(Q[e])})),r};if(u||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=N(e),n=function(e){this===G&&n.call(Z,e),d(this,U)&&d(this[U],t)&&(this[U][t]=!1),ae(this,t,y(1,e))};return s&&ie&&ae(G,t,{configurable:!0,set:n}),oe(t,e)},R(H[V],"toString",(function(){return z(this).tag})),R(H,"withoutSetter",(function(e){return oe(N(e),e)})),E.f=de,S.f=ue,C.f=pe,w.f=x.f=he,T.f=fe,P.f=function(e){return oe(D(e),e)},s&&(Y(H[V],"description",{configurable:!0,get:function(){return z(this).description}}),o||R(G,"propertyIsEnumerable",de,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:H}),B(_(ne),(function(e){M(e)})),r({target:F,stat:!0,forced:!u},{for:function(e){var t=String(e);if(d(ee,t))return ee[t];var n=H(t);return ee[t]=n,te[n]=t,n},keyFor:function(e){if(!se(e))throw TypeError(e+" is not a symbol");if(d(te,e))return te[e]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!s},{create:le,defineProperty:ue,defineProperties:ce,getOwnPropertyDescriptor:pe}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:he,getOwnPropertySymbols:fe}),r({target:"Object",stat:!0,forced:l((function(){T.f(1)}))},{getOwnPropertySymbols:function(e){return T.f(m(e))}}),$){var me=!u||l((function(){var e=H();return"[null]"!=$([e])||"{}"!=$({a:e})||"{}"!=$(Object(e))}));r({target:"JSON",stat:!0,forced:me},{stringify:function(e,t,n){var r,i=[e],a=1;while(arguments.length>a)i.push(arguments[a++]);if(r=t,(h(t)||void 0!==e)&&!se(e))return p(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!se(t))return t}),i[1]=t,$.apply(null,i)}})}H[V][q]||k(H[V],q,H[V].valueOf),L(H,F),I[U]=!0},a559:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},a691:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},a79d:function(e,t,n){"use strict";var r=n("23e7"),i=n("c430"),a=n("fea9"),o=n("d039"),s=n("d066"),u=n("4840"),c=n("cdf9"),l=n("6eeb"),d=!!a&&o((function(){a.prototype["finally"].call({then:function(){}},(function(){}))}));r({target:"Promise",proto:!0,real:!0,forced:d},{finally:function(e){var t=u(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return c(t,e()).then((function(){return n}))}:e,n?function(n){return c(t,e()).then((function(){throw n}))}:e)}}),i||"function"!=typeof a||a.prototype["finally"]||l(a.prototype,"finally",s("Promise").prototype["finally"])},a80f:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},a8e0:function(e,t,n){"use strict";var r=n("dc6d").discardEmulationPreventionBytes,i=n("4e69").CaptionStream,a=n("2806"),o=n("9afa"),s=function(e,t){for(var n=e,r=0;r<t.length;r++){var i=t[r];if(n<i.size)return i;n-=i.size}return null},u=function(e,t,n){var i,a,o,u,c=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(a=0;a+4<e.length;a+=o)if(o=c.getUint32(a),a+=4,!(o<=0))switch(31&e[a]){case 6:var d=e.subarray(a+1,a+1+o),p=s(a,t);i={nalUnitType:"sei_rbsp",size:o,data:d,escapedRBSP:r(d),trackId:n},p?(i.pts=p.pts,i.dts=p.dts,u=p):(i.pts=u.pts,i.dts=u.dts),l.push(i);break;default:break}return l},c=function(e,t,n){var r=t,i=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,s=n.trackId,u=[];return e.forEach((function(e){var t=o.parseTrun(e),n=t.samples;n.forEach((function(e){void 0===e.duration&&(e.duration=i),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration})),u=u.concat(n)})),u},l=function(e,t){var n=a.findBox(e,["moof","traf"]),r=a.findBox(e,["mdat"]),i={},s=[];return r.forEach((function(e,t){var r=n[t];s.push({mdat:e,traf:r})})),s.forEach((function(e){var n,r,s=e.mdat,l=e.traf,d=a.findBox(l,["tfhd"]),p=o.parseTfhd(d[0]),h=p.trackId,f=a.findBox(l,["tfdt"]),m=f.length>0?o.parseTfdt(f[0]).baseMediaDecodeTime:0,v=a.findBox(l,["trun"]);t===h&&v.length>0&&(n=c(v,m,p),r=u(s,n,h),i[h]||(i[h]=[]),i[h]=i[h].concat(r))})),i},d=function(e,t,n){var r;return null===t?null:(r=l(e,t),{seiNals:r[t],timescale:n})},p=function(){var e,t,n,r,a,o,s=!1;this.isInitialized=function(){return s},this.init=function(t){e=new i,s=!0,o=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/r,e.endTime=e.endPts/r,a.captions.push(e),a.captionStreams[e.stream]=!0}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"===typeof t&&0===Object.keys(t).length)&&(n!==e[0]||r!==t[n])},this.parse=function(e,i,o){var s;if(!this.isInitialized())return null;if(!i||!o)return null;if(this.isNewInit(i,o))n=i[0],r=o[n];else if(null===n||!r)return t.push(e),null;while(t.length>0){var u=t.shift();this.parse(u,i,o)}return s=d(e,n,r),null!==s&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),a):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;o?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){a.captions=[],a.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,r=null,a?this.clearParsedCaptions():a={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()};e.exports=p},a9e3:function(e,t,n){"use strict";var r=n("83ab"),i=n("da84"),a=n("94ca"),o=n("6eeb"),s=n("5135"),u=n("c6b6"),c=n("7156"),l=n("c04e"),d=n("d039"),p=n("7c73"),h=n("241c").f,f=n("06cf").f,m=n("9bf2").f,v=n("58a8").trim,g="Number",y=i[g],b=y.prototype,_=u(p(b))==g,w=function(e){var t,n,r,i,a,o,s,u,c=l(e,!1);if("string"==typeof c&&c.length>2)if(c=v(c),t=c.charCodeAt(0),43===t||45===t){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(a=c.slice(2),o=a.length,s=0;s<o;s++)if(u=a.charCodeAt(s),u<48||u>i)return NaN;return parseInt(a,r)}return+c};if(a(g,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var x,T=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof T&&(_?d((function(){b.valueOf.call(n)})):u(n)!=g)?c(new y(w(t)),n,T):w(t)},C=r?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;C.length>S;S++)s(y,x=C[S])&&!s(T,x)&&m(T,x,f(y,x));T.prototype=b,b.constructor=T,o(i,g,T)}},a9ee:function(e,t,n){"use strict";(function(n,r){var i,a;
/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */
function o(e,t){if(!e)throw"First parameter is required.";t=t||{type:"video"},t=new s(e,t);var n=this;function r(r){return t.disableLogs||console.log("RecordRTC version: ",n.version),r&&(t=new s(e,r)),t.disableLogs||console.log("started recording "+t.type+" stream."),v?(v.clearRecordedData(),v.record(),f("recording"),n.recordingDuration&&h(),n):(i((function(){n.recordingDuration&&h()})),n)}function i(n){n&&(t.initCallback=function(){n(),n=t.initCallback=null});var r=new u(e,t);v=new r(e,t),v.record(),f("recording"),t.disableLogs||console.log("Initialized recorderType:",v.constructor.name,"for output-type:",t.type)}function a(e){if(e=e||function(){},v){if("paused"===n.state)return n.resumeRecording(),void setTimeout((function(){a(e)}),1);"recording"===n.state||t.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',n.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),"gif"!==t.type?v.stop(r):(v.stop(),r()),f("stopped")}else y();function r(r){if(v){Object.keys(v).forEach((function(e){"function"!==typeof v[e]&&(n[e]=v[e])}));var i=v.blob;if(!i){if(!r)throw"Recording failed.";v.blob=i=r}if(i&&!t.disableLogs&&console.log(i.type,"->",x(i.size)),e){var a;try{a=m.createObjectURL(i)}catch(o){}"function"===typeof e.call?e.call(n,a):e(a)}t.autoWriteToDisk&&p((function(e){var n={};n[t.type+"Blob"]=e,M.Store(n)}))}else"function"===typeof e.call?e.call(n,""):e("")}}function c(){v?"recording"===n.state?(f("paused"),v.pause(),t.disableLogs||console.log("Paused recording.")):t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",n.state):y()}function l(){v?"paused"===n.state?(f("recording"),v.resume(),t.disableLogs||console.log("Resumed recording.")):t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",n.state):y()}function d(e){postMessage((new FileReaderSync).readAsDataURL(e))}function p(e,n){if(!e)throw"Pass a callback function over getDataURL.";var r=n?n.blob:(v||{}).blob;if(!r)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){p(e,n)}),1e3);if("undefined"===typeof Worker||navigator.mozGetUserMedia){var i=new FileReader;i.readAsDataURL(r),i.onload=function(t){e(t.target.result)}}else{var a=o(d);a.onmessage=function(t){e(t.data)},a.postMessage(r)}function o(e){try{var t=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(t);return m.revokeObjectURL(t),n}catch(r){}}}function h(e){e=e||0,"paused"!==n.state?"stopped"!==n.state&&(e>=n.recordingDuration?a(n.onRecordingStopped):(e+=1e3,setTimeout((function(){h(e)}),1e3))):setTimeout((function(){h(e)}),1e3)}function f(e){n&&(n.state=e,"function"===typeof n.onStateChanged.call?n.onStateChanged.call(n,e):n.onStateChanged(e))}var v,g='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function y(){!0!==t.disableLogs&&console.warn(g)}var b={startRecording:r,stopRecording:a,pauseRecording:c,resumeRecording:l,initRecorder:i,setRecordingDuration:function(e,t){if("undefined"===typeof e)throw"recordingDuration is required.";if("number"!==typeof e)throw"recordingDuration must be a number.";return n.recordingDuration=e,n.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){n.onRecordingStopped=e}}},clearRecordedData:function(){v?(v.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")):y()},getBlob:function(){if(v)return v.blob;y()},getDataURL:p,toURL:function(){if(v)return m.createObjectURL(v.blob);y()},getInternalRecorder:function(){return v},save:function(e){v?T(v.blob,e):y()},getFromDisk:function(e){v?o.getFromDisk(t.type,e):y()},setAdvertisementArray:function(e){t.advertisement=[];for(var n=e.length,r=0;r<n;r++)t.advertisement.push({duration:r,image:e[r]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==n.state||t.disableLogs||console.warn("Stop an active recorder."),v&&"function"===typeof v.clearRecordedData&&v.clearRecordedData(),v=null,f("inactive"),n.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return n.state},destroy:function(){var e=t.disableLogs;t={disableLogs:!0},n.reset(),f("destroyed"),b=n=null,R.AudioContextConstructor&&(R.AudioContextConstructor.close(),R.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.1"};if(!this)return n=b,b;for(var _ in b)this[_]=b[_];return n=this,b}
/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */
function s(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===D||t.recorderType===N||"undefined"!==typeof F&&t.recorderType===F?t.type="video":t.recorderType===L?t.type="gif":t.recorderType===I?t.type="audio":t.recorderType===A&&(S(e,"audio").length&&S(e,"video").length||!S(e,"audio").length&&S(e,"video").length?t.type="video":S(e,"audio").length&&!S(e,"video").length&&(t.type="audio"))),"undefined"!==typeof A&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}
/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function u(e,t){var n;return(b||v||g)&&(n=I),"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!b&&(n=A),"video"===t.type&&(b||g)&&(n=D,"undefined"!==typeof F&&"undefined"!==typeof ReadableStream&&(n=F)),"gif"===t.type&&(n=L),"canvas"===t.type&&(n=N),O()&&n!==N&&n!==L&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(S(e,"video").length||S(e,"audio").length)&&("audio"===t.type?"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(n=A):"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(n=A)),e instanceof Array&&e.length&&(n=B),t.recorderType&&(n=t.recorderType),!t.disableLogs&&n&&n.name&&console.log("Using recorderType:",n.name||n.constructor.name),!n&&_&&(n=A),n}
/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function c(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,n=this.mediaType,r=this.mimeType||{audio:null,video:null,gif:null};if("function"!==typeof n.audio&&O()&&!S(e,"audio").length&&(n.audio=!1),"function"!==typeof n.video&&O()&&!S(e,"video").length&&(n.video=!1),"function"!==typeof n.gif&&O()&&!S(e,"video").length&&(n.gif=!1),!n.audio&&!n.video&&!n.gif)throw"MediaStream must have either audio or video tracks.";if(n.audio&&(t=null,"function"===typeof n.audio&&(t=n.audio),this.audioRecorder=new o(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:r.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),n.video||this.audioRecorder.startRecording()),n.video){t=null,"function"===typeof n.video&&(t=n.video);var i=e;if(O()&&n.audio&&"function"===typeof n.audio){var a=S(e,"video")[0];y?(i=new w,i.addTrack(a),t&&t===D&&(t=A)):(i=new w,i.addTrack(a))}this.videoRecorder=new o(i,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:r.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),n.audio||this.videoRecorder.startRecording()}if(n.audio&&n.video){var s=this,u=!0===O();(n.audio instanceof I&&n.video||!0!==n.audio&&!0!==n.video&&n.audio!==n.video)&&(u=!1),!0===u?(s.audioRecorder=null,s.videoRecorder.startRecording()):s.videoRecorder.initRecorder((function(){s.audioRecorder.initRecorder((function(){s.videoRecorder.startRecording(),s.audioRecorder.startRecording()}))}))}n.gif&&(t=null,"function"===typeof n.gif&&(t=n.gif),this.gifRecorder=new o(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:r.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!==typeof Worker){var r=n((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));r.onmessage=function(e){t(e.data)},r.postMessage(e)}else{var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){t(e.target.result)}}}function n(e){var t,n=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),r=new Worker(n);if("undefined"!==typeof m)t=m;else{if("undefined"===typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(n),r}this.getBlob((function(n){n.audio&&n.video?t(n.audio,(function(r){t(n.video,(function(t){e({audio:r,video:t})}))})):n.audio?t(n.audio,(function(t){e({audio:t})})):n.video&&t(n.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){o.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save("string"===typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"===typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"===typeof e.gif?e.gif:"")}}o.version="5.6.1",e.exports=o,i=[],a=function(){return o}.apply(t,i),void 0===a||(e.exports=a),o.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),M.Fetch((function(n,r){"all"!==e&&r===e+"Blob"&&t&&t(n),"all"===e&&t&&t(n,r.replace("Blob",""))}))},o.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(n){e.gif.getDataURL((function(e){M.Store({audioBlob:t,videoBlob:n,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){M.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){M.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){M.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){M.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){M.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){M.Store({gifBlob:e})}))},c.getFromDisk=o.getFromDisk,c.writeToDisk=o.writeToDisk,"undefined"!==typeof o&&(o.MRecordRTC=c);var l="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){e&&"undefined"===typeof window&&"undefined"!==typeof n&&(n.navigator={userAgent:l,getUserMedia:function(){}},n.console||(n.console={}),"undefined"!==typeof n.console.log&&"undefined"!==typeof n.console.error||(n.console.error=n.console.log=n.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof m&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=n)})("undefined"!==typeof n?n:null);var d=window.requestAnimationFrame;if("undefined"===typeof d)if("undefined"!==typeof webkitRequestAnimationFrame)d=webkitRequestAnimationFrame;else if("undefined"!==typeof mozRequestAnimationFrame)d=mozRequestAnimationFrame;else if("undefined"!==typeof msRequestAnimationFrame)d=msRequestAnimationFrame;else if("undefined"===typeof d){var p=0;d=function(e,t){var n=(new Date).getTime(),r=Math.max(0,16-(n-p)),i=setTimeout((function(){e(n+r)}),r);return p=n+r,i}}var h=window.cancelAnimationFrame;"undefined"===typeof h&&("undefined"!==typeof webkitCancelAnimationFrame?h=webkitCancelAnimationFrame:"undefined"!==typeof mozCancelAnimationFrame?h=mozCancelAnimationFrame:"undefined"!==typeof msCancelAnimationFrame?h=msCancelAnimationFrame:"undefined"===typeof h&&(h=function(e){clearTimeout(e)}));var f=window.AudioContext;"undefined"===typeof f&&("undefined"!==typeof webkitAudioContext&&(f=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(f=mozAudioContext));var m=window.URL;"undefined"===typeof m&&"undefined"!==typeof webkitURL&&(m=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var v=-1!==navigator.userAgent.indexOf("Edge")&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),g=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),y=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),b=!g&&!v&&!!navigator.webkitGetUserMedia||C()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),_=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);_&&!b&&-1!==navigator.userAgent.indexOf("CriOS")&&(_=!1,b=!0);var w=window.MediaStream;function x(e){var t=1e3,n=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Bytes";var r=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);return(e/Math.pow(t,r)).toPrecision(3)+" "+n[r]}function T(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(o){}var n=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var r=t.split(".");t=r[0],n=r[1]}var i=(t||Math.round(9999999999*Math.random())+888888888)+"."+n;if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,i);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,i);var a=document.createElement("a");a.href=m.createObjectURL(e),a.download=i,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"===typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),m.revokeObjectURL(a.href)}function C(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof r||"object"!==typeof r.versions||!r.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}function S(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function E(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function k(e,t){if("undefined"===typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var n=new EBML.Reader,r=new EBML.Decoder,i=EBML.tools,a=new FileReader;a.onload=function(e){var a=r.decode(this.result);a.forEach((function(e){n.read(e)})),n.stop();var o=i.makeMetadataSeekable(n.metadatas,n.duration,n.cues),s=this.result.slice(n.metadataSize),u=new Blob([o,s],{type:"video/webm"});t(u)},a.readAsArrayBuffer(e)}"undefined"===typeof w&&"undefined"!==typeof webkitMediaStream&&(w=webkitMediaStream),"undefined"!==typeof w&&"undefined"===typeof w.prototype.stop&&(w.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),"undefined"!==typeof o&&(o.invokeSaveAsDialog=T,o.getTracks=S,o.getSeekableBlob=k,o.bytesToSize=x,o.isElectron=C);
/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var R={};function O(){if(y||_||v)return!0;navigator.appVersion;var e,t,n=navigator.userAgent,r=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);return(b||g)&&(e=n.indexOf("Chrome"),r=n.substring(e+7)),-1!==(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!==(t=r.indexOf(" "))&&(r=r.substring(0,t)),i=parseInt(""+r,10),isNaN(i)&&(r=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i>=49}
/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function A(e,t){var n=this;if("undefined"===typeof e)throw'First argument "MediaStream" is required.';if("undefined"===typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},"audio"===t.type){var r;if(S(e,"video").length&&S(e,"audio").length)navigator.mozGetUserMedia?(r=new w,r.addTrack(S(e,"audio")[0])):r=new w(S(e,"audio")),e=r;t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=b?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var i,a=[];function o(){n.timestamps.push((new Date).getTime()),"function"===typeof t.onTimeStamp&&t.onTimeStamp(n.timestamps[n.timestamps.length-1],n.timestamps)}function s(e){return i&&i.mimeType?i.mimeType:e.mimeType||"video/webm"}function u(){a=[],i=null,n.timestamps=[]}function c(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}this.getArrayOfBlobs=function(){return a},this.record=function(){n.blob=null,n.clearRecordedData(),n.timestamps=[],l=[],a=[];var r=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",r),i&&(i=null),b&&!O()&&(r="video/vp8"),"function"===typeof MediaRecorder.isTypeSupported&&r.mimeType&&(MediaRecorder.isTypeSupported(r.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",r.mimeType),r.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{i=new MediaRecorder(e,r),t.mimeType=r.mimeType}catch(u){i=new MediaRecorder(e)}r.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in i&&!1===i.canRecordMimeType(r.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",r.mimeType)),i.ondataavailable=function(e){if(e.data&&l.push("ondataavailable: "+x(e.data.size)),"number"!==typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||n.blob?n.recordingCallback&&(n.recordingCallback(new Blob([],{type:s(r)})),n.recordingCallback=null):(n.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:s(r)}),n.recordingCallback&&(n.recordingCallback(n.blob),n.recordingCallback=null));else if(e.data&&e.data.size&&e.data.size>100&&(a.push(e.data),o(),"function"===typeof t.ondataavailable)){var i=t.getNativeBlob?e.data:new Blob([e.data],{type:s(r)});t.ondataavailable(i)}},i.onstart=function(){l.push("started")},i.onpause=function(){l.push("paused")},i.onresume=function(){l.push("resumed")},i.onstop=function(){l.push("stopped")},i.onerror=function(e){e&&(e.name||(e.name="UnknownError"),l.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",r.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!n.manuallyStopped&&i&&"inactive"===i.state)return delete t.timeslice,void i.start(6e5);setTimeout(e,1e3)}(),"inactive"!==i.state&&"stopped"!==i.state&&i.stop())},"number"===typeof t.timeSlice?(o(),i.start(t.timeSlice)):i.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},n.manuallyStopped=!0,i&&(this.recordingCallback=e,"recording"===i.state&&i.stop(),"number"===typeof t.timeSlice&&setTimeout((function(){n.blob=new Blob(a,{type:s(t)}),n.recordingCallback(n.blob)}),100))},this.pause=function(){i&&"recording"===i.state&&i.pause()},this.resume=function(){i&&"paused"===i.state&&i.resume()},this.clearRecordedData=function(){i&&"recording"===i.state&&n.stop(u),u()},this.getInternalRecorder=function(){return i},this.blob=null,this.getState=function(){return i&&i.state||"inactive"};var l=[];this.getAllStates=function(){return l},"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1);n=this;(function e(){if(i&&!1!==t.checkForInactiveTracks)return!1===c()?(t.disableLogs||console.log("MediaStream seems stopped."),void n.stop()):void setTimeout(e,1e3)})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}
/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */
function I(e,t){if(!S(e,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var n,r=this,i=[],a=[],s=!1,u=0,c=2,l=t.desiredSampRate;function d(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function p(e,t){function n(e,t){var n,r=e.numberOfAudioChannels,i=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),o=e.sampleRate,s=e.internalInterleavedLength,u=e.desiredSampRate;function c(e,t,n){var r=Math.round(e.length*(t/n)),i=[],a=Number((e.length-1)/(r-1));i[0]=e[0];for(var o=1;o<r-1;o++){var s=o*a,u=Number(Math.floor(s)).toFixed(),c=Number(Math.ceil(s)).toFixed(),d=s-u;i[o]=l(e[u],e[c],d)}return i[r-1]=e[e.length-1],i}function l(e,t,n){return e+(t-e)*n}function d(e,t){for(var n=new Float64Array(t),r=0,i=e.length,a=0;a<i;a++){var o=e[a];n.set(o,r),r+=o.length}return n}function p(e,t){for(var n=e.length+t.length,r=new Float64Array(n),i=0,a=0;a<n;)r[a++]=e[i],r[a++]=t[i],i++;return r}function h(e,t,n){for(var r=n.length,i=0;i<r;i++)e.setUint8(t+i,n.charCodeAt(i))}2===r&&(i=d(i,s),a=d(a,s),u&&(i=c(i,u,o),a=c(a,u,o))),1===r&&(i=d(i,s),u&&(i=c(i,u,o))),u&&(o=u),2===r&&(n=p(i,a)),1===r&&(n=i);var f=n.length,m=44+2*f,v=new ArrayBuffer(m),g=new DataView(v);h(g,0,"RIFF"),g.setUint32(4,36+2*f,!0),h(g,8,"WAVE"),h(g,12,"fmt "),g.setUint32(16,16,!0),g.setUint16(20,1,!0),g.setUint16(22,r,!0),g.setUint32(24,o,!0),g.setUint32(28,2*o,!0),g.setUint16(32,2*r,!0),g.setUint16(34,16,!0),h(g,36,"data"),g.setUint32(40,2*f,!0);for(var y=f,b=44,_=1,w=0;w<y;w++)g.setInt16(b,n[w]*(32767*_),!0),b+=2;if(t)return t({buffer:v,view:g});postMessage({buffer:v,view:g})}if(e.noWorker)n(e,(function(e){t(e.buffer,e.view)}));else{var r=h(n);r.onmessage=function(e){t(e.data.buffer,e.data.view),m.revokeObjectURL(r.workerURL),r.terminate()},r.postMessage(e)}}function h(e){var t=m.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(t);return n.workerURL=t,n}!0===t.leftChannel&&(c=1),1===t.numberOfAudioChannels&&(c=1),(!c||c<1)&&(c=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+c),"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===d())throw"Please make sure MediaStream is active.";w(),T=_=!1,s=!0,"undefined"!==typeof t.timeSlice&&k()},this.stop=function(e){e=e||function(){},s=!1,p({desiredSampRate:l,sampleRate:b,numberOfAudioChannels:c,internalInterleavedLength:u,leftBuffers:i,rightBuffers:1===c?[]:a,noWorker:t.noWorker},(function(t,n){r.blob=new Blob([n],{type:"audio/wav"}),r.buffer=new ArrayBuffer(n.buffer.byteLength),r.view=n,r.sampleRate=l||b,r.bufferSize=y,r.length=u,T=!1,e&&e(r.blob)}))},"undefined"===typeof o.Storage&&(o.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),o.Storage.AudioContextConstructor&&"closed"!==o.Storage.AudioContextConstructor.state||(o.Storage.AudioContextConstructor=new o.Storage.AudioContext);var f=o.Storage.AudioContextConstructor,v=f.createMediaStreamSource(e),g=[0,256,512,1024,2048,4096,8192,16384],y="undefined"===typeof t.bufferSize?4096:t.bufferSize;if(-1===g.indexOf(y)&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(g,null,"\t"))),f.createJavaScriptNode)n=f.createJavaScriptNode(y,c,c);else{if(!f.createScriptProcessor)throw"WebAudio API has no support on this browser.";n=f.createScriptProcessor(y,c,c)}v.connect(n),t.bufferSize||(y=n.bufferSize);var b="undefined"!==typeof t.sampleRate?t.sampleRate:f.sampleRate||44100;(b<22050||b>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var _=!1;function w(){i=[],a=[],u=0,T=!1,s=!1,_=!1,f=null,r.leftchannel=i,r.rightchannel=a,r.numberOfAudioChannels=c,r.desiredSampRate=l,r.sampleRate=b,r.recordingLength=u,E={left:[],right:[],recordingLength:0}}function x(){n&&(n.onaudioprocess=null,n.disconnect(),n=null),v&&(v.disconnect(),v=null),w()}this.pause=function(){_=!0},this.resume=function(){if(!1===d())throw"Please make sure MediaStream is active.";if(!s)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();_=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,s&&this.stop(x),x()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var T=!1;function C(e){if(!_)if(!1===d()&&(t.disableLogs||console.log("MediaStream seems stopped."),n.disconnect(),s=!1),s){T||(T=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var o=e.inputBuffer.getChannelData(0),l=new Float32Array(o);if(i.push(l),2===c){var p=e.inputBuffer.getChannelData(1),h=new Float32Array(p);a.push(h)}u+=y,r.recordingLength=u,"undefined"!==typeof t.timeSlice&&(E.recordingLength+=y,E.left.push(l),2===c&&E.right.push(h))}else v&&(v.disconnect(),v=null)}n.onaudioprocess=C,f.createMediaStreamDestination?n.connect(f.createMediaStreamDestination()):n.connect(f.destination),this.leftchannel=i,this.rightchannel=a,this.numberOfAudioChannels=c,this.desiredSampRate=l,this.sampleRate=b,r.recordingLength=u;var E={left:[],right:[],recordingLength:0};function k(){s&&"function"===typeof t.ondataavailable&&"undefined"!==typeof t.timeSlice&&(E.left.length?(p({desiredSampRate:l,sampleRate:b,numberOfAudioChannels:c,internalInterleavedLength:E.recordingLength,leftBuffers:E.left,rightBuffers:1===c?[]:E.right},(function(e,n){var r=new Blob([n],{type:"audio/wav"});t.ondataavailable(r),setTimeout(k,t.timeSlice)})),E={left:[],right:[],recordingLength:0}):setTimeout(k,t.timeSlice))}}
/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */
function N(e,t){if("undefined"===typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var n=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(n=!0)}));var r,i,a,o=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,s=50,u=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(o&&u&&u[2]&&(s=parseInt(u[2],10)),o&&s<52&&(n=!1),t.useWhammyRecorder&&(n=!1),n)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)r=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";r=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,n&&!t.useWhammyRecorder){var e;"captureStream"in r?e=r.captureStream(25):"mozCaptureStream"in r?e=r.mozCaptureStream(25):"webkitCaptureStream"in r&&(e=r.webkitCaptureStream(25));try{var o=new w;o.addTrack(S(e,"video")[0]),e=o}catch(s){}if(!e)throw"captureStream API are NOT available.";i=new A(e,{mimeType:t.mimeType||"video/webm"}),i.record()}else f.frames=[],h=(new Date).getTime(),p();t.initCallback&&t.initCallback()},this.getWebPImages=function(n){if("canvas"===e.nodeName.toLowerCase()){var r=f.frames.length;f.frames.forEach((function(e,n){var i=r-n;t.disableLogs||console.log(i+"/"+r+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(i,r);var a=e.image.toDataURL("image/webp",1);f.frames[n].image=a})),t.disableLogs||console.log("Generating WebM"),n()}else n()},this.stop=function(e){a=!1;var r=this;n&&i?i.stop(e):this.getWebPImages((function(){f.compile((function(n){t.disableLogs||console.log("Recording finished!"),r.blob=n,r.blob.forEach&&(r.blob=new Blob([],{type:"video/webm"})),e&&e(r.blob),f.frames=[]}))}))};var c=!1;function l(){f.frames=[],a=!1,c=!1}function d(){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function p(){if(c)return h=(new Date).getTime(),setTimeout(p,500);if("canvas"===e.nodeName.toLowerCase()){var n=(new Date).getTime()-h;return h=(new Date).getTime(),f.frames.push({image:d(),duration:n}),void(a&&setTimeout(p,t.frameInterval))}html2canvas(e,{grabMouse:"undefined"===typeof t.showMousePointer||t.showMousePointer,onrendered:function(e){var n=(new Date).getTime()-h;if(!n)return setTimeout(p,t.frameInterval);h=(new Date).getTime(),f.frames.push({image:e.toDataURL("image/webp",1),duration:n}),a&&setTimeout(p,t.frameInterval)}})}this.pause=function(){c=!0,i instanceof A&&i.pause()},this.resume=function(){c=!1,i instanceof A?i.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(l),l()},this.name="CanvasRecorder",this.toString=function(){return this.name};var h=(new Date).getTime(),f=new P.Video(100)}
/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */
function D(e,t){function n(e){e="undefined"!==typeof e?e:10;var t=(new Date).getTime()-c;return t?o?(c=(new Date).getTime(),setTimeout(n,100)):(c=(new Date).getTime(),u.paused&&u.play(),p.drawImage(u,0,0,d.width,d.height),l.frames.push({duration:t,image:d.toDataURL("image/webp")}),void(a||setTimeout(n,e,e))):setTimeout(n,e,e)}function r(e){var t=-1,n=e.length;(function r(){t++,t!==n?setTimeout((function(){e.functionToLoop(r,t)}),1):e.callback()})()}function i(e,t,n,i,a){var o=document.createElement("canvas");o.width=d.width,o.height=d.height;var s=o.getContext("2d"),u=[],c=-1===t,l=t&&t>0&&t<=e.length?t:e.length,p={r:0,g:0,b:0},h=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),f=n&&n>=0&&n<=1?n:0,m=i&&i>=0&&i<=1?i:0,v=!1;r({length:l,functionToLoop:function(t,n){var r,i,a,o=function(){!v&&a-r<=a*m||(c&&(v=!0),u.push(e[n])),t()};if(v)o();else{var l=new Image;l.onload=function(){s.drawImage(l,0,0,d.width,d.height);var e=s.getImageData(0,0,d.width,d.height);r=0,i=e.data.length,a=e.data.length/4;for(var t=0;t<i;t+=4){var n={r:e.data[t],g:e.data[t+1],b:e.data[t+2]},u=Math.sqrt(Math.pow(n.r-p.r,2)+Math.pow(n.g-p.g,2)+Math.pow(n.b-p.b,2));u<=h*f&&r++}o()},l.src=e[n].image}},callback:function(){u=u.concat(e.slice(l)),u.length<=0&&u.push(e[e.length-1]),a(u)}})}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),d.width=t.canvas.width||320,d.height=t.canvas.height||240,p=d.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(u=t.video.cloneNode(),t.initCallback&&t.initCallback()):(u=document.createElement("video"),E(e,u),u.onloadedmetadata=function(){t.initCallback&&t.initCallback()},u.width=t.video.width,u.height=t.video.height),u.muted=!0,u.play(),c=(new Date).getTime(),l=new P.Video,t.disableLogs||(console.log("canvas resolutions",d.width,"*",d.height),console.log("video width/height",u.width||d.width,"*",u.height||d.height)),n(t.frameInterval)};var a=!1;this.stop=function(e){e=e||function(){},a=!0;var n=this;setTimeout((function(){i(l.frames,-1,null,null,(function(r){l.frames=r,t.advertisement&&t.advertisement.length&&(l.frames=t.advertisement.concat(l.frames)),l.compile((function(t){n.blob=t,n.blob.forEach&&(n.blob=new Blob([],{type:"video/webm"})),e&&e(n.blob)}))}))}),10)};var o=!1;function s(){l.frames=[],a=!0,o=!1}this.pause=function(){o=!0},this.resume=function(){o=!1,a&&this.record()},this.clearRecordedData=function(){a||this.stop(s),s()},this.name="WhammyRecorder",this.toString=function(){return this.name};var u,c,l,d=document.createElement("canvas"),p=d.getContext("2d")}"undefined"!==typeof f?R.AudioContext=f:"undefined"!==typeof webkitAudioContext&&(R.AudioContext=webkitAudioContext),"undefined"!==typeof o&&(o.Storage=R),"undefined"!==typeof o&&(o.MediaStreamRecorder=A),"undefined"!==typeof o&&(o.StereoAudioRecorder=I),"undefined"!==typeof o&&(o.CanvasRecorder=N),"undefined"!==typeof o&&(o.WhammyRecorder=D);
/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var P=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(t);return m.revokeObjectURL(t),n}function n(e){function t(e){var t=r(e);if(!t)return[];var i=3e4,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:p(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],o=0,u=0;while(o<e.length){var c=[],l=0;do{c.push(e[o]),l+=e[o].duration,o++}while(o<e.length&&l<i);var d=0,h={id:524531317,data:n(u,d,c)};a[1].data.push(h),u+=l}return s(a)}function n(e,t,n){return[{data:e,id:231}].concat(n.map((function(e){var n=u({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:n,id:163}})))}function r(e){if(e[0]){for(var t=e[0].width,n=e[0].height,r=e[0].duration,i=1;i<e.length;i++)r+=e[i].duration;return{duration:r,width:t,height:n}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}function i(e){var t=[];while(e>0)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function a(e){return new Uint8Array(e.split("").map((function(e){return e.charCodeAt(0)})))}function o(e){var t=[],n=e.length%8?new Array(9-e.length%8).join("0"):"";e=n+e;for(var r=0;r<e.length;r+=8)t.push(parseInt(e.substr(r,8),2));return new Uint8Array(t)}function s(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].data;"object"===typeof r&&(r=s(r)),"number"===typeof r&&(r=o(r.toString(2))),"string"===typeof r&&(r=a(r));var u=r.size||r.byteLength||r.length,c=Math.ceil(Math.ceil(Math.log(u)/Math.log(2))/8),l=u.toString(2),d=new Array(7*c+7+1-l.length).join("0")+l,p=new Array(c).join("0")+"1"+d;t.push(i(e[n].id)),t.push(o(p)),t.push(r)}return new Blob(t,{type:"video/webm"})}function u(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";var n=[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame;return n}function c(e){for(var t,n,r,i=e.RIFF[0].WEBP[0],a=i.indexOf("*"),o=0,s=[];o<4;o++)s[o]=i.charCodeAt(a+3+o);return r=s[1]<<8|s[0],t=16383&r,r=s[3]<<8|s[2],n=16383&r,{width:t,height:n,data:i,riff:e}}function l(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}function d(e){var t=0,n={};while(t<e.length){var r=e.substr(t,4),i=l(e,t),a=e.substr(t+4+4,i);t+=8+i,n[r]=n[r]||[],"RIFF"===r||"LIST"===r?n[r].push(d(a)):n[r].push(a)}return n}function p(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")}var h=new t(e.map((function(e){var t=c(d(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(h)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var r=t(n);r.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},r.postMessage(this.frames)},{Video:e}}();"undefined"!==typeof o&&(o.Whammy=P);
/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var M={init:function(){var e=this;if("undefined"!==typeof indexedDB&&"undefined"!==typeof indexedDB.open){var t,n=1,r=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),i=indexedDB.open(r,n);i.onerror=e.onError,i.onsuccess=function(){if(t=i.result,t.onerror=e.onError,t.setVersion)if(t.version!==n){var r=t.setVersion(n);r.onsuccess=function(){a(t),o()}}else o();else o()},i.onupgradeneeded=function(e){a(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function a(t){t.createObjectStore(e.dataStoreName)}function o(){var n=t.transaction([e.dataStoreName],"readwrite");function r(t){n.objectStore(e.dataStoreName).get(t).onsuccess=function(n){e.callback&&e.callback(n.target.result,t)}}e.videoBlob&&n.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&n.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&n.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),r("audioBlob"),r("videoBlob"),r("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};
/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */
function L(e,t){if("undefined"===typeof GIFEncoder){var n=document.createElement("script");n.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(n)}t=t||{};var r=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(n){if(!0!==m.clearedRecordedData){if(i)return setTimeout((function(){e(n)}),100);f=d(e),void 0===typeof l&&(l=n),n-l<90||(!r&&c.paused&&c.play(),r||s.drawImage(c,0,0,o.width,o.height),t.onGifPreview&&t.onGifPreview(o.toDataURL("image/png")),p.addFrame(s),l=n)}}"undefined"!==typeof GIFEncoder&&u?(r||(t.width||(t.width=c.offsetWidth||320),t.height||(t.height=c.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),o.width=t.canvas.width||320,o.height=t.canvas.height||240,c.width=t.video.width||320,c.height=t.video.height||240),p=new GIFEncoder,p.setRepeat(0),p.setDelay(t.frameRate||200),p.setQuality(t.quality||10),p.start(),"function"===typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),Date.now(),f=d(e),t.initCallback&&t.initCallback()):setTimeout(m.record,1e3)},this.stop=function(e){e=e||function(){},f&&h(f),Date.now(),this.blob=new Blob([new Uint8Array(p.stream().bin)],{type:"image/gif"}),e(this.blob),p.stream().bin=[]};var i=!1;function a(){p&&(p.stream().bin=[])}this.pause=function(){i=!0},this.resume=function(){i=!1},this.clearRecordedData=function(){m.clearedRecordedData=!0,a()},this.name="GifRecorder",this.toString=function(){return this.name};var o=document.createElement("canvas"),s=o.getContext("2d");r&&(e instanceof CanvasRenderingContext2D?(s=e,o=s.canvas):e instanceof HTMLCanvasElement&&(s=e.getContext("2d"),o=e));var u=!0;if(!r){var c=document.createElement("video");c.muted=!0,c.autoplay=!0,c.playsInline=!0,u=!1,c.onloadedmetadata=function(){u=!0},E(e,c),c.play()}var l,p,f=null,m=this}function j(e,t){var r="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){"undefined"===typeof o&&e&&"undefined"===typeof window&&"undefined"!==typeof n&&(n.navigator={userAgent:r,getUserMedia:function(){}},n.console||(n.console={}),"undefined"!==typeof n.console.log&&"undefined"!==typeof n.console.error||(n.console.error=n.console.log=n.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof d&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=n)})("undefined"!==typeof n?n:null),t=t||"multi-streams-mixer";var i=[],a=!1,s=document.createElement("canvas"),u=s.getContext("2d");s.style.opacity=0,s.style.position="absolute",s.style.zIndex=-1,s.style.top="-1000em",s.style.left="-1000em",s.className=t,(document.body||document.documentElement).appendChild(s),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var c=this,l=window.AudioContext;"undefined"===typeof l&&("undefined"!==typeof webkitAudioContext&&(l=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(l=mozAudioContext));var d=window.URL;"undefined"===typeof d&&"undefined"!==typeof webkitURL&&(d=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var p=window.MediaStream;"undefined"===typeof p&&"undefined"!==typeof webkitMediaStream&&(p=webkitMediaStream),"undefined"!==typeof p&&"undefined"===typeof p.prototype.stop&&(p.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var h={};function f(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function m(){if(!a){var e=i.length,t=!1,n=[];if(i.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:n.push(e)})),t)s.width=t.stream.width,s.height=t.stream.height;else if(n.length){s.width=e>1?2*n[0].width:n[0].width;var r=1;3!==e&&4!==e||(r=2),5!==e&&6!==e||(r=3),7!==e&&8!==e||(r=4),9!==e&&10!==e||(r=5),s.height=n[0].height*r}else s.width=c.width||360,s.height=c.height||240;t&&t instanceof HTMLVideoElement&&v(t),n.forEach((function(e,t){v(e,t)})),setTimeout(m,c.frameInterval)}}function v(e,t){if(!a){var n=0,r=0,i=e.width,o=e.height;1===t&&(n=e.width),2===t&&(r=e.height),3===t&&(n=e.width,r=e.height),4===t&&(r=2*e.height),5===t&&(n=e.width,r=2*e.height),6===t&&(r=3*e.height),7===t&&(n=e.width,r=3*e.height),"undefined"!==typeof e.stream.left&&(n=e.stream.left),"undefined"!==typeof e.stream.top&&(r=e.stream.top),"undefined"!==typeof e.stream.width&&(i=e.stream.width),"undefined"!==typeof e.stream.height&&(o=e.stream.height),u.drawImage(e,n,r,i,o),"function"===typeof e.stream.onRender&&e.stream.onRender(u,n,r,i,o,t)}}function g(){a=!1;var t=y(),n=b();return n&&n.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){e.fullcanvas&&!0})),t}function y(){var e;w(),"captureStream"in s?e=s.captureStream():"mozCaptureStream"in s?e=s.mozCaptureStream():c.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new p;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),s.stream=t,t}function b(){h.AudioContextConstructor||(h.AudioContextConstructor=new h.AudioContext),c.audioContext=h.AudioContextConstructor,c.audioSources=[],!0===c.useGainNode&&(c.gainNode=c.audioContext.createGain(),c.gainNode.connect(c.audioContext.destination),c.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var n=c.audioContext.createMediaStreamSource(e);!0===c.useGainNode&&n.connect(c.gainNode),c.audioSources.push(n)}})),t)return c.audioDestination=c.audioContext.createMediaStreamDestination(),c.audioSources.forEach((function(e){e.connect(c.audioDestination)})),c.audioDestination.stream}function _(e){var n=document.createElement("video");return f(e,n),n.className=t,n.muted=!0,n.volume=0,n.width=e.width||c.width||360,n.height=e.height||c.height||240,n.play(),n}function w(t){i=[],t=t||e,t.forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=_(e);t.stream=e,i.push(t)}}))}"undefined"!==typeof l?h.AudioContext=l:"undefined"!==typeof webkitAudioContext&&(h.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){m()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var n=new p;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var r=_(t);r.stream=t,i.push(r),n.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var a=c.audioContext.createMediaStreamSource(t);c.audioDestination=c.audioContext.createMediaStreamDestination(),a.connect(c.audioDestination),n.addTrack(c.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(n)}))},this.releaseStreams=function(){i=[],a=!0,c.gainNode&&(c.gainNode.disconnect(),c.gainNode=null),c.audioSources.length&&(c.audioSources.forEach((function(e){e.disconnect()})),c.audioSources=[]),c.audioDestination&&(c.audioDestination.disconnect(),c.audioDestination=null),c.audioContext&&c.audioContext.close(),c.audioContext=null,u.clearRect(0,0,s.width,s.height),s.stream&&(s.stream.stop(),s.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),w(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=g}
/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */
function B(e,t){e=e||[];var n,r,i=this;function a(){var t=[];return e.forEach((function(e){S(e,"video").forEach((function(e){t.push(e)}))})),t}t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){n=new j(e,t.elementClass||"multi-streams-mixer"),a().length&&(n.frameInterval=t.frameInterval||10,n.width=t.video.width||360,n.height=t.video.height||240,n.startDrawingFrames()),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(n.getMixedStream()),r=new A(n.getMixedStream(),t),r.record()},this.stop=function(e){r&&r.stop((function(t){i.blob=t,e(t),i.clearRecordedData()}))},this.pause=function(){r&&r.pause()},this.resume=function(){r&&r.resume()},this.clearRecordedData=function(){r&&(r.clearRecordedData(),r=null),n&&(n.releaseStreams(),n=null)},this.addStreams=function(i){if(!i)throw"First parameter is required.";i instanceof Array||(i=[i]),e.concat(i),r&&n&&(n.appendStreams(i),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(n.getMixedStream()))},this.resetVideoStreams=function(e){n&&(!e||e instanceof Array||(e=[e]),n.resetVideoStreams(e))},this.getMixer=function(){return n},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}
/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */
function U(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if("undefined"===typeof e)throw'First argument "MediaStream" is required.';var n=this;n.recordRTC=new o(e,t),this.startRecording=function(){return new Promise((function(e,t){try{n.recordRTC.startRecording(),e()}catch(r){t(r)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{n.recordRTC.stopRecording((function(r){n.blob=n.recordRTC.getBlob(),n.blob&&n.blob.size?e(r):t("Empty blob.",n.blob)}))}catch(r){t(r)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{n.recordRTC.pauseRecording(),e()}catch(r){t(r)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{n.recordRTC.resumeRecording(),e()}catch(r){t(r)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{n.recordRTC.getDataURL((function(t){e(t)}))}catch(r){t(r)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(n.recordRTC.getBlob())}catch(r){t(r)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(n.recordRTC.getInternalRecorder())}catch(r){t(r)}}))},this.reset=function(){return new Promise((function(e,t){try{e(n.recordRTC.reset())}catch(r){t(r)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(n.recordRTC.destroy())}catch(r){t(r)}}))},this.getState=function(){return new Promise((function(e,t){try{e(n.recordRTC.getState())}catch(r){t(r)}}))},this.blob=null,this.version="5.6.1"}
/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */
function F(e,t){var n,r,i;function a(){return new ReadableStream({start:function(r){var i=document.createElement("canvas"),a=document.createElement("video"),o=!0;a.srcObject=e,a.muted=!0,a.height=t.height,a.width=t.width,a.volume=0,a.onplaying=function(){i.width=t.width,i.height=t.height;var e=i.getContext("2d"),s=1e3/t.frameRate,u=setInterval((function(){if(n&&(clearInterval(u),r.close()),o&&(o=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),e.drawImage(a,0,0),"closed"!==r._controlledReadableStream.state)try{r.enqueue(e.getImageData(0,0,t.width,t.height))}catch(i){}}),s)},a.play()}})}function o(e,s){if(!t.workerPath&&!s)return n=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){o(e,t)}))}));if(!t.workerPath&&s instanceof ArrayBuffer){var c=new Blob([s],{type:"text/javascript"});t.workerPath=m.createObjectURL(c)}t.workerPath||console.error("workerPath parameter is missing."),r=new Worker(t.workerPath),r.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),r.addEventListener("message",(function(e){"READY"===e.data?(r.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),a().pipeTo(new WritableStream({write:function(e){n?console.error("Got image, but recorder is finished!"):r.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(i||u.push(e.data))}))}function s(e){r?(r.addEventListener("message",(function(t){null===t.data&&(r.terminate(),r=null,e&&e())})),r.postMessage(null)):e&&e()}"undefined"!==typeof ReadableStream&&"undefined"!==typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0,this.record=function(){u=[],i=!1,this.blob=null,o(e),"function"===typeof t.initCallback&&t.initCallback()},this.pause=function(){i=!0},this.resume=function(){i=!1};var u=[];this.stop=function(e){n=!0;var t=this;s((function(){t.blob=new Blob(u,{type:"video/webm"}),e(t.blob)}))},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){u=[],i=!1,this.blob=null},this.blob=null}"undefined"!==typeof o&&(o.DiskStorage=M),"undefined"!==typeof o&&(o.GifRecorder=L),"undefined"===typeof o&&(e.exports=j,i=[],a=function(){return j}.apply(t,i),void 0===a||(e.exports=a)),"undefined"!==typeof o&&(o.MultiStreamRecorder=B),"undefined"!==typeof o&&(o.RecordRTCPromisesHandler=U),"undefined"!==typeof o&&(o.WebAssemblyRecorder=F)}).call(this,n("c8ba"),n("4362"))},ad6d:function(e,t,n){"use strict";var r=n("825a");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},ae75:function(e,t,n){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},ae93:function(e,t,n){"use strict";var r,i,a,o=n("e163"),s=n("9112"),u=n("5135"),c=n("b622"),l=n("c430"),d=c("iterator"),p=!1,h=function(){return this};[].keys&&(a=[].keys(),"next"in a?(i=o(o(a)),i!==Object.prototype&&(r=i)):p=!0),void 0==r&&(r={}),l||u(r,d)||s(r,d,h),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},aeab:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},b03c:function(e,t){var n="auto",r={"":1,lr:1,rl:1},i={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function a(e){if("string"!==typeof e)return!1;var t=r[e.toLowerCase()];return!!t&&e.toLowerCase()}function o(e){if("string"!==typeof e)return!1;var t=i[e.toLowerCase()];return!!t&&e.toLowerCase()}function s(e,t,r){this.hasBeenReset=!1;var i="",s=!1,u=e,c=t,l=r,d=null,p="",h=!0,f="auto",m="start",v="auto",g="auto",y=100,b="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return i},set:function(e){i=""+e}},pauseOnExit:{enumerable:!0,get:function(){return s},set:function(e){s=!!e}},startTime:{enumerable:!0,get:function(){return u},set:function(e){if("number"!==typeof e)throw new TypeError("Start time must be set to a number.");u=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return c},set:function(e){if("number"!==typeof e)throw new TypeError("End time must be set to a number.");c=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return l},set:function(e){l=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return d},set:function(e){d=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return p},set:function(e){var t=a(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");p=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(e){if("number"!==typeof e&&e!==n)throw new SyntaxError("Line: an invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return m},set:function(e){var t=o(e);t?(m=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return v},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");v=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=o(e);t?(g=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return b},set:function(e){var t=o(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");b=t,this.hasBeenReset=!0}}}),this.displayState=void 0}s.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=s},b041:function(e,t,n){"use strict";var r=n("00ee"),i=n("f5df");e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},b17c:function(e,t,n){n("4ae1");var r=n("4a4b"),i=n("6f8f");function a(t,n,o){return i()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,n){var i=[null];i.push.apply(i,t);var a=Function.bind.apply(e,i),o=new a;return n&&r(o,n.prototype),o},a.apply(null,arguments)}e.exports=a},b575:function(e,t,n){var r,i,a,o,s,u,c,l,d=n("da84"),p=n("06cf").f,h=n("c6b6"),f=n("2cf4").set,m=n("1cdc"),v=d.MutationObserver||d.WebKitMutationObserver,g=d.process,y=d.Promise,b="process"==h(g),_=p(d,"queueMicrotask"),w=_&&_.value;w||(r=function(){var e,t;b&&(e=g.domain)&&e.exit();while(i){t=i.fn,i=i.next;try{t()}catch(n){throw i?o():a=void 0,n}}a=void 0,e&&e.enter()},b?o=function(){g.nextTick(r)}:v&&!m?(s=!0,u=document.createTextNode(""),new v(r).observe(u,{characterData:!0}),o=function(){u.data=s=!s}):y&&y.resolve?(c=y.resolve(void 0),l=c.then,o=function(){l.call(c,r)}):o=function(){f.call(d,r)}),e.exports=w||function(e){var t={fn:e,next:void 0};a&&(a.next=t),i||(i=t,o()),a=t}},b622:function(e,t,n){var r=n("da84"),i=n("5692"),a=n("5135"),o=n("90e3"),s=n("4930"),u=n("fdbf"),c=i("wks"),l=r.Symbol,d=u?l:l&&l.withoutSetter||o;e.exports=function(e){return a(c,e)||(s&&a(l,e)?c[e]=l[e]:c[e]=d("Symbol."+e)),c[e]}},b639:function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n("1fb5"),i=n("9152"),a=n("e3db");function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=c.prototype):(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?v(e,t,n,r):"string"===typeof t?f(e,t,n):g(e,t)}function d(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function p(e,t,n,r){return d(t),t<=0?u(e,t):void 0!==n?"string"===typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}function h(e,t){if(d(t),e=u(e,t<0?0:0|y(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t,n){if("string"===typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|_(t,n);e=u(e,r);var i=e.write(t,n);return i!==r&&(e=e.slice(0,i)),e}function m(e,t){var n=t.length<0?0:0|y(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function v(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),c.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=c.prototype):e=m(e,t),e}function g(e,t){if(c.isBuffer(t)){var n=0|y(t.length);return e=u(e,n),0===e.length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||te(t.length)?u(e,0):m(e,t);if("Buffer"===t.type&&a(t.data))return m(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function b(e){return+e!=e&&(e=0),c.alloc(+e)}function _(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(e).length;default:if(r)return X(e).length;t=(""+t).toLowerCase(),r=!0}}function w(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return N(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return L(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function x(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function T(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:C(e,t,n,r,i);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):C(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function C(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(e,a)===c(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var d=!0,p=0;p<u;p++)if(c(e,a+p)!==c(t,p)){d=!1;break}if(d)return a}return-1}function S(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function E(e,t,n,r){return ee(X(t,e.length-n),e,n,r)}function k(e,t,n,r){return ee(J(t),e,n,r)}function R(e,t,n,r){return k(e,t,n,r)}function O(e,t,n,r){return ee(Z(t),e,n,r)}function A(e,t,n,r){return ee(Q(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function N(e,t,n){n=Math.min(e.length,n);var r=[],i=t;while(i<n){var a,o,s,u,c=e[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:a=e[i+1],128===(192&a)&&(u=(31&c)<<6|63&a,u>127&&(l=u));break;case 3:a=e[i+1],o=e[i+2],128===(192&a)&&128===(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o,u>2047&&(u<55296||u>57343)&&(l=u));break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128===(192&a)&&128===(192&o)&&128===(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s,u>65535&&u<1114112&&(l=u))}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return P(r)}t.Buffer=c,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:o(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return p(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},c.byteLength=_,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)x(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)x(this,t,t+3),x(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)x(this,t,t+7),x(this,t+1,t+6),x(this,t+2,t+5),x(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?N(this,0,e):w.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var a=i-r,o=n-t,s=Math.min(a,o),u=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(u[d]!==l[d]){a=u[d],o=l[d];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return T(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return T(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return k(this,e,t,n);case"latin1":case"binary":return R(this,e,t,n);case"base64":return O(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function P(e){var t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);var n="",r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function j(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=Y(e[a]);return i}function B(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function U(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(e,t,n,r,i,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function V(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function q(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function W(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,r,a){return a||W(e,t,n,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,n,r,23,4),n+4}function G(e,t,n,r,a){return a||W(e,t,n,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||U(e,t,this.length);var r=this[e],i=1,a=0;while(++a<t&&(i*=256))r+=this[e+a]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||U(e,t,this.length);var r=this[e+--t],i=1;while(t>0&&(i*=256))r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||U(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||U(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||U(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||U(e,t,this.length);var r=this[e],i=1,a=0;while(++a<t&&(i*=256))r+=this[e+a]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||U(e,t,this.length);var r=t,i=1,a=this[e+--r];while(r>0&&(i*=256))a+=this[e+--r]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||U(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||U(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||U(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;F(this,e,t,n,i,0)}var a=1,o=0;this[t]=255&e;while(++o<n&&(a*=256))this[t+o]=e/a&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;F(this,e,t,n,i,0)}var a=n-1,o=1;this[t+a]=255&e;while(--a>=0&&(o*=256))this[t+a]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):V(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):V(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):q(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):q(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;this[t]=255&e;while(++a<n&&(o*=256))e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);F(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;this[t+a]=255&e;while(--a>=0&&(o*=256))e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):V(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):V(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):q(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||F(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):q(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return G(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return G(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=c.isBuffer(e)?e:X(new c(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function $(e){if(e=K(e).replace(H,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function K(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Y(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function J(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Q(e,t){for(var n,r,i,a=[],o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r)}return a}function Z(e){return r.toByteArray($(e))}function ee(e,t,n,r){for(var i=0;i<r;++i){if(i+n>=t.length||i>=e.length)break;t[i+n]=e[i]}return i}function te(e){return e!==e}}).call(this,n("c8ba"))},b727:function(e,t,n){var r=n("0366"),i=n("44ad"),a=n("7b0b"),o=n("50c4"),s=n("65f0"),u=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,l=4==e,d=6==e,p=5==e||d;return function(h,f,m,v){for(var g,y,b=a(h),_=i(b),w=r(f,m,3),x=o(_.length),T=0,C=v||s,S=t?C(h,x):n?C(h,0):void 0;x>T;T++)if((p||T in _)&&(g=_[T],y=w(g,T,b),e))if(t)S[T]=y;else if(y)switch(e){case 3:return!0;case 5:return g;case 6:return T;case 2:u.call(S,g)}else if(l)return!1;return d?-1:c||l?l:S}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},be09:function(e,t,n){(function(t){var n;n="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{},e.exports=n}).call(this,n("c8ba"))},c04e:function(e,t,n){var r=n("861d");e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},c430:function(e,t){e.exports=!1},c6b6:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},c6cd:function(e,t,n){var r=n("da84"),i=n("ce4e"),a="__core-js_shared__",o=r[a]||i(a,{});e.exports=o},c8ad:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},ca84:function(e,t,n){var r=n("5135"),i=n("fc6a"),a=n("4d64").indexOf,o=n("d012");e.exports=function(e,t){var n,s=i(e),u=0,c=[];for(n in s)!r(o,n)&&r(s,n)&&c.push(n);while(t.length>u)r(s,n=t[u++])&&(~a(c,n)||c.push(n));return c}},cc12:function(e,t,n){var r=n("da84"),i=n("861d"),a=r.document,o=i(a)&&i(a.createElement);e.exports=function(e){return o?a.createElement(e):{}}},cc57:function(e,t,n){(function(t){var r,i="undefined"!==typeof t?t:"undefined"!==typeof window?window:{},a=n(1);"undefined"!==typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"],r||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=a)),e.exports=r}).call(this,n("c8ba"))},cca6:function(e,t,n){var r=n("23e7"),i=n("60da");r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},cdf9:function(e,t,n){var r=n("825a"),i=n("861d"),a=n("f069");e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=a.f(e),o=n.resolve;return o(t),n.promise}},ce4e:function(e,t,n){var r=n("da84"),i=n("9112");e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},d012:function(e,t){e.exports={}},d02c:function(e,t,n){var r=n("ef34"),i=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function a(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function o(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function s(){this.values=i(null)}function u(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"===typeof i[a]){var o=i[a].split(n);if(2===o.length){var s=o[0],u=o[1];t(s,u)}}}function c(e,t,n){var r=e;function i(){var t=o(e);if(null===t)throw new a(a.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function c(e,t){var r=new s;u(e,(function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];r.integer(e,o),r.percent(e,o)&&r.set("snapToLines",!1),r.alt(e,o,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"]);break}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(i){}t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(i){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(i){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}function l(){e=e.replace(/^\s+/,"")}if(l(),t.startTime=i(),l(),"--\x3e"!==e.substr(0,3))throw new a(a.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),l(),t.endTime=i(),l(),c(e,t)}a.prototype=i(Error.prototype),a.prototype.constructor=a,a.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t),t>=0&&t<=100))&&(this.set(e,t),!0)}};var l=r.createElement("textarea"),d={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},p={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},h={v:"title",lang:"lang"},f={rt:"ruby"};function m(e,t){function n(){if(!t)return null;function e(e){return t=t.substr(e.length),e}var n=t.match(/^([^<]*)(<[^>]*>?)?/);return e(n[1]?n[1]:n[2])}function r(e){return l.innerHTML=e,e=l.textContent,l.textContent="",e}function i(e,t){return!f[t.localName]||f[t.localName]===e.localName}function a(t,n){var r=d[t];if(!r)return null;var i=e.document.createElement(r),a=h[t];return a&&n&&(i[a]=n.trim()),i}var s,u=e.document.createElement("div"),c=u,m=[];while(null!==(s=n()))if("<"!==s[0])c.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){m.length&&m[m.length-1]===s.substr(2).replace(">","")&&(m.pop(),c=c.parentNode);continue}var v,g=o(s.substr(1,s.length-2));if(g){v=e.document.createProcessingInstruction("timestamp",g),c.appendChild(v);continue}var y=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(v=a(y[1],y[3]),!v)continue;if(!i(c,v))continue;if(y[2]){var b=y[2].split(".");b.forEach((function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(p.hasOwnProperty(n)){var r=t?"background-color":"color",i=p[n];v.style[r]=i}})),v.className=b.join(" ")}m.push(y[1]),c.appendChild(v),c=v}return u}var v=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function g(e){for(var t=0;t<v.length;t++){var n=v[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function y(e){var t,n=[],r="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function a(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var r=n.match(/^.*(\n|\r)/);return r?(e.length=0,r[0]):n}return"ruby"===t.tagName?a(e):t.childNodes?(i(e,t),a(e)):void 0}i(n,e);while(r=a(n))for(var o=0;o<r.length;o++)if(t=r.charCodeAt(o),g(t))return"rtl";return"ltr"}function b(e){if("number"===typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}function _(){}function w(e,t,n){_.call(this),this.cue=t,this.cueDiv=m(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:y(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":i=t.position;break;case"center":i=t.position-t.size/2;break;case"end":i=t.position-t.size;break}""===t.vertical?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function x(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function T(e,t,n,r){function i(e,t){for(var i,a=new x(e),o=1,s=0;s<t.length;s++){while(e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(r))e.move(t[s]);if(e.within(n))return e;var u=e.intersectPercentage(n);o>u&&(i=new x(e),o=u),e=new x(a)}return i||a}var a=new x(t),o=t.cue,s=b(o),u=[];if(o.snapToLines){var c;switch(o.vertical){case"":u=["+y","-y"],c="height";break;case"rl":u=["+x","-x"],c="width";break;case"lr":u=["-x","+x"],c="width";break}var l=a.lineHeight,d=l*Math.round(s),p=n[c]+l,h=u[0];Math.abs(d)>p&&(d=d<0?-1:1,d*=Math.ceil(p/l)*l),s<0&&(d+=""===o.vertical?n.height:n.width,u=u.reverse()),a.move(h,d)}else{var f=a.lineHeight/n.height*100;switch(o.lineAlign){case"center":s-=f/2;break;case"end":s-=f;break}switch(o.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")});break}u=["+y","-x","+x","-y"],a=new x(t)}var m=i(a,u);t.move(m.toCSSCompatValues(n))}function C(){}_.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},_.prototype.formatStyle=function(e,t){return 0===e?0:e+t},w.prototype=i(_.prototype),w.prototype.constructor=w,x.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t;break}},x.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},x.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},x.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},x.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},x.prototype.intersectPercentage=function(e){var t=Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left)),n=Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top)),r=t*n;return r/(this.height*this.width)},x.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},x.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e;var i={left:e.left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n};return i},C.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!==typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},C.convertCueToDOMTree=function(e,t){return e&&t?m(e,t):null};var S=.05,E="sans-serif",k="1.5%";C.processCues=function(e,t,n){if(!e||!t||!n)return null;while(n.firstChild)n.removeChild(n.firstChild);var r=e.document.createElement("div");function i(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin=k,n.appendChild(r),i(t)){var a=[],o=x.getSimpleBoxPosition(r),s=Math.round(o.height*S*100)/100,u={font:s+"px "+E};(function(){for(var n,i,s=0;s<t.length;s++)i=t[s],n=new w(e,i,u),r.appendChild(n.div),T(e,n,o,a),i.displayState=n.div,a.push(x.getSimpleBoxPosition(n))})()}else for(var c=0;c<t.length;c++)r.appendChild(t[c].displayState)},C.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},C.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof a))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){var e=t.buffer,n=0;while(n<e.length&&"\r"!==e[n]&&"\n"!==e[n])++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}function r(e){var n=new s;if(u(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var i=new s;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y"));break;case"scroll":n.alt(e,t,["up"]);break}}),/=/,/\s/),n.has("id")){var r=new(t.vttjs.VTTRegion||t.window.VTTRegion);r.width=n.get("width",100),r.lines=n.get("lines",3),r.regionAnchorX=n.get("regionanchorX",0),r.regionAnchorY=n.get("regionanchorY",100),r.viewportAnchorX=n.get("viewportanchorX",0),r.viewportAnchorY=n.get("viewportanchorY",100),r.scroll=n.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:n.get("id"),region:r})}}function i(e){var n=new s;u(e,(function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",o(t));break}}),/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}function l(e){e.match(/X-TIMESTAMP-MAP/)?u(e,(function(e,t){switch(e){case"X-TIMESTAMP-MAP":i(t);break}}),/=/):u(e,(function(e,t){switch(e){case"Region":r(t);break}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var d;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;d=n();var p=d.match(/^WEBVTT([ \t].*)?$/);if(!p||!p[0])throw new a(a.Errors.BadSignature);t.state="HEADER"}var h=!1;while(t.buffer){if(!/\r\n|\n/.test(t.buffer))return this;switch(h?h=!1:d=n(),t.state){case"HEADER":/:/.test(d)?l(d):d||(t.state="ID");continue;case"NOTE":d||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(d)){t.state="NOTE";break}if(!d)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(m){t.cue.align="middle"}if(t.state="CUE",-1===d.indexOf("--\x3e")){t.cue.id=d;continue}case"CUE":try{c(d,t.cue,t.regionList)}catch(m){t.reportOrThrowError(m),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var f=-1!==d.indexOf("--\x3e");if(!d||f&&(h=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=d.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":d||(t.state="ID");continue}}}catch(m){t.reportOrThrowError(m),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new a(a.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}},e.exports=C},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d066:function(e,t,n){var r=n("428f"),i=n("da84"),a=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?a(r[e])||a(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},d093:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"shimGetUserMedia",(function(){return x})),n.d(r,"shimGetDisplayMedia",(function(){return T})),n.d(r,"shimMediaStream",(function(){return C})),n.d(r,"shimOnTrack",(function(){return S})),n.d(r,"shimGetSendersWithDtmf",(function(){return E})),n.d(r,"shimGetStats",(function(){return k})),n.d(r,"shimSenderReceiverGetStats",(function(){return R})),n.d(r,"shimAddTrackRemoveTrackWithNative",(function(){return O})),n.d(r,"shimAddTrackRemoveTrack",(function(){return A})),n.d(r,"shimPeerConnection",(function(){return I})),n.d(r,"fixNegotiationNeeded",(function(){return N}));var i={};n.r(i),n.d(i,"shimGetUserMedia",(function(){return L})),n.d(i,"shimGetDisplayMedia",(function(){return j})),n.d(i,"shimPeerConnection",(function(){return B})),n.d(i,"shimReplaceTrack",(function(){return U}));var a={};n.r(a),n.d(a,"shimGetUserMedia",(function(){return F})),n.d(a,"shimGetDisplayMedia",(function(){return V})),n.d(a,"shimOnTrack",(function(){return q})),n.d(a,"shimPeerConnection",(function(){return W})),n.d(a,"shimSenderGetStats",(function(){return z})),n.d(a,"shimReceiverGetStats",(function(){return G})),n.d(a,"shimRemoveStream",(function(){return H})),n.d(a,"shimRTCDataChannel",(function(){return $})),n.d(a,"shimAddTransceiver",(function(){return K})),n.d(a,"shimGetParameters",(function(){return Y})),n.d(a,"shimCreateOffer",(function(){return X})),n.d(a,"shimCreateAnswer",(function(){return J}));var o={};n.r(o),n.d(o,"shimLocalStreamsAPI",(function(){return Q})),n.d(o,"shimRemoteStreamsAPI",(function(){return Z})),n.d(o,"shimCallbacksAPI",(function(){return ee})),n.d(o,"shimGetUserMedia",(function(){return te})),n.d(o,"shimConstraints",(function(){return ne})),n.d(o,"shimRTCIceServerUrls",(function(){return re})),n.d(o,"shimTrackEventTransceiver",(function(){return ie})),n.d(o,"shimCreateOfferLegacy",(function(){return ae})),n.d(o,"shimAudioContext",(function(){return oe}));var s={};n.r(s),n.d(s,"shimRTCIceCandidate",(function(){return ce})),n.d(s,"shimMaxMessageSize",(function(){return le})),n.d(s,"shimSendThrowTypeError",(function(){return de})),n.d(s,"shimConnectionState",(function(){return pe})),n.d(s,"removeAllowExtmapMixed",(function(){return he}));let u=!0,c=!0;function l(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function d(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const a=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,a),i.apply(this,[e,a])};const a=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function p(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(u=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function h(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function f(){if("object"===typeof window){if(u)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function m(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")}function v(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=l(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=l(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=l(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=l(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function g(e){return"[object Object]"===Object.prototype.toString.call(e)}function y(e){return g(e)?Object.keys(e).reduce((function(t,n){const r=g(e[n]),i=r?y(e[n]):e[n],a=r&&!Object.keys(i).length;return void 0===i||a?t:Object.assign(t,{[n]:i})}),{}):e}function b(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?b(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(t=>{b(e,e.get(t),n)})}))}function _(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const a=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&b(e,n,i)})}),i}const w=f;function x(e){const t=e&&e.navigator;if(!t.mediaDevices)return;const n=v(e),r=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"===typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"===typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!==typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(n.version>=61)return i(e);if(e=JSON.parse(JSON.stringify(e)),e&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};e=JSON.parse(JSON.stringify(e)),t(e.audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===typeof e.video){let a=e.video.facingMode;a=a&&("object"===typeof a?a:{ideal:a});const o=n.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||o)){let n;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?n=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(n=["front"]),n)return t.mediaDevices.enumerateDevices().then(t=>{t=t.filter(e=>"videoinput"===e.kind);let o=t.find(e=>n.some(t=>e.label.toLowerCase().includes(t)));return!o&&t.length&&n.includes("back")&&(o=t[t.length-1]),o&&(e.video.deviceId=a.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=r(e.video),w("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return w("chrome: "+JSON.stringify(e)),i(e)},a=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(e,n,r){i(e,e=>{t.webkitGetUserMedia(e,n,e=>{r&&r(a(e))})})};if(t.getUserMedia=o.bind(t),t.mediaDevices.getUserMedia){const e=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(t){return i(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(a(e))))}}}function T(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function C(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function S(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else d(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function E(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function k(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const i=function(e){const t={},n=e.result();return n.forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},a=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const r=function(e){n(a(i(e)))};return t.apply(this,[r,e])}return new Promise((e,n)=>{t.apply(this,[function(t){e(a(i(t)))},n])}).then(n,r)}}function R(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>_(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),d(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>_(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function O(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{const t=this.getSenders().find(t=>t.track===e);if(t)throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function A(e){if(!e.RTCPeerConnection)return;const t=v(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return O(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{const t=this.getSenders().find(t=>t.track===e);if(t)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function a(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(e=>e.track===t);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const a=this._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments,t=arguments.length&&"function"===typeof arguments[0];return t?n.apply(this,[t=>{const n=a(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>a(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=o(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=u.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");const t=e._pc===this;if(!t)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let n;this._streams=this._streams||{},Object.keys(this._streams).forEach(t=>{const r=this._streams[t].getTracks().find(t=>e.track===t);r&&(n=this._streams[t])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function I(e){const t=v(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!e.RTCPeerConnection)return;const n=0===e.RTCPeerConnection.prototype.addIceCandidate.length;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return n||arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function N(e){const t=v(e);d(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}function D(e,t){let n=!1;return e=JSON.parse(JSON.stringify(e)),e.filter(e=>{if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&m("RTCIceServer.url","RTCIceServer.urls");const r="string"===typeof t;return r&&(t=[t]),t=t.filter(e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}var P=n("f03d"),M=n.n(P);function L(e){const t=e&&e.navigator,n=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}},r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(e=>Promise.reject(n(e)))}}function j(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function B(e){const t=v(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=M()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=D(e.iceServers,t.version),f("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function U(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function F(e){const t=v(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){m("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function V(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function q(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function W(e){const t=v(e);if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){const t=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,a]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!i)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(r){if("TypeError"!==r.name)throw r;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(i,a)}}function z(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function G(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),d(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function H(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){m("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function $(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function K(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(e=>{if("rid"in e){const t=/^[a-z0-9]{0,16}$/i;if(!t.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();"encodings"in n||(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function Y(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"sendEncodings"in this?Object.assign({},{encodings:this.sendEncodings},e):e})}function X(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function J(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Q(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function Z(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function ee(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}function te(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(ne(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function ne(e){return e&&void 0!==e.video?Object.assign({},e,{video:y(e.video)}):e}function re(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(m("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return t.generateCertificate}})}function ie(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ae(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function oe(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var se=n("282b"),ue=n.n(se);function ce(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&(e=JSON.parse(JSON.stringify(e)),e.candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=ue.a.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,d(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function le(e){if(!e.RTCPeerConnection)return;const t=v(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=ue.a.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=ue.a.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},a=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=ue.a.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=a(arguments[0],e);let o;o=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const s={};Object.defineProperty(s,"maxMessageSize",{get(){return o}}),this._sctp=s}return o.apply(this,arguments)}}function de(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},d(e,"datachannel",e=>(t(e.channel,e.target),e))}function pe(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function he(e){if(!e.RTCPeerConnection)return;const t=v(e);if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n")),n.apply(this,arguments)}}function fe({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=f,u=v(e),c={browserDetails:u,commonShim:s,extractVersion:l,disableLog:p,disableWarnings:h};switch(u.browser){case"chrome":if(!r||!I||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),c;if(null===u.version)return n("Chrome shim can not determine version, not shimming."),c;n("adapter.js shimming chrome."),c.browserShim=r,x(e),C(e),I(e),S(e),A(e),E(e),k(e),R(e),N(e),ce(e),pe(e),le(e),de(e),he(e);break;case"firefox":if(!a||!W||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),c;n("adapter.js shimming firefox."),c.browserShim=a,F(e),W(e),q(e),H(e),z(e),G(e),$(e),K(e),Y(e),X(e),J(e),ce(e),pe(e),le(e),de(e);break;case"edge":if(!i||!B||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),c;n("adapter.js shimming edge."),c.browserShim=i,L(e),j(e),B(e),U(e),le(e),de(e);break;case"safari":if(!o||!t.shimSafari)return n("Safari shim is not included in this adapter release."),c;n("adapter.js shimming safari."),c.browserShim=o,re(e),ae(e),ee(e),Q(e),Z(e),ie(e),te(e),oe(e),ce(e),le(e),de(e),he(e);break;default:n("Unsupported browser!");break}return c}fe({window:"undefined"===typeof window?void 0:window})},d136:function(e,t,n){(function(t){var n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,r=/^([^\/?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),t=t.trim(),!t){if(!n.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var u=r.exec(s.path);s.netLoc=u[1],s.path=u[2]}s.netLoc&&!s.path&&(s.path="/");var c={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(c.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var l=s.path,d=l.substring(0,l.lastIndexOf("/")+1)+a.path;c.path=o.normalizePath(d)}else c.path=s.path,a.params||(c.params=s.params,a.query||(c.query=s.query));return null===c.path&&(c.path=n.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(c)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){e=e.split("").reverse().join("").replace(i,"");while(e.length!==(e=e.replace(a,"")).length);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};e.exports=o})()},d1e7:function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!r.call({1:2},1);t.f=a?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},d28b:function(e,t,n){var r=n("746f");r("iterator")},d2bb:function(e,t,n){var r=n("825a"),i=n("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,e.call(n,[]),t=n instanceof Array}catch(a){}return function(n,a){return r(n),i(a),t?e.call(n,a):n.__proto__=a,n}}():void 0)},d303:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r={};function i(e){return r[e]}},d3b7:function(e,t,n){var r=n("00ee"),i=n("6eeb"),a=n("b041");r||i(Object.prototype,"toString",a,{unsafe:!0})},d44e:function(e,t,n){var r=n("9bf2").f,i=n("5135"),a=n("b622"),o=a("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},d52a:function(e,t,n){},d556:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]},d61d:function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$"),a=0,o=1,s=2,u=3,c=4,l=5,d=6,p=7;function h(){}function f(e,t,n,r,i){function a(e){if(e>65535){e-=65536;var t=55296+(e>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}function o(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?a(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function s(t){if(t>_){var n=e.substring(_,t).replace(/&#?\w+;/g,o);p&&u(_),r.characters(n,0,t-_),_=t}}function u(t,n){while(t>=l&&(n=d.exec(e)))c=n.index,l=c+n[0].length,p.lineNumber++;p.columnNumber=t-c+1}var c=0,l=0,d=/.*(?:\r\n?|\n)|.*$/g,p=r.locator,h=[{currentNSMap:t}],f={},_=0;while(1){try{var C=e.indexOf("<",_);if(C<0){if(!e.substr(_).match(/^\s*$/)){var S=r.doc,E=S.createTextNode(e.substr(_));S.appendChild(E),r.currentElement=E}return}switch(C>_&&s(C),e.charAt(C+1)){case"/":var k=e.indexOf(">",C+3),R=e.substring(C+2,k),O=h.pop();k<0?(R=e.substring(C+2).replace(/[\s<].*/,""),i.error("end tag name: "+R+" is not complete:"+O.tagName),k=C+1+R.length):R.match(/\s</)&&(R=R.replace(/[\s<].*/,""),i.error("end tag name: "+R+" maybe not complete"),k=C+1+R.length);var A=O.localNSMap,I=O.tagName==R,N=I||O.tagName&&O.tagName.toLowerCase()==R.toLowerCase();if(N){if(r.endElement(O.uri,O.localName,R),A)for(var D in A)r.endPrefixMapping(D);I||i.fatalError("end tag name: "+R+" is not match the current start tagName:"+O.tagName)}else h.push(O);k++;break;case"?":p&&u(C),k=x(e,C,r);break;case"!":p&&u(C),k=w(e,C,r,i);break;default:p&&u(C);var P=new T,M=h[h.length-1].currentNSMap,L=(k=v(e,C,P,M,o,i),P.length);if(!P.closed&&b(e,k,P.tagName,f)&&(P.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),p&&L){for(var j=m(p,{}),B=0;B<L;B++){var U=P[B];u(U.offset),U.locator=m(p,{})}r.locator=j,g(P,r,M)&&h.push(P),r.locator=p}else g(P,r,M)&&h.push(P);"http://www.w3.org/1999/xhtml"!==P.uri||P.closed?k++:k=y(e,k,P.tagName,o,r)}}catch(F){i.error("element parse error: "+F),k=-1}k>_?_=k:s(Math.max(C,_)+1)}}function m(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function v(e,t,n,r,i,h){var f,m=++t,v=a;while(1){var g=e.charAt(m);switch(g){case"=":if(v===o)f=e.slice(t,m),v=u;else{if(v!==s)throw new Error("attribute equal must after attrName");v=u}break;case"'":case'"':if(v===u||v===o){if(v===o&&(h.warning('attribute value must after "="'),f=e.slice(t,m)),t=m+1,m=e.indexOf(g,t),!(m>0))throw new Error("attribute value no end '"+g+"' match");y=e.slice(t,m).replace(/&#?\w+;/g,i),n.add(f,y,t-1),v=l}else{if(v!=c)throw new Error('attribute value must after "="');y=e.slice(t,m).replace(/&#?\w+;/g,i),n.add(f,y,t),h.warning('attribute "'+f+'" missed start quot('+g+")!!"),t=m+1,v=l}break;case"/":switch(v){case a:n.setTagName(e.slice(t,m));case l:case d:case p:v=p,n.closed=!0;case c:case o:case s:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return h.error("unexpected end of input"),v==a&&n.setTagName(e.slice(t,m)),m;case">":switch(v){case a:n.setTagName(e.slice(t,m));case l:case d:case p:break;case c:case o:y=e.slice(t,m),"/"===y.slice(-1)&&(n.closed=!0,y=y.slice(0,-1));case s:v===s&&(y=f),v==c?(h.warning('attribute "'+y+'" missed quot(")!!'),n.add(f,y.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&y.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+y+'" missed value!! "'+y+'" instead!!'),n.add(y,y,t));break;case u:throw new Error("attribute value missed!!")}return m;case"":g=" ";default:if(g<=" ")switch(v){case a:n.setTagName(e.slice(t,m)),v=d;break;case o:f=e.slice(t,m),v=s;break;case c:var y=e.slice(t,m).replace(/&#?\w+;/g,i);h.warning('attribute "'+y+'" missed quot(")!!'),n.add(f,y,t);case l:v=d;break}else switch(v){case s:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&f.match(/^(?:disabled|checked|selected)$/i)||h.warning('attribute "'+f+'" missed value!! "'+f+'" instead2!!'),n.add(f,f,t),t=m,v=o;break;case l:h.warning('attribute space is required"'+f+'"!!');case d:v=o,t=m;break;case u:v=c,t=m;break;case p:throw new Error("elements closed character '/' and '>' must be connected to")}}m++}}function g(e,t,n){var r=e.tagName,i=null,a=e.length;while(a--){var o=e[a],s=o.qName,u=o.value,c=s.indexOf(":");if(c>0)var l=o.prefix=s.slice(0,c),d=s.slice(c+1),p="xmlns"===l&&d;else d=s,l=null,p="xmlns"===s&&"";o.localName=d,!1!==p&&(null==i&&(i={},_(n,n={})),n[p]=i[p]=u,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(p,u))}a=e.length;while(a--){o=e[a];l=o.prefix;l&&("xml"===l&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(o.uri=n[l||""]))}c=r.indexOf(":");c>0?(l=e.prefix=r.slice(0,c),d=e.localName=r.slice(c+1)):(l=null,d=e.localName=r);var h=e.uri=n[l||""];if(t.startElement(h,d,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(h,d,r),i)for(l in i)t.endPrefixMapping(l)}function y(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function b(e,t,n,r){var i=r[n];return null==i&&(i=e.lastIndexOf("</"+n+">"),i<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function _(e,t){for(var n in e)t[n]=e[n]}function w(e,t,n,r){var i=e.charAt(t+2);switch(i){case"-":if("-"===e.charAt(t+3)){var a=e.indexOf("--\x3e",t+4);return a>t?(n.comment(e,t+4,a-t-4),a+3):(r.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==e.substr(t+3,6)){a=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,a-t-9),n.endCDATA(),a+3}var o=S(e,t),s=o.length;if(s>1&&/!doctype/i.test(o[0][0])){var u=o[1][0],c=s>3&&/^public$/i.test(o[2][0])&&o[3][0],l=s>4&&o[4][0],d=o[s-1];return n.startDTD(u,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),d.index+d[0].length}}return-1}function x(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function T(e){}function C(e,t){return e.__proto__=t,e}function S(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);while(n=i.exec(e))if(r.push(n),n[1])return r}h.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),_(t,t={}),f(e,t,n,r,this.errorHandler),r.endDocument()}},T.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},C({},C.prototype)instanceof C||(C=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=h},da84:function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n("c8ba"))},dbf3:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},dc3e:function(e,t,n){"use strict";var r=n("ae75"),i=n("256f").handleRollover,a={};a.ts=n("423e"),a.aac=n("fbd0");var o=n("36c64").ONE_SECOND_IN_TS,s=188,u=71,c=function(e,t){var n,r,i=0,o=s;while(o<e.byteLength)if(e[i]!==u||e[o]!==u)i++,o++;else{switch(n=e.subarray(i,o),r=a.ts.parseType(n,t.pid),r){case"pat":t.pid||(t.pid=a.ts.parsePat(n));break;case"pmt":t.table||(t.table=a.ts.parsePmt(n));break;default:break}if(t.pid&&t.table)return;i+=s,o+=s}},l=function(e,t,n){var r,i,o,c,l,d=0,p=s,h=!1;while(p<=e.byteLength)if(e[d]!==u||e[p]!==u&&p!==e.byteLength)d++,p++;else{switch(r=e.subarray(d,p),i=a.ts.parseType(r,t.pid),i){case"pes":o=a.ts.parsePesType(r,t.table),c=a.ts.parsePayloadUnitStartIndicator(r),"audio"===o&&c&&(l=a.ts.parsePesTime(r),l&&(l.type="audio",n.audio.push(l),h=!0));break;default:break}if(h)break;d+=s,p+=s}p=e.byteLength,d=p-s,h=!1;while(d>=0)if(e[d]!==u||e[p]!==u&&p!==e.byteLength)d--,p--;else{switch(r=e.subarray(d,p),i=a.ts.parseType(r,t.pid),i){case"pes":o=a.ts.parsePesType(r,t.table),c=a.ts.parsePayloadUnitStartIndicator(r),"audio"===o&&c&&(l=a.ts.parsePesTime(r),l&&(l.type="audio",n.audio.push(l),h=!0));break;default:break}if(h)break;d-=s,p-=s}},d=function(e,t,n){var r,i,o,c,l,d,p,h,f=0,m=s,v=!1,g={data:[],size:0};while(m<e.byteLength)if(e[f]!==u||e[m]!==u)f++,m++;else{switch(r=e.subarray(f,m),i=a.ts.parseType(r,t.pid),i){case"pes":if(o=a.ts.parsePesType(r,t.table),c=a.ts.parsePayloadUnitStartIndicator(r),"video"===o&&(c&&!v&&(l=a.ts.parsePesTime(r),l&&(l.type="video",n.video.push(l),v=!0)),!n.firstKeyFrame)){if(c&&0!==g.size){d=new Uint8Array(g.size),p=0;while(g.data.length)h=g.data.shift(),d.set(h,p),p+=h.byteLength;if(a.ts.videoPacketContainsKeyFrame(d)){var y=a.ts.parsePesTime(d);y?(n.firstKeyFrame=y,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}g.size=0}g.data.push(r),g.size+=r.byteLength}break;default:break}if(v&&n.firstKeyFrame)break;f+=s,m+=s}m=e.byteLength,f=m-s,v=!1;while(f>=0)if(e[f]!==u||e[m]!==u)f--,m--;else{switch(r=e.subarray(f,m),i=a.ts.parseType(r,t.pid),i){case"pes":o=a.ts.parsePesType(r,t.table),c=a.ts.parsePayloadUnitStartIndicator(r),"video"===o&&c&&(l=a.ts.parsePesTime(r),l&&(l.type="video",n.video.push(l),v=!0));break;default:break}if(v)break;f-=s,m-=s}},p=function(e,t){if(e.audio&&e.audio.length){var n=t;"undefined"===typeof n&&(n=e.audio[0].dts),e.audio.forEach((function(e){e.dts=i(e.dts,n),e.pts=i(e.pts,n),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o}))}if(e.video&&e.video.length){var r=t;if("undefined"===typeof r&&(r=e.video[0].dts),e.video.forEach((function(e){e.dts=i(e.dts,r),e.pts=i(e.pts,r),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o})),e.firstKeyFrame){var a=e.firstKeyFrame;a.dts=i(a.dts,r),a.pts=i(a.pts,r),a.dtsTime=a.dts/o,a.ptsTime=a.dts/o}}},h=function(e){var t,n=!1,r=0,i=null,s=null,u=0,c=0;while(e.length-c>=3){var l=a.aac.parseType(e,c);switch(l){case"timed-metadata":if(e.length-c<10){n=!0;break}if(u=a.aac.parseId3TagSize(e,c),u>e.length){n=!0;break}null===s&&(t=e.subarray(c,c+u),s=a.aac.parseAacTimestamp(t)),c+=u;break;case"audio":if(e.length-c<7){n=!0;break}if(u=a.aac.parseAdtsSize(e,c),u>e.length){n=!0;break}null===i&&(t=e.subarray(c,c+u),i=a.aac.parseSampleRate(t)),r++,c+=u;break;default:c++;break}if(n)return null}if(null===i||null===s)return null;var d=o/i,p={audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*r*d,pts:s+1024*r*d}]};return p},f=function(e){var t={pid:null,table:null},n={};for(var i in c(e,t),t.table)if(t.table.hasOwnProperty(i)){var a=t.table[i];switch(a){case r.H264_STREAM_TYPE:n.video=[],d(e,t,n),0===n.video.length&&delete n.video;break;case r.ADTS_STREAM_TYPE:n.audio=[],l(e,t,n),0===n.audio.length&&delete n.audio;break;default:break}}return n},m=function(e,t){var n,r=a.aac.isLikelyAacData(e);return n=r?h(e):f(e),n&&(n.audio||n.video)?(p(n,t),n):null};e.exports={inspect:m,parseAudioPes_:l}},dc6d:function(e,t,n){"use strict";var r=4,i=128,a=function(e){var t=0,n={payloadType:-1,payloadSize:0},a=0,o=0;while(t<e.byteLength){if(e[t]===i)break;while(255===e[t])a+=255,t++;a+=e[t++];while(255===e[t])o+=255,t++;if(o+=e[t++],!n.payload&&a===r){n.payloadType=a,n.payloadSize=o,n.payload=e.subarray(t,t+o);break}t+=o,a=0,o=0}return n},o=function(e){return 181!==e.payload[0]||49!==(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},s=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)i=3*n,a={type:3&t[i+2],pts:e},4&t[i+2]&&(a.ccData=t[i+3]<<8|t[i+4],o.push(a));return o},u=function(e){var t,n,r=e.byteLength,i=[],a=1;while(a<r-2)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n};e.exports={parseSei:a,parseUserData:o,parseCaptionPackets:s,discardEmulationPreventionBytes:u,USER_DATA_REGISTERED_ITU_T_T35:r}},ddb0:function(e,t,n){var r=n("da84"),i=n("fdbc"),a=n("e260"),o=n("9112"),s=n("b622"),u=s("iterator"),c=s("toStringTag"),l=a.values;for(var d in i){var p=r[d],h=p&&p.prototype;if(h){if(h[u]!==l)try{o(h,u,l)}catch(m){h[u]=l}if(h[c]||o(h,c,d),i[d])for(var f in a)if(h[f]!==a[f])try{o(h,f,a[f])}catch(m){h[f]=a[f]}}}},df33:function(e,t){function n(e){if(e&&"object"===typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"===typeof e)return o[e];var n=String(e),a=r[n.toLowerCase()];if(a)return a;a=i[n.toLowerCase()];return a||(1===n.length?n.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"===typeof e){var n=e.which||e.keyCode||e.charCode;if(null===n||void 0===n)return!1;if("string"===typeof t){var a=r[t.toLowerCase()];if(a)return a===n;a=i[t.toLowerCase()];if(a)return a===n}else if("number"===typeof t)return t===n;return!1}},t=e.exports=n;var r=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};
/*!
 * Programatically add the following
 */
for(a=97;a<123;a++)r[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)r[a-48]=a;for(a=1;a<13;a++)r["f"+a]=a+111;for(a=0;a<10;a++)r["numpad "+a]=a+96;var o=t.names=t.title={};for(a in r)o[r[a]]=a;for(var s in i)r[s]=i[s]},df75:function(e,t,n){var r=n("ca84"),i=n("7839");e.exports=Object.keys||function(e){return r(e,i)}},df7c:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!==typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,a=arguments.length-1;a>=-1&&!r;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return t=n(i(t.split("/"),(function(e){return!!e})),!r).join("/"),(r?"/":"")+t||"."},t.normalize=function(e){var r=t.isAbsolute(e),o="/"===a(e,-1);return e=n(i(e.split("/"),(function(e){return!!e})),!r).join("/"),e||r||(e="."),e&&o&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),a=r(n.split("/")),o=Math.min(i.length,a.length),s=o,u=0;u<o;u++)if(i[u]!==a[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return c=c.concat(a.slice(s)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),47===t){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,a=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===r&&(i=!1,r=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){n=o+1;break}}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===n+1?"":e.slice(t,r)};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},e01a:function(e,t,n){"use strict";var r=n("23e7"),i=n("83ab"),a=n("da84"),o=n("5135"),s=n("861d"),u=n("9bf2").f,c=n("e893"),l=a.Symbol;if(i&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new l(e):void 0===e?l():l(e);return""===e&&(d[t]=!0),t};c(p,l);var h=p.prototype=l.prototype;h.constructor=p;var f=h.toString,m="Symbol(test)"==String(l("test")),v=/^Symbol\((.*)\)[^)]+$/;u(h,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=f.call(e);if(o(d,e))return"";var n=m?t.slice(7,-1):t.replace(v,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:p})}},e163:function(e,t,n){var r=n("5135"),i=n("7b0b"),a=n("f772"),o=n("e177"),s=a("IE_PROTO"),u=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){return e=i(e),r(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},e177:function(e,t,n){var r=n("d039");e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},e260:function(e,t,n){"use strict";var r=n("fc6a"),i=n("44d2"),a=n("3f8c"),o=n("69f3"),s=n("7dd0"),u="Array Iterator",c=o.set,l=o.getterFor(u);e.exports=s(Array,"Array",(function(e,t){c(this,{type:u,target:r(e),index:0,kind:t})}),(function(){var e=l(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},e2cc:function(e,t,n){var r=n("6eeb");e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},e3db:function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},e538:function(e,t,n){var r=n("b622");t.f=r},e667:function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},e6cf:function(e,t,n){"use strict";var r,i,a,o,s=n("23e7"),u=n("c430"),c=n("da84"),l=n("d066"),d=n("fea9"),p=n("6eeb"),h=n("e2cc"),f=n("d44e"),m=n("2626"),v=n("861d"),g=n("1c0b"),y=n("19aa"),b=n("c6b6"),_=n("8925"),w=n("2266"),x=n("1c7e"),T=n("4840"),C=n("2cf4").set,S=n("b575"),E=n("cdf9"),k=n("44de"),R=n("f069"),O=n("e667"),A=n("69f3"),I=n("94ca"),N=n("b622"),D=n("2d00"),P=N("species"),M="Promise",L=A.get,j=A.set,B=A.getterFor(M),U=d,F=c.TypeError,V=c.document,q=c.process,W=l("fetch"),z=R.f,G=z,H="process"==b(q),$=!!(V&&V.createEvent&&c.dispatchEvent),K="unhandledrejection",Y="rejectionhandled",X=0,J=1,Q=2,Z=1,ee=2,te=I(M,(function(){var e=_(U)!==String(U);if(!e){if(66===D)return!0;if(!H&&"function"!=typeof PromiseRejectionEvent)return!0}if(u&&!U.prototype["finally"])return!0;if(D>=51&&/native code/.test(U))return!1;var t=U.resolve(1),n=function(e){e((function(){}),(function(){}))},r=t.constructor={};return r[P]=n,!(t.then((function(){}))instanceof n)})),ne=te||!x((function(e){U.all(e)["catch"]((function(){}))})),re=function(e){var t;return!(!v(e)||"function"!=typeof(t=e.then))&&t},ie=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;S((function(){var i=t.value,a=t.state==J,o=0;while(r.length>o){var s,u,c,l=r[o++],d=a?l.ok:l.fail,p=l.resolve,h=l.reject,f=l.domain;try{d?(a||(t.rejection===ee&&ue(e,t),t.rejection=Z),!0===d?s=i:(f&&f.enter(),s=d(i),f&&(f.exit(),c=!0)),s===l.promise?h(F("Promise-chain cycle")):(u=re(s))?u.call(s,p,h):p(s)):h(i)}catch(m){f&&!c&&f.exit(),h(m)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&oe(e,t)}))}},ae=function(e,t,n){var r,i;$?(r=V.createEvent("Event"),r.promise=t,r.reason=n,r.initEvent(e,!1,!0),c.dispatchEvent(r)):r={promise:t,reason:n},(i=c["on"+e])?i(r):e===K&&k("Unhandled promise rejection",n)},oe=function(e,t){C.call(c,(function(){var n,r=t.value,i=se(t);if(i&&(n=O((function(){H?q.emit("unhandledRejection",r,e):ae(K,e,r)})),t.rejection=H||se(t)?ee:Z,n.error))throw n.value}))},se=function(e){return e.rejection!==Z&&!e.parent},ue=function(e,t){C.call(c,(function(){H?q.emit("rejectionHandled",e):ae(Y,e,t.value)}))},ce=function(e,t,n,r){return function(i){e(t,n,i,r)}},le=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=Q,ie(e,t,!0))},de=function(e,t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(e===n)throw F("Promise can't be resolved itself");var i=re(n);i?S((function(){var r={done:!1};try{i.call(n,ce(de,e,r,t),ce(le,e,r,t))}catch(a){le(e,r,a,t)}})):(t.value=n,t.state=J,ie(e,t,!1))}catch(a){le(e,{done:!1},a,t)}}};te&&(U=function(e){y(this,U,M),g(e),r.call(this);var t=L(this);try{e(ce(de,this,t),ce(le,this,t))}catch(n){le(this,t,n)}},r=function(e){j(this,{type:M,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:X,value:void 0})},r.prototype=h(U.prototype,{then:function(e,t){var n=B(this),r=z(T(this,U));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=H?q.domain:void 0,n.parent=!0,n.reactions.push(r),n.state!=X&&ie(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=L(e);this.promise=e,this.resolve=ce(de,e,t),this.reject=ce(le,e,t)},R.f=z=function(e){return e===U||e===a?new i(e):G(e)},u||"function"!=typeof d||(o=d.prototype.then,p(d.prototype,"then",(function(e,t){var n=this;return new U((function(e,t){o.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof W&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return E(U,W.apply(c,arguments))}}))),s({global:!0,wrap:!0,forced:te},{Promise:U}),f(U,M,!1,!0),m(M),a=l(M),s({target:M,stat:!0,forced:te},{reject:function(e){var t=z(this);return t.reject.call(void 0,e),t.promise}}),s({target:M,stat:!0,forced:u||te},{resolve:function(e){return E(u&&this===a?U:this,e)}}),s({target:M,stat:!0,forced:ne},{all:function(e){var t=this,n=z(t),r=n.resolve,i=n.reject,a=O((function(){var n=g(t.resolve),a=[],o=0,s=1;w(e,(function(e){var u=o++,c=!1;a.push(void 0),s++,n.call(t,e).then((function(e){c||(c=!0,a[u]=e,--s||r(a))}),i)})),--s||r(a)}));return a.error&&i(a.value),n.promise},race:function(e){var t=this,n=z(t),r=n.reject,i=O((function(){var i=g(t.resolve);w(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},e893:function(e,t,n){var r=n("5135"),i=n("56ef"),a=n("06cf"),o=n("9bf2");e.exports=function(e,t){for(var n=i(t),s=o.f,u=a.f,c=0;c<n.length;c++){var l=n[c];r(e,l)||s(e,l,u(t,l))}}},e8b5:function(e,t,n){var r=n("c6b6");e.exports=Array.isArray||function(e){return"Array"==r(e)}},e95a:function(e,t,n){var r=n("b622"),i=n("3f8c"),a=r("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[a]===e)}},ed6d:function(e,t,n){var r=n("4a4b");function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}e.exports=i},ef34:function(e,t,n){(function(t){var r,i="undefined"!==typeof t?t:"undefined"!==typeof window?window:{},a=n(2);"undefined"!==typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"],r||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=a)),e.exports=r}).call(this,n("c8ba"))},f011:function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},f03d:function(e,t,n){"use strict";var r=n("282b");function i(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function a(e,t,n,i,a){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":a||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var u="msid:"+(i?i.id:"-")+" "+s+"\r\n";o+="a="+u,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+u,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+u,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o}function o(e,t){var n=!1;return e=JSON.parse(JSON.stringify(e)),e.filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"===typeof r;return i&&(r=[r]),r=r.filter((function(e){var r=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n;return r?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}function s(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var a=r(e.parameters.apt,n),o=r(t.parameters.apt,i);return a&&o&&a.name.toLowerCase()===o.name.toLowerCase()};return e.codecs.forEach((function(r){for(var a=0;a<t.codecs.length;a++){var o=t.codecs[a];if(r.name.toLowerCase()===o.name.toLowerCase()&&r.clockRate===o.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&o.parameters.apt&&!i(r,o,e.codecs,t.codecs))continue;o=JSON.parse(JSON.stringify(o)),o.numChannels=Math.min(r.numChannels,o.numChannels),n.codecs.push(o),o.rtcpFeedback=o.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function u(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function c(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function l(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function p(t,n,r,i){var a=new Event("track");a.track=n,a.receiver=r,a.transceiver={receiver:r},a.streams=i,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var h=function(n){var i=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all";break}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced";break}if(n.iceServers=o(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var s=n.iceCandidatePoolSize;s>0;s--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(h.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(h.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),h.prototype.onicecandidate=null,h.prototype.onaddstream=null,h.prototype.ontrack=null,h.prototype.onremovestream=null,h.prototype.onsignalingstatechange=null,h.prototype.oniceconnectionstatechange=null,h.prototype.onconnectionstatechange=null,h.prototype.onicegatheringstatechange=null,h.prototype.onnegotiationneeded=null,h.prototype.ondatachannel=null,h.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"===typeof this["on"+e]&&this["on"+e](t))},h.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},h.prototype.getConfiguration=function(){return this._config},h.prototype.getLocalStreams=function(){return this.localStreams},h.prototype.getRemoteStreams=function(){return this.remoteStreams},h.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},h.prototype.addTrack=function(t,n){if(this._isClosed)throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r,i=this.transceivers.find((function(e){return e.track===t}));if(i)throw l("InvalidAccessError","Track already exists.");for(var a=0;a<this.transceivers.length;a++)this.transceivers[a].track||this.transceivers[a].kind!==t.kind||(r=this.transceivers[a]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},h.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},h.prototype.removeTrack=function(t){if(this._isClosed)throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw l("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null;var i=this.transceivers.map((function(e){return e.stream}));-1===i.indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},h.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},h.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},h.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},h.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},h.prototype._gather=function(t,n){var i=this,a=this.transceivers[n].iceGatherer;if(!a.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),a.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,u=!s||0===Object.keys(s).length;if(u)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),s.component=1,s.ufrag=a.getLocalParameters().usernameFragment;var c=r.writeCandidate(s);o.candidate=Object.assign(o.candidate,r.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[o.candidate.sdpMLineIndex]+=u?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var d=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),u||i._dispatchEvent("icecandidate",o),d&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},h.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},h.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},h.prototype._transceive=function(e,n,i){var a=s(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},h.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(l("TypeError",'Unsupported type "'+e.type+'"'));if(!u("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(l("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var a=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var o=i.transceivers[t],u=o.iceGatherer,c=o.iceTransport,l=o.dtlsTransport,d=o.localCapabilities,p=o.remoteCapabilities,h=r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length;if(!h&&!o.rejected){var f=r.getIceParameters(e,n),m=r.getDtlsParameters(e,n);a&&(m.role="server"),i.usingBundle&&0!==t||(i._gather(o.mid,t),"new"===c.state&&c.start(u,f,a?"controlling":"controlled"),"new"===l.state&&l.start(m));var v=s(d,p);i._transceive(o,v.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},h.prototype.setRemoteDescription=function(i){var a=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(l("TypeError",'Unsupported type "'+i.type+'"'));if(!u("setRemoteDescription",i.type,a.signalingState)||a._isClosed)return Promise.reject(l("InvalidStateError","Can not set remote "+i.type+" in state "+a.signalingState));var o={};a.remoteStreams.forEach((function(e){o[e.id]=e}));var h=[],f=r.splitSections(i.sdp),m=f.shift(),v=r.matchPrefix(m,"a=ice-lite").length>0,g=r.matchPrefix(m,"a=group:BUNDLE ").length>0;a.usingBundle=g;var y=r.matchPrefix(m,"a=ice-options:")[0];return a.canTrickleIceCandidates=!!y&&y.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(u,l){var p=r.splitLines(u),f=r.getKind(u),y=r.isRejected(u)&&0===r.matchPrefix(u,"a=bundle-only").length,b=p[0].substr(2).split(" ")[2],_=r.getDirection(u,m),w=r.parseMsid(u),x=r.getMid(u)||r.generateIdentifier();if(y||"application"===f&&("DTLS/SCTP"===b||"UDP/DTLS/SCTP"===b))a.transceivers[l]={mid:x,kind:f,protocol:b,rejected:!0};else{var T,C,S,E,k,R,O,A,I;!y&&a.transceivers[l]&&a.transceivers[l].rejected&&(a.transceivers[l]=a._createTransceiver(f,!0));var N,D,P=r.parseRtpParameters(u);y||(N=r.getIceParameters(u,m),D=r.getDtlsParameters(u,m),D.role="client"),O=r.parseRtpEncodingParameters(u);var M=r.parseRtcpParameters(u),L=r.matchPrefix(u,"a=end-of-candidates",m).length>0,j=r.matchPrefix(u,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!y&&g&&l>0&&a.transceivers[l]&&(a._disposeIceAndDtlsTransports(l),a.transceivers[l].iceGatherer=a.transceivers[0].iceGatherer,a.transceivers[l].iceTransport=a.transceivers[0].iceTransport,a.transceivers[l].dtlsTransport=a.transceivers[0].dtlsTransport,a.transceivers[l].rtpSender&&a.transceivers[l].rtpSender.setTransport(a.transceivers[0].dtlsTransport),a.transceivers[l].rtpReceiver&&a.transceivers[l].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)),"offer"!==i.type||y){if("answer"===i.type&&!y){T=a.transceivers[l],C=T.iceGatherer,S=T.iceTransport,E=T.dtlsTransport,k=T.rtpReceiver,R=T.sendEncodingParameters,A=T.localCapabilities,a.transceivers[l].recvEncodingParameters=O,a.transceivers[l].remoteCapabilities=P,a.transceivers[l].rtcpParameters=M,j.length&&"new"===S.state&&(!v&&!L||g&&0!==l?j.forEach((function(e){c(T.iceTransport,e)})):S.setRemoteCandidates(j)),g&&0!==l||("new"===S.state&&S.start(C,N,"controlling"),"new"===E.state&&E.start(D));var B=s(T.localCapabilities,T.remoteCapabilities),U=B.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length;!U&&T.sendEncodingParameters[0].rtx&&delete T.sendEncodingParameters[0].rtx,a._transceive(T,"sendrecv"===_||"recvonly"===_,"sendrecv"===_||"sendonly"===_),!k||"sendrecv"!==_&&"sendonly"!==_?delete T.rtpReceiver:(I=k.track,w?(o[w.stream]||(o[w.stream]=new e.MediaStream),n(I,o[w.stream]),h.push([I,k,o[w.stream]])):(o.default||(o.default=new e.MediaStream),n(I,o.default),h.push([I,k,o.default])))}}else{T=a.transceivers[l]||a._createTransceiver(f),T.mid=x,T.iceGatherer||(T.iceGatherer=a._createIceGatherer(l,g)),j.length&&"new"===T.iceTransport.state&&(!L||g&&0!==l?j.forEach((function(e){c(T.iceTransport,e)})):T.iceTransport.setRemoteCandidates(j)),A=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(A.codecs=A.codecs.filter((function(e){return"rtx"!==e.name}))),R=T.sendEncodingParameters||[{ssrc:1001*(2*l+2)}];var F,V=!1;if("sendrecv"===_||"sendonly"===_){if(V=!T.rtpReceiver,k=T.rtpReceiver||new e.RTCRtpReceiver(T.dtlsTransport,f),V)I=k.track,w&&"-"===w.stream||(w?(o[w.stream]||(o[w.stream]=new e.MediaStream,Object.defineProperty(o[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(I,"id",{get:function(){return w.track}}),F=o[w.stream]):(o.default||(o.default=new e.MediaStream),F=o.default)),F&&(n(I,F),T.associatedRemoteMediaStreams.push(F)),h.push([I,k,F])}else T.rtpReceiver&&T.rtpReceiver.track&&(T.associatedRemoteMediaStreams.forEach((function(e){var t=e.getTracks().find((function(e){return e.id===T.rtpReceiver.track.id}));t&&d(t,e)})),T.associatedRemoteMediaStreams=[]);T.localCapabilities=A,T.remoteCapabilities=P,T.rtpReceiver=k,T.rtcpParameters=M,T.sendEncodingParameters=R,T.recvEncodingParameters=O,a._transceive(a.transceivers[l],!1,V)}}})),void 0===a._dtlsRole&&(a._dtlsRole="offer"===i.type?"active":"passive"),a._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?a._updateSignalingState("have-remote-offer"):a._updateSignalingState("stable"),Object.keys(o).forEach((function(t){var n=o[t];if(n.getTracks().length){if(-1===a.remoteStreams.indexOf(n)){a.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){a._dispatchEvent("addstream",r)}))}h.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&p(a,t,r,[n])}))}})),h.forEach((function(e){e[2]||p(a,e[0],e[1],[])})),e.setTimeout((function(){a&&a.transceivers&&a.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},h.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},h.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},h.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},h.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},h.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},h.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(l("InvalidStateError","Can not call createOffer after close"));var i=n.transceivers.filter((function(e){return"audio"===e.kind})).length,o=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(i=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(o=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}n.transceivers.forEach((function(e){"audio"===e.kind?(i--,i<0&&(e.wantReceive=!1)):"video"===e.kind&&(o--,o<0&&(e.wantReceive=!1))}));while(i>0||o>0)i>0&&(n._createTransceiver("audio"),i--),o>0&&(n._createTransceiver("video"),o--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,a){var o=i.track,s=i.kind,u=i.mid||r.generateIdentifier();i.mid=u,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(a,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){var t=i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[];t.forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];o&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=c,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=a(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var c=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(c)},h.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var i=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(i+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),i+="a=ice-options:trickle\r\n";var o=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>o)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?i+="m=application 0 DTLS/SCTP 5000\r\n":i+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?i+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(i+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(i+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var u;if(e.stream)"audio"===e.kind?u=e.stream.getAudioTracks()[0]:"video"===e.kind&&(u=e.stream.getVideoTracks()[0]),u&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var c=s(e.localCapabilities,e.remoteCapabilities),l=c.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length;!l&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,i+=a(e,c,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(i+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:i});return Promise.resolve(u)},h.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,a){if(!n._remoteDescription)return a(l("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<n.transceivers.length;s++)if(n.transceivers[s].mid===e.sdpMid){o=s;break}var u=n.transceivers[o];if(!u)return a(l("OperationError","Can not add ICE candidate"));if(u.rejected)return i();var d=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return i();if(d.component&&1!==d.component)return i();if((0===o||o>0&&u.iceTransport!==n.transceivers[0].iceTransport)&&!c(u.iceTransport,d))return a(l("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),t=r.getMediaSections(n._remoteDescription.sdp),t[o]+="a="+(d.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var h=0;h<n.transceivers.length;h++)if(!n.transceivers[h].rejected&&(n.transceivers[h].iceTransport.addRemoteCandidate({}),t=r.getMediaSections(n._remoteDescription.sdp),t[h]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),n.usingBundle))break;i()}))},h.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw l("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};var f=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];f.forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=i(e[n]),t.set(n,e[n])})),t}))}}}));var m=["createOffer","createAnswer"];return m.forEach((function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;return"function"===typeof e[0]||"function"===typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"===typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"===typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),m=["setLocalDescription","setRemoteDescription","addIceCandidate"],m.forEach((function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]||"function"===typeof e[2]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)}),(function(t){"function"===typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;return"function"===typeof e[1]?t.apply(this,arguments).then((function(){"function"===typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),h}},f069:function(e,t,n){"use strict";var r=n("1c0b"),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},f0e2:function(e,t,n){"use strict";n.r(t);var r=n("672b"),i=n.n(r),a=n("cc57"),o=n.n(a),s=n("a559"),u=n.n(s),c=n("3c96"),l=n.n(c),d=(n("6b58"),n("36c6"),n("55b5")),p=n.n(d),h=n("8c10"),f=n.n(h),m=n("df33"),v=n.n(m),g=n("045f"),y=n.n(g),b=n("2b8c"),_=n.n(b),w=n("b17c"),x=n.n(w),T=n("ed6d"),C=n.n(T),S=n("d136"),E=n.n(S),k=n("be09"),R=n.n(k);
/*! @name m3u8-parser @version 4.4.0 @license Apache-2.0 */
function O(){return O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O.apply(this,arguments)}function A(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var N=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t,n,r,i=this.listeners[e];if(i)if(2===arguments.length)for(n=i.length,t=0;t<n;++t)i[t].call(this,arguments[1]);else for(r=Array.prototype.slice.call(arguments,1),n=i.length,t=0;t<n;++t)i[t].apply(this,r)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),D=function(e){function t(){var t;return t=e.call(this)||this,t.buffer="",t}A(t,e);var n=t.prototype;return n.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(N),P=function(){var e="[^=]*",t='"[^"]*"|[^,]*',n="(?:"+e+")=(?:"+t+")";return new RegExp("(?:^|,)("+n+")")},M=function(e){var t,n=e.split(P()),r={},i=n.length;while(i--)""!==n[i]&&(t=/([^=]*)=(.*)/.exec(n[i]).slice(1),t[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r},L=function(e){function t(){var t;return t=e.call(this)||this,t.customParsers=[],t.tagMappers=[],t}A(t,e);var n=t.prototype;return n.push=function(e){var t,n,r=this;if(e=e.trim(),0!==e.length)if("#"===e[0]){var i=this.tagMappers.reduce((function(t,n){var r=n(e);return r===e?t:t.concat([r])}),[e]);i.forEach((function(e){for(var i=0;i<r.customParsers.length;i++)if(r.customParsers[i].call(r,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e),t)r.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void r.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"totalduration"},t[1]&&(n.duration=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void r.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e),t)return n={type:"tag",tagType:"byterange"},t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),void r.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e),t)return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e),t){if(n={type:"tag",tagType:"map"},t[1]){var a=M(t[1]);if(a.URI&&(n.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],u=o[1];n.byterange={},s&&(n.byterange.length=parseInt(s,10)),u&&(n.byterange.offset=parseInt(u,10))}}r.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e),t){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=M(t[1]),n.attributes.RESOLUTION){var c=n.attributes.RESOLUTION.split("x"),l={};c[0]&&(l.width=parseInt(c[0],10)),c[1]&&(l.height=parseInt(c[1],10)),n.attributes.RESOLUTION=l}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}r.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e),t)return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=M(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e),t)r.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e),t)r.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e),t)return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e),t)return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=M(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void r.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e),t)return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=M(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e),t)return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);r.trigger("data",{type:"tag",data:e.slice(4)})}}}else r.trigger("data",{type:"comment",text:e.slice(1)})}))}else this.trigger("data",{type:"uri",uri:e})},n.addParser=function(e){var t=this,n=e.expression,r=e.customType,i=e.dataParser,a=e.segment;"function"!==typeof i&&(i=function(e){return e}),this.customParsers.push((function(e){var o=n.exec(e);if(o)return t.trigger("data",{type:"custom",data:i(e),customType:r,segment:a}),!0}))},n.addTagMapper=function(e){var t=e.expression,n=e.map,r=function(e){return t.test(e)?n(e):e};this.tagMappers.push(r)},t}(N);function j(e){for(var t=R.a.atob(e||""),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}var B=function(e){function t(){var t;t=e.call(this)||this,t.lineStream=new D,t.parseStream=new L,t.lineStream.pipe(t.parseStream);var n,r,i=I(t),a=[],o={},s=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",l=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",(function(e){var t,d;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(o.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if(e.attributes.KEYFORMAT===c){var t=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return-1===t.indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:j(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},"undefined"!==typeof e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes?(o.attributes||(o.attributes={}),O(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],d={default:/yes/i.test(e.attributes.DEFAULT)},d.default?d.autoselect=!0:d.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(d.language=e.attributes.LANGUAGE),e.attributes.URI&&(d.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(d.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(d.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(d.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=d}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data}}[e.tagType]||s).call(i)},uri:function(){o.uri=e.uri,a.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),r&&(o.key=r),o.timeline=l,n&&(o.map=n),o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(i)})),t}A(t,e);var n=t.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(N),U=n("5fcf"),F=n.n(U),V=n("8507"),q=n.n(V),W=n("29d8"),z=function(e){return!!e&&"object"===typeof e},G=function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce((function(t,n){return Object.keys(n).forEach((function(r){Array.isArray(t[r])&&Array.isArray(n[r])?t[r]=t[r].concat(n[r]):z(t[r])&&z(n[r])?t[r]=e(t[r],n[r]):t[r]=n[r]})),t}),{})},H=function(e){return Object.keys(e).map((function(t){return e[t]}))},$=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n},K=function(e){return e.reduce((function(e,t){return e.concat(t)}),[])},Y=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},X=function(e,t){return e.reduce((function(e,n,r){return n[t]&&e.push(r),e}),[])},J={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},Q=function(e){var t=e.baseUrl,n=void 0===t?"":t,r=e.source,i=void 0===r?"":r,a=e.range,o=void 0===a?"":a,s=e.indexRange,u=void 0===s?"":s,c={uri:i,resolvedUri:F()(n||"",i)};if(o||u){var l=o||u,d=l.split("-"),p=parseInt(d[0],10),h=parseInt(d[1],10);c.byterange={length:h-p+1,offset:p}}return c},Z=function(e){var t=e.offset+e.length-1;return e.offset+"-"+t},ee={static:function(e){var t=e.duration,n=e.timescale,r=void 0===n?1:n,i=e.sourceDuration;return{start:0,end:Math.ceil(i/(t/r))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,r=e.availabilityStartTime,i=e.timescale,a=void 0===i?1:i,o=e.duration,s=e.start,u=void 0===s?0:s,c=e.minimumUpdatePeriod,l=void 0===c?0:c,d=e.timeShiftBufferDepth,p=void 0===d?1/0:d,h=(t+n)/1e3,f=r+u,m=h+l,v=m-f,g=Math.ceil(v*a/o),y=Math.floor((h-f-p)*a/o),b=Math.floor((h-f)*a/o);return{start:Math.max(0,y),end:Math.min(g,b)}}},te=function(e){return function(t,n){var r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.periodIndex,s=e.startNumber,u=void 0===s?1:s;return{number:u+t,duration:r/a,timeline:o,time:n*r}}},ne=function(e){var t=e.type,n=void 0===t?"static":t,r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.sourceDuration,s=ee[n](e),u=s.start,c=s.end,l=$(u,c).map(te(e));if("static"===n){var d=l.length-1;l[d].duration=o-r/a*d}return l},re=function(e){var t=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,i=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,u=void 0===s?"":s,c=e.duration;if(!t)throw new Error(J.NO_BASE_URL);var l=Q({baseUrl:t,source:r.sourceURL,range:r.range}),d=Q({baseUrl:t,source:t,indexRange:u});if(d.map=l,c){var p=ne(e);p.length&&(d.duration=p[0].duration,d.timeline=p[0].timeline)}else i&&(d.duration=i/o,d.timeline=0);return d.number=0,[d]},ie=function(e,t,n){for(var r=e.sidx.map?e.sidx.map:null,i=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,u=t.timescale,c=t.references.filter((function(e){return 1!==e.referenceType})),l=[],d=s+t.firstOffset,p=0;p<c.length;p++){var h=t.references[p],f=h.referencedSize,m=h.subsegmentDuration,v=d+f-1,g=d+"-"+v,y={baseUrl:n,timescale:u,timeline:a,periodIndex:a,duration:m,sourceDuration:i,indexRange:g},b=re(y)[0];r&&(b.map=r),l.push(b),d+=f}return e.segments=l,e},ae=function(e){var t=H(e.reduce((function(e,t){var n,r=t.attributes.id+(t.attributes.lang||"");e[r]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[r].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[r].attributes.contentProtection=t.attributes.contentProtection)):e[r]=t;return e}),{}));return t.map((function(e){return e.discontinuityStarts=X(e.segments,"discontinuity"),e}))},oe=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var r=e[n];if(r.sidx){var i=r.sidx.uri+"-"+Z(r.sidx.byterange),a=t[i]&&t[i].sidx;r.sidx&&a&&ie(r,a,r.sidx.resolvedUri)}}return e},se=function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a},ue=function(e){var t,n=e.attributes,r=e.segments;return"undefined"===typeof r&&(r=[{uri:n.baseUrl,timeline:n.periodIndex,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration),{attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:n.baseUrl||"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1}},ce=function(e,t){var n;void 0===t&&(t={});var r=e.reduce((function(e,r){var i=r.attributes.role&&r.attributes.role.value||"",a=r.attributes.lang||"",o="main";if(a){var s=i?" ("+i+")":"";o=""+r.attributes.lang+s}return e[o]&&e[o].playlists[0].attributes.BANDWIDTH>r.attributes.bandwidth||(e[o]={language:a,autoselect:!0,default:"main"===i,playlists:oe([se(r)],t),uri:""},"undefined"===typeof n&&"main"===i&&(n=r,n.default=!0)),e}),{});if(!n){var i=Object.keys(r)[0];r[i].default=!0}return r},le=function(e,t){return void 0===t&&(t={}),e.reduce((function(e,n){var r=n.attributes.lang||"text";return e[r]||(e[r]={language:r,default:!1,autoselect:!1,playlists:oe([ue(n)],t),uri:""}),e}),{})},de=function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a},pe=function(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var r=e[0].attributes,i=r.sourceDuration,a=r.type,o=void 0===a?"static":a,s=r.suggestedPresentationDelay,u=r.minimumUpdatePeriod,c=void 0===u?0:u,l=function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType},d=function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType},p=function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType},h=ae(e.filter(l)).map(de),f=ae(e.filter(d)),m=e.filter(p),v={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:i,playlists:oe(h,t),minimumUpdatePeriod:1e3*c};return"dynamic"===o&&(v.suggestedPresentationDelay=s),f.length&&(v.mediaGroups.AUDIO.audio=ce(f,t)),m.length&&(v.mediaGroups.SUBTITLES.subs=le(m,t)),v},he=function(e,t,n){var r=e.NOW,i=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,u=e.start,c=void 0===u?0:u,l=e.minimumUpdatePeriod,d=void 0===l?0:l,p=(r+i)/1e3,h=a+c,f=p+d,m=f-h;return Math.ceil((m*s-t)/n)},fe=function(e,t){for(var n=e.type,r=void 0===n?"static":n,i=e.minimumUpdatePeriod,a=void 0===i?0:i,o=e.media,s=void 0===o?"":o,u=e.sourceDuration,c=e.timescale,l=void 0===c?1:c,d=e.startNumber,p=void 0===d?1:d,h=e.periodIndex,f=[],m=-1,v=0;v<t.length;v++){var g=t[v],y=g.d,b=g.r||0,_=g.t||0;m<0&&(m=_),_&&_>m&&(m=_);var w=void 0;if(b<0){var x=v+1;w=x===t.length?"dynamic"===r&&a>0&&s.indexOf("$Number$")>0?he(e,m,y):(u*l-m)/y:(t[x].t-m)/y}else w=b+1;var T=p+f.length+w,C=p+f.length;while(C<T)f.push({number:C,duration:y/l,time:m,timeline:h}),m+=y,C++}return f},me=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,ve=function(e){return function(t,n,r,i){if("$$"===t)return"$";if("undefined"===typeof e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(i=r?parseInt(i,10):1,a.length>=i?a:""+new Array(i-a.length+1).join("0")+a)}},ge=function(e,t){return e.replace(me,ve(t))},ye=function(e,t){return e.duration||t?e.duration?ne(e):fe(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]},be=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},r=e.initialization,i=void 0===r?{sourceURL:"",range:""}:r,a=Q({baseUrl:e.baseUrl,source:ge(i.sourceURL,n),range:i.range}),o=ye(e,t);return o.map((function(t){n.Number=t.number,n.Time=t.time;var r=ge(e.media||"",n);return{uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:F()(e.baseUrl||"",r),map:a,number:t.number}}))},_e=function(e,t){var n=e.baseUrl,r=e.initialization,i=void 0===r?{}:r,a=Q({baseUrl:n,source:i.sourceURL,range:i.range}),o=Q({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o},we=function(e,t){var n=e.duration,r=e.segmentUrls,i=void 0===r?[]:r;if(!n&&!t||n&&t)throw new Error(J.SEGMENT_TIME_UNSPECIFIED);var a,o=i.map((function(t){return _e(e,t)}));n&&(a=ne(e)),t&&(a=fe(e,t));var s=a.map((function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}})).filter((function(e){return e}));return s},xe=function(e){var t,n,r=e.attributes,i=e.segmentInfo;i.template?(n=be,t=G(r,i.template)):i.base?(n=re,t=G(r,i.base)):i.list&&(n=we,t=G(r,i.list));var a={attributes:r};if(!n)return a;var o=n(t,i.timeline);if(t.duration){var s=t,u=s.duration,c=s.timescale,l=void 0===c?1:c;t.duration=u/l}else o.length?t.duration=o.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0):t.duration=0;return a.attributes=t,a.segments=o,i.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},Te=function(e){return e.map(xe)},Ce=function(e,t){return Y(e.childNodes).filter((function(e){var n=e.tagName;return n===t}))},Se=function(e){return e.textContent.trim()},Ee=function(e){var t=31536e3,n=2592e3,r=86400,i=3600,a=60,o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,s=o.exec(e);if(!s)return 0;var u=s.slice(1),c=u[0],l=u[1],d=u[2],p=u[3],h=u[4],f=u[5];return parseFloat(c||0)*t+parseFloat(l||0)*n+parseFloat(d||0)*r+parseFloat(p||0)*i+parseFloat(h||0)*a+parseFloat(f||0)},ke=function(e){var t=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return t.test(e)&&(e+="Z"),Date.parse(e)},Re={mediaPresentationDuration:function(e){return Ee(e)},availabilityStartTime:function(e){return ke(e)/1e3},minimumUpdatePeriod:function(e){return Ee(e)},suggestedPresentationDelay:function(e){return Ee(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return Ee(e)},start:function(e){return Ee(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?Ee(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Oe=function(e){return e&&e.attributes?Y(e.attributes).reduce((function(e,t){var n=Re[t.name]||Re.DEFAULT;return e[t.name]=n(t.value),e}),{}):{}},Ae={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Ie=function(e,t){return t.length?K(e.map((function(e){return t.map((function(t){return F()(e,Se(t))}))}))):e},Ne=function(e){var t=Ce(e,"SegmentTemplate")[0],n=Ce(e,"SegmentList")[0],r=n&&Ce(n,"SegmentURL").map((function(e){return G({tag:"SegmentURL"},Oe(e))})),i=Ce(e,"SegmentBase")[0],a=n||t,o=a&&Ce(a,"SegmentTimeline")[0],s=n||i||t,u=s&&Ce(s,"Initialization")[0],c=t&&Oe(t);c&&u?c.initialization=u&&Oe(u):c&&c.initialization&&(c.initialization={sourceURL:c.initialization});var l={template:c,timeline:o&&Ce(o,"S").map((function(e){return Oe(e)})),list:n&&G(Oe(n),{segmentUrls:r,initialization:Oe(u)}),base:i&&G(Oe(i),{initialization:Oe(u)})};return Object.keys(l).forEach((function(e){l[e]||delete l[e]})),l},De=function(e,t,n){return function(r){var i=Ce(r,"BaseURL"),a=Ie(t,i),o=G(e,Oe(r)),s=Ne(r);return a.map((function(e){return{segmentInfo:G(n,s),attributes:G(o,{baseUrl:e})}}))}},Pe=function(e){return e.reduce((function(e,t){var n=Oe(t),r=Ae[n.schemeIdUri];if(r){e[r]={attributes:n};var i=Ce(t,"cenc:pssh")[0];if(i){var a=Se(i),o=a&&q()(a);e[r].pssh=o}}return e}),{})},Me=function(e,t,n){return function(r){var i=Oe(r),a=Ie(t,Ce(r,"BaseURL")),o=Ce(r,"Role")[0],s={role:Oe(o)},u=G(e,i,s),c=Pe(Ce(r,"ContentProtection"));Object.keys(c).length&&(u=G(u,{contentProtection:c}));var l=Ne(r),d=Ce(r,"Representation"),p=G(n,l);return K(d.map(De(u,a,p)))}},Le=function(e,t){return function(n,r){var i=Ie(t,Ce(n,"BaseURL")),a=Oe(n),o=parseInt(a.id,10),s=R.a.isNaN(o)?r:o,u=G(e,{periodIndex:s}),c=Ce(n,"AdaptationSet"),l=Ne(n);return K(c.map(Me(u,i,l)))}},je=function(e,t){void 0===t&&(t={});var n=t,r=n.manifestUri,i=void 0===r?"":r,a=n.NOW,o=void 0===a?Date.now():a,s=n.clientOffset,u=void 0===s?0:s,c=Ce(e,"Period");if(!c.length)throw new Error(J.INVALID_NUMBER_OF_PERIOD);var l=Oe(e),d=Ie([i],Ce(e,"BaseURL"));return l.sourceDuration=l.mediaPresentationDuration||0,l.NOW=o,l.clientOffset=u,K(c.map(Le(l,d)))},Be=function(e){if(""===e)throw new Error(J.DASH_EMPTY_MANIFEST);var t=new W["DOMParser"],n=t.parseFromString(e,"application/xml"),r=n&&"MPD"===n.documentElement.tagName?n.documentElement:null;if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(J.DASH_INVALID_XML);return r},Ue=function(e){var t=Ce(e,"UTCTiming")[0];if(!t)return null;var n=Oe(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(J.UNSUPPORTED_UTC_TIMING_SCHEME)}return n},Fe=function(e,t){return void 0===t&&(t={}),pe(Te(je(Be(e),t)),t.sidxMapping)},Ve=function(e){return Ue(Be(e))},qe=n("9afa"),We=n.n(qe),ze=n("2806"),Ge=n.n(ze),He=n("a8e0"),$e=n.n(He),Ke=n("dc3e"),Ye=n.n(Ke);function Xe(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var Je=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Qe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ze=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},et=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t},tt=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,u=[],c=[],l=void 0,d=void 0,p=void 0,h=void 0,f=void 0,m=void 0;for(a=0;a<256;a++)c[(u[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=l||1,s=c[s]||1)for(h=s^s<<1^s<<2^s<<3^s<<4,h=h>>8^255&h^99,r[o]=h,i[h]=o,p=u[d=u[l=u[o]]],m=16843009*p^65537*d^257*l^16843008*o,f=257*u[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=m=m<<24^m>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},nt=null,rt=function(){function e(t){Je(this,e),nt||(nt=tt()),this._tables=[[nt[0][0].slice(),nt[0][1].slice(),nt[0][2].slice(),nt[0][3].slice(),nt[0][4].slice()],[nt[1][0].slice(),nt[1][1].slice(),nt[1][2].slice(),nt[1][3].slice(),nt[1][4].slice()]];var n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=this._tables[0][4],u=this._tables[1],c=t.length,l=1;if(4!==c&&6!==c&&8!==c)throw new Error("Invalid aes key size");for(a=t.slice(0),o=[],this._key=[a,o],n=c;n<4*c+28;n++)i=a[n-1],(n%c===0||8===c&&n%c===4)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],n%c===0&&(i=i<<8^i>>>24^l<<24,l=l<<1^283*(l>>7))),a[n]=a[n-c]^i;for(r=0;n;r++,n--)i=a[3&r?n:n-4],o[r]=n<=4||r<4?i:u[0][s[i>>>24]]^u[1][s[i>>16&255]]^u[2][s[i>>8&255]]^u[3][s[255&i]]}return e.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],u=r^o[1],c=n^o[2],l=t^o[3],d=void 0,p=void 0,h=void 0,f=o.length/4-2,m=void 0,v=4,g=this._tables[1],y=g[0],b=g[1],_=g[2],w=g[3],x=g[4];for(m=0;m<f;m++)d=y[s>>>24]^b[u>>16&255]^_[c>>8&255]^w[255&l]^o[v],p=y[u>>>24]^b[c>>16&255]^_[l>>8&255]^w[255&s]^o[v+1],h=y[c>>>24]^b[l>>16&255]^_[s>>8&255]^w[255&u]^o[v+2],l=y[l>>>24]^b[s>>16&255]^_[u>>8&255]^w[255&c]^o[v+3],v+=4,s=d,u=p,c=h;for(m=0;m<4;m++)i[(3&-m)+a]=x[s>>>24]<<24^x[u>>16&255]<<16^x[c>>8&255]<<8^x[255&l]^o[v++],d=s,s=u,u=c,c=l,l=d},e}(),it=function(){function e(){Je(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),at=function(e){function t(){Je(this,t);var n=et(this,e.call(this,it));return n.jobs=[],n.delay=1,n.timeout_=null,n}return Ze(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(it),ot=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},st=function(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),i=new rt(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,u=void 0,c=void 0,l=void 0,d=void 0,p=void 0,h=void 0,f=void 0,m=void 0;for(s=n[0],u=n[1],c=n[2],l=n[3],m=0;m<r.length;m+=4)d=ot(r[m]),p=ot(r[m+1]),h=ot(r[m+2]),f=ot(r[m+3]),i.decrypt(d,p,h,f,o,m),o[m]=ot(o[m]^s),o[m+1]=ot(o[m+1]^u),o[m+2]=ot(o[m+2]^c),o[m+3]=ot(o[m+3]^l),s=d,u=p,c=h,l=f;return a},ut=function(){function e(t,n,r,i){Je(this,e);var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),u=0;for(this.asyncStream_=new at,this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+a),n,r,s)),u=a;u<o.length;u+=a)r=new Uint32Array([ot(o[u-4]),ot(o[u-3]),ot(o[u-2]),ot(o[u-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+a),n,r,s));this.asyncStream_.push((function(){i(null,Xe(s))}))}return e.prototype.decryptChunk_=function(e,t,n,r){return function(){var i=st(e,t,n);r.set(i,e.byteOffset)}},Qe(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),ct="7.8.4",lt=[],dt=function(e,t){return function(n,r,a){var o=t.levels[r],s=new RegExp("^("+o+")$");if("log"!==n&&a.unshift(n.toUpperCase()+":"),a.unshift(e+":"),lt){lt.push([].concat(a));var u=lt.length-1e3;lt.splice(0,u>0?u:0)}if(i.a.console){var c=i.a.console[n];c||"debug"!==n||(c=i.a.console.info||i.a.console.log),c&&o&&s.test(n)&&c[Array.isArray(a)?"apply":"call"](i.a.console,a)}}};function pt(e){var t,n="info",r=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];t("log",n,r)};return t=dt(e,r),r.createLogger=function(t){return pt(e+": "+t)},r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:n},r.level=function(e){if("string"===typeof e){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');n=e}return n},r.history=function(){return lt?[].concat(lt):[]},r.history.filter=function(e){return(lt||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))},r.history.clear=function(){lt&&(lt.length=0)},r.history.disable=function(){null!==lt&&(lt.length=0,lt=null)},r.history.enable=function(){null===lt&&(lt=[])},r.error=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t("error",n,r)},r.warn=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t("warn",n,r)},r.debug=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return t("debug",n,r)},r}var ht=pt("VIDEOJS"),ft=ht.createLogger,mt=Object.prototype.toString,vt=function(e){return _t(e)?Object.keys(e):[]};function gt(e,t){vt(e).forEach((function(n){return t(e[n],n)}))}function yt(e,t,n){return void 0===n&&(n=0),vt(e).reduce((function(n,r){return t(n,e[r],r)}),n)}function bt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign?u.a.apply(void 0,[e].concat(n)):(n.forEach((function(t){t&&gt(t,(function(t,n){e[n]=t}))})),e)}function _t(e){return!!e&&"object"===typeof e}function wt(e){return _t(e)&&"[object Object]"===mt.call(e)&&e.constructor===Object}function xt(e,t){if(!e||!t)return"";if("function"===typeof i.a.getComputedStyle){var n=i.a.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:""}return""}function Tt(e){return"string"===typeof e&&Boolean(e.trim())}function Ct(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function St(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}function Et(){return o.a===i.a.document}function kt(e){return _t(e)&&1===e.nodeType}function Rt(){try{return i.a.parent!==i.a.self}catch(e){return!0}}function Ot(e){return function(t,n){if(!Tt(t))return o.a[e](null);Tt(n)&&(n=o.a.querySelector(n));var r=kt(n)?n:o.a;return r[e]&&r[e](t)}}function At(e,t,n,r){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n={});var i=o.a.createElement(e);return Object.getOwnPropertyNames(t).forEach((function(e){var n=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(ht.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+n+"."),i.setAttribute(e,n)):"textContent"===e?It(i,n):i[e]!==n&&(i[e]=n)})),Object.getOwnPropertyNames(n).forEach((function(e){i.setAttribute(e,n[e])})),r&&Xt(i,r),i}function It(e,t){return"undefined"===typeof e.textContent?e.innerText=t:e.textContent=t,e}function Nt(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function Dt(e,t){return Ct(t),e.classList?e.classList.contains(t):St(t).test(e.className)}function Pt(e,t){return e.classList?e.classList.add(t):Dt(e,t)||(e.className=(e.className+" "+t).trim()),e}function Mt(e,t){return e.classList?e.classList.remove(t):(Ct(t),e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")),e}function Lt(e,t,n){var r=Dt(e,t);if("function"===typeof n&&(n=n(e,t)),"boolean"!==typeof n&&(n=!r),n!==r)return n?Pt(e,t):Mt(e,t),e}function jt(e,t){Object.getOwnPropertyNames(t).forEach((function(n){var r=t[n];null===r||"undefined"===typeof r||!1===r?e.removeAttribute(n):e.setAttribute(n,!0===r?"":r)}))}function Bt(e){var t={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&e.attributes.length>0)for(var r=e.attributes,i=r.length-1;i>=0;i--){var a=r[i].name,o=r[i].value;"boolean"!==typeof e[a]&&-1===n.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function Ut(e,t){return e.getAttribute(t)}function Ft(e,t,n){e.setAttribute(t,n)}function Vt(e,t){e.removeAttribute(t)}function qt(){o.a.body.focus(),o.a.onselectstart=function(){return!1}}function Wt(){o.a.onselectstart=function(){return!0}}function zt(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat(xt(e,"height"))),n.width||(n.width=parseFloat(xt(e,"width"))),n}}function Gt(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=o.a.documentElement,r=o.a.body,a=n.clientLeft||r.clientLeft||0,s=i.a.pageXOffset||r.scrollLeft,u=t.left+s-a,c=n.clientTop||r.clientTop||0,l=i.a.pageYOffset||r.scrollTop,d=t.top+l-c;return{left:Math.round(u),top:Math.round(d)}}function Ht(e,t){var n={},r=Gt(e),i=e.offsetWidth,a=e.offsetHeight,o=r.top,s=r.left,u=t.pageY,c=t.pageX;return t.changedTouches&&(c=t.changedTouches[0].pageX,u=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-u+a)/a)),n.x=Math.max(0,Math.min(1,(c-s)/i)),n}function $t(e){return _t(e)&&3===e.nodeType}function Kt(e){while(e.firstChild)e.removeChild(e.firstChild);return e}function Yt(e){return"function"===typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"===typeof e&&(e=e()),kt(e)||$t(e)?e:"string"===typeof e&&/\S/.test(e)?o.a.createTextNode(e):void 0})).filter((function(e){return e}))}function Xt(e,t){return Yt(t).forEach((function(t){return e.appendChild(t)})),e}function Jt(e,t){return Xt(Kt(e),t)}function Qt(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var Zt,en=Ot("querySelector"),tn=Ot("querySelectorAll"),nn=Object.freeze({__proto__:null,isReal:Et,isEl:kt,isInFrame:Rt,createEl:At,textContent:It,prependTo:Nt,hasClass:Dt,addClass:Pt,removeClass:Mt,toggleClass:Lt,setAttributes:jt,getAttributes:Bt,getAttribute:Ut,setAttribute:Ft,removeAttribute:Vt,blockTextSelection:qt,unblockTextSelection:Wt,getBoundingClientRect:zt,findPosition:Gt,getPointerPosition:Ht,isTextNode:$t,emptyEl:Kt,normalizeContent:Yt,appendContent:Xt,insertContent:Jt,isSingleLeftClick:Qt,$:en,$$:tn}),rn=!1,an=function(){if(Et()&&!1!==Zt.options.autoSetup){var e=Array.prototype.slice.call(o.a.getElementsByTagName("video")),t=Array.prototype.slice.call(o.a.getElementsByTagName("audio")),n=Array.prototype.slice.call(o.a.getElementsByTagName("video-js")),r=e.concat(t,n);if(r&&r.length>0)for(var i=0,a=r.length;i<a;i++){var s=r[i];if(!s||!s.getAttribute){on(1);break}if(void 0===s.player){var u=s.getAttribute("data-setup");null!==u&&Zt(s)}}else rn||on(1)}};function on(e,t){t&&(Zt=t),i.a.setTimeout(an,e)}function sn(){rn=!0,i.a.removeEventListener("load",sn)}Et()&&("complete"===o.a.readyState?sn():i.a.addEventListener("load",sn));var un,cn=function(e){var t=o.a.createElement("style");return t.className=e,t},ln=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},dn=3,pn=dn;function hn(){return pn++}i.a.WeakMap||(un=function(){function e(){this.vdata="vdata"+Math.floor(i.a.performance&&i.a.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||hn();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];ht("We have no data for this element",e)},t.has=function(e){var t=e[this.vdata];return t in this.data},t["delete"]=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var fn,mn=i.a.WeakMap?new WeakMap:new un;function vn(e,t){if(mn.has(e)){var n=mn.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&mn["delete"](e)}}function gn(e,t,n,r){n.forEach((function(n){e(t,n,r)}))}function yn(e){if(e.fixed_)return e;function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var r=e||i.a.event;for(var a in e={},r)"layerX"!==a&&"layerY"!==a&&"keyLocation"!==a&&"webkitMovementX"!==a&&"webkitMovementY"!==a&&("returnValue"===a&&r.preventDefault||(e[a]=r[a]));if(e.target||(e.target=e.srcElement||o.a),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var s=o.a.documentElement,u=o.a.body;e.pageX=e.clientX+(s&&s.scrollLeft||u&&u.scrollLeft||0)-(s&&s.clientLeft||u&&u.clientLeft||0),e.pageY=e.clientY+(s&&s.scrollTop||u&&u.scrollTop||0)-(s&&s.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var bn=function(){if("boolean"!==typeof fn){fn=!1;try{var e=Object.defineProperty({},"passive",{get:function(){fn=!0}});i.a.addEventListener("test",null,e),i.a.removeEventListener("test",null,e)}catch(t){}}return fn},_n=["touchstart","touchmove"];function wn(e,t,n){if(Array.isArray(t))return gn(wn,e,t,n);mn.has(e)||mn.set(e,{});var r=mn.get(e);if(r.handlers||(r.handlers={}),r.handlers[t]||(r.handlers[t]=[]),n.guid||(n.guid=hn()),r.handlers[t].push(n),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,n){if(!r.disabled){t=yn(t);var i=r.handlers[t.type];if(i)for(var a=i.slice(0),o=0,s=a.length;o<s;o++){if(t.isImmediatePropagationStopped())break;try{a[o].call(e,t,n)}catch(u){ht.error(u)}}}}),1===r.handlers[t].length)if(e.addEventListener){var i=!1;bn()&&_n.indexOf(t)>-1&&(i={passive:!0}),e.addEventListener(t,r.dispatcher,i)}else e.attachEvent&&e.attachEvent("on"+t,r.dispatcher)}function xn(e,t,n){if(mn.has(e)){var r=mn.get(e);if(r.handlers){if(Array.isArray(t))return gn(xn,e,t,n);var i=function(e,t){r.handlers[t]=[],vn(e,t)};if(void 0!==t){var a=r.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);vn(e,t)}else i(e,t)}else for(var s in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},s)&&i(e,s)}}}function Tn(e,t,n){var r=mn.has(e)?mn.get(e):{},i=e.parentNode||e.ownerDocument;if("string"===typeof t?t={type:t,target:e}:t.target||(t.target=e),t=yn(t),r.dispatcher&&r.dispatcher.call(e,t,n),i&&!t.isPropagationStopped()&&!0===t.bubbles)Tn.call(null,i,t,n);else if(!i&&!t.defaultPrevented&&t.target&&t.target[t.type]){mn.has(t.target)||mn.set(t.target,{});var a=mn.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"===typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function Cn(e,t,n){if(Array.isArray(t))return gn(Cn,e,t,n);var r=function r(){xn(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||hn(),wn(e,t,r)}function Sn(e,t,n){var r=function r(){xn(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||hn(),wn(e,t,r)}var En,kn=Object.freeze({__proto__:null,fixEvent:yn,on:wn,off:xn,trigger:Tn,one:Cn,any:Sn}),Rn=30,On=function(e,t,n){t.guid||(t.guid=hn());var r=t.bind(e);return r.guid=n?n+"_"+t.guid:t.guid,r},An=function(e,t){var n=i.a.performance.now(),r=function(){var r=i.a.performance.now();r-n>=t&&(e.apply(void 0,arguments),n=r)};return r},In=function(e,t,n,r){var a;void 0===r&&(r=i.a);var o=function(){r.clearTimeout(a),a=null},s=function(){var i=this,o=arguments,s=function(){a=null,s=null,n||e.apply(i,o)};!a&&n&&e.apply(i,o),r.clearTimeout(a),a=r.setTimeout(s,t)};return s.cancel=o,s},Nn=function(){};Nn.prototype.allowedEvents_={},Nn.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},wn(this,e,t),this.addEventListener=n},Nn.prototype.addEventListener=Nn.prototype.on,Nn.prototype.off=function(e,t){xn(this,e,t)},Nn.prototype.removeEventListener=Nn.prototype.off,Nn.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Cn(this,e,t),this.addEventListener=n},Nn.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Sn(this,e,t),this.addEventListener=n},Nn.prototype.trigger=function(e){var t=e.type||e;"string"===typeof e&&(e={type:t}),e=yn(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Tn(this,e)},Nn.prototype.dispatchEvent=Nn.prototype.trigger,Nn.prototype.queueTrigger=function(e){var t=this;En||(En=new Map);var n=e.type||e,r=En.get(this);r||(r=new Map,En.set(this,r));var a=r.get(n);r["delete"](n),i.a.clearTimeout(a);var o=i.a.setTimeout((function(){0===r.size&&(r=null,En["delete"](t)),t.trigger(e)}),0);r.set(n,o)};var Dn=function(e){return e instanceof Nn||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(t){return"function"===typeof e[t]}))},Pn=function(e,t){Dn(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))},Mn=function(e){return"string"===typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Ln=function(e){if(!e.nodeName&&!Dn(e))throw new Error("Invalid target; must be a DOM node or evented object.")},jn=function(e){if(!Mn(e))throw new Error("Invalid event type; must be a non-empty string or array.")},Bn=function(e){if("function"!==typeof e)throw new Error("Invalid listener; must be a function.")},Un=function(e,t){var n,r,i,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return a?(n=e.eventBusEl_,t.length>=3&&t.shift(),r=t[0],i=t[1]):(n=t[0],r=t[1],i=t[2]),Ln(n),jn(r),Bn(i),i=On(e,i),{isTargetingSelf:a,target:n,type:r,listener:i}},Fn=function(e,t,n,r){Ln(e),e.nodeName?kn[t](e,n,r):e[t](n,r)},Vn={on:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Un(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(Fn(o,"on",s,u),!a){var c=function(){return e.off(o,s,u)};c.guid=u.guid;var l=function(){return e.off("dispose",c)};l.guid=u.guid,Fn(this,"on","dispose",c),Fn(o,"on","dispose",l)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Un(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)Fn(o,"one",s,u);else{var c=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};c.guid=u.guid,Fn(o,"one",s,c)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Un(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)Fn(o,"any",s,u);else{var c=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};c.guid=u.guid,Fn(o,"any",s,c)}},off:function(e,t,n){if(!e||Mn(e))xn(this.eventBusEl_,e,t);else{var r=e,i=t;Ln(r),jn(i),Bn(n),n=On(this,n),this.off("dispose",n),r.nodeName?(xn(r,i,n),xn(r,"dispose",n)):Dn(r)&&(r.off(i,n),r.off("dispose",n))}},trigger:function(e,t){return Tn(this.eventBusEl_,e,t)}};function qn(e,t){void 0===t&&(t={});var n=t,r=n.eventBusKey;if(r){if(!e[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');e.eventBusEl_=e[r]}else e.eventBusEl_=At("span",{className:"vjs-event-bus"});return bt(e,Vn),e.eventedCallbacks&&e.eventedCallbacks.forEach((function(e){e()})),e.on("dispose",(function(){e.off(),i.a.setTimeout((function(){e.eventBusEl_=null}),0)})),e}var Wn={state:{},setState:function(e){var t,n=this;return"function"===typeof e&&(e=e()),gt(e,(function(e,r){n.state[r]!==e&&(t=t||{},t[r]={from:n.state[r],to:e}),n.state[r]=e})),t&&Dn(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function zn(e,t){return bt(e,Wn),e.state=bt({},e.state,t),"function"===typeof e.handleStateChanged&&Dn(e)&&e.on("statechanged",e.handleStateChanged),e}var Gn=function(e){return"string"!==typeof e?e:e.replace(/./,(function(e){return e.toLowerCase()}))},Hn=function(e){return"string"!==typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))},$n=function(e,t){return Hn(e)===Hn(t)};function Kn(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t&&gt(t,(function(t,n){wt(t)?(wt(e[n])||(e[n]={}),e[n]=Kn(e[n],t)):e[n]=t}))})),e}var Yn=function(){function e(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Kn({},this.options_),t=this.options_=Kn(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+hn()}var a;this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&qn(this,{eventBusKey:this.el_?"el_":null}),zn(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},i.a.Set||(a=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t["delete"]=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var n in this.set_)e.call(t,n,n,this)},e}()),this.setTimeoutIds_=i.a.Set?new Set:new a,this.setIntervalIds_=i.a.Set?new Set:new a,this.rafIds_=i.a.Set?new Set:new a,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var t=e.prototype;return t.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),mn.has(this.el_)&&mn["delete"](this.el_),this.el_=null),this.player_=null}},t.isDisposed=function(){return Boolean(this.isDisposed_)},t.player=function(){return this.player_},t.options=function(e){return e?(this.options_=Kn(this.options_,e),this.options_):this.options_},t.el=function(){return this.el_},t.createEl=function(e,t,n){return At(e,t,n)},t.localize=function(e,t,n){void 0===n&&(n=e);var r=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages(),a=i&&i[r],o=r&&r.split("-")[0],s=i&&i[o],u=n;return a&&a[e]?u=a[e]:s&&s[e]&&(u=s[e]),t&&(u=u.replace(/\{(\d+)\}/g,(function(e,n){var r=t[n-1],i=r;return"undefined"===typeof r&&(i=e),i}))),u},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(e){return this.childIndex_[e]},t.getChild=function(e){if(e)return this.childNameIndex_[e]},t.getDescendant=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce((function(e,t){return e.concat(t)}),[]);for(var r=this,i=0;i<t.length;i++)if(r=r.getChild(t[i]),!r||!r.getChild)return;return r},t.addChild=function(t,n,r){var i,a;if(void 0===n&&(n={}),void 0===r&&(r=this.children_.length),"string"===typeof t){a=Hn(t);var o=n.componentClass||a;n.name=a;var s=e.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!==typeof s)return null;i=new s(this.player_||this,n)}else i=t;if(i.parentComponent_&&i.parentComponent_.removeChild(i),this.children_.splice(r,0,i),i.parentComponent_=this,"function"===typeof i.id&&(this.childIndex_[i.id()]=i),a=a||i.name&&Hn(i.name()),a&&(this.childNameIndex_[a]=i,this.childNameIndex_[Gn(a)]=i),"function"===typeof i.el&&i.el()){var u=null;this.children_[r+1]&&(this.children_[r+1].el_?u=this.children_[r+1].el_:kt(this.children_[r+1])&&(u=this.children_[r+1])),this.contentEl().insertBefore(i.el(),u)}return i},t.removeChild=function(e){if("string"===typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Hn(e.name())]=null,this.childNameIndex_[Gn(e.name())]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},t.initChildren=function(){var t=this,n=this.options_.children;if(n){var r,i=this.options_,a=function(e){var n=e.name,r=e.opts;if(void 0!==i[n]&&(r=i[n]),!1!==r){!0===r&&(r={}),r.playerOptions=t.options_.playerOptions;var a=t.addChild(n,r);a&&(t[n]=a)}},o=e.getComponent("Tech");r=Array.isArray(n)?n:Object.keys(n),r.concat(Object.keys(this.options_).filter((function(e){return!r.some((function(t){return"string"===typeof t?e===t:e===t.name}))}))).map((function(e){var r,i;return"string"===typeof e?(r=e,i=n[r]||t.options_[r]||{}):(r=e.name,i=e),{name:r,opts:i}})).filter((function(t){var n=e.getComponent(t.opts.componentClass||Hn(t.name));return n&&!o.isTech(n)})).forEach(a)}},t.buildCSSClass=function(){return""},t.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},t.triggerReady=function(){this.isReady_=!0,this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)},t.$=function(e,t){return en(e,t||this.contentEl())},t.$$=function(e,t){return tn(e,t||this.contentEl())},t.hasClass=function(e){return Dt(this.el_,e)},t.addClass=function(e){Pt(this.el_,e)},t.removeClass=function(e){Mt(this.el_,e)},t.toggleClass=function(e,t){Lt(this.el_,e,t)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(e){return Ut(this.el_,e)},t.setAttribute=function(e,t){Ft(this.el_,e,t)},t.removeAttribute=function(e){Vt(this.el_,e)},t.width=function(e,t){return this.dimension("width",e,t)},t.height=function(e,t){return this.dimension("height",e,t)},t.dimensions=function(e,t){this.width(e,!0),this.height(t)},t.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t===t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],i=r.indexOf("px");return-1!==i?parseInt(r.slice(0,i),10):parseInt(this.el_["offset"+Hn(e)],10)},t.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=xt(this.el_,e),t=parseFloat(t),0===t||isNaN(t)){var n="offset"+Hn(e);t=this.el_[n]}return t},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},t.handleKeyPress=function(e){this.handleKeyDown(e)},t.emitTapEvents=function(){var e,t=0,n=null,r=10,a=200;this.on("touchstart",(function(r){1===r.touches.length&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},t=i.a.performance.now(),e=!0)})),this.on("touchmove",(function(t){if(t.touches.length>1)e=!1;else if(n){var i=t.touches[0].pageX-n.pageX,a=t.touches[0].pageY-n.pageY,o=Math.sqrt(i*i+a*a);o>r&&(e=!1)}}));var o=function(){e=!1};this.on("touchleave",o),this.on("touchcancel",o),this.on("touchend",(function(r){if(n=null,!0===e){var o=i.a.performance.now()-t;o<a&&(r.preventDefault(),this.trigger("tap"))}}))},t.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=On(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}));var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.setTimeout=function(e,t){var n,r=this;return e=On(this,e),this.clearTimersOnDispose_(),n=i.a.setTimeout((function(){r.setTimeoutIds_.has(n)&&r.setTimeoutIds_["delete"](n),e()}),t),this.setTimeoutIds_.add(n),n},t.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_["delete"](e),i.a.clearTimeout(e)),e},t.setInterval=function(e,t){e=On(this,e),this.clearTimersOnDispose_();var n=i.a.setInterval(e,t);return this.setIntervalIds_.add(n),n},t.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_["delete"](e),i.a.clearInterval(e)),e},t.requestAnimationFrame=function(e){var t,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=On(this,e),t=i.a.requestAnimationFrame((function(){n.rafIds_.has(t)&&n.rafIds_["delete"](t),e()})),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},t.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_["delete"](e),i.a.cancelAnimationFrame(e)),e):this.clearTimeout(e)},t.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(t){var n=t[0],r=t[1];e[n].forEach(e[r],e)})),e.clearingTimersOnDispose_=!1})))},e.registerComponent=function(t,n){if("string"!==typeof t||!t)throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.');var r,i=e.getComponent("Tech"),a=i&&i.isTech(n),o=e===n||e.prototype.isPrototypeOf(n.prototype);if(a||!o)throw r=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+t+'"; '+r+".");t=Hn(t),e.components_||(e.components_={});var s=e.getComponent("Player");if("Player"===t&&s&&s.players){var u=s.players,c=Object.keys(u);if(u&&c.length>0&&c.map((function(e){return u[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return e.components_[t]=n,e.components_[Gn(t)]=n,n},e.getComponent=function(t){if(t&&e.components_)return e.components_[t]},e}();Yn.prototype.supportsRaf_="function"===typeof i.a.requestAnimationFrame&&"function"===typeof i.a.cancelAnimationFrame,Yn.registerComponent("Component",Yn);var Xn=i.a.navigator&&i.a.navigator.userAgent||"",Jn=/AppleWebKit\/([\d.]+)/i.exec(Xn),Qn=Jn?parseFloat(Jn.pop()):null,Zn=/iPod/i.test(Xn),er=function(){var e=Xn.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),tr=/Android/i.test(Xn),nr=function(){var e=Xn.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),rr=tr&&nr<5&&Qn<537,ir=/Firefox/i.test(Xn),ar=/Edg/i.test(Xn),or=!ar&&(/Chrome/i.test(Xn)||/CriOS/i.test(Xn)),sr=function(){var e=Xn.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),ur=function(){var e=/MSIE\s(\d+)\.\d/.exec(Xn),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Xn)&&/rv:11.0/.test(Xn)&&(t=11),t}(),cr=/Safari/i.test(Xn)&&!or&&!tr&&!ar,lr=/Windows/i.test(Xn),dr=Et()&&("ontouchstart"in i.a||i.a.navigator.maxTouchPoints||i.a.DocumentTouch&&i.a.document instanceof i.a.DocumentTouch),pr=/iPad/i.test(Xn)||cr&&dr&&!/iPhone/i.test(Xn),hr=/iPhone/i.test(Xn)&&!pr,fr=hr||pr||Zn,mr=(cr||fr)&&!or,vr=Object.freeze({__proto__:null,IS_IPOD:Zn,IOS_VERSION:er,IS_ANDROID:tr,ANDROID_VERSION:nr,IS_NATIVE_ANDROID:rr,IS_FIREFOX:ir,IS_EDGE:ar,IS_CHROME:or,CHROME_VERSION:sr,IE_VERSION:ur,IS_SAFARI:cr,IS_WINDOWS:lr,TOUCH_ENABLED:dr,IS_IPAD:pr,IS_IPHONE:hr,IS_IOS:fr,IS_ANY_SAFARI:mr});function gr(e,t,n){if("number"!==typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}function yr(e,t,n,r){return gr(e,r,n.length-1),n[r][t]}function br(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:yr.bind(null,"start",0,e),end:yr.bind(null,"end",1,e)}}function _r(e,t){return Array.isArray(e)?br(e):void 0===e||void 0===t?br():br([[e,t]])}function wr(e,t){var n,r,i=0;if(!t)return 0;e&&e.length||(e=_r(0,0));for(var a=0;a<e.length;a++)n=e.start(a),r=e.end(a),r>t&&(r=t),i+=r-n;return i/t}for(var xr,Tr={prefixed:!0},Cr=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Sr=Cr[0],Er=0;Er<Cr.length;Er++)if(Cr[Er][1]in o.a){xr=Cr[Er];break}if(xr){for(var kr=0;kr<xr.length;kr++)Tr[Sr[kr]]=xr[kr];Tr.prefixed=xr[0]!==Sr[0]}function Rr(e){if(e instanceof Rr)return e;"number"===typeof e?this.code=e:"string"===typeof e?this.message=e:_t(e)&&("number"===typeof e.code&&(this.code=e.code),bt(this,e)),this.message||(this.message=Rr.defaultMessages[this.code]||"")}Rr.prototype.code=0,Rr.prototype.message="",Rr.prototype.status=null,Rr.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Rr.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Or=0;Or<Rr.errorTypes.length;Or++)Rr[Rr.errorTypes[Or]]=Or,Rr.prototype[Rr.errorTypes[Or]]=Or;function Ar(e){return void 0!==e&&null!==e&&"function"===typeof e.then}function Ir(e){Ar(e)&&e.then(null,(function(e){}))}var Nr=function(e){var t=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(t,n,r){return e[n]&&(t[n]=e[n]),t}),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))});return t},Dr=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,(function(e){return e.track})),r=Array.prototype.map.call(t,(function(e){var t=Nr(e.track);return e.src&&(t.src=e.src),t}));return r.concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===n.indexOf(e)})).map(Nr))},Pr=function(e,t){return e.forEach((function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((function(e){return n.addCue(e)}))})),t.textTracks()},Mr={textTracksToJson:Dr,jsonToTextTracks:Pr,trackToJson_:Nr},Lr="vjs-modal-dialog",jr=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=At("div",{className:Lr+"-content"},{role:"document"}),r.descEl_=At("p",{className:Lr+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),It(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return Lr+" vjs-hidden "+e.prototype.buildCSSClass.call(this)},n.label=function(){return this.localize(this.options_.label||"Modal Window")},n.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.opened=function(e){return"boolean"===typeof e&&this[e?"open":"close"](),this.opened_},n.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.closeable=function(e){if("boolean"===typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var r=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},n.fill=function(){this.fillWith(this.content())},n.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),Jt(t,e),this.trigger("modalfill"),r?n.insertBefore(t,r):n.appendChild(t);var i=this.getChild("closeButton");i&&n.appendChild(i.el_)},n.empty=function(){this.trigger("beforemodalempty"),Kt(this.contentEl()),this.trigger("modalempty")},n.content=function(e){return"undefined"!==typeof e&&(this.content_=e),this.content_},n.conditionalFocus_=function(){var e=o.a.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())},n.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},n.handleKeyDown=function(e){if(e.stopPropagation(),v.a.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(v.a.isEventKey(e,"Tab")){for(var t,n=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=0;i<n.length;i++)if(r===n[i]){t=i;break}o.a.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||t!==n.length-1||(n[0].focus(),e.preventDefault())}},n.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(function(e){return(e instanceof i.a.HTMLAnchorElement||e instanceof i.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof i.a.HTMLInputElement||e instanceof i.a.HTMLSelectElement||e instanceof i.a.HTMLTextAreaElement||e instanceof i.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof i.a.HTMLIFrameElement||e instanceof i.a.HTMLObjectElement||e instanceof i.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")}))},t}(Yn);jr.prototype.options_={pauseOnOpen:!0,temporary:!0},Yn.registerComponent("ModalDialog",jr);var Br=function(e){function t(t){var n;void 0===t&&(t=[]),n=e.call(this)||this,n.tracks_=[],Object.defineProperty(l()(n),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)n.addTrack(t[r]);return n}p()(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},n.removeTrack=function(e){for(var t,n=0,r=this.length;n<r;n++)if(this[n]===e){t=this[n],t.off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},t}(Nn);for(var Ur in Br.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Br.prototype.allowedEvents_)Br.prototype["on"+Ur]=null;var Fr=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},Vr=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].enabled){Fr(t,t[r]);break}return n=e.call(this,t)||this,n.changing_=!1,n}p()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&Fr(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,Fr(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Br),qr=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},Wr=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].selected){qr(t,t[r]);break}return n=e.call(this,t)||this,n.changing_=!1,Object.defineProperty(l()(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}p()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&qr(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,qr(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Br),zr=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_);var r=["metadata","chapters"];-1===r.indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Br),Gr=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,r=this.trackElements_.length;n<r;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"===typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"===typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),Hr=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,r=e.length;this.cues_=e,this.length_=e.length;var i=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<r)for(n=t;n<r;n++)i.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},e}(),$r={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Kr={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Yr={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Xr={disabled:"disabled",hidden:"hidden",showing:"showing"},Jr=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var r={id:t.id||"vjs_track_"+hn(),kind:t.kind||"",label:t.label||"",language:t.language||""},i=function(e){Object.defineProperty(l()(n),e,{get:function(){return r[e]},set:function(){}})};for(var a in r)i(a);return n}return p()(t,e),t}(Nn),Qr=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],n=o.a.createElement("a");n.href=e;var r,a=""===n.host&&"file:"!==n.protocol;a&&(r=o.a.createElement("div"),r.innerHTML='<a href="'+e+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),o.a.body.appendChild(r));for(var s={},u=0;u<t.length;u++)s[t[u]]=n[t[u]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=i.a.location.protocol),a&&o.a.body.removeChild(r),s},Zr=function(e){if(!e.match(/^https?:\/\//)){var t=o.a.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},ei=function(e){if("string"===typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,n=t.exec(e);if(n)return n.pop().toLowerCase()}return""},ti=function(e,t){void 0===t&&(t=i.a.location);var n=Qr(e),r=":"===n.protocol?t.protocol:n.protocol,a=r+n.host!==t.protocol+t.host;return a},ni=Object.freeze({__proto__:null,parseUrl:Qr,getAbsoluteURL:Zr,getFileExtension:ei,isCrossOrigin:ti}),ri=function(e,t){var n=new i.a.WebVTT.Parser(i.a,i.a.vttjs,i.a.WebVTT.StringDecoder()),r=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){r.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),r.length>0&&(i.a.console&&i.a.console.groupCollapsed&&i.a.console.groupCollapsed("Text Track parsing errors for "+t.src),r.forEach((function(e){return ht.error(e)})),i.a.console&&i.a.console.groupEnd&&i.a.console.groupEnd()),n.flush()},ii=function(e,t){var n={uri:e},r=ti(e);r&&(n.cors=r),y()(n,On(this,(function(e,n,r){if(e)return ht.error(e,n);t.loaded_=!0,"function"!==typeof i.a.WebVTT?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"!==e.type)return ri(r,t);ht.error("vttjs failed to load, stopping trying to process "+t.src)})):ri(r,t)})))},ai=function(e){function t(t){var n;if(void 0===t&&(t={}),!t.tech)throw new Error("A tech was not provided.");var r=Kn(t,{kind:Yr[t.kind]||"subtitles",language:t.language||t.srclang||""}),i=Xr[r.mode]||"disabled",a=r["default"];"metadata"!==r.kind&&"chapters"!==r.kind||(i="hidden"),n=e.call(this,r)||this,n.tech_=r.tech,n.cues_=[],n.activeCues_=[],n.preload_=!1!==n.tech_.preloadTextTracks;var o=new Hr(n.cues_),s=new Hr(n.activeCues_),u=!1,c=On(l()(n),(function(){this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1)}));return"disabled"!==i&&n.tech_.ready((function(){n.tech_.on("timeupdate",c)}),!0),Object.defineProperties(l()(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return i},set:function(e){var t=this;Xr[e]&&(i=e,this.preload_||"disabled"===i||0!==this.cues.length||ii(this.src,this),"disabled"!==i?this.tech_.ready((function(){t.tech_.on("timeupdate",c)}),!0):this.tech_.off("timeupdate",c),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?o:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],n=0,r=this.cues.length;n<r;n++){var i=this.cues[n];(i.startTime<=e&&i.endTime>=e||i.startTime===i.endTime&&i.startTime<=e&&i.startTime+.5>=e)&&t.push(i)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),r.src?(n.src=r.src,n.preload_||(n.loaded_=!0),(n.preload_||a||"subtitles"!==r.kind&&"captions"!==r.kind)&&ii(n.src,l()(n))):n.loaded_=!0,n}p()(t,e);var n=t.prototype;return n.addCue=function(e){var t=e;if(i.a.vttjs&&!(e instanceof i.a.vttjs.VTTCue)){for(var n in t=new i.a.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}for(var r=this.tech_.textTracks(),a=0;a<r.length;a++)r[a]!==this&&r[a].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},n.removeCue=function(e){var t=this.cues_.length;while(t--){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},t}(Jr);ai.prototype.allowedEvents_={cuechange:"cuechange"};var oi=function(e){function t(t){var n;void 0===t&&(t={});var r=Kn(t,{kind:Kr[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(l()(n),"enabled",{get:function(){return i},set:function(e){"boolean"===typeof e&&e!==i&&(i=e,this.trigger("enabledchange"))}}),r.enabled&&(n.enabled=r.enabled),n.loaded_=!0,n}return p()(t,e),t}(Jr),si=function(e){function t(t){var n;void 0===t&&(t={});var r=Kn(t,{kind:$r[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(l()(n),"selected",{get:function(){return i},set:function(e){"boolean"===typeof e&&e!==i&&(i=e,this.trigger("selectedchange"))}}),r.selected&&(n.selected=r.selected),n}return p()(t,e),t}(Jr),ui=0,ci=1,li=2,di=3,pi=function(e){function t(t){var n,r;void 0===t&&(t={}),n=e.call(this)||this;var i=new ai(t);return n.kind=i.kind,n.src=i.src,n.srclang=i.language,n.label=i.label,n["default"]=i["default"],Object.defineProperties(l()(n),{readyState:{get:function(){return r}},track:{get:function(){return i}}}),r=ui,i.addEventListener("loadeddata",(function(){r=li,n.trigger({type:"load",target:l()(n)})})),n}return p()(t,e),t}(Nn);pi.prototype.allowedEvents_={load:"load"},pi.NONE=ui,pi.LOADING=ci,pi.LOADED=li,pi.ERROR=di;var hi={audio:{ListClass:Vr,TrackClass:oi,capitalName:"Audio"},video:{ListClass:Wr,TrackClass:si,capitalName:"Video"},text:{ListClass:zr,TrackClass:ai,capitalName:"Text"}};Object.keys(hi).forEach((function(e){hi[e].getterName=e+"Tracks",hi[e].privateName=e+"Tracks_"}));var fi={remoteText:{ListClass:zr,TrackClass:ai,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Gr,TrackClass:pi,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},mi=u()({},hi,fi);function vi(e,t,n,r,i){void 0===i&&(i={});var a=e.textTracks();i.kind=t,n&&(i.label=n),r&&(i.language=r),i.tech=e;var o=new mi.text.TrackClass(i);return a.addTrack(o),o}fi.names=Object.keys(fi),hi.names=Object.keys(hi),mi.names=[].concat(fi.names).concat(hi.names);var gi=function(e){function t(t,n){var r;return void 0===t&&(t={}),void 0===n&&(n=function(){}),t.reportTouchActivity=!1,r=e.call(this,null,t,n)||this,r.hasStarted_=!1,r.on("playing",(function(){this.hasStarted_=!0})),r.on("loadstart",(function(){this.hasStarted_=!1})),mi.names.forEach((function(e){var n=mi[e];t&&t[n.getterName]&&(r[n.privateName]=t[n.getterName])})),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(e){!1===t["native"+e+"Tracks"]&&(r["featuresNative"+e+"Tracks"]=!1)})),!1===t.nativeCaptions||!1===t.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==t.nativeCaptions&&!0!==t.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.preloadTextTracks=!1!==t.preloadTextTracks,r.autoRemoteTextTracks_=new mi.text.ListClass,r.initTrackListeners(),t.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}p()(t,e);var n=t.prototype;return n.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",(function(){return t.setTimeout((function(){return t.triggerSourceset(e)}),1)})),this.trigger({src:e,type:"sourceset"})},n.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},n.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},n.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(On(this,(function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()})),500)},n.onDurationChange=function(e){this.duration_=this.duration()},n.buffered=function(){return _r(0,0)},n.bufferedPercent=function(){return wr(this.buffered(),this.duration_)},n.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},n.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},n.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},n.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)},n.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.dispose=function(){this.clearTracks(hi.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},n.clearTracks=function(e){var t=this;e=[].concat(e),e.forEach((function(e){var n=t[e+"Tracks"]()||[],r=n.length;while(r--){var i=n[r];"text"===e&&t.removeRemoteTextTrack(i),n.removeTrack(i)}}))},n.cleanupAutoTextTracks=function(){var e=this.autoRemoteTextTracks_||[],t=e.length;while(t--){var n=e[t];this.removeRemoteTextTrack(n)}},n.reset=function(){},n.error=function(e){return void 0!==e&&(this.error_=new Rr(e),this.trigger("error")),this.error_},n.played=function(){return this.hasStarted_?_r(0,0):_r()},n.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.initTrackListeners=function(){var e=this;hi.names.forEach((function(t){var n=hi[t],r=function(){e.trigger(t+"trackchange")},i=e[n.getterName]();i.addEventListener("removetrack",r),i.addEventListener("addtrack",r),e.on("dispose",(function(){i.removeEventListener("removetrack",r),i.removeEventListener("addtrack",r)}))}))},n.addWebVttScript_=function(){var e=this;if(!i.a.WebVTT)if(o.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&wt(_.a)&&Object.keys(_.a).length>0)return void this.trigger("vttjsloaded");var t=o.a.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",(function(){t.onload=null,t.onerror=null})),i.a.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},n.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),r=function(e){return t.addTrack(e.track)},i=function(e){return t.removeTrack(e.track)};n.on("addtrack",r),n.on("removetrack",i),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",(function(){n.off("addtrack",r),n.off("removetrack",i),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){var s=t[e];s.removeEventListener("cuechange",a)}}))},n.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return vi(this,e,t,n)},n.createRemoteTextTrack=function(e){var t=Kn(e,{tech:this});return new fi.remoteTextEl.TrackClass(t)},n.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(ht.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready((function(){return n.autoRemoteTextTracks_.addTrack(r.track)})),r},n.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},n.getVideoPlaybackQuality=function(){return{}},n.requestPictureInPicture=function(){var e=this.options_.Promise||i.a.Promise;if(e)return e.reject()},n.setPoster=function(){},n.playsinline=function(){},n.setPlaysinline=function(){},n.overrideNativeAudioTracks=function(){},n.overrideNativeVideoTracks=function(){},n.canPlayType=function(){return""},t.canPlayType=function(){return""},t.canPlaySource=function(e,n){return t.canPlayType(e.type)},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,n){if(t.techs_||(t.techs_={}),!t.isTech(n))throw new Error("Tech "+e+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Hn(e),t.techs_[e]=n,t.techs_[Gn(e)]=n,"Tech"!==e&&t.defaultTechOrder_.push(e),n},t.getTech=function(e){if(e)return t.techs_&&t.techs_[e]?t.techs_[e]:(e=Hn(e),i.a&&i.a.videojs&&i.a.videojs[e]?(ht.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),i.a.videojs[e]):void 0)},t}(Yn);mi.names.forEach((function(e){var t=mi[e];gi.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}})),gi.prototype.featuresVolumeControl=!0,gi.prototype.featuresMuteControl=!0,gi.prototype.featuresFullscreenResize=!1,gi.prototype.featuresPlaybackRate=!1,gi.prototype.featuresProgressEvents=!1,gi.prototype.featuresSourceset=!1,gi.prototype.featuresTimeupdateEvents=!1,gi.prototype.featuresNativeTextTracks=!1,gi.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var r=e.sourceHandlers;r||(r=e.sourceHandlers=[]),void 0===n&&(n=r.length),r.splice(n,0,t)},e.canPlayType=function(t){for(var n,r=e.sourceHandlers||[],i=0;i<r.length;i++)if(n=r[i].canPlayType(t),n)return n;return""},e.selectSourceHandler=function(t,n){for(var r,i=e.sourceHandlers||[],a=0;a<i.length;a++)if(r=i[a].canHandleSource(t,n),r)return i[a];return null},e.canPlaySource=function(t,n){var r=e.selectSourceHandler(t,n);return r?r.canHandleSource(t,n):""};var t=["seekable","seeking","duration"];t.forEach((function(e){var t=this[e];"function"===typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:ht.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Yn.registerComponent("Tech",gi),gi.registerTech("Tech",gi),gi.defaultTechOrder_=[];var yi={},bi={},_i={};function wi(e,t){yi[e]=yi[e]||[],yi[e].push(t)}function xi(e,t,n){e.setTimeout((function(){return Pi(t,yi[t.type],n,e)}),1)}function Ti(e,t){e.forEach((function(e){return e.setTech&&e.setTech(t)}))}function Ci(e,t,n){return e.reduceRight(Ai(n),t[n]())}function Si(e,t,n,r){return t[n](e.reduce(Ai(n),r))}function Ei(e,t,n,r){void 0===r&&(r=null);var i="call"+Hn(n),a=e.reduce(Ai(i),r),o=a===_i,s=o?null:t[n](a);return Ii(e,n,s,o),s}var ki={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},Ri={setCurrentTime:1,setMuted:1,setVolume:1},Oi={play:1,pause:1};function Ai(e){return function(t,n){return t===_i?_i:n[e]?n[e](t):t}}function Ii(e,t,n,r){for(var i=e.length-1;i>=0;i--){var a=e[i];a[t]&&a[t](r,n)}}function Ni(e){bi[e.id()]=null}function Di(e,t){var n=bi[e.id()],r=null;if(void 0===n||null===n)return r=t(e),bi[e.id()]=[[t,r]],r;for(var i=0;i<n.length;i++){var a=n[i],o=a[0],s=a[1];o===t&&(r=s)}return null===r&&(r=t(e),n.push([t,r])),r}function Pi(e,t,n,r,i,a){void 0===e&&(e={}),void 0===t&&(t=[]),void 0===i&&(i=[]),void 0===a&&(a=!1);var o=t,s=o[0],u=o.slice(1);if("string"===typeof s)Pi(e,yi[s],n,r,i,a);else if(s){var c=Di(r,s);if(!c.setSource)return i.push(c),Pi(e,u,n,r,i,a);c.setSource(bt({},e),(function(t,o){if(t)return Pi(e,u,n,r,i,a);i.push(c),Pi(o,e.type===o.type?u:yi[o.type],n,r,i,a)}))}else u.length?Pi(e,u,n,r,i,a):a?n(e,i):Pi(e,yi["*"],n,r,i,!0)}var Mi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Li=function(e){void 0===e&&(e="");var t=ei(e),n=Mi[t.toLowerCase()];return n||""},ji=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter((function(e){return e.src===t}));if(n.length)return n[0].type;for(var r=e.$$("source"),i=0;i<r.length;i++){var a=r[i];if(a.type&&a.src&&a.src===t)return a.type}return Li(t)},Bi=function e(t){if(Array.isArray(t)){var n=[];t.forEach((function(t){t=e(t),Array.isArray(t)?n=n.concat(t):_t(t)&&n.push(t)})),t=n}else t="string"===typeof t&&t.trim()?[Ui({src:t})]:_t(t)&&"string"===typeof t.src&&t.src&&t.src.trim()?[Ui(t)]:[];return t};function Ui(e){if(!e.type){var t=Li(e.src);t&&(e.type=t)}return e}var Fi=function(e){function t(t,n,r){var i,a=Kn({createEl:!1},n);if(i=e.call(this,t,a,r)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var u=Hn(s[o]),c=gi.getTech(u);if(u||(c=Yn.getComponent(u)),c&&c.isSupported()){t.loadTech_(u);break}}return i}return p()(t,e),t}(Yn);Yn.registerComponent("MediaLoader",Fi);var Vi=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.emitTapEvents(),r.enable(),r}p()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===r&&(r={}),n=bt({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&ht.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),r=bt({role:"button"},r),this.tabIndex_=n.tabIndex;var i=e.prototype.createEl.call(this,t,n,r);return this.createControlTextEl(i),i},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=At("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,It(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},n.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},n.handleKeyDown=function(t){v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Yn);Yn.registerComponent("ClickableComponent",Vi);var qi=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.update(),t.on("posterchange",On(l()(r),r.update)),r}p()(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){var e=At("div",{className:"vjs-poster",tabIndex:-1});return e},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(ur||ar)&&t||this.player_.tech(!0).focus(),this.player_.paused()?Ir(this.player_.play()):this.player_.pause()}},t}(Vi);Yn.registerComponent("PosterImage",qi);var Wi="#222",zi="#ccc",Gi={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Hi(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function $i(e,t,n){try{e.style[t]=n}catch(r){return}}var Ki=function(e){function t(t,n,r){var a;a=e.call(this,t,n,r)||this;var o=On(l()(a),a.updateDisplay);return t.on("loadstart",On(l()(a),a.toggleDisplay)),t.on("texttrackchange",o),t.on("loadedmetadata",On(l()(a),a.preselectTrack)),t.ready(On(l()(a),(function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)this.hide();else{t.on("fullscreenchange",o),t.on("playerresize",o),i.a.addEventListener("orientationchange",o),t.on("dispose",(function(){return i.a.removeEventListener("orientationchange",o)}));for(var e=this.options_.playerOptions.tracks||[],n=0;n<e.length;n++)this.player_.addRemoteTextTrack(e[n],!0);this.preselectTrack()}}))),a}p()(t,e);var n=t.prototype;return n.preselectTrack=function(){for(var e,t,n,r={captions:1,subtitles:1},i=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<i.length;o++){var s=i[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in r?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s["default"]&&("descriptions"!==s.kind||e?s.kind in r&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},n.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},n.clearDisplay=function(){"function"===typeof i.a.WebVTT&&i.a.WebVTT.processCues(i.a,[],this.el_)},n.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],r=0;r<e.length;++r){var i=e[r];"showing"===i.mode&&n.push(i)}this.updateForTrack(n)}else{var a=null,o=null,s=e.length;while(s--){var u=e[s];"showing"===u.mode&&("descriptions"===u.kind?a=u:o=u)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},n.updateDisplayState=function(e){var t=this.player_.textTrackSettings.getValues(),n=e.activeCues,r=n.length;while(r--){var a=n[r];if(a){var o=a.displayState;if(t.color&&(o.firstChild.style.color=t.color),t.textOpacity&&$i(o.firstChild,"color",Hi(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(o.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&$i(o.firstChild,"backgroundColor",Hi(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?$i(o,"backgroundColor",Hi(t.windowColor,t.windowOpacity)):o.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px "+Wi+", 2px 2px 4px "+Wi+", 2px 2px 5px "+Wi:"raised"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px "+Wi+", 2px 2px "+Wi+", 3px 3px "+Wi:"depressed"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px "+zi+", 0 1px "+zi+", -1px -1px "+Wi+", 0 -1px "+Wi:"uniform"===t.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px "+Wi+", 0 0 4px "+Wi+", 0 0 4px "+Wi+", 0 0 4px "+Wi)),t.fontPercent&&1!==t.fontPercent){var s=i.a.parseFloat(o.style.fontSize);o.style.fontSize=s*t.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=Gi[t.fontFamily])}}},n.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"===typeof i.a.WebVTT&&!e.every((function(e){return!e.activeCues}))){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],a=0;a<r.activeCues.length;++a)t.push(r.activeCues[a]);i.a.WebVTT.processCues(i.a,t,this.el_);for(var o=0;o<e.length;++o){for(var s=e[o],u=0;u<s.activeCues.length;++u){var c=s.activeCues[u].displayState;Pt(c,"vjs-text-track-cue"),Pt(c,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},t}(Yn);Yn.registerComponent("TextTrackDisplay",Ki);var Yi=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),r=At("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),i=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(r),i},t}(Yn);Yn.registerComponent("LoadingSpinner",Yi);var Xi=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),e="button",t=bt({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=bt({type:"button"},n);var r=Yn.prototype.createEl.call(this,e,t,n);return this.createControlTextEl(r),r},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return ht.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),Yn.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(Vi);Yn.registerComponent("Button",Xi);var Ji=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return Ir(t),void(!this.player_.tech(!0)||(ur||ar)&&n||this.player_.tech(!0).focus())}var r=this.player_.getChild("controlBar"),i=r&&r.getChild("playToggle");if(i){var a=function(){return i.focus()};Ar(t)?t.then(a,(function(){})):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(Xi);Ji.prototype.controlText_="Play Video",Yn.registerComponent("BigPlayButton",Ji);var Qi=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.controlText(n&&n.controlText||r.localize("Close")),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){v.a.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Xi);Yn.registerComponent("CloseButton",Qi);var Zi=function(e){function t(t,n){var r;return void 0===n&&(n={}),r=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,r.on(t,"play",r.handlePlay),r.on(t,"pause",r.handlePause),n.replay&&r.on(t,"ended",r.handleEnded),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(Xi);Zi.prototype.controlText_="Play",Yn.registerComponent("PlayToggle",Zi);var ea=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(i=r=n="-"),i=i>0||o>0?i+":":"",r=((i||a>=10)&&r<10?"0"+r:r)+":",n=n<10?"0"+n:n,i+r+n},ta=ea;function na(e){ta=e}function ra(){ta=ea}function ia(e,t){return void 0===t&&(t=e),ta(e,t)}var aa=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,["timeupdate","ended"],r.updateContent),r.updateTextNode_(),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=At("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),n.appendChild(this.contentEl_),n},n.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},n.updateTextNode_=function(e){var t=this;void 0===e&&(e=0),e=ia(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestAnimationFrame((function(){if(t.contentEl_){var e=t.textNode_;t.textNode_=o.a.createTextNode(t.formattedTime_),t.textNode_&&(e?t.contentEl_.replaceChild(t.textNode_,e):t.contentEl_.appendChild(t.textNode_))}})))},n.updateContent=function(e){},t}(Yn);aa.prototype.labelText_="Time",aa.prototype.controlText_="Time",Yn.registerComponent("TimeDisplay",aa);var oa=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(aa);oa.prototype.labelText_="Current Time",oa.prototype.controlText_="Current Time",Yn.registerComponent("CurrentTimeDisplay",oa);var sa=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,"durationchange",r.updateContent),r.on(t,"loadstart",r.updateContent),r.on(t,"loadedmetadata",r.updateContent),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},t}(aa);sa.prototype.labelText_="Duration",sa.prototype.controlText_="Duration",Yn.registerComponent("DurationDisplay",sa);var ua=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(Yn);Yn.registerComponent("TimeDivider",ua);var ca=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,"durationchange",r.updateContent),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(At("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){var t;"number"===typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},t}(aa);ca.prototype.labelText_="Remaining Time",ca.prototype.controlText_="Remaining Time",Yn.registerComponent("RemainingTimeDisplay",ca);var la=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=At("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Yn);Yn.registerComponent("LiveDisplay",la);var da=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.updateLiveEdgeStatus(),r.player_.liveTracker&&r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatus),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=At("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(Xi);da.prototype.controlText_="Seek to live, currently playing live",Yn.registerComponent("SeekToLive",da);var pa=function(e,t,n){return e=Number(e),Math.min(n,Math.max(t,isNaN(e)?t:e))},ha=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}p()(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),n.className=n.className+" vjs-slider",n=bt({tabIndex:0},n),r=bt({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),e.prototype.createEl.call(this,t,n,r)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||or||e.preventDefault(),qt(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;Wt(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){var e=this;if(this.el_&&this.bar){var t=this.getProgress();return t===this.progress_||(this.progress_=t,this.requestAnimationFrame((function(){var n=e.vertical()?"height":"width";e.bar.el().style[n]=(100*t).toFixed(2)+"%"}))),t}},n.getProgress=function(){return Number(pa(this.getPercent(),0,1).toFixed(4))},n.calculateDistance=function(e){var t=Ht(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){v.a.isEventKey(t,"Left")||v.a.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):v.a.isEventKey(t,"Right")||v.a.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(Yn);Yn.registerComponent("Slider",ha);var fa=function(e,t){return pa(e/t*100,0,100).toFixed(2)+"%"},ma=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.partEls_=[],r.on(t,"progress",r.update),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),n=At("span",{className:"vjs-control-text"}),r=At("span",{textContent:this.localize("Loaded")}),i=o.a.createTextNode(": ");return this.percentageEl_=At("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(n),n.appendChild(r),n.appendChild(i),n.appendChild(this.percentageEl_),t},n.dispose=function(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this;this.requestAnimationFrame((function(){var e=t.player_.liveTracker,n=t.player_.buffered(),r=e&&e.isLive()?e.seekableEnd():t.player_.duration(),i=t.player_.bufferedEnd(),a=t.partEls_,o=fa(i,r);t.percent_!==o&&(t.el_.style.width=o,It(t.percentageEl_,o),t.percent_=o);for(var s=0;s<n.length;s++){var u=n.start(s),c=n.end(s),l=a[s];l||(l=t.el_.appendChild(At()),a[s]=l),l.dataset.start===u&&l.dataset.end===c||(l.dataset.start=u,l.dataset.end=c,l.style.left=fa(u,i),l.style.width=fa(c-u,i))}for(var d=a.length;d>n.length;d--)t.el_.removeChild(a[d-1]);a.length=n.length}))},t}(Yn);Yn.registerComponent("LoadProgressBar",ma);var va=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.update=An(On(l()(r),r.update),Rn),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var r=zt(this.el_),i=zt(this.player_.el()),a=e.width*t;if(i&&r){var o=e.left-i.left+a,s=e.width-a+(i.right-e.right),u=r.width/2;o<u?u+=u-o:s<u&&(u=s),u<0?u=0:u>r.width&&(u=r.width),this.el_.style.right="-"+u+"px",this.write(n)}},n.write=function(e){It(this.el_,e)},n.updateTime=function(e,t,n,r){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame((function(){var a,o=i.player_.duration();if(i.player_.liveTracker&&i.player_.liveTracker.isLive()){var s=i.player_.liveTracker.liveWindow(),u=s-t*s;a=(u<1?"":"-")+ia(u,s)}else a=ia(n,o);i.update(e,t,a),r&&r()}))},t}(Yn);Yn.registerComponent("TimeTooltip",va);var ga=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.update=An(On(l()(r),r.update),Rn),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,r)}},t}(Yn);ga.prototype.options_={children:[]},fr||tr||ga.prototype.options_.children.push("timeTooltip"),Yn.registerComponent("PlayProgressBar",ga);var ya=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.update=An(On(l()(r),r.update),Rn),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,(function(){n.el_.style.left=e.width*t+"px"}))},t}(Yn);ya.prototype.options_={children:["timeTooltip"]},Yn.registerComponent("MouseTimeDisplay",ya);var ba=5,_a=12,wa=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.setEventHandlers_(),r}p()(t,e);var n=t.prototype;return n.setEventHandlers_=function(){this.update_=On(this,this.update),this.update=An(this.update_,Rn),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.on(o.a,"visibilitychange",this.toggleVisibility_)},n.toggleVisibility_=function(e){o.a.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},n.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Rn))},n.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update=function(t){var n=this,r=e.prototype.update.call(this);return this.requestAnimationFrame((function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),t=n.player_.liveTracker,i=n.player_.duration();t&&t.isLive()&&(i=n.player_.liveTracker.liveCurrentTime()),n.percent_!==r&&(n.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),n.percent_=r),n.currentTime_===e&&n.duration_===i||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[ia(e,i),ia(i,i)],"{1} of {2}")),n.currentTime_=e,n.duration_=i),n.bar&&n.bar.update(zt(n.el()),n.getProgress())})),r},n.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},n.handleMouseDown=function(t){Qt(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},n.handleMouseMove=function(e){if(Qt(e)){var t,n=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){if(n>=.99)return void r.seekToLiveEdge();var i=r.seekableStart(),a=r.liveCurrentTime();if(t=i+n*r.liveWindow(),t>=a&&(t=a),t<=i&&(t=i+.1),t===1/0)return}else t=n*this.player_.duration(),t===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Ir(this.player_.play()):this.update_()},n.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+ba)},n.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-ba)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyDown=function(t){if(v.a.isEventKey(t,"Space")||v.a.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(v.a.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(v.a.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(v()(t))){t.preventDefault(),t.stopPropagation();var n=10*(v.a.codes[v()(t)]-v.a.codes["0"])/100;this.player_.currentTime(this.player_.duration()*n)}else v.a.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-ba*_a)):v.a.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+ba*_a)):e.prototype.handleKeyDown.call(this,t)},n.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.off(o.a,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},t}(ha);wa.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},fr||tr||wa.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Yn.registerComponent("SeekBar",wa);var xa=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.handleMouseMove=An(On(l()(r),r.handleMouseMove),Rn),r.throttledHandleMouseSeek=An(On(l()(r),r.handleMouseSeek),Rn),r.enable(),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay");if(n||r){var i=t.el(),a=zt(i),o=Ht(i,e).x;o=pa(0,1,o),r&&r.update(a,o),n&&n.update(a,t.getProgress())}}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach((function(e){return e.disable&&e.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach((function(e){return e.enable&&e.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(Yn);xa.prototype.options_={children:["seekBar"]},Yn.registerComponent("ProgressControl",xa);var Ta=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),o.a.pictureInPictureEnabled||r.disable(),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},n.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},n.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},t}(Xi);Ta.prototype.controlText_="Picture-in-Picture",Yn.registerComponent("PictureInPictureToggle",Ta);var Ca=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,"fullscreenchange",r.handleFullscreenChange),!1===o.a[t.fsApi_.fullscreenEnabled]&&r.disable(),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},n.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},n.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(Xi);Ca.prototype.controlText_="Fullscreen",Yn.registerComponent("FullscreenToggle",Ca);var Sa=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))},Ea=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Yn);Yn.registerComponent("VolumeLevel",Ea);var ka=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on("slideractive",r.updateLastVolume_),r.on(t,"volumechange",r.updateARIAAttributes),t.ready((function(){return r.updateARIAAttributes()})),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Qt(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Qt(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",(function(){0===e.player_.volume()&&e.player_.lastVolume_(t)}))},t}(ha);ka.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},ka.prototype.playerEvent="volumechange",Yn.registerComponent("VolumeBar",ka);var Ra=function(e){function t(t,n){var r;return void 0===n&&(n={}),n.vertical=n.vertical||!1,("undefined"===typeof n.volumeBar||wt(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),r=e.call(this,t,n)||this,Sa(l()(r),t),r.throttledHandleMouseMove=An(On(l()(r),r.handleMouseMove),Rn),r.on("mousedown",r.handleMouseDown),r.on("touchstart",r.handleMouseDown),r.on(r.volumeBar,["focus","slideractive"],(function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")})),r.on(r.volumeBar,["blur","sliderinactive"],(function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")})),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Yn);Ra.prototype.options_={children:["volumeBar"]},Yn.registerComponent("VolumeControl",Ra);var Oa=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))},Aa=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,Oa(l()(r),t),r.on(t,["loadstart","volumechange"],r.update),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var r=n<.1?.1:n;this.player_.volume(r),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;fr&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)Mt(this.el_,"vjs-vol-"+n);Pt(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume(),t=e?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)},t}(Xi);Aa.prototype.controlText_="Mute",Yn.registerComponent("MuteToggle",Aa);var Ia=function(e){function t(t,n){var r;return void 0===n&&(n={}),"undefined"!==typeof n.inline?n.inline=n.inline:n.inline=!0,("undefined"===typeof n.volumeControl||wt(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),r=e.call(this,t,n)||this,r.on(t,["loadstart"],r.volumePanelState_),r.on(r.muteToggle,"keyup",r.handleKeyPress),r.on(r.volumeControl,"keyup",r.handleVolumeControlKeyUp),r.on("keydown",r.handleKeyPress),r.on("mouseover",r.handleMouseOver),r.on("mouseout",r.handleMouseOut),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}p()(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},n.dispose=function(){this.handleMouseOut(),e.prototype.dispose.call(this)},n.handleVolumeControlKeyUp=function(e){v.a.isEventKey(e,"Esc")&&this.muteToggle.focus()},n.handleMouseOver=function(e){this.addClass("vjs-hover"),wn(o.a,"keyup",On(this,this.handleKeyPress))},n.handleMouseOut=function(e){this.removeClass("vjs-hover"),xn(o.a,"keyup",On(this,this.handleKeyPress))},n.handleKeyPress=function(e){v.a.isEventKey(e,"Esc")&&this.handleMouseOut()},t}(Yn);Ia.prototype.options_={children:["muteToggle","volumeControl"]},Yn.registerComponent("VolumePanel",Ia);var Na=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,n&&(r.menuButton_=n.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyDown),r.boundHandleBlur_=On(l()(r),r.handleBlur),r.boundHandleTapClick_=On(l()(r),r.handleTapClick),r}p()(t,e);var n=t.prototype;return n.addEventListenerForItem=function(e){e instanceof Yn&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},n.removeEventListenerForItem=function(e){e instanceof Yn&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},n.removeChild=function(t){"string"===typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},n.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},n.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=At(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),wn(n,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),n},n.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},n.handleBlur=function(e){var t=e.relatedTarget||o.a.activeElement;if(!this.children().some((function(e){return e.el()===t}))){var n=this.menuButton_;n&&n.buttonPressed_&&t!==n.el().firstChild&&n.unpressButton()}},n.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter((function(t){return t.el()===e.target}))[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},n.handleKeyDown=function(e){v.a.isEventKey(e,"Left")||v.a.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(v.a.isEventKey(e,"Right")||v.a.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},n.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.focus=function(e){void 0===e&&(e=0);var t=this.children().slice(),n=t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className);n&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(Yn);Yn.registerComponent("Menu",Na);var Da=function(e){function t(t,n){var r;void 0===n&&(n={}),r=e.call(this,t,n)||this,r.menuButton_=new Xi(t,n),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var i=Xi.prototype.buildCSSClass();return r.menuButton_.el_.className=r.buildCSSClass()+" "+i,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0,r.on(r.menuButton_,"tap",r.handleClick),r.on(r.menuButton_,"click",r.handleClick),r.on(r.menuButton_,"keydown",r.handleKeyDown),r.on(r.menuButton_,"mouseenter",(function(){r.addClass("vjs-hover"),r.menu.show(),wn(o.a,"keyup",On(l()(r),r.handleMenuKeyUp))})),r.on("mouseleave",r.handleMouseLeave),r.on("keydown",r.handleSubmenuKeyDown),r}p()(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Na(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=At("li",{className:"vjs-menu-title",innerHTML:Hn(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new Yn(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";!0===this.options_.inline?t+="-inline":t+="-popup";var n=Xi.prototype.buildCSSClass();return"vjs-menu-button "+t+" "+n+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.dispose=function(){this.handleMouseLeave(),e.prototype.dispose.call(this)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.handleMouseLeave=function(e){this.removeClass("vjs-hover"),xn(o.a,"keyup",On(this,this.handleMenuKeyUp))},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),v.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(v.a.isEventKey(e,"Up")||v.a.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleMenuKeyUp=function(e){(v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(v.a.isEventKey(e,"Esc")||v.a.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),v.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),fr&&Rt())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(Yn);Yn.registerComponent("MenuButton",Da);var Pa=function(e){function t(t,n){var r,i=n.tracks;if(r=e.call(this,t,n)||this,r.items.length<=1&&r.hide(),!i)return l()(r);var a=On(l()(r),r.update);return i.addEventListener("removetrack",a),i.addEventListener("addtrack",a),r.player_.on("ready",a),r.player_.on("dispose",(function(){i.removeEventListener("removetrack",a),i.removeEventListener("addtrack",a)})),r}return p()(t,e),t}(Da);Yn.registerComponent("TrackButton",Pa);var Ma=["Tab","Esc","Up","Down","Right","Left"],La=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.selectable=n.selectable,r.isSelected_=n.selected||!1,r.multiSelectable=n.multiSelectable,r.selected(r.isSelected_),r.selectable?r.multiSelectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitemradio"):r.el_.setAttribute("role","menuitem"),r}p()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",bt({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),r)},n.handleKeyDown=function(t){Ma.some((function(e){return v.a.isEventKey(t,e)}))||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(Vi);Yn.registerComponent("MenuItem",La);var ja=function(e){function t(t,n){var r,a=n.track,s=t.textTracks();n.label=a.label||a.language||"Unknown",n.selected="showing"===a.mode,r=e.call(this,t,n)||this,r.track=a,r.kinds=(n.kinds||[n.kind||r.track.kind]).filter(Boolean);var u,c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(l()(r),t)},d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleSelectedLanguageChange.apply(l()(r),t)};(t.on(["loadstart","texttrackchange"],c),s.addEventListener("change",c),s.addEventListener("selectedlanguagechange",d),r.on("dispose",(function(){t.off(["loadstart","texttrackchange"],c),s.removeEventListener("change",c),s.removeEventListener("selectedlanguagechange",d)})),void 0===s.onchange)&&r.on(["tap","click"],(function(){if("object"!==typeof i.a.Event)try{u=new i.a.Event("change")}catch(e){}u||(u=o.a.createEvent("Event"),u.initEvent("change",!0,!0)),s.dispatchEvent(u)}));return r.handleTracksChange(),r}p()(t,e);var n=t.prototype;return n.handleClick=function(t){var n=this.track,r=this.player_.textTracks();if(e.prototype.handleClick.call(this,t),r)for(var i=0;i<r.length;i++){var a=r[i];-1!==this.kinds.indexOf(a.kind)&&(a===n?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},n.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},n.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},n.dispose=function(){this.track=null,e.prototype.dispose.call(this)},t}(La);Yn.registerComponent("TextTrackMenuItem",ja);var Ba=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}p()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(ja);Yn.registerComponent("OffTextTrackMenuItem",Ba);var Ua=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}p()(t,e);var n=t.prototype;return n.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=ja),this.label_&&(n=this.label_+" off"),e.push(new Ba(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<r.length;i++){var a=r[i];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Pa);Yn.registerComponent("TextTrackButton",Ua);var Fa=function(e){function t(t,n){var r,i=n.track,a=n.cue,o=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=o&&o<a.endTime,r=e.call(this,t,n)||this,r.track=i,r.cue=a,i.addEventListener("cuechange",On(l()(r),r.update)),r}p()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(La);Yn.registerComponent("ChaptersTrackMenuItem",Fa);var Va=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Hn(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,r=t.length;n<r;n++){var i=t[n],a=new Fa(this.player_,{track:this.track_,cue:i});e.push(a)}return e},t}(Ua);Va.prototype.kind_="chapters",Va.prototype.controlText_="Chapters",Yn.registerComponent("ChaptersButton",Va);var qa=function(e){function t(t,n,r){var i;i=e.call(this,t,n,r)||this;var a=t.textTracks(),o=On(l()(i),i.handleTracksChange);return a.addEventListener("change",o),i.on("dispose",(function(){a.removeEventListener("change",o)})),i}p()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,r=0,i=t.length;r<i;r++){var a=t[r];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Ua);qa.prototype.kind_="descriptions",qa.prototype.controlText_="Descriptions",Yn.registerComponent("DescriptionsButton",qa);var Wa=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Ua);Wa.prototype.kind_="subtitles",Wa.prototype.controlText_="Subtitles",Yn.registerComponent("SubtitlesButton",Wa);var za=function(e){function t(t,n){var r;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",r=e.call(this,t,n)||this,r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+n.kind+" settings dialog"),r}p()(t,e);var n=t.prototype;return n.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(ja);Yn.registerComponent("CaptionSettingsMenuItem",za);var Ga=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new za(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Ua);Ga.prototype.kind_="captions",Ga.prototype.controlText_="Captions",Yn.registerComponent("CaptionsButton",Ga);var Ha=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);"captions"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),i+="</span>";var a=e.prototype.createEl.call(this,t,bt({innerHTML:i},n),r);return a},t}(ja);Yn.registerComponent("SubsCapsMenuItem",Ha);var $a=function(e){function t(t,n){var r;return void 0===n&&(n={}),r=e.call(this,t,n)||this,r.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(Hn(r.label_)),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new za(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=e.prototype.createItems.call(this,t,Ha),t},t}(Ua);$a.prototype.kinds_=["captions","subtitles"],$a.prototype.controlText_="Subtitles",Yn.registerComponent("SubsCapsButton",$a);var Ka=function(e){function t(t,n){var r,i=n.track,a=t.audioTracks();n.label=i.label||i.language||"Unknown",n.selected=i.enabled,r=e.call(this,t,n)||this,r.track=i,r.addClass("vjs-"+i.kind+"-menu-item");var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(l()(r),t)};return a.addEventListener("change",o),r.on("dispose",(function(){a.removeEventListener("change",o)})),r}p()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);"main-desc"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),i+="</span>";var a=e.prototype.createEl.call(this,t,bt({innerHTML:i},n),r);return a},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var r=0;r<n.length;r++){var i=n[r];i.enabled=i===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(La);Yn.registerComponent("AudioTrackMenuItem",Ka);var Ya=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var r=t[n];e.push(new Ka(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e},t}(Pa);Ya.prototype.controlText_="Audio Track",Yn.registerComponent("AudioTrackButton",Ya);var Xa=function(e){function t(t,n){var r,i=n.rate,a=parseFloat(i,10);return n.label=i,n.selected=1===a,n.selectable=!0,n.multiSelectable=!1,r=e.call(this,t,n)||this,r.label=i,r.rate=a,r.on(t,"ratechange",r.update),r}p()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(La);Xa.prototype.contentElType="button",Yn.registerComponent("PlaybackRateMenuItem",Xa);var Ja=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.updateVisibility(),r.updateLabel(),r.on(t,"loadstart",r.updateVisibility),r.on(t,"ratechange",r.updateLabel),r}p()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=At("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Na(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new Xa(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),r=n[0],i=0;i<n.length;i++)if(n[i]>t){r=n[i];break}this.player().playbackRate(r)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Da);Ja.prototype.controlText_="Playback Rate",Yn.registerComponent("PlaybackRateMenuButton",Ja);var Qa=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Yn);Yn.registerComponent("Spacer",Qa);var Za=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML=" ",t},t}(Qa);Yn.registerComponent("CustomControlSpacer",Za);var eo=function(e){function t(){return e.apply(this,arguments)||this}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Yn);eo.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in o.a&&eo.prototype.options_.children.splice(eo.prototype.options_.children.length-1,0,"pictureInPictureToggle"),Yn.registerComponent("ControlBar",eo);var to=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,r.on(t,"error",r.open),r}p()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(jr);to.prototype.options_=u()({},jr.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Yn.registerComponent("ErrorDisplay",to);var no="vjs-text-track-settings",ro=["#000","Black"],io=["#00F","Blue"],ao=["#0FF","Cyan"],oo=["#0F0","Green"],so=["#F0F","Magenta"],uo=["#F00","Red"],co=["#FFF","White"],lo=["#FF0","Yellow"],po=["1","Opaque"],ho=["0.5","Semi-Transparent"],fo=["0","Transparent"],mo={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ro,co,uo,oo,io,lo,so,ao]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[po,ho,fo]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[co,ro,uo,oo,io,lo,so,ao]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[po,ho]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[fo,ho,po]}};function vo(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}function go(e,t){var n=e.options[e.options.selectedIndex].value;return vo(n,t)}function yo(e,t,n){if(t)for(var r=0;r<e.options.length;r++)if(vo(e.options[r].value,n)===t){e.selectedIndex=r;break}}mo.windowColor.options=mo.backgroundColor.options;var bo=function(e){function t(t,n){var r;return n.temporary=!1,r=e.call(this,t,n)||this,r.updateDisplay=On(l()(r),r.updateDisplay),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=At("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===n.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",(function(){r.saveSettings(),r.close()})),r.on(r.$(".vjs-default-button"),"click",(function(){r.setDefaults(),r.updateDisplay()})),gt(mo,(function(e){r.on(r.$(e.selector),"change",r.updateDisplay)})),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}p()(t,e);var n=t.prototype;return n.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},n.createElSelect_=function(e,t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n="label");var i=mo[e],a=i.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(i.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(i.options.map((function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")},n.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},n.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},n.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},n.createElColors_=function(){return At("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},n.createElFont_=function(){return At("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},n.createElControls_=function(){var e=this.localize("restore all settings to the default values");return At("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},n.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.label=function(){return this.localize("Caption Settings Dialog")},n.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.getValues=function(){var e=this;return yt(mo,(function(t,n,r){var i=go(e.$(n.selector),n.parser);return void 0!==i&&(t[r]=i),t}),{})},n.setValues=function(e){var t=this;gt(mo,(function(n,r){yo(t.$(n.selector),e[r],n.parser)}))},n.setDefaults=function(){var e=this;gt(mo,(function(t){var n=t.hasOwnProperty("default")?t["default"]:0;e.$(t.selector).selectedIndex=n}))},n.restoreSettings=function(){var e;try{e=JSON.parse(i.a.localStorage.getItem(no))}catch(t){ht.warn(t)}e&&this.setValues(e)},n.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?i.a.localStorage.setItem(no,JSON.stringify(e)):i.a.localStorage.removeItem(no)}catch(t){ht.warn(t)}}},n.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},t}(jr);Yn.registerComponent("TextTrackSettings",bo);var _o=function(e){function t(t,n){var r,a=n.ResizeObserver||i.a.ResizeObserver;null===n.ResizeObserver&&(a=!1);var o=Kn({createEl:!a,reportTouchActivity:!1},n);return r=e.call(this,t,o)||this,r.ResizeObserver=n.ResizeObserver||i.a.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=In((function(){r.resizeHandler()}),100,!1,l()(r)),a?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(t.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){xn(this,"resize",e),xn(this,"unload",t),t=null};wn(r.el_.contentWindow,"unload",t),wn(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}p()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},n.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},n.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,e.prototype.dispose.call(this)},t}(Yn);Yn.registerComponent("ResizeManager",_o);var wo={trackingThreshold:30,liveTolerance:15},xo=function(e){function t(t,n){var r,i=Kn(wo,n,{createEl:!1});return r=e.call(this,t,i)||this,r.reset_(),r.on(r.player_,"durationchange",r.handleDurationchange),ur&&"hidden"in o.a&&"visibilityState"in o.a&&r.on(o.a,"visibilitychange",r.handleVisibilityChange),r}p()(t,e);var n=t.prototype;return n.handleVisibilityChange=function(){this.player_.duration()===1/0&&(o.a.hidden?this.stopTracking():this.startTracking())},n.trackLive_=function(){var e=this.player_.seekable();if(e&&e.length){var t=Number(i.a.performance.now().toFixed(4)),n=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+n;var r=this.liveCurrentTime(),a=this.player_.currentTime(),o=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-a)>this.options_.liveTolerance;this.timeupdateSeen_&&r!==1/0||(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}},n.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},n.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,Rn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},n.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},n.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&e>2,this.skipNextSeeked_=!1,this.trackLive_()},n.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},n.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},n.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},n.seekableEnd=function(){var e=this.player_.seekable(),t=[],n=e?e.length:0;while(n--)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},n.seekableStart=function(){var e=this.player_.seekable(),t=[],n=e?e.length:0;while(n--)t.push(e.start(n));return t.length?t.sort()[0]:0},n.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},n.isLive=function(){return this.isTracking()},n.atLiveEdge=function(){return!this.behindLiveEdge()},n.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},n.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},n.behindLiveEdge=function(){return this.behindLiveEdge_},n.isTracking=function(){return"number"===typeof this.trackingInterval_},n.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},n.dispose=function(){this.off(o.a,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),e.prototype.dispose.call(this)},t}(Yn);Yn.registerComponent("LiveTracker",xo);var To,Co=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),r=[],i="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===r.indexOf(o)&&r.push(o)}return!!r.length&&(1===r.length&&(i=r[0]),e.triggerSourceset(i),!0)},So=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=o.a.createElement(this.nodeName.toLowerCase());t.innerHTML=e;var n=o.a.createDocumentFragment();while(t.childNodes.length)n.appendChild(t.childNodes[0]);return this.innerText="",i.a.Element.prototype.appendChild.call(this,n),this.innerHTML}}),Eo=function(e,t){for(var n={},r=0;r<e.length;r++)if(n=Object.getOwnPropertyDescriptor(e[r],t),n&&n.set&&n.get)break;return n.enumerable=!0,n.configurable=!0,n},ko=function(e){return Eo([e.el(),i.a.HTMLMediaElement.prototype,i.a.Element.prototype,So],"innerHTML")},Ro=function(e){var t=e.el();if(!t.resetSourceWatch_){var n={},r=ko(e),i=function(n){return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=n.apply(t,i);return Co(e),o}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){t[e]&&(n[e]=t[e],t[e]=i(n[e]))})),Object.defineProperty(t,"innerHTML",Kn(r,{set:i(r.set)})),t.resetSourceWatch_=function(){t.resetSourceWatch_=null,Object.keys(n).forEach((function(e){t[e]=n[e]})),Object.defineProperty(t,"innerHTML",r)},e.one("sourceset",t.resetSourceWatch_)}},Oo=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Zr(i.a.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return i.a.Element.prototype.setAttribute.call(this,"src",e),e}}),Ao=function(e){return Eo([e.el(),i.a.HTMLMediaElement.prototype,Oo],"src")},Io=function(e){if(e.featuresSourceset){var t=e.el();if(!t.resetSourceset_){var n=Ao(e),r=t.setAttribute,i=t.load;Object.defineProperty(t,"src",Kn(n,{set:function(r){var i=n.set.call(t,r);return e.triggerSourceset(t.src),i}})),t.setAttribute=function(n,i){var a=r.call(t,n,i);return/src/i.test(n)&&e.triggerSourceset(t.src),a},t.load=function(){var n=i.call(t);return Co(e)||(e.triggerSourceset(""),Ro(e)),n},t.currentSrc?e.triggerSourceset(t.currentSrc):Co(e)||Ro(e),t.resetSourceset_=function(){t.resetSourceset_=null,t.load=i,t.setAttribute=r,Object.defineProperty(t,"src",n),t.resetSourceWatch_&&t.resetSourceWatch_()}}}},No=function(e,t,n,r){void 0===r&&(r=!0);var i=function(n){return Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0})},a={configurable:!0,enumerable:!0,get:function(){var e=n();return i(e),e}};return r&&(a.set=i),Object.defineProperty(e,t,a)},Do=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i=t.source,a=!1;if(i&&(r.el_.currentSrc!==i.src||t.tag&&3===t.tag.initNetworkState_)?r.setSource(i):r.handleLateInit_(r.el_),t.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){var o=r.el_.childNodes,s=o.length,u=[];while(s--){var c=o[s],l=c.nodeName.toLowerCase();"track"===l&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(c),r.remoteTextTracks().addTrack(c.track),r.textTracks().addTrack(c.track),a||r.el_.hasAttribute("crossorigin")||!ti(c.src)||(a=!0)):u.push(c))}for(var d=0;d<u.length;d++)r.el_.removeChild(u[d])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&a&&ht.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),r.restoreMetadataTracksInIOSNativePlayer_(),(dr||hr||rr)&&!0===t.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}p()(t,e);var n=t.prototype;return n.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),t.disposeMediaElement(this.el_),this.options_=null,e.prototype.dispose.call(this)},n.setupSourcesetHandling_=function(){Io(this)},n.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var r=t[n];"metadata"===r.kind&&e.push({track:r,storedMode:r.mode})}};n(),t.addEventListener("change",n),this.on("dispose",(function(){return t.removeEventListener("change",n)}));var r=function n(){for(var r=0;r<e.length;r++){var i=e[r];"disabled"===i.track.mode&&i.track.mode!==i.storedMode&&(i.track.mode=i.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",(function(){t.removeEventListener("change",n),t.removeEventListener("change",r),t.addEventListener("change",r)})),this.on("webkitendfullscreen",(function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",r)}))},n.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach((function(e){var t=n.el()[r+"Tracks"];t.removeEventListener(e,n[r+"TracksListeners_"][e])})),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},n.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},n.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},n.proxyNativeTracksForType_=function(e){var t=this,n=hi[e],r=this.el()[n.getterName],i=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&r&&r.addEventListener){var a={change:function(n){var r={type:"change",target:i,currentTarget:i,srcElement:i};i.trigger(r),"text"===e&&t[fi.remoteText.getterName]().trigger(r)},addtrack:function(e){i.addTrack(e.track)},removetrack:function(e){i.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<i.length;t++){for(var n=!1,a=0;a<r.length;a++)if(r[a]===i[t]){n=!0;break}n||e.push(i[t])}while(e.length)i.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach((function(e){var n=a[e];r.addEventListener(e,n),t.on("dispose",(function(t){return r.removeEventListener(e,n)}))})),this.on("loadstart",o),this.on("dispose",(function(e){return t.off("loadstart",o)}))}},n.proxyNativeTracks_=function(){var e=this;hi.names.forEach((function(t){e.proxyNativeTracksForType_(t)}))},n.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),t.disposeMediaElement(e),e=n}else{e=o.a.createElement("video");var r=this.options_.tag&&Bt(this.options_.tag),i=Kn({},r);dr&&!0===this.options_.nativeControlsForTouch||delete i.controls,jt(e,bt(i,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&Ft(e,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],s=0;s<a.length;s++){var u=a[s],c=this.options_[u];"undefined"!==typeof c&&(c?Ft(e,u,u):Vt(e,u),e[u]=c)}return e},n.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var r=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",r),void this.ready((function(){this.off("loadstart",n),this.off("loadedmetadata",r),t||this.trigger("loadstart")}))}var i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready((function(){i.forEach((function(e){this.trigger(e)}),this)}))}},n.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(t){ht(t,"Video is not ready. (Video.js)")}},n.duration=function(){var e=this;if(this.el_.duration===1/0&&tr&&or&&0===this.el_.currentTime){var t=function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))};return this.on("timeupdate",t),NaN}return this.el_.duration||NaN},n.width=function(){return this.el_.offsetWidth},n.height=function(){return this.el_.offsetHeight},n.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",(function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)}))}},n.supportsFullScreen=function(){if("function"===typeof this.el_.webkitEnterFullScreen){var e=i.a.navigator&&i.a.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},n.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Ir(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}),0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},n.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},n.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},n.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},n.reset=function(){t.resetMediaElement(this.el_)},n.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},n.setControls=function(e){this.el_.controls=!!e},n.addTextTrack=function(t,n,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,n,r):e.prototype.addTextTrack.call(this,t,n,r)},n.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var n=o.a.createElement("track");return t.kind&&(n.kind=t.kind),t.label&&(n.label=t.label),(t.language||t.srclang)&&(n.srclang=t.language||t.srclang),t["default"]&&(n["default"]=t["default"]),t.id&&(n.id=t.id),t.src&&(n.src=t.src),n},n.addRemoteTextTrack=function(t,n){var r=e.prototype.addRemoteTextTrack.call(this,t,n);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},n.removeRemoteTextTrack=function(t){if(e.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks){var n=this.$$("track"),r=n.length;while(r--)t!==n[r]&&t!==n[r].track||this.el().removeChild(n[r])}},n.getVideoPlaybackQuality=function(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),i.a.performance&&"function"===typeof i.a.performance.now?e.creationTime=i.a.performance.now():i.a.performance&&i.a.performance.timing&&"number"===typeof i.a.performance.timing.navigationStart&&(e.creationTime=i.a.Date.now()-i.a.performance.timing.navigationStart),e},t}(gi);No(Do,"TEST_VID",(function(){if(Et()){var e=o.a.createElement("video"),t=o.a.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}})),Do.isSupported=function(){try{Do.TEST_VID.volume=.5}catch(e){return!1}return!(!Do.TEST_VID||!Do.TEST_VID.canPlayType)},Do.canPlayType=function(e){return Do.TEST_VID.canPlayType(e)},Do.canPlaySource=function(e,t){return Do.canPlayType(e.type)},Do.canControlVolume=function(){try{var e=Do.TEST_VID.volume;return Do.TEST_VID.volume=e/2+.1,e!==Do.TEST_VID.volume}catch(t){return!1}},Do.canMuteVolume=function(){try{var e=Do.TEST_VID.muted;return Do.TEST_VID.muted=!e,Do.TEST_VID.muted?Ft(Do.TEST_VID,"muted","muted"):Vt(Do.TEST_VID,"muted","muted"),e!==Do.TEST_VID.muted}catch(t){return!1}},Do.canControlPlaybackRate=function(){if(tr&&or&&sr<58)return!1;try{var e=Do.TEST_VID.playbackRate;return Do.TEST_VID.playbackRate=e/2+.1,e!==Do.TEST_VID.playbackRate}catch(t){return!1}},Do.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(o.a.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(t){return!1}return!0},Do.supportsNativeTextTracks=function(){return mr||fr&&or},Do.supportsNativeVideoTracks=function(){return!(!Do.TEST_VID||!Do.TEST_VID.videoTracks)},Do.supportsNativeAudioTracks=function(){return!(!Do.TEST_VID||!Do.TEST_VID.audioTracks)},Do.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[0],n=e[1];No(Do.prototype,t,(function(){return Do[n]()}),!0)})),Do.prototype.movingMediaElementInDOM=!fr,Do.prototype.featuresFullscreenResize=!0,Do.prototype.featuresProgressEvents=!0,Do.prototype.featuresTimeupdateEvents=!0,Do.patchCanPlayType=function(){nr>=4&&!ir&&!or&&(To=Do.TEST_VID&&Do.TEST_VID.constructor.prototype.canPlayType,Do.TEST_VID.constructor.prototype.canPlayType=function(e){var t=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return e&&t.test(e)?"maybe":To.call(this,e)})},Do.unpatchCanPlayType=function(){var e=Do.TEST_VID.constructor.prototype.canPlayType;return To&&(Do.TEST_VID.constructor.prototype.canPlayType=To),e},Do.patchCanPlayType(),Do.disposeMediaElement=function(e){if(e){e.parentNode&&e.parentNode.removeChild(e);while(e.hasChildNodes())e.removeChild(e.firstChild);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()}},Do.resetMediaElement=function(e){if(e){var t=e.querySelectorAll("source"),n=t.length;while(n--)e.removeChild(t[n]);e.removeAttribute("src"),"function"===typeof e.load&&function(){try{e.load()}catch(t){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){Do.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){Do.prototype["set"+Hn(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){Do.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","crossOrigin"].forEach((function(e){Do.prototype["set"+Hn(e)]=function(t){this.el_[e]=t}})),["pause","load","play"].forEach((function(e){Do.prototype[e]=function(){return this.el_[e]()}})),gi.withSourceHandlers(Do),Do.nativeSourceHandler={},Do.nativeSourceHandler.canPlayType=function(e){try{return Do.TEST_VID.canPlayType(e)}catch(t){return""}},Do.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Do.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=ei(e.src);return Do.nativeSourceHandler.canPlayType("video/"+n)}return""},Do.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Do.nativeSourceHandler.dispose=function(){},Do.registerSourceHandler(Do.nativeSourceHandler),gi.registerTech("Html5",Do);var Po=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Mo={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Lo=["tiny","xsmall","small","medium","large","xlarge","huge"],jo={};Lo.forEach((function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;jo[e]="vjs-layout-"+t}));var Bo={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Uo=function(e){function t(n,r,i){var a;if(n.id=n.id||r.id||"vjs_video_"+hn(),r=bt(t.getTagSettings(n),r),r.initChildren=!1,r.createEl=!1,r.evented=!1,r.reportTouchActivity=!1,!r.language)if("function"===typeof n.closest){var s=n.closest("[lang]");s&&s.getAttribute&&(r.language=s.getAttribute("lang"))}else{var u=n;while(u&&1===u.nodeType){if(Bt(u).hasOwnProperty("lang")){r.language=u.getAttribute("lang");break}u=u.parentNode}}if(a=e.call(this,null,r,i)||this,a.boundDocumentFullscreenChange_=On(l()(a),a.documentFullscreenChange_),a.boundFullWindowOnEscKey_=On(l()(a),a.fullWindowOnEscKey),a.isFullscreen_=!1,a.log=ft(a.id_),a.fsApi_=Tr,a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=n,a.tagAttributes=n&&Bt(n),a.language(a.options_.language),r.languages){var c={};Object.getOwnPropertyNames(r.languages).forEach((function(e){c[e.toLowerCase()]=r.languages[e]})),a.languages_=c}else a.languages_=t.prototype.options_.languages;a.resetCache_(),a.poster_=r.poster||"",a.controls_=!!r.controls,n.controls=!1,n.removeAttribute("controls"),a.changingSrc_=!1,a.playCallbacks_=[],a.playTerminatedQueue_=[],n.hasAttribute("autoplay")?a.autoplay(!0):a.autoplay(a.options_.autoplay),r.plugins&&Object.keys(r.plugins).forEach((function(e){if("function"!==typeof a[e])throw new Error('plugin "'+e+'" does not exist')})),a.scrubbing_=!1,a.el_=a.createEl(),qn(l()(a),{eventBusKey:"el_"}),a.fsApi_.requestFullscreen&&(wn(o.a,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_),a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)),a.fluid_&&a.on("playerreset",a.updateStyleEl_);var d=Kn(a.options_);r.plugins&&Object.keys(r.plugins).forEach((function(e){a[e](r.plugins[e])})),a.options_.playerOptions=d,a.middleware_=[],a.initChildren(),a.isAudio("audio"===n.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),dr&&a.addClass("vjs-touch-enabled"),fr||a.addClass("vjs-workinghover"),t.players[a.id_]=l()(a);var p=ct.split(".")[0];return a.addClass("vjs-v"+p),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("stageclick",a.handleStageClick_),a.on("keydown",a.handleKeyDown),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a}p()(t,e);var n=t.prototype;return n.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),xn(o.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),xn(o.a,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Ni(this),mi.names.forEach((function(e){var t=mi[e],r=n[t.getterName]();r&&r.off&&r.off()})),e.prototype.dispose.call(this)},n.createEl=function(){var t,n=this.tag,r=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),a="video-js"===this.tag.tagName.toLowerCase();r?t=this.el_=n.parentNode:a||(t=this.el_=e.prototype.createEl.call(this,"div"));var s=Bt(n);if(a){t=this.el_=n,n=this.tag=o.a.createElement("video");while(t.children.length)n.appendChild(t.firstChild);Dt(t,"video-js")||Pt(t,"video-js"),t.appendChild(n),r=this.playerElIngest_=t,Object.keys(t).forEach((function(e){try{n[e]=t[e]}catch(r){}}))}if(n.setAttribute("tabindex","-1"),s.tabindex="-1",(ur||or&&lr)&&(n.setAttribute("role","application"),s.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach((function(e){a&&"class"===e||t.setAttribute(e,s[e]),a&&n.setAttribute(e,s[e])})),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=t.player=this,this.addClass("vjs-paused"),!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=cn("vjs-styles-dimensions");var u=en(".vjs-styles-defaults"),c=en("head");c.insertBefore(this.styleEl_,u?u.nextSibling:c.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var l=n.getElementsByTagName("a"),d=0;d<l.length;d++){var p=l.item(d);Pt(p,"vjs-hidden"),p.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!r&&n.parentNode.insertBefore(t,n),Nt(n,t),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=t,t},n.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):ht.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},n.width=function(e){return this.dimension("width",e)},n.height=function(e){return this.dimension("height",e)},n.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t||"auto"===t)return this[n]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?ht.error('Improper value "'+t+'" supplied for for '+e):(this[n]=r,this.updateStyleEl_())},n.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,Dn(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Pn((function(){this.on("playerreset",this.updateStyleEl_)}))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},n.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},n.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},n.updateStyleEl_=function(){if(!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,n,r;n=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";var a=n.split(":"),o=a[1]/a[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/o:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*o,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),ln(this.styleEl_,"\n      ."+r+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*o+"%;\n      }\n    ")}else{var s="number"===typeof this.width_?this.width_:this.options_.width,u="number"===typeof this.height_?this.height_:this.options_.height,c=this.tech_&&this.tech_.el();c&&(s>=0&&(c.width=s),u>=0&&(c.height=u))}},n.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var r=Hn(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(gi.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var a="string"!==typeof this.autoplay()&&this.autoplay(),o={source:t,autoplay:a,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};mi.names.forEach((function(e){var t=mi[e];o[t.getterName]=n[t.privateName]})),bt(o,this.options_[r]),bt(o,this.options_[i]),bt(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);var s=gi.getTech(e);if(!s)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new s(o),this.tech_.ready(On(this,this.handleTechReady_),!0),Mr.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Po.forEach((function(e){n.on(n.tech_,e,n["handleTech"+Hn(e)+"_"])})),Object.keys(Mo).forEach((function(e){n.on(n.tech_,e,(function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Mo[e]+"_"].bind(n),event:t}):n["handleTech"+Mo[e]+"_"](t)}))})),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||Nt(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},n.unloadTech_=function(){var e=this;mi.names.forEach((function(t){var n=mi[t];e[n.privateName]=e[n.getterName]()})),this.textTracksJson_=Mr.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},n.tech=function(e){return void 0===e&&ht.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},n.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},n.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},n.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},n.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},n.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"===typeof e){var n,r=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var r=t.play();if(Ar(r))return r["catch"](n)};if("any"===e&&!0!==this.muted()?(n=this.play(),Ar(n)&&(n=n["catch"](r))):n="muted"===e&&!0!==this.muted()?r():this.play(),Ar(n))return n.then((function(){t.trigger({type:"autoplay-success",autoplay:e})}))["catch"]((function(n){t.trigger({type:"autoplay-failure",autoplay:e})}))}},n.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!==typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=ji(this,t)),this.cache_.source=Kn({},e,{src:t,type:n});for(var r=this.cache_.sources.filter((function(e){return e.src&&e.src===t})),i=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var u=Bt(a[s]);i.push(u),u.src&&u.src===t&&o.push(u.src)}o.length&&!r.length?this.cache_.sources=i:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},n.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},r=this.currentSource().src,i=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(i)&&(!this.lastSource_||this.lastSource_.tech!==i&&this.lastSource_.player!==r)&&(n=function(){}),n(i),e.src||this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}}))}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},n.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},n.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},n.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},n.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime(),n=function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))};this.on("timeupdate",n)},n.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},n.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},n.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},n.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},n.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},n.handleTechFirstPlay_=function(){this.options_.starttime&&(ht.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},n.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},n.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},n.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},n.handleTechClick_=function(e){Qt(e)&&this.controls_&&(this.paused()?Ir(this.play()):this.pause())},n.handleTechDoubleClick_=function(e){if(this.controls_){var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(t){return t.contains(e.target)}));t||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"===typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},n.handleTechTap_=function(){this.userActive(!this.userActive())},n.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},n.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},n.handleTechTouchEnd_=function(e){e.preventDefault()},n.handleStageClick_=function(){this.reportUserActivity()},n.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},n.documentFullscreenChange_=function(e){var t=e.target.player;if(!t||t===this){var n=this.el(),r=o.a[this.fsApi_.fullscreenElement]===n;!r&&n.matches?r=n.matches(":"+this.fsApi_.fullscreen):!r&&n.msMatchesSelector&&(r=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}},n.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},n.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},n.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},n.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},n.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},n.handleTechError_=function(){var e=this.tech_.error();this.error(e)},n.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},n.getCache=function(){return this.cache_},n.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},n.techCall_=function(e,t){this.ready((function(){if(e in Ri)return Si(this.middleware_,this.tech_,e,t);if(e in Oi)return Ei(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(n){throw ht(n),n}}),!0)},n.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in ki)return Ci(this.middleware_,this.tech_,e);if(e in Oi)return Ei(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw ht("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw ht("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw ht(t),t}}},n.play=function(){var e=this,t=this.options_.Promise||i.a.Promise;return t?new t((function(t){e.play_(t)})):this.play_()},n.play_=function(e){var t=this;void 0===e&&(e=Ir),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!mr&&!fr||this.load());var r=this.techGet_("play");null===r?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)},n.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))},n.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach((function(t){t(e)}))},n.pause=function(){this.techCall_("pause")},n.paused=function(){return!1!==this.techGet_("paused")},n.played=function(){return this.techGet_("played")||_r(0,0)},n.scrubbing=function(e){if("undefined"===typeof e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},n.currentTime=function(e){return"undefined"!==typeof e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},n.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},n.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},n.remainingTime=function(){return this.duration()-this.currentTime()},n.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},n.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=_r(0,0)),e},n.bufferedPercent=function(){return wr(this.buffered(),this.duration())},n.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},n.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},n.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},n.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},n.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},n.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},n.isFullscreen=function(e){if(void 0!==e){var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},n.requestFullscreen=function(e){var t=this.options_.Promise||i.a.Promise;if(t){var n=this;return new t((function(t,r){function i(){n.off("fullscreenerror",o),n.off("fullscreenchange",a)}function a(){i(),t()}function o(e,t){i(),r(t)}n.one("fullscreenchange",a),n.one("fullscreenerror",o);var s=n.requestFullscreenHelper_(e);if(s)return s.then(i,i),s}))}return this.requestFullscreenHelper_()},n.requestFullscreenHelper_=function(e){var t,n=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var r=this.el_[this.fsApi_.requestFullscreen](t);return r&&r.then((function(){return n.isFullscreen(!0)}),(function(){return n.isFullscreen(!1)})),r}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},n.exitFullscreen=function(){var e=this.options_.Promise||i.a.Promise;if(e){var t=this;return new e((function(e,n){function r(){t.off("fullscreenerror",a),t.off("fullscreenchange",i)}function i(){r(),e()}function a(e,t){r(),n(t)}t.one("fullscreenchange",i),t.one("fullscreenerror",a);var o=t.exitFullscreenHelper_();if(o)return o.then(r,r),o}))}return this.exitFullscreenHelper_()},n.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=o.a[this.fsApi_.exitFullscreen]();return t&&t.then((function(){return e.isFullscreen(!1)})),t}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},n.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=o.a.documentElement.style.overflow,wn(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow="hidden",Pt(o.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},n.fullWindowOnEscKey=function(e){v.a.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},n.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,xn(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow=this.docOrigOverflow,Mt(o.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},n.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},n.requestPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return this.techGet_("requestPictureInPicture")},n.exitPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return o.a.exitPictureInPicture()},n.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){var n=function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;var n=["button","checkbox","hidden","radio","reset","submit"];if("input"===t)return-1===n.indexOf(e.type);var r=["textarea"];return-1!==r.indexOf(t)};n(this.el_.ownerDocument.activeElement)||("function"===typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},n.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},n=t.fullscreenKey,r=void 0===n?function(e){return v.a.isEventKey(e,"f")}:n,i=t.muteKey,a=void 0===i?function(e){return v.a.isEventKey(e,"m")}:i,s=t.playPauseKey,u=void 0===s?function(e){return v.a.isEventKey(e,"k")||v.a.isEventKey(e,"Space")}:s;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var c=Yn.getComponent("FullscreenToggle");!1!==o.a[this.fsApi_.fullscreenEnabled]&&c.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation();var l=Yn.getComponent("MuteToggle");l.prototype.handleClick.call(this,e)}else if(u.call(this,e)){e.preventDefault(),e.stopPropagation();var d=Yn.getComponent("PlayToggle");d.prototype.handleClick.call(this,e)}},n.canPlayType=function(e){for(var t,n=0,r=this.options_.techOrder;n<r.length;n++){var i=r[n],a=gi.getTech(i);if(a||(a=Yn.getComponent(i)),a){if(a.isSupported()&&(t=a.canPlayType(e),t))return t}else ht.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return""},n.selectSource=function(e){var t,n=this,r=this.options_.techOrder.map((function(e){return[e,gi.getTech(e)]})).filter((function(e){var t=e[0],n=e[1];return n?n.isSupported():(ht.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)})),i=function(e,t,n){var r;return e.some((function(e){return t.some((function(t){if(r=n(e,t),r)return!0}))})),r},a=function(e){return function(t,n){return e(n,t)}},o=function(e,t){var r=e[0],i=e[1];if(i.canPlaySource(t,n.options_[r.toLowerCase()]))return{source:t,tech:r}};return t=this.options_.sourceOrder?i(e,r,a(o)):i(r,e,o),t||!1},n.src=function(e){var t=this;if("undefined"===typeof e)return this.cache_.src||"";var n=Bi(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),xi(this,n[0],(function(e,r){t.middleware_=r,t.cache_.sources=n,t.updateSourceCaches_(e);var i=t.src_(e);if(i)return n.length>1?t.src(n.slice(1)):(t.changingSrc_=!1,t.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0),void t.triggerReady());Ti(r,t.tech_)}))):this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0)},n.src_=function(e){var t=this,n=this.selectSource([e]);return!n||($n(n.tech,this.techName_)?(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0),!1):(this.changingSrc_=!0,this.loadTech_(n.tech,n.source),this.tech_.ready((function(){t.changingSrc_=!1})),!1))},n.load=function(){this.techCall_("load")},n.reset=function(){var e=this,t=this.options_.Promise||i.a.Promise;if(this.paused()||!t)this.doReset_();else{var n=this.play();Ir(n.then((function(){return e.doReset_()})))}},n.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Dn(this)&&this.trigger("playerreset")},n.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},n.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},n.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},n.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},n.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},n.currentSource=function(){return this.cache_.source||{}},n.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},n.currentType=function(){return this.currentSource()&&this.currentSource().type||""},n.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},n.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"===typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t="undefined"===typeof t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},n.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},n.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},n.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},n.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},n.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},n.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},n.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",(function(){this.off(["click","touchstart"],t)}))}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Rr(e),this.addClass("vjs-error"),ht.error("(CODE:"+this.error_.code+" "+Rr.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},n.reportUserActivity=function(e){this.userActivity_=!0},n.userActive=function(e){if(void 0===e)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},n.listenForUserActivity_=function(){var e,t,n,r=On(this,this.reportUserActivity),i=function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,r())},a=function(){r(),this.clearInterval(e),e=this.setInterval(r,250)},o=function(t){r(),this.clearInterval(e)};this.on("mousedown",a),this.on("mousemove",i),this.on("mouseup",o),this.on("mouseleave",o);var s,u=this.getChild("controlBar");!u||fr||tr||(u.on("mouseenter",(function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0})),u.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",r),this.on("keyup",r),this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(s);var e=this.options_.inactivityTimeout;e<=0||(s=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}}),250)},n.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},n.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},n.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},n.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},n.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},n.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e,n=t.track;if(n||(n=e),this.tech_)return this.tech_.removeRemoteTextTrack(n)},n.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},n.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},n.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},n.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},n.languages=function(){return Kn(t.prototype.options_.languages,this.languages_)},n.toJSON=function(){var e=Kn(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var r=t[n];r=Kn(r),r.player=void 0,e.tracks[n]=r}return e},n.createModal=function(e,t){var n=this;t=t||{},t.content=e||"";var r=new jr(this,t);return this.addChild(r),r.on("dispose",(function(){n.removeChild(r)})),r.open(),r},n.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Lo.length;n++){var r=Lo[n],i=this.breakpoints_[r];if(t<=i){if(e===r)return;e&&this.removeClass(jo[e]),this.addClass(jo[r]),this.breakpoint_=r;break}}},n.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},n.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=bt({},Bo,e),this.updateCurrentBreakpoint_()),bt(this.breakpoints_)},n.responsive=function(e){if(void 0===e)return this.responsive_;e=Boolean(e);var t=this.responsive_;return e!==t?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},n.currentBreakpoint=function(){return this.breakpoint_},n.currentBreakpointClass=function(){return jo[this.breakpoint_]||""},n.loadMedia=function(e,t){var n=this;if(e&&"object"===typeof e){this.reset(),this.cache_.media=Kn(e);var r=this.cache_.media,i=r.artwork,a=r.poster,o=r.src,s=r.textTracks;!i&&a&&(this.cache_.media.artwork=[{src:a,type:Li(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach((function(e){return n.addRemoteTextTrack(e,!1)})),this.ready(t)}},n.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t=this.currentSources(),n=Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})),r={src:t,textTracks:n};return e&&(r.poster=e,r.artwork=[{src:r.poster,type:Li(r.poster)}]),r}return Kn(this.cache_.media)},t.getTagSettings=function(e){var t={sources:[],tracks:[]},n=Bt(e),r=n["data-setup"];if(Dt(e,"vjs-fill")&&(n.fill=!0),Dt(e,"vjs-fluid")&&(n.fluid=!0),null!==r){var i=f()(r||"{}"),a=i[0],o=i[1];a&&ht.error(a),bt(n,o)}if(bt(t,n),e.hasChildNodes())for(var s=e.childNodes,u=0,c=s.length;u<c;u++){var l=s[u],d=l.nodeName.toLowerCase();"source"===d?t.sources.push(Bt(l)):"track"===d&&t.tracks.push(Bt(l))}return t},n.flexNotSupported_=function(){var e=o.a.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},t}(Yn);mi.names.forEach((function(e){var t=mi[e];Uo.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}})),Uo.prototype.crossorigin=Uo.prototype.crossOrigin,Uo.players={};var Fo=i.a.navigator;Uo.prototype.options_={techOrder:gi.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Fo&&(Fo.languages&&Fo.languages[0]||Fo.userLanguage||Fo.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach((function(e){Uo.prototype[e]=function(){return this.techGet_(e)}})),Po.forEach((function(e){Uo.prototype["handleTech"+Hn(e)+"_"]=function(){return this.trigger(e)}})),Yn.registerComponent("Player",Uo);var Vo="plugin",qo="activePlugins_",Wo={},zo=function(e){return Wo.hasOwnProperty(e)},Go=function(e){return zo(e)?Wo[e]:void 0},Ho=function(e,t){e[qo]=e[qo]||{},e[qo][t]=!0},$o=function(e,t,n){var r=(n?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)},Ko=function(e,t){var n=function(){$o(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return Ho(this,e),$o(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach((function(e){n[e]=t[e]})),n},Yo=function(e,t){return t.prototype.name=e,function(){$o(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=x()(t,[this].concat(r));return this[e]=function(){return a},$o(this,a.getEventHash()),a}},Xo=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,qn(this),delete this.trigger,zn(this,this.constructor.defaultState),Ho(t,this.name),this.dispose=On(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),Tn(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[qo][e]=!1,this.player=this.state=null,t[e]=Yo(e,Wo[e])},e.isBasic=function(t){var n="string"===typeof t?Go(t):t;return"function"===typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!==typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(zo(t))ht.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Uo.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!==typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Wo[t]=n,t!==Vo&&(e.isBasic(n)?Uo.prototype[t]=Ko(t,n):Uo.prototype[t]=Yo(t,n)),n},e.deregisterPlugin=function(e){if(e===Vo)throw new Error("Cannot de-register base plugin.");zo(e)&&(delete Wo[e],delete Uo.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Wo)),e.forEach((function(e){var n=Go(e);n&&(t=t||{},t[e]=n)})),t},e.getPluginVersion=function(e){var t=Go(e);return t&&t.VERSION||""},e}();Xo.getPlugin=Go,Xo.BASE_PLUGIN_NAME=Vo,Xo.registerPlugin(Vo,Xo),Uo.prototype.usingPlugin=function(e){return!!this[qo]&&!0===this[qo][e]},Uo.prototype.hasPlugin=function(e){return!!zo(e)};var Jo=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},r={};for(var i in"object"===typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),r=t):"function"===typeof t&&(n=t),C()(n,e),e&&(n.super_=e),r)r.hasOwnProperty(i)&&(n.prototype[i]=r[i]);return n},Qo=function(e){return 0===e.indexOf("#")?e.slice(1):e};function Zo(e,t,n){var r=Zo.getPlayer(e);if(r)return t&&ht.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&r.ready(n),r;var i="string"===typeof e?en("#"+Qo(e)):e;if(!kt(i))throw new TypeError("The element or ID supplied is not valid. (videojs)");i.ownerDocument.defaultView&&i.ownerDocument.body.contains(i)||ht.warn("The element supplied is not included in the DOM"),t=t||{},Zo.hooks("beforesetup").forEach((function(e){var n=e(i,Kn(t));_t(n)&&!Array.isArray(n)?t=Kn(t,n):ht.error("please return an object in beforesetup hooks")}));var a=Yn.getComponent("Player");return r=new a(i,t,n),Zo.hooks("setup").forEach((function(e){return e(r)})),r}if(Zo.hooks_={},Zo.hooks=function(e,t){return Zo.hooks_[e]=Zo.hooks_[e]||[],t&&(Zo.hooks_[e]=Zo.hooks_[e].concat(t)),Zo.hooks_[e]},Zo.hook=function(e,t){Zo.hooks(e,t)},Zo.hookOnce=function(e,t){Zo.hooks(e,[].concat(t).map((function(t){var n=function n(){return Zo.removeHook(e,n),t.apply(void 0,arguments)};return n})))},Zo.removeHook=function(e,t){var n=Zo.hooks(e).indexOf(t);return!(n<=-1)&&(Zo.hooks_[e]=Zo.hooks_[e].slice(),Zo.hooks_[e].splice(n,1),!0)},!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE&&Et()){var es=en(".vjs-styles-defaults");if(!es){es=cn("vjs-styles-defaults");var ts=en("head");ts&&ts.insertBefore(es,ts.firstChild),ln(es,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}on(1,Zo),Zo.VERSION=ct,Zo.options=Uo.prototype.options_,Zo.getPlayers=function(){return Uo.players},Zo.getPlayer=function(e){var t,n=Uo.players;if("string"===typeof e){var r=Qo(e),i=n[r];if(i)return i;t=en("#"+r)}else t=e;if(kt(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},Zo.getAllPlayers=function(){return Object.keys(Uo.players).map((function(e){return Uo.players[e]})).filter(Boolean)},Zo.players=Uo.players,Zo.getComponent=Yn.getComponent,Zo.registerComponent=function(e,t){gi.isTech(t)&&ht.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Yn.registerComponent.call(Yn,e,t)},Zo.getTech=gi.getTech,Zo.registerTech=gi.registerTech,Zo.use=wi,Object.defineProperty(Zo,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Zo.middleware,"TERMINATOR",{value:_i,writeable:!1,enumerable:!0}),Zo.browser=vr,Zo.TOUCH_ENABLED=dr,Zo.extend=Jo,Zo.mergeOptions=Kn,Zo.bind=On,Zo.registerPlugin=Xo.registerPlugin,Zo.deregisterPlugin=Xo.deregisterPlugin,Zo.plugin=function(e,t){return ht.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Xo.registerPlugin(e,t)},Zo.getPlugins=Xo.getPlugins,Zo.getPlugin=Xo.getPlugin,Zo.getPluginVersion=Xo.getPluginVersion,Zo.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),Zo.options.languages=Kn(Zo.options.languages,(n={},n[e]=t,n)),Zo.options.languages[e]},Zo.log=ht,Zo.createLogger=ft,Zo.createTimeRange=Zo.createTimeRanges=_r,Zo.formatTime=ia,Zo.setFormatTime=na,Zo.resetFormatTime=ra,Zo.parseUrl=Qr,Zo.isCrossOrigin=ti,Zo.EventTarget=Nn,Zo.on=wn,Zo.one=Cn,Zo.off=xn,Zo.trigger=Tn,Zo.xhr=y.a,Zo.TextTrack=ai,Zo.AudioTrack=oi,Zo.VideoTrack=si,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){Zo[e]=function(){return ht.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),nn[e].apply(null,arguments)}})),Zo.computedStyle=xt,Zo.dom=nn,Zo.url=ni,Zo.defineLazyProperty=No;
/**
 * @videojs/http-streaming
 * @version 1.13.2
 * @copyright 2020 Brightcove, Inc
 * @license Apache-2.0
 */
var ns=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=E.a.buildAbsoluteURL(i.a.location.href,e)),E.a.buildAbsoluteURL(e,t))},rs=function(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t},is=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},as=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),os=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0},ss=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},us=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t},cs=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),t&&n.length===t)break}catch(u){i=!0,a=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ls=Zo.mergeOptions,ds=Zo.EventTarget,ps=Zo.log,hs=function(e,t){["AUDIO","SUBTITLES"].forEach((function(n){for(var r in e.mediaGroups[n])for(var i in e.mediaGroups[n][r]){var a=e.mediaGroups[n][r][i];t(a,n,r,i)}}))},fs=function(e,t,n){var r=t.slice();n=n||0;for(var i=Math.min(e.length,t.length+n),a=n;a<i;a++)r[a-n]=ls(e[a],r[a-n]);return r},ms=function(e,t){e.resolvedUri||(e.resolvedUri=ns(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=ns(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=ns(t,e.map.uri))},vs=function(e,t){var n=ls(e,{}),r=n.playlists[t.id];if(!r)return null;if(r.segments&&t.segments&&r.segments.length===t.segments.length&&r.endList===t.endList&&r.mediaSequence===t.mediaSequence)return null;var i=ls(r,t);r.segments&&(i.segments=fs(r.segments,t.segments,t.mediaSequence-r.mediaSequence)),i.segments.forEach((function(e){ms(e,i.resolvedUri)}));for(var a=0;a<n.playlists.length;a++)n.playlists[a].id===t.id&&(n.playlists[a]=i);return n.playlists[t.id]=i,n.playlists[t.uri]=i,n},gs=function(e,t){return e+"-"+t},ys=function(e){var t=e.playlists.length;while(t--){var n=e.playlists[t];n.resolvedUri=ns(e.uri,n.uri),n.id=gs(t,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes||(n.attributes={},ps.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},bs=function(e){hs(e,(function(t){t.uri&&(t.resolvedUri=ns(e.uri,t.uri))}))},_s=function(e,t){var n=e.segments[e.segments.length-1],r=void 0;return r=t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10),r},ws=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};is(this,t);var i=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=r.withCredentials,o=void 0!==a&&a,s=r.handleManifestRedirects,u=void 0!==s&&s;i.srcUrl=e,i.hls_=n,i.withCredentials=o,i.handleManifestRedirects=u;var c=n.options_;if(i.customTagParsers=c&&c.customTagParsers||[],i.customTagMappers=c&&c.customTagMappers||[],!i.srcUrl)throw new Error("A non-empty playlist URL is required");return i.state="HAVE_NOTHING",i.on("mediaupdatetimeout",(function(){"HAVE_METADATA"===i.state&&(i.state="HAVE_CURRENT_METADATA",i.request=i.hls_.xhr({uri:ns(i.master.uri,i.media().uri),withCredentials:i.withCredentials},(function(e,t){if(i.request)return e?i.playlistRequestError(i.request,i.media(),"HAVE_METADATA"):void i.haveMetadata(i.request,i.media().uri,i.media().id)})))})),i}return ss(t,e),as(t,[{key:"playlistRequestError",value:function(e,t,n){var r=t.uri,i=t.id;this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[i],status:e.status,message:"HLS playlist request error at URL: "+r+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t,n){var r=this;this.request=null,this.state="HAVE_METADATA";var a=new B;this.customTagParsers.forEach((function(e){return a.addParser(e)})),this.customTagMappers.forEach((function(e){return a.addTagMapper(e)})),a.push(e.responseText),a.end(),a.manifest.uri=t,a.manifest.id=n,a.manifest.attributes=a.manifest.attributes||{};var o=vs(this.master,a.manifest);this.targetDuration=a.manifest.targetDuration,o?(this.master=o,this.media_=this.master.playlists[n]):this.trigger("playlistunchanged"),this.media().endList||(i.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=i.a.setTimeout((function(){r.trigger("mediaupdatetimeout")}),_s(this.media(),!!o))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.finalRenditionTimeout),this.off()}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(e,t){var n=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"===typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(i.a.clearTimeout(this.finalRenditionTimeout),t){var r=e.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=i.a.setTimeout(this.media.bind(this,e,!1),r)}else{var a=this.state,o=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(function(t,r){if(n.request){if(e.resolvedUri=rs(n.handleManifestRedirects,e.resolvedUri,r),t)return n.playlistRequestError(n.request,e,a);n.haveMetadata(r,e.uri,e.id),"HAVE_MASTER"===a?n.trigger("loadedmetadata"):n.trigger("mediachange")}}))}}}},{key:"pause",value:function(){this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;i.a.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=i.a.setTimeout((function(){return t.load()}),r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var e=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"HLS playlist request error at URL: "+e.srcUrl+".",responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");var r=new B;if(e.customTagParsers.forEach((function(e){return r.addParser(e)})),e.customTagMappers.forEach((function(e){return r.addTagMapper(e)})),r.push(n.responseText),r.end(),e.state="HAVE_MASTER",e.srcUrl=rs(e.handleManifestRedirects,e.srcUrl,n),r.manifest.uri=e.srcUrl,r.manifest.playlists)return e.master=r.manifest,ys(e.master),bs(e.master),e.trigger("loadedplaylist"),void(e.request||e.media(r.manifest.playlists[0]));var a=gs(0,e.srcUrl);return e.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:i.a.location.href,playlists:[{uri:e.srcUrl,id:a,resolvedUri:e.srcUrl,attributes:{}}]},e.master.playlists[a]=e.master.playlists[0],e.master.playlists[e.srcUrl]=e.master.playlists[0],e.haveMetadata(n,e.srcUrl,a),e.trigger("loadedmetadata")}}))}}]),t}(ds),xs=Zo.createTimeRange,Ts=function(e,t){var n=0,r=t-e.mediaSequence,i=e.segments[r];if(i){if("undefined"!==typeof i.start)return{result:i.start,precise:!0};if("undefined"!==typeof i.end)return{result:i.end-i.duration,precise:!0}}while(r--){if(i=e.segments[r],"undefined"!==typeof i.end)return{result:n+i.end,precise:!0};if(n+=i.duration,"undefined"!==typeof i.start)return{result:n+i.start,precise:!0}}return{result:n,precise:!1}},Cs=function(e,t){for(var n=0,r=void 0,i=t-e.mediaSequence;i<e.segments.length;i++){if(r=e.segments[i],"undefined"!==typeof r.start)return{result:r.start-n,precise:!0};if(n+=r.duration,"undefined"!==typeof r.end)return{result:r.end-n,precise:!0}}return{result:-1,precise:!1}},Ss=function(e,t,n){var r=void 0,i=void 0;return"undefined"===typeof t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(r=Ts(e,t),r.precise?r.result:(i=Cs(e,t),i.precise?i.result:r.result+n))},Es=function(e,t,n){if(!e)return 0;if("number"!==typeof n&&(n=0),"undefined"===typeof t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return i.a.Infinity}return Ss(e,t,n)},ks=function(e,t,n){var r=0;if(t>n){var i=[n,t];t=i[0],n=i[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)r+=e.targetDuration;t=0}for(var o=t;o<n;o++)r+=e.segments[o].duration;return r},Rs=function(e,t){if(!e.segments.length)return 0;var n=e.segments.length,r=e.segments[n-1].duration||e.targetDuration,i="number"===typeof t?t:r+2*e.targetDuration;if(0===i)return n;var a=0;while(n--)if(a+=e.segments[n].duration,a>=i)break;return Math.max(0,n)},Os=function(e,t,n,r){if(!e||!e.segments)return null;if(e.endList)return Es(e);if(null===t)return null;t=t||0;var i=n?Rs(e,r):e.segments.length;return Ss(e,e.mediaSequence+i,t)},As=function(e,t,n){var r=!0,i=t||0,a=Os(e,t,r,n);return null===a?xs():xs(i,a)},Is=function(e){return e-Math.floor(e)===0},Ns=function(e,t){if(Is(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,r=1;r<=n;r++){var i=Math.pow(10,r),a=t*i;if(Is(a)||r===n)return(a+e)/i}},Ds=Ns.bind(null,1),Ps=Ns.bind(null,-1),Ms=function(e,t,n,r){var i=void 0,a=void 0,o=e.segments.length,s=t-r;if(s<0){if(n>0)for(i=n-1;i>=0;i--)if(a=e.segments[i],s+=Ps(a.duration),s>0)return{mediaIndex:i,startTime:r-ks(e,n,i)};return{mediaIndex:0,startTime:t}}if(n<0){for(i=n;i<0;i++)if(s-=e.targetDuration,s<0)return{mediaIndex:0,startTime:t};n=0}for(i=n;i<o;i++)if(a=e.segments[i],s-=Ds(a.duration),s<0)return{mediaIndex:i,startTime:r+ks(e,n,i)};return{mediaIndex:o-1,startTime:t}},Ls=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},js=function(e){return e.excludeUntil&&e.excludeUntil===1/0},Bs=function(e){var t=Ls(e);return!e.disabled&&!t},Us=function(e){return e.disabled},Fs=function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},Vs=function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},qs=function(e,t){return t.attributes&&t.attributes[e]},Ws=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!qs("BANDWIDTH",n))return NaN;var i=e*n.attributes.BANDWIDTH;return(i-8*r)/t},zs=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){return!!Bs(e)&&(e.attributes.BANDWIDTH||0)<n})).length},Gs={duration:Es,seekable:As,safeLiveIndex:Rs,getMediaInfoForTime:Ms,isEnabled:Bs,isDisabled:Us,isBlacklisted:Ls,isIncompatible:js,playlistEnd:Os,isAes:Fs,isFmp4:Vs,hasAttribute:qs,estimateSegmentRequestTime:Ws,isLowestEnabledRendition:zs},Hs=Zo.xhr,$s=Zo.mergeOptions,Ks=function(){var e=function e(t,n){t=$s({timeout:45e3},t);var r=e.beforeRequest||Zo.Hls.xhr.beforeRequest;if(r&&"function"===typeof r){var i=r(t);i&&(t=i)}var a=Hs(t,(function(e,t){var r=a.response;!e&&r&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=r.byteLength||r.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(r||a.responseText)))),n(e,a)})),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a};return e},Ys=function(e){var t=void 0,n=void 0;return n=e.offset+e.length-1,t=e.offset,"bytes="+t+"-"+n},Xs=function(e){var t={};return e.byterange&&(t.Range=Ys(e.byterange)),t},Js=function(e,t){return e.start(t)+"-"+e.end(t)},Qs=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Zs=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},eu=function(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];ArrayBuffer.isView(r)?t[n]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:t[n]=r})),t},tu=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},nu=function(e){return e.resolvedUri},ru=function(e){for(var t=Array.prototype.slice.call(e),n=16,r="",i=void 0,a=void 0,o=0;o<t.length/n;o++)i=t.slice(o*n,o*n+n).map(Qs).join(""),a=t.slice(o*n,o*n+n).map(Zs).join(""),r+=i+" "+a+"\n";return r},iu=function(e){var t=e.bytes;return ru(t)},au=function(e){var t="",n=void 0;for(n=0;n<e.length;n++)t+=Js(e,n)+" ";return t},ou=Object.freeze({createTransferableMessage:eu,initSegmentId:tu,segmentKeyId:nu,hexDump:ru,tagDump:iu,textRanges:au}),su=.25,uu=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,r=t.videoTimingInfo.transmuxedPresentationStart,i=r+n,a=e-i;return new Date(t.dateTimeObject.getTime()+1e3*a)},cu=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds},lu=function(e,t){var n=void 0;try{n=new Date(e)}catch(l){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(n<r.dateTimeObject)return null;for(var i=0;i<t.segments.length-1;i++){r=t.segments[i];var a=t.segments[i+1].dateTimeObject;if(n<a)break}var o=t.segments[t.segments.length-1],s=o.dateTimeObject,u=o.videoTimingInfo?cu(o.videoTimingInfo):o.duration+o.duration*su,c=new Date(s.getTime()+1e3*u);return n>c?null:(n>s&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:Gs.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},du=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,r=void 0,i=0;i<t.segments.length;i++)if(r=t.segments[i],n=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:n+r.duration,e<=n)break;var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+a.duration*su)return null;r=a}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:n-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},pu=function(e,t){var n=void 0,r=void 0;try{n=new Date(e),r=new Date(t)}catch(o){}var i=n.getTime(),a=r.getTime();return(a-i)/1e3},hu=function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++){var n=e.segments[t];if(!n.dateTimeObject)return!1}return!0},fu=function(e){var t=e.playlist,n=e.time,r=void 0===n?void 0:n,i=e.callback;if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return i({message:"getProgramTime: playlist and time must be provided"});var a=du(r,t);if(!a)return i({message:"valid programTime was not found"});if("estimate"===a.type)return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:r},s=uu(r,a.segment);return s&&(o.programDateTime=s.toISOString()),i(null,o)},mu=function e(t){var n=t.programTime,r=t.playlist,i=t.retryCount,a=void 0===i?2:i,o=t.seekTo,s=t.pauseAfterSeek,u=void 0===s||s,c=t.tech,l=t.callback;if(!l)throw new Error("seekToProgramTime: callback must be provided");if("undefined"===typeof n||!r||!o)return l({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!c.hasStarted_)return l({message:"player must be playing a live stream to start buffering"});if(!hu(r))return l({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});var d=lu(n,r);if(!d)return l({message:n+" was not found in the stream"});var p=d.segment,h=pu(p.dateTimeObject,n);if("estimate"===d.type)return 0===a?l({message:n+" is not buffered yet. Try again"}):(o(d.estimatedStart+h),void c.one("seeked",(function(){e({programTime:n,playlist:r,retryCount:a-1,seekTo:o,pauseAfterSeek:u,tech:c,callback:l})})));var f=p.start+h,m=function(){return l(null,c.currentTime())};c.one("seeked",m),u&&c.pause(),o(f)},vu=1/30,gu=3*vu,yu=function(e,t){var n=[],r=void 0;if(e&&e.length)for(r=0;r<e.length;r++)t(e.start(r),e.end(r))&&n.push([e.start(r),e.end(r)]);return Zo.createTimeRanges(n)},bu=function(e,t){return yu(e,(function(e,n){return e-gu<=t&&n+gu>=t}))},_u=function(e,t){return yu(e,(function(e){return e-vu>=t}))},wu=function(e){if(e.length<2)return Zo.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var r=e.end(n-1),i=e.start(n);t.push([r,i])}return Zo.createTimeRanges(t)},xu=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},Tu=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.length?e.end(e.length-1):0;return(r-t)/n},Cu=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},Su=function(e,t,n){var r=t.player_;if(n.captions&&n.captions.length)for(var i in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[i]){r.tech_.trigger({type:"usage",name:"hls-608"});var a=r.textTracks().getTrackById(i);e.inbandTextTracks_[i]=a||r.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)},Eu=function(e,t,n){var r=void 0,i=void 0;if(n&&n.cues){r=n.cues.length;while(r--)i=n.cues[r],i.startTime<=t&&i.endTime>=e&&n.removeCue(i)}},ku=function(e){Object.defineProperties(e.frame,{id:{get:function(){return Zo.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return Zo.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return Zo.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})},Ru=function(e){var t=void 0;return t=isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e,t},Ou=function(e,t,n){var r=i.a.WebKitDataCue||i.a.VTTCue;if(t&&t.forEach((function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))}),e),n){var a=Ru(e.mediaSource_.duration);if(n.forEach((function(e){var t=e.cueTime+this.timestampOffset;!("number"!==typeof t||i.a.isNaN(t)||t<0)&&t<1/0&&e.frames.forEach((function(e){var n=new r(t,t,e.value||e.url||e.data||"");n.frame=e,n.value=e,ku(n),this.metadataTrack_.addCue(n)}),this)}),e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var o=e.metadataTrack_.cues,s=[],u=0;u<o.length;u++)o[u]&&s.push(o[u]);var c=s.reduce((function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e}),{}),l=Object.keys(c).sort((function(e,t){return Number(e)-Number(t)}));l.forEach((function(e,t){var n=c[e],r=Number(l[t+1])||a;n.forEach((function(e){e.endTime=r}))}))}}},Au="undefined"!==typeof window?window:{},Iu="undefined"===typeof Symbol?"__target":Symbol(),Nu="application/javascript",Du=Au.BlobBuilder||Au.WebKitBlobBuilder||Au.MozBlobBuilder||Au.MSBlobBuilder,Pu=Au.URL||Au.webkitURL||Pu&&Pu.msURL,Mu=Au.Worker;function Lu(e,t){return function(n){var r=this;if(!t)return new Mu(e);if(Mu&&!n){var i=t.toString().replace(/^function.+?{/,"").slice(0,-1),a=Fu(i);return this[Iu]=new Mu(a),Vu(this[Iu],a),this[Iu]}var o={postMessage:function(e){r.onmessage&&setTimeout((function(){r.onmessage({data:e,target:o})}))}};t.call(o),this.postMessage=function(e){setTimeout((function(){o.onmessage({data:e,target:r})}))},this.isThisThread=!0}}if(Mu){var ju,Bu=Fu("self.onmessage = function () {}"),Uu=new Uint8Array(1);try{ju=new Mu(Bu),ju.postMessage(Uu,[Uu.buffer])}catch(Xl){Mu=null}finally{Pu.revokeObjectURL(Bu),ju&&ju.terminate()}}function Fu(e){try{return Pu.createObjectURL(new Blob([e],{type:Nu}))}catch(Xl){var t=new Du;return t.append(e),Pu.createObjectURL(t.getBlob(type))}}function Vu(e,t){if(e&&t){var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Pu.revokeObjectURL(e.objURL),n.call(e)}}}var qu=new Lu("./transmuxer-worker.worker.js",(function(e,t){var n=this;(function(){var e=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var r;return!!e[t]&&(r=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var n,r,i,a;if(n=e[t],n)if(2===arguments.length)for(i=n.length,r=0;r<i;++r)n[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(i=n.length,r=0;r<i;++r)n[r].apply(this,a)}},this.dispose=function(){e={}}}};e.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var t,r,i,a,o,s,u,c,l,d,p,h,f,m,v,g,y,b,_,w,x,T,C,S,E,k,R,O,A,I,N,D,P,M,L,j,B=e,U=Math.pow(2,32)-1;(function(){var e;if(C={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(e in C)C.hasOwnProperty(e)&&(C[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);S=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),k=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),E=new Uint8Array([0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),O=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),A={video:R,audio:O},D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),N=new Uint8Array([0,0,0,0,0,0,0,0]),P=new Uint8Array([0,0,0,0,0,0,0,0]),M=P,L=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),j=P,I=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),t=function(e){var t,n,r,i=[],a=0;for(t=1;t<arguments.length;t++)i.push(arguments[t]);t=i.length;while(t--)a+=i[t].byteLength;for(n=new Uint8Array(a+8),r=new DataView(n.buffer,n.byteOffset,n.byteLength),r.setUint32(0,n.byteLength),n.set(e,4),t=0,a=8;t<i.length;t++)n.set(i[t],a),a+=i[t].byteLength;return n},r=function(){return t(C.dinf,t(C.dref,D))},i=function(e){return t(C.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},a=function(){return t(C.ftyp,S,E,S,k)},g=function(e){return t(C.hdlr,A[e])},o=function(e){return t(C.mdat,e)},v=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(n[12]=e.samplerate>>>24&255,n[13]=e.samplerate>>>16&255,n[14]=e.samplerate>>>8&255,n[15]=255&e.samplerate),t(C.mdhd,n)},m=function(e){return t(C.mdia,v(e),g(e.type),u(e))},s=function(e){return t(C.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},u=function(e){return t(C.minf,"video"===e.type?t(C.vmhd,I):t(C.smhd,N),r(),b(e))},c=function(e,n){var r=[],i=n.length;while(i--)r[i]=w(n[i]);return t.apply(null,[C.moof,s(e)].concat(r))},l=function(e){var n=e.length,r=[];while(n--)r[n]=h(e[n]);return t.apply(null,[C.moov,p(4294967295)].concat(r).concat(d(e)))},d=function(e){var n=e.length,r=[];while(n--)r[n]=x(e[n]);return t.apply(null,[C.mvex].concat(r))},p=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(C.mvhd,n)},y=function(e){var n,r,i=e.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t(C.sdtp,a)},b=function(e){return t(C.stbl,_(e),t(C.stts,j),t(C.stsc,M),t(C.stsz,L),t(C.stco,P))},function(){var e,n;_=function(r){return t(C.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===r.type?e(r):n(r))},e=function(e){var n,r,i=e.sps||[],a=e.pps||[],o=[],s=[];for(n=0;n<i.length;n++)o.push((65280&i[n].byteLength)>>>8),o.push(255&i[n].byteLength),o=o.concat(Array.prototype.slice.call(i[n]));for(n=0;n<a.length;n++)s.push((65280&a[n].byteLength)>>>8),s.push(255&a[n].byteLength),s=s.concat(Array.prototype.slice.call(a[n]));if(r=[C.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(C.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([i.length],o,[a.length],s))),t(C.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var u=e.sarRatio[0],c=e.sarRatio[1];r.push(t(C.pasp,new Uint8Array([(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,(4278190080&c)>>24,(16711680&c)>>16,(65280&c)>>8,255&c])))}return t.apply(null,r)},n=function(e){return t(C.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),i(e))}}(),f=function(e){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(C.tkhd,n)},w=function(e){var n,r,i,a,o,s,u;return n=t(C.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(e.baseMediaDecodeTime/(U+1)),u=Math.floor(e.baseMediaDecodeTime%(U+1)),r=t(C.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,u>>>24&255,u>>>16&255,u>>>8&255,255&u])),o=92,"audio"===e.type?(i=T(e,o),t(C.traf,n,r,i)):(a=y(e),i=T(e,a.length+o),t(C.traf,n,r,i,a))},h=function(e){return e.duration=e.duration||4294967295,t(C.trak,f(e),m(e))},x=function(e){var n=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(n[n.length-1]=0),t(C.trex,n)},function(){var e,n,r;r=function(e,t){var n=0,r=0,i=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(i=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|r|i|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},n=function(e,n){var i,a,o,s;for(a=e.samples||[],n+=20+16*a.length,i=r(a,n),s=0;s<a.length;s++)o=a[s],i=i.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size,o.flags.isLeading<<2|o.flags.dependsOn,o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,61440&o.flags.degradationPriority,15&o.flags.degradationPriority,(4278190080&o.compositionTimeOffset)>>>24,(16711680&o.compositionTimeOffset)>>>16,(65280&o.compositionTimeOffset)>>>8,255&o.compositionTimeOffset]);return t(C.trun,new Uint8Array(i))},e=function(e,n){var i,a,o,s;for(a=e.samples||[],n+=20+8*a.length,i=r(a,n),s=0;s<a.length;s++)o=a[s],i=i.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size]);return t(C.trun,new Uint8Array(i))},T=function(t,r){return"audio"===t.type?e(t,r):n(t,r)}}();var F,V,q,W,z,G,H,$={ftyp:a,mdat:o,moof:c,moov:l,initSegment:function(e){var t,n=a(),r=l(e);return t=new Uint8Array(n.byteLength+r.byteLength),t.set(n),t.set(r,n.byteLength),t}},K=function(e){var t,n,r=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,r.byteLength=0,t=0;t<e.length;t++)n=e[t],"access_unit_delimiter_rbsp"===n.nalUnitType?(r.length&&(r.duration=n.dts-r.dts,i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r)),r=[n],r.byteLength=n.data.byteLength,r.pts=n.pts,r.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(r.keyFrame=!0),r.duration=n.dts-r.dts,r.byteLength+=n.data.byteLength,r.push(n));return i.length&&(!r.duration||r.duration<=0)&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r),i},Y=function(e){var t,n,r=[],i=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,t=0;t<e.length;t++)n=e[t],n.keyFrame?(r.length&&(i.push(r),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration),r=[n],r.nalCount=n.length,r.byteLength=n.byteLength,r.pts=n.pts,r.dts=n.dts,r.duration=n.duration):(r.duration+=n.duration,r.nalCount+=n.length,r.byteLength+=n.byteLength,r.push(n));return i.length&&r.duration<=0&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration,i.push(r),i},X=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},J=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Q=function(e,t){var n=J();return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},Z=function(e,t){var n,r,i,a,o,s=t||0,u=[];for(n=0;n<e.length;n++)for(a=e[n],r=0;r<a.length;r++)o=a[r],i=Q(o,s),s+=i.size,u.push(i);return u},ee=function(e){var t,n,r,i,a,o,s=0,u=e.byteLength,c=e.nalCount,l=u+4*c,d=new Uint8Array(l),p=new DataView(d.buffer);for(t=0;t<e.length;t++)for(i=e[t],n=0;n<i.length;n++)for(a=i[n],r=0;r<a.length;r++)o=a[r],p.setUint32(s,o.data.byteLength),s+=4,d.set(o.data,s),s+=o.data.byteLength;return d},te=function(e,t){var n,r=t||0,i=[];return n=Q(e,r),i.push(n),i},ne=function(e){var t,n,r=0,i=e.byteLength,a=e.length,o=i+4*a,s=new Uint8Array(o),u=new DataView(s.buffer);for(t=0;t<e.length;t++)n=e[t],u.setUint32(r,n.data.byteLength),r+=4,s.set(n.data,r),r+=n.data.byteLength;return s},re={groupNalsIntoFrames:K,groupFramesIntoGops:Y,extendFirstKeyFrame:X,generateSampleTable:Z,concatenateNalData:ee,generateSampleTableForFrame:te,concatenateNalDataForFrame:ne},ie=[33,16,5,32,164,27],ae=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],oe=function(e){var t=[];while(e--)t.push(0);return t},se=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=new Uint8Array(e[n].reduce((function(e,t){return e.concat(t)}),[])),t}),{})},ue={96e3:[ie,[227,64],oe(154),[56]],88200:[ie,[231],oe(170),[56]],64e3:[ie,[248,192],oe(240),[56]],48e3:[ie,[255,192],oe(268),[55,148,128],oe(54),[112]],44100:[ie,[255,192],oe(268),[55,163,128],oe(84),[112]],32e3:[ie,[255,192],oe(268),[55,234],oe(226),[112]],24e3:[ie,[255,192],oe(268),[55,255,128],oe(268),[111,112],oe(126),[224]],16e3:[ie,[255,192],oe(268),[55,255,128],oe(268),[111,255],oe(269),[223,108],oe(195),[1,192]],12e3:[ae,oe(268),[3,127,248],oe(268),[6,255,240],oe(268),[13,255,224],oe(268),[27,253,128],oe(259),[56]],11025:[ae,oe(268),[3,127,248],oe(268),[6,255,240],oe(268),[13,255,224],oe(268),[27,255,192],oe(268),[55,175,128],oe(108),[112]],8e3:[ae,oe(268),[3,121,16],oe(47),[7]]},ce=se(ue),le=9e4;F=function(e){return e*le},V=function(e,t){return e*t},q=function(e){return e/le},W=function(e,t){return e/t},z=function(e,t){return F(W(e,t))},G=function(e,t){return V(q(e),t)},H=function(e,t,n){return q(n?e:e-t)};var de={ONE_SECOND_IN_TS:le,secondsToVideoTs:F,secondsToAudioTs:V,videoTsToSeconds:q,audioTsToSeconds:W,audioTsToVideoTs:z,videoTsToAudioTs:G,metadataTsToSeconds:H},pe=function(e){var t,n,r=0;for(t=0;t<e.length;t++)n=e[t],r+=n.data.byteLength;return r},he=function(e,t,n,r){var i,a,o,s,u=0,c=0,l=0,d=0;if(t.length&&(i=de.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),u=Math.ceil(de.ONE_SECOND_IN_TS/(e.samplerate/1024)),n&&r&&(c=i-Math.max(n,r),l=Math.floor(c/u),d=l*u),!(l<1||d>de.ONE_SECOND_IN_TS/2))){for(a=ce[e.samplerate],a||(a=t[0].data),o=0;o<l;o++)s=t[0],t.splice(0,0,{data:a,dts:s.dts-u,pts:s.pts-u});e.baseMediaDecodeTime-=Math.floor(de.videoTsToAudioTs(d,e.samplerate))}},fe=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},me=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t],r.push({size:n.data.byteLength,duration:1024});return r},ve=function(e){var t,n,r=0,i=new Uint8Array(pe(e));for(t=0;t<e.length;t++)n=e[t],i.set(n.data,r),r+=n.data.byteLength;return i},ge={prefixWithSilence:he,trimAdtsFramesByEarliestDts:fe,generateSampleTable:me,concatenateFrameData:ve},ye=de.ONE_SECOND_IN_TS,be=function(e,t){"number"===typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"===typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},_e=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},we=function(e,t){var n,r,i=e.minSegmentDts;return t||(i-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=i,n=Math.max(0,n),"audio"===e.type&&(r=e.samplerate/ye,n*=r,n=Math.floor(n)),n},xe={clearDtsInfo:_e,calculateTrackBaseMediaDecodeTime:we,collectDtsInfo:be},Te=4,Ce=128,Se=function(e){var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;while(t<e.byteLength){if(e[t]===Ce)break;while(255===e[t])r+=255,t++;r+=e[t++];while(255===e[t])i+=255,t++;if(i+=e[t++],!n.payload&&r===Te){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}t+=i,r=0,i=0}return n},Ee=function(e){return 181!==e.payload[0]||49!==(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},ke=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)i=3*n,a={type:3&t[i+2],pts:e},4&t[i+2]&&(a.ccData=t[i+3]<<8|t[i+4],o.push(a));return o},Re=function(e){var t,n,r=e.byteLength,i=[],a=1;while(a<r-2)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},Oe={parseSei:Se,parseUserData:Ee,parseCaptionPackets:ke,discardEmulationPreventionBytes:Re,USER_DATA_REGISTERED_ITU_T_T35:Te},Ae=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Le(0,0),new Le(0,1),new Le(1,0),new Le(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};Ae.prototype=new B,Ae.prototype.push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=Oe.parseSei(e.escapedRBSP),t.payloadType===Oe.USER_DATA_REGISTERED_ITU_T_T35&&(n=Oe.parseUserData(t),n)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=Oe.parseCaptionPackets(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},Ae.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},Ae.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},Ae.prototype.flush=function(){return this.flushStream("flush")},Ae.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ae.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},Ae.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},Ae.prototype.setsChannel1Active=function(e){return 4096===(30720&e.ccData)},Ae.prototype.setsChannel2Active=function(e){return 6144===(30720&e.ccData)},Ae.prototype.setsTextOrXDSActive=function(e){return 256===(28928&e.ccData)||4138===(30974&e.ccData)||6186===(30974&e.ccData)};var Ie={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ne=function(e){return null===e?"":(e=Ie[e]||e,String.fromCharCode(e))},De=14,Pe=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Me=function(){var e=[],t=De+1;while(t--)e.push("");return e},Le=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if(t=32639&e.ccData,t!==this.lastControlCode_){if(4096===(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Me();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Me();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Me()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))r=(3&r)<<8,a=Ne(r|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),r=(3&r)<<8,a=Ne(r|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14===(14&i)&&this.addFormatting(e.pts,["i"]),1===(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=Pe.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16===(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14===(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=Ne(r),a+=Ne(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Le.prototype=new B,Le.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(Xl){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Le.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Me(),this.nonDisplayed_=Me(),this.lastControlCode_=null,this.column_=0,this.row_=De,this.rollUpRows_=2,this.formatting_=[]},Le.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Le.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Le.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Le.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Le.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Le.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Le.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Le.prototype.isNormalChar=function(e){return e>=32&&e<=127},Le.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=De,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Me(),this.displayed_=Me()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Le.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},Le.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},Le.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Le.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Le.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<De+1;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Le.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var je={CaptionStream:Ae,Cea608Stream:Le},Be={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ue=8589934592,Fe=4294967296,Ve="shared",qe=function(e,t){var n=1;e>t&&(n=-1);while(Math.abs(t-e)>Fe)e+=n*Ue;return e},We=function e(t){var n,r;e.prototype.init.call(this),this.type_=t||Ve,this.push=function(e){this.type_!==Ve&&e.type!==this.type_||(void 0===r&&(r=e.dts),e.dts=qe(e.dts,r),e.pts=qe(e.pts,r),n=e.dts,this.trigger("data",e))},this.flush=function(){r=n,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){r=void 0,n=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};We.prototype=new B;var ze,Ge={TimestampRolloverStream:We,handleRollover:qe},He=function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i},$e=function(e,t,n){return decodeURIComponent(He(e,t,n))},Ke=function(e,t,n){return unescape(He(e,t,n))},Ye=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},Xe={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.value=$e(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=$e(e.data,1,t),e.url=$e(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=Ke(e.data,0,t);break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};ze=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},r=0,i=[],a=0;if(ze.prototype.init.call(this),this.dispatchType=Be.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,u,c,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,i.length=0),0===i.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(i.push(e),a+=e.data.byteLength,1===i.length&&(r=Ye(e.data.subarray(6,10)),r+=10),!(a<r)){for(t={data:new Uint8Array(r),frames:[],pts:i[0].pts,dts:i[0].dts},c=0;c<r;)t.data.set(i[0].data.subarray(0,r-c),c),c+=i[0].data.byteLength,a-=i[0].data.byteLength,i.shift();o=10,64&t.data[5]&&(o+=4,o+=Ye(t.data.subarray(10,14)),r-=Ye(t.data.subarray(16,20)));do{if(s=Ye(t.data.subarray(o+4,o+8)),s<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(l=String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),u={id:l,data:t.data.subarray(o+10,o+s+10)},u.key=u.id,Xe[u.id]&&(Xe[u.id](u),"com.apple.streaming.transportStreamTimestamp"===u.owner)){var d=u.data,p=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;p*=4,p+=3&d[7],u.timeStamp=p,void 0===t.pts&&void 0===t.dts&&(t.pts=u.timeStamp,t.dts=u.timeStamp),this.trigger("timestamp",u)}t.frames.push(u),o+=10,o+=s}while(o<r);this.trigger("data",t)}}},ze.prototype=new B;var Je,Qe,Ze,et=ze,tt=Ge.TimestampRolloverStream,nt=188,rt=71;Je=function(){var e=new Uint8Array(nt),t=0;Je.prototype.init.call(this),this.push=function(n){var r,i=0,a=nt;t?(r=new Uint8Array(n.byteLength+t),r.set(e.subarray(0,t)),r.set(n,t),t=0):r=n;while(a<r.byteLength)r[i]!==rt||r[a]!==rt?(i++,a++):(this.trigger("data",r.subarray(i,a)),i+=nt,a+=nt);i<r.byteLength&&(e.set(r.subarray(i),0),t=r.byteLength-i)},this.flush=function(){t===nt&&e[0]===rt&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}},Je.prototype=new B,Qe=function(){var e,t,n,r;Qe.prototype.init.call(this),r=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,r){var i=0;r.payloadUnitStartIndicator&&(i+=e[i]+1),"pat"===r.type?t(e.subarray(i),r):n(e.subarray(i),r)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],r.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=r.pmtPid},n=function(e,t){var n,i,a,o;if(1&e[5]){r.programMapTable={video:null,audio:null,"timed-metadata":{}},n=(15&e[1])<<8|e[2],i=3+n-4,a=(15&e[10])<<8|e[11],o=12+a;while(o<i){var s=e[o],u=(31&e[o+1])<<8|e[o+2];s===Be.H264_STREAM_TYPE&&null===r.programMapTable.video?r.programMapTable.video=u:s===Be.ADTS_STREAM_TYPE&&null===r.programMapTable.audio?r.programMapTable.audio=u:s===Be.METADATA_STREAM_TYPE&&(r.programMapTable["timed-metadata"][u]=s),o+=5+((15&e[o+3])<<8|e[o+4])}t.programMapTable=r.programMapTable}},this.push=function(t){var n={},r=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(r+=t[r]+1),0===n.pid)n.type="pat",e(t.subarray(r),n),this.trigger("data",n);else if(n.pid===this.pmtPid){n.type="pmt",e(t.subarray(r),n),this.trigger("data",n);while(this.packetsWaitingForPmt.length)this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,r,n]):this.processPes_(t,r,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Be.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Be.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}},Qe.prototype=new B,Qe.STREAM_TYPES={h264:27,adts:15},Ze=function(){var e,t=this,n={data:[],size:0},r={data:[],size:0},i={data:[],size:0},a=function(e,t){var n;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!==(4&e[6]),n=e[7],192&n&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&n&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])},o=function(e,n,r){var i,o=new Uint8Array(e.size),s={type:n},u=0,c=0,l=!1;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,u=0;u<e.data.length;u++)i=e.data[u],o.set(i.data,c),c+=i.data.byteLength;a(o,s),l="video"===n||s.packetLength<=e.size,(r||l)&&(e.size=0,e.data.length=0),l&&t.trigger("data",s)}};Ze.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var e,t;switch(a.streamType){case Be.H264_STREAM_TYPE:case Be.H264_STREAM_TYPE:e=n,t="video";break;case Be.ADTS_STREAM_TYPE:e=r,t="audio";break;case Be.METADATA_STREAM_TYPE:e=i,t="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&o(e,t,!0),e.data.push(a),e.size+=a.data.byteLength},pmt:function(){var n={type:"metadata",tracks:[]};e=a.programMapTable,null!==e.video&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",n)}})[a.type]()},this.reset=function(){n.size=0,n.data.length=0,r.size=0,r.data.length=0,this.trigger("reset")},this.flushStreams_=function(){o(n,"video"),o(r,"audio"),o(i,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}},Ze.prototype=new B;var it={PAT_PID:0,MP2T_PACKET_LENGTH:nt,TransportPacketStream:Je,TransportParseStream:Qe,ElementaryStream:Ze,TimestampRolloverStream:tt,CaptionStream:je.CaptionStream,Cea608Stream:je.Cea608Stream,MetadataStream:et};for(var at in Be)Be.hasOwnProperty(at)&&(it[at]=Be[at]);var ot,st=it,ut=de.ONE_SECOND_IN_TS,ct=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];ot=function(e){var t,n=0;ot.prototype.init.call(this),this.push=function(r){var i,a,o,s,u,c,l=0;if(e||(n=0),"audio"===r.type){t?(s=t,t=new Uint8Array(s.byteLength+r.data.byteLength),t.set(s),t.set(r.data,s.byteLength)):t=r.data;while(l+5<t.length)if(255===t[l]&&240===(246&t[l+1])){if(a=2*(1&~t[l+1]),i=(3&t[l+3])<<11|t[l+4]<<3|(224&t[l+5])>>5,u=1024*(1+(3&t[l+6])),c=u*ut/ct[(60&t[l+2])>>>2],o=l+i,t.byteLength<o)return;if(this.trigger("data",{pts:r.pts+n*c,dts:r.dts+n*c,sampleCount:u,audioobjecttype:1+(t[l+2]>>>6&3),channelcount:(1&t[l+2])<<2|(192&t[l+3])>>>6,samplerate:ct[(60&t[l+2])>>>2],samplingfrequencyindex:(60&t[l+2])>>>2,samplesize:16,data:t.subarray(l+7+a,o)}),n++,t.byteLength===o)return void(t=void 0);t=t.subarray(o)}else l++}},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}},ot.prototype=new B;var lt,dt=ot;lt=function(e){var t=e.byteLength,n=0,r=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+r},this.loadWord=function(){var i=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(i,i+o)),n=new DataView(a.buffer).getUint32(0),r=8*o,t-=o},this.skipBits=function(e){var i;r>e?(n<<=e,r-=e):(e-=r,i=Math.floor(e/8),e-=8*i,t-=i,this.loadWord(),n<<=e,r-=e)},this.readBits=function(e){var i=Math.min(r,e),a=n>>>32-i;return r-=i,r>0?n<<=i:t>0&&this.loadWord(),i=e-i,i>0?a<<i|this.readBits(i):a},this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!==(n&2147483648>>>e))return n<<=e,r-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var pt,ht,ft,mt=lt;ht=function(){var e,t,n=0;ht.prototype.init.call(this),this.push=function(r){var i;t?(i=new Uint8Array(t.byteLength+r.data.byteLength),i.set(t),i.set(r.data,t.byteLength),t=i):t=r.data;for(var a=t.byteLength;n<a-3;n++)if(1===t[n+2]){e=n+5;break}while(e<a)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<a);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3;break}t=t.subarray(n),e-=n,n=0},this.reset=function(){t=null,n=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},ht.prototype=new B,ft={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},pt=function(){var e,t,n,r,i,a,o,s=new ht;pt.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,r=e.dts,s.push(e))},s.on("data",(function(o){var s={trackId:t,pts:n,dts:r,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=i(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=i(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp";break}e.trigger("data",s)})),s.on("done",(function(){e.trigger("done")})),s.on("partialdone",(function(){e.trigger("partialdone")})),s.on("reset",(function(){e.trigger("reset")})),s.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){s.flush()},this.partialFlush=function(){s.partialFlush()},this.reset=function(){s.reset()},this.endTimeline=function(){s.endTimeline()},o=function(e,t){var n,r,i=8,a=8;for(n=0;n<e;n++)0!==a&&(r=t.readExpGolomb(),a=(i+r+256)%256),i=0===a?i:a},i=function(e){var t,n,r=e.byteLength,i=[],a=1;while(a<r-2)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},a=function(e){var t,n,r,i,a,s,u,c,l,d,p,h,f,m,v=0,g=0,y=0,b=0,_=1;if(t=new mt(e),n=t.readUnsignedByte(),i=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ft[n]&&(a=t.readUnsignedExpGolomb(),3===a&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(p=3!==a?8:12,m=0;m<p;m++)t.readBoolean()&&o(m<6?16:64,t);if(t.skipUnsignedExpGolomb(),s=t.readUnsignedExpGolomb(),0===s)t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),u=t.readUnsignedExpGolomb(),m=0;m<u;m++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),c=t.readUnsignedExpGolomb(),l=t.readUnsignedExpGolomb(),d=t.readBits(1),0===d&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(v=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb(),b=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(f=t.readUnsignedByte(),f){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()];break}h&&(_=h[0]/h[1])}return{profileIdc:n,levelIdc:r,profileCompatibility:i,width:Math.ceil((16*(c+1)-2*v-2*g)*_),height:(2-d)*(l+1)*16-2*y-2*b,sarRatio:h}}},pt.prototype=new B;var vt,gt={H264Stream:pt,NalByteStream:ht},yt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],bt=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},_t=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},wt=function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i},xt=function(e,t,n){return unescape(wt(e,t,n))},Tt=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],r=e[t+5],i=(16&r)>>4;return i?n+20:n+10},Ct=function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3,i=6144&e[t+3];return i|r|n},St=function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240===(240&e[t+1])?"audio":null},Et=function(e){var t=0;while(t+5<e.length){if(255===e[t]&&240===(246&e[t+1]))return yt[(60&e[t+2])>>>2];t++}return null},kt=function(e){var t,n,r,i;t=10,64&e[5]&&(t+=4,t+=_t(e.subarray(10,14)));do{if(n=_t(e.subarray(t+4,t+8)),n<1)return null;if(i=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]),"PRIV"===i){r=e.subarray(t+10,t+n+10);for(var a=0;a<r.byteLength;a++)if(0===r[a]){var o=xt(r,0,a);if("com.apple.streaming.transportStreamTimestamp"===o){var s=r.subarray(a+1),u=(1&s[3])<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2;return u*=4,u+=3&s[7],u}break}}t+=10,t+=n}while(t<e.byteLength);return null},Rt={isLikelyAacData:bt,parseId3TagSize:Tt,parseAdtsSize:Ct,parseType:St,parseSampleRate:Et,parseAacTimestamp:kt};vt=function(){var e=new Uint8Array,t=0;vt.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var r,i,a,o,s=0,u=0;e.length?(o=e.length,e=new Uint8Array(n.byteLength+o),e.set(e.subarray(0,o)),e.set(n,o)):e=n;while(e.length-u>=3)if(e[u]!=="I".charCodeAt(0)||e[u+1]!=="D".charCodeAt(0)||e[u+2]!=="3".charCodeAt(0))if(255!==(255&e[u])||240!==(240&e[u+1]))u++;else{if(e.length-u<7)break;if(s=Rt.parseAdtsSize(e,u),u+s>e.length)break;a={type:"audio",data:e.subarray(u,u+s),pts:t,dts:t},this.trigger("data",a),u+=s}else{if(e.length-u<10)break;if(s=Rt.parseId3TagSize(e,u),u+s>e.length)break;i={type:"timed-metadata",data:e.subarray(u,u+s)},this.trigger("data",i),u+=s}r=e.length-u,e=r>0?e.subarray(u):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}},vt.prototype=new B;var Ot,At,It,Nt,Dt=vt,Pt=gt.H264Stream,Mt=Rt.isLikelyAacData,Lt=de.ONE_SECOND_IN_TS,jt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Bt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Ut=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},Ft=function(e,t,n,r,i,a){var o=n-t,s=r-t,u=i-n;return{start:{dts:e,pts:e+o},end:{dts:e+s,pts:e+u},prependedContentDuration:a,baseMediaDecodeTime:e}};At=function(e,t){var n=[],r=0,i=0,a=0,o=1/0;t=t||{},At.prototype.init.call(this),this.push=function(t){xe.collectDtsInfo(e,t),e&&jt.forEach((function(n){e[n]=t[n]})),n.push(t)},this.setEarliestDts=function(t){i=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,u,c,l,d;0!==n.length?(s=ge.trimAdtsFramesByEarliestDts(n,e,i),e.baseMediaDecodeTime=xe.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),ge.prefixWithSilence(e,s,a,o),e.samples=ge.generateSampleTable(s),c=$.mdat(ge.concatenateFrameData(s)),n=[],u=$.moof(r,[e]),l=new Uint8Array(u.byteLength+c.byteLength),r++,l.set(u),l.set(c,u.byteLength),xe.clearDtsInfo(e),d=Math.ceil(1024*Lt/e.samplerate),s.length&&this.trigger("timingInfo",{start:s[0].pts,end:s[0].pts+s.length*d}),this.trigger("data",{track:e,boxes:l}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){xe.clearDtsInfo(e),n=[],this.trigger("reset")}},At.prototype=new B,Ot=function(e,t){var n,r,i=0,a=[],o=[];t=t||{},Ot.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){xe.collectDtsInfo(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],Bt.forEach((function(t){e[t]=n[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){var n,r,s,u,c,l,d,p,h=0;while(a.length){if("access_unit_delimiter_rbsp"===a[0].nalUnitType)break;a.shift()}if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=re.groupNalsIntoFrames(a),s=re.groupFramesIntoGops(n),s[0][0].keyFrame||(r=this.getGopForFusion_(a[0],e),r?(h=r.duration,s.unshift(r),s.byteLength+=r.byteLength,s.nalCount+=r.nalCount,s.pts=r.pts,s.dts=r.dts,s.duration+=r.duration):s=re.extendFirstKeyFrame(s)),o.length){var f;if(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s),!f)return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");xe.clearDtsInfo(e),s=f}xe.collectDtsInfo(e,s),e.samples=re.generateSampleTable(s),c=$.mdat(re.concatenateNalData(s)),e.baseMediaDecodeTime=xe.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),d=s[0],p=s[s.length-1],this.trigger("segmentTimingInfo",Ft(e.baseMediaDecodeTime,d.dts,d.pts,p.dts+p.duration,p.pts+p.duration,h)),this.trigger("timingInfo",{start:s[0].pts,end:s[s.length-1].pts+s[s.length-1].duration}),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),u=$.moof(i,[e]),l=new Uint8Array(u.byteLength+c.byteLength),i++,l.set(u),l.set(c,u.byteLength),this.trigger("data",{track:e,boxes:l}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,o.length=0,this.trigger("reset")},this.resetStream_=function(){xe.clearDtsInfo(e),n=void 0,r=void 0},this.getGopForFusion_=function(t){var n,r,i,a,o,s=45e3,u=1e4,c=1/0;for(o=0;o<this.gopCache_.length;o++)a=this.gopCache_[o],i=a.gop,e.pps&&Ut(e.pps[0],a.pps[0])&&e.sps&&Ut(e.sps[0],a.sps[0])&&(i.dts<e.timelineStartInfo.dts||(n=t.dts-i.dts-i.duration,n>=-u&&n<=s&&(!r||c>n)&&(r=a,c=n)));return r?r.gop:null},this.alignGopsAtStart_=function(e){var t,n,r,i,a,s,u,c;a=e.byteLength,s=e.nalCount,u=e.duration,t=n=0;while(t<o.length&&n<e.length){if(r=o[t],i=e[n],r.pts===i.pts)break;i.pts>r.pts?t++:(n++,a-=i.byteLength,s-=i.nalCount,u-=i.duration)}return 0===n?e:n===e.length?null:(c=e.slice(n),c.byteLength=a,c.duration=u,c.nalCount=s,c.pts=c[0].pts,c.dts=c[0].dts,c)},this.alignGopsAtEnd_=function(e){var t,n,r,i,a,s,u;t=o.length-1,n=e.length-1,a=null,s=!1;while(t>=0&&n>=0){if(r=o[t],i=e[n],r.pts===i.pts){s=!0;break}r.pts>i.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(u=s?n:a,0===u)return e;var c=e.slice(u),l=c.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return c.byteLength=l.byteLength,c.duration=l.duration,c.nalCount=l.nalCount,c.pts=c[0].pts,c.dts=c[0].dts,c},this.alignGopsWith=function(e){o=e}},Ot.prototype=new B,Nt=function(e,t){this.numberOfTracks=0,this.metadataStream=t,e=e||{},"undefined"!==typeof e.remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"===typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Nt.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}},Nt.prototype=new B,Nt.prototype.flush=function(e){var t,n,r,i,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,Bt.forEach((function(e){o.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,jt.forEach((function(e){o.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,r=$.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(r.byteLength),o.initSegment.set(r),o.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)o.data.set(this.pendingBoxes[i],a),a+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)t=this.pendingCaptions[i],t.startTime=de.metadataTsToSeconds(t.startPts,s,this.keepOriginalTimestamps),t.endTime=de.metadataTsToSeconds(t.endPts,s,this.keepOriginalTimestamps),o.captionStreams[t.stream]=!0,o.captions.push(t);for(i=0;i<this.pendingMetadata.length;i++)n=this.pendingMetadata[i],n.cueTime=de.metadataTsToSeconds(n.pts,s,this.keepOriginalTimestamps),o.metadata.push(n);for(o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),i=0;i<o.captions.length;i++)t=o.captions[i],this.trigger("caption",t);for(i=0;i<o.metadata.length;i++)n=o.metadata[i],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Nt.prototype.setRemux=function(e){this.remuxTracks=e},It=function(e){var t,n,r=this,i=!0;It.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="aac",i.metadataStream=new st.MetadataStream,i.aacStream=new Dt,i.audioTimestampRolloverStream=new st.TimestampRolloverStream("audio"),i.timedMetadataTimestampRolloverStream=new st.TimestampRolloverStream("timed-metadata"),i.adtsStream=new dt,i.coalesceStream=new Nt(e,i.metadataStream),i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream),i.metadataStream.on("timestamp",(function(e){i.aacStream.setTimestamp(e.timeStamp)})),i.aacStream.on("data",(function(a){"timed-metadata"!==a.type||i.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new At(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="ts",i.metadataStream=new st.MetadataStream,i.packetStream=new st.TransportPacketStream,i.parseStream=new st.TransportParseStream,i.elementaryStream=new st.ElementaryStream,i.timestampRolloverStream=new st.TimestampRolloverStream,i.adtsStream=new dt,i.h264Stream=new Pt,i.captionStream=new st.CaptionStream,i.coalesceStream=new Nt(e,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",(function(a){var o;if("metadata"===a.type){o=a.tracks.length;while(o--)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||(n=a.tracks[o],n.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(t=a.tracks[o],t.timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime);t&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new Ot(t,e),i.videoSegmentStream.on("timelineStartInfo",(function(e){n&&(n.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts))})),i.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",(function(e){n&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),i.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),n&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new At(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})}})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",(function(e){e.dispatchType=i.metadataStream.dispatchType,r.trigger("id3Frame",e)})),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(r){var i=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=r),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,xe.clearDtsInfo(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=r),i.audioTimestampRolloverStream&&i.audioTimestampRolloverStream.discontinuity()),t&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,xe.clearDtsInfo(t),i.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=r)),i.timestampRolloverStream&&i.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var n=this.transmuxPipeline_;e.remux=t,n&&n.coalesceStream&&n.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(i){var t=Mt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},It.prototype=new B;var Vt={Transmuxer:It,VideoSegmentStream:Ot,AudioSegmentStream:At,AUDIO_PROPERTIES:jt,VIDEO_PROPERTIES:Bt,generateVideoSegmentTimingInfo:Ft},qt=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Wt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),zt=function(e,t){t.on("data",(function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var r=t.data;t.data=r.buffer,e.postMessage({action:"data",segment:t,byteOffset:r.byteOffset,byteLength:r.byteLength},[t.data])})),t.captionStream&&t.captionStream.on("data",(function(t){e.postMessage({action:"caption",data:t})})),t.on("done",(function(t){e.postMessage({action:"done"})})),t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})})),t.on("videoSegmentTimingInfo",(function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}))},Gt=function(){function e(t,n){qt(this,e),this.options=n||{},this.self=t,this.init()}return Wt(e,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Vt.Transmuxer(this.options),zt(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),e}(),Ht=function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new Gt(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new Gt(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}},$t=new Ht(n)})()})),Wu={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},zu=function(e){return e.map((function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,n){var r=("00"+Number(t).toString(16)).slice(-2),i=("00"+Number(n).toString(16)).slice(-2);return"avc1."+r+"00"+i}))}))},Gu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={codecCount:0},n=void 0;return t.codecCount=e.split(",").length,t.codecCount=t.codecCount||2,n=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e),n&&(t.videoCodec=n[2],t.videoObjectTypeIndicator=n[3]),t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e),t.audioProfile=t.audioProfile&&t.audioProfile[2],t},Hu=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return zu([e])[0]}))},$u=function(e,t,n){return e+"/"+t+'; codecs="'+n.filter((function(e){return!!e})).join(", ")+'"'},Ku=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"},Yu=function(e){var t=e.attributes||{};return t.CODECS?Gu(t.CODECS):Wu},Xu=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var r in n){var i=n[r];if(i["default"]&&i.playlists)return Gu(i.playlists[0].attributes.CODECS).audioProfile}return null},Ju=function(e,t){var n=Ku(t),r=Yu(t),i=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&i.AUDIO){var s=e.mediaGroups.AUDIO[i.AUDIO];if(s)for(var u in o=!0,a=!1,s)if(!s[u].uri&&!s[u].playlists){a=!0;break}}o&&!r.audioProfile&&(a||(r.audioProfile=Xu(e,i.AUDIO)),r.audioProfile||(Zo.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),r.audioProfile=Wu.audioProfile));var c={};r.videoCodec&&(c.video=""+r.videoCodec+r.videoObjectTypeIndicator),r.audioProfile&&(c.audio="mp4a.40."+r.audioProfile);var l=$u("audio",n,[c.audio]),d=$u("video",n,[c.video]),p=$u("video",n,[c.video,c.audio]);return o?!a&&c.video?[d,l]:a||c.video?[p,l]:[l,l]:c.video?[p]:[l]},Qu=function(e){var t={type:"",parameters:{}},n=e.trim().split(";");return t.type=n.shift().trim(),n.forEach((function(e){var n=e.trim().split("=");if(n.length>1){var r=n[0].replace(/"/g,"").trim(),i=n[1].replace(/"/g,"").trim();t.parameters[r]=i}})),t},Zu=function(e){return/mp4a\.\d+.\d+/i.test(e)},ec=function(e){return/avc1\.[\da-f]+/i.test(e)},tc=function(e,t,n){if("undefined"===typeof t||null===t||!e.length)return[];var r=Math.ceil(9e4*(t-n+3)),i=void 0;for(i=0;i<e.length;i++)if(e[i].pts>r)break;return e.slice(i)},nc=function(e,t,n){if(!t.length)return e;if(n)return t.slice();var r=t[0].pts,i=0;for(i;i<e.length;i++)if(e[i].pts>=r)break;return e.slice(0,i).concat(t)},rc=function(e,t,n,r){var i=Math.ceil(9e4*(t-r)),a=Math.ceil(9e4*(n-r)),o=e.slice(),s=e.length;while(s--)if(e[s].pts<=a)break;if(-1===s)return o;var u=s+1;while(u--)if(e[u].pts<=i)break;return u=Math.max(u,0),o.splice(u,s-u+1),o},ic=function(e,t,n){var r=null,i=null,a=0,o=[],s=[];if(!e&&!t)return Zo.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return Zo.createTimeRange();var u=e.buffered,c=t.buffered,l=u.length;while(l--)o.push({time:u.start(l),type:"start"}),o.push({time:u.end(l),type:"end"});l=c.length;while(l--)o.push({time:c.start(l),type:"start"}),o.push({time:c.end(l),type:"end"});for(o.sort((function(e,t){return e.time-t.time})),l=0;l<o.length;l++)"start"===o[l].type?(a++,2===a&&(r=o[l].time)):"end"===o[l].type&&(a--,1===a&&(i=o[l].time)),null!==r&&null!==i&&(s.push([r,i]),r=null,i=null);return Zo.createTimeRanges(s)},ac=9e4,oc=function(e,t){var n=e.addSourceBuffer(t),r=Object.create(null);r.updating=!1,r.realBuffer_=n;var i=function(e){"function"===typeof n[e]?r[e]=function(){return n[e].apply(n,arguments)}:"undefined"===typeof r[e]&&Object.defineProperty(r,e,{get:function(){return n[e]},set:function(t){return n[e]=t}})};for(var a in n)i(a);return r},sc=function(e){function t(e,n){is(this,t);var r=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Zo.EventTarget));r.timestampOffset_=0,r.pendingBuffers_=[],r.bufferUpdating_=!1,r.mediaSource_=e,r.codecs_=n,r.audioCodec_=null,r.videoCodec_=null,r.audioDisabled_=!1,r.appendAudioInitSegment_=!0,r.gopBuffer_=[],r.timeMapping_=0,r.safeAppend_=Zo.browser.IE_VERSION>=11;var i={remux:!1,alignGopsAtEnd:r.safeAppend_};return r.codecs_.forEach((function(e){Zu(e)?r.audioCodec_=e:ec(e)&&(r.videoCodec_=e)})),r.transmuxer_=new qu,r.transmuxer_.postMessage({action:"init",options:i}),r.transmuxer_.onmessage=function(e){return"data"===e.data.action?r.data_(e):"done"===e.data.action?r.done_(e):"gopInfo"===e.data.action?r.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?r.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(r,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"===typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(r,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(r,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(r,"buffered",{get:function(){return ic(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),r}return ss(t,e),as(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),Su(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/ac,presentation:e.start.pts/ac},end:{decode:e.end.dts/ac,presentation:e.end.pts/ac},baseMediaDecodeTime:e.baseMediaDecodeTime/ac};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/ac),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach((function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var r=null;if(e.mediaSource_[n+"Buffer_"])r=e.mediaSource_[n+"Buffer_"],r.updating=!1;else{var i=n+"Codec_",a=n+'/mp4;codecs="'+e[i]+'"';r=oc(e.mediaSource_.nativeMediaSource_,a),e.mediaSource_[n+"Buffer_"]=r}e[n+"Buffer_"]=r,["update","updatestart","updateend"].forEach((function(i){r.addEventListener(i,(function(){if("audio"!==n||!e.audioDisabled_){"updateend"===i&&(e[n+"Buffer_"].updating=!1);var r=t.every((function(t){return!("audio"!==t||!e.audioDisabled_)||(n===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating)}));return r?e.trigger(i):void 0}}))}))}}))}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:tc(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=nc(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=rc(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Eu(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Eu(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length)return this.trigger("updateend"),void(this.bufferUpdating_=!1);e=this.pendingBuffers_.reduce((function(e,t){var n=t.type,r=t.data,i=t.initSegment;return e[n].segments.push(r),e[n].bytes+=r.byteLength,e[n].initSegment=i,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e}),e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),Ou(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,r=void 0;if(e.bytes){r=new Uint8Array(e.bytes),e.segments.forEach((function(e){r.set(e,n),n+=e.byteLength}));try{t.updating=!0,t.appendBuffer(r)}catch(i){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:i.message,originalError:i})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"dispose",value:function(){this.transmuxer_&&this.transmuxer_.terminate(),this.trigger("dispose"),this.off()}}]),t}(Zo.EventTarget),uc=function(e){function t(){is(this,t);var e=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=void 0;for(n in e.nativeMediaSource_=new i.a.MediaSource,e.nativeMediaSource_)n in t.prototype||"function"!==typeof e.nativeMediaSource_[n]||(e[n]=e.nativeMediaSource_[n].bind(e.nativeMediaSource_));return e.duration_=NaN,Object.defineProperty(e,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){this.duration_=e,e===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(e,"seekable",{get:function(){return this.duration_===1/0?Zo.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(e,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(e,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),e.sourceBuffers=[],e.activeSourceBuffers_=[],e.updateActiveSourceBuffers_=function(){if(e.activeSourceBuffers_.length=0,1===e.sourceBuffers.length){var t=e.sourceBuffers[0];return t.appendAudioInitSegment_=!0,t.audioDisabled_=!t.audioCodec_,void e.activeSourceBuffers_.push(t)}for(var n=!1,r=!0,i=0;i<e.player_.audioTracks().length;i++){var a=e.player_.audioTracks()[i];if(a.enabled&&"main"!==a.kind){n=!0,r=!1;break}}e.sourceBuffers.forEach((function(t,i){if(t.appendAudioInitSegment_=!0,t.videoCodec_&&t.audioCodec_)t.audioDisabled_=n;else if(t.videoCodec_&&!t.audioCodec_)t.audioDisabled_=!0,r=!1;else if(!t.videoCodec_&&t.audioCodec_&&(t.audioDisabled_=i?r:!r,t.audioDisabled_))return;e.activeSourceBuffers_.push(t)}))},e.onPlayerMediachange_=function(){e.sourceBuffers.forEach((function(e){e.appendAudioInitSegment_=!0}))},e.onHlsReset_=function(){e.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})}))},e.onHlsSegmentTimeMapping_=function(t){e.sourceBuffers.forEach((function(e){return e.timeMapping_=t.mapping}))},["sourceopen","sourceclose","sourceended"].forEach((function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))}),e),e.on("sourceopen",(function(t){var n=o.a.querySelector('[src="'+e.url_+'"]');n&&(e.player_=Zo(n.parentNode),e.player_&&(e.player_.tech_.on("hls-reset",e.onHlsReset_),e.player_.tech_.on("hls-segment-time-mapping",e.onHlsSegmentTimeMapping_),e.player_.audioTracks&&e.player_.audioTracks()&&(e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)),e.player_.on("mediachange",e.onPlayerMediachange_)))})),e.on("sourceended",(function(t){for(var n=Ru(e.duration),r=0;r<e.sourceBuffers.length;r++){var i=e.sourceBuffers[r],a=i.metadataTrack_&&i.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=n)}})),e.on("sourceclose",(function(e){this.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.terminate()})),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))})),e}return ss(t,e),as(t,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),n.name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=Qu(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var r=[];n.parameters&&n.parameters.codecs&&(r=n.parameters.codecs.split(","),r=zu(r),r=r.filter((function(e){return Zu(e)||ec(e)}))),0===r.length&&(r=["avc1.4d400d","mp4a.40.2"]),t=new sc(this,r),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}},{key:"dispose",value:function(){this.trigger("dispose"),this.off(),this.sourceBuffers.forEach((function(e){e.dispose&&e.dispose()})),this.sourceBuffers.length=0}}]),t}(Zo.EventTarget),cc=0;Zo.mediaSources={};var lc=function(e,t){var n=Zo.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})},dc=function(){return!!i.a.MediaSource&&!!i.a.MediaSource.isTypeSupported&&i.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},pc=function(){if(this.MediaSource={open:lc,supportsNativeMediaSources:dc},dc())return new uc;throw new Error("Cannot use create a virtual MediaSource for this video")};pc.open=lc,pc.supportsNativeMediaSources=dc;var hc={createObjectURL:function(e){var t="blob:vjs-media-source/",n=void 0;return e instanceof uc?(n=i.a.URL.createObjectURL(e.nativeMediaSource_),e.url_=n,n):e instanceof uc?(n=t+cc,cc++,Zo.mediaSources[n]=e,n):(n=i.a.URL.createObjectURL(e),e.url_=n,n)}};Zo.MediaSource=pc,Zo.URL=hc;var fc=Zo.EventTarget,mc=Zo.mergeOptions,vc=function(e,t){for(var n=void 0,r=mc(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),i=0;i<t.playlists.length;i++){var a=vs(r,t.playlists[i]);a?r=a:n=!0}return hs(t,(function(e,t,i,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].id,s=vs(r,e.playlists[0]);s&&(r=s,r.mediaGroups[t][i][a].playlists[0]=r.playlists[o],n=!1)}})),n?null:r},gc=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},yc=function(e,t){var n=Boolean(!e.map&&!t.map),r=n||Boolean(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length);return r&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length},bc=function(e,t){var n={};for(var r in e){var i=e[r],a=i.sidx;if(a){var o=gc(a);if(!t[o])break;var s=t[o].sidxInfo;yc(s,a)&&(n[o]=t[o])}}return n},_c=function(e,t,n,r){var i=Fe(e,{manifestUri:t,clientOffset:n}),a=bc(i.playlists,r),o=a;return hs(i,(function(e,t,n,i){if(e.playlists&&e.playlists.length){var a=e.playlists;o=mc(o,bc(a,r))}})),o},wc=function(e,t,n,r,i){var a={uri:rs(r.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t},o=Zo.mergeOptions(a,{responseType:"arraybuffer",headers:Xs(a)});return n(o,i)},xc=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];is(this,t);var a=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=r.withCredentials,s=void 0!==o&&o,u=r.handleManifestRedirects,c=void 0!==u&&u;if(a.hls_=n,a.withCredentials=s,a.handleManifestRedirects=c,!e)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",(function(){a.refreshXml_()})),a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)})),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"===typeof e?(a.srcUrl=e,a.sidxMapping_={},us(a)):(a.setupChildLoader(i,e),a)}return ss(t,e),as(t,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},i.a.clearTimeout(this.minimumUpdatePeriodTimeout_),i.a.clearTimeout(this.mediaRequest_),i.a.clearTimeout(this.mediaUpdateTimeout),this.off()}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,r){var i=this;return function(a,o){if(i.request){if(i.request=null,a)return i.error={status:o.status,message:"DASH playlist request error at URL: "+e.uri,response:o.response,code:2},n&&(i.state=n),i.trigger("error"),r(t,null);var s=new Uint8Array(o.response),u=We.a.parseSidx(s.subarray(8));return r(t,u)}}}},{key:"media",value:function(e){var t=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"===typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}var r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(r)if(this.media_&&this.trigger("mediachanging"),e.sidx){var a=void 0,o=void 0;this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(a=this.master,o=this.sidxMapping_);var s=gc(e.sidx);o[s]={sidxInfo:e.sidx},this.request=wc(e.sidx,e,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(e,a,n,(function(r,i){if(!r||!i)throw new Error("failed to request sidx");o[s].sidx=i,t.haveMetadata({startingState:n,playlist:r.playlists[e.id]})})))}else this.mediaRequest_=i.a.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:e}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(e){var t=this;i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=i.a.setTimeout((function(){return t.load()}),r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=Fe(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n}return hs(e,(function(t,n,r,i){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+n+"-"+r+"-"+i,o=gs(0,a);t.playlists[0].uri=a,t.playlists[0].id=o,e.playlists[o]=t.playlists[0],e.playlists[a]=t.playlists[0]}})),ys(e),bs(e),e}},{key:"start",value:function(){var e=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=i.a.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?e.masterLoaded_=Date.parse(n.responseHeaders.date):e.masterLoaded_=Date.now(),e.srcUrl=rs(e.handleManifestRedirects,e.srcUrl,n),e.syncClientServerClock_(e.onClientServerClockSync_.bind(e))}}))}},{key:"syncClientServerClock_",value:function(e){var t=this,n=Ve(this.masterXml_);return null===n?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.clientOffset_=n.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:ns(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},(function(r,i){if(t.request){if(r)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a=void 0;a="HEAD"===n.method?i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):t.masterLoaded_:Date.parse(i.responseText),t.clientOffset_=a-Date.now(),e()}})))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var e=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,e.sidxMapping_=_c(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var r=e.parseMasterXml(),a=vc(e.master,r),o=e.media().sidx;if(a)if(o){var s=gc(o);if(!e.sidxMapping_[s]){var u=e.media();e.request=wc(u.sidx,u,e.hls_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(u,r,e.state,(function(t,n){if(!t||!n)throw new Error("failed to request sidx on minimumUpdatePeriod");e.sidxMapping_[s].sidx=n,e.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod),e.refreshMedia_(e.media().id)})))}}else e.master=a;e.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod)}}))}},{key:"refreshMedia_",value:function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");var n=void 0,r=void 0;this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,r=this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,r=this.parseMasterXml());var a=vc(n,r);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[e]):(this.media_=r.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=i.a.setTimeout((function(){t.trigger("mediaupdatetimeout")}),_s(this.media(),!!a))),this.trigger("loadedplaylist")}}]),t}(fc),Tc=function(e){return Zo.log.debug?Zo.log.debug.bind(Zo,"VHS:",e+" >"):function(){}};function Cc(){}var Sc=function(){function e(t,n,r,i){is(this,e),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,this.processedAppend_=!1,this.type_=r,this.mimeType_=n,this.logger_=Tc("SourceUpdater["+r+"]["+n+"]"),"closed"===t.readyState?t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,n,i)):this.createSourceBuffer_(n,i)}return as(e,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",(function(){n.start_()})):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+xu(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_((function(){t.sourceBuffer_.abort()}),e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_((function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)}),(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()}))}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:Zo.createTimeRanges()}},{key:"remove",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cc;this.processedAppend_&&this.queueCallback_((function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)}),r)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Cc}},{key:"timestampOffset",value:function(e){var t=this;return"undefined"!==typeof e&&(this.queueCallback_((function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()})),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){var e=this,t=function t(){e.sourceBuffer_&&"open"===e.mediaSource.readyState&&e.sourceBuffer_.abort(),e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",t):t()}}]),e}(),Ec={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},kc={FAILURE:2,TIMEOUT:-101,ABORTED:-102},Rc=function(e){e.forEach((function(e){e.abort()}))},Oc=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},Ac=function(e){var t=e.target,n=Date.now()-t.requestTime,r={bandwidth:1/0,bytesReceived:0,roundTripTime:n||0};return r.bytesReceived=e.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},Ic=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:kc.TIMEOUT,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:kc.ABORTED,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:kc.FAILURE,xhr:t}:null},Nc=function(e,t){return function(n,r){var i=r.response,a=Ic(n,r);if(a)return t(a,e);if(16!==i.byteLength)return t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:kc.FAILURE,xhr:r},e);var o=new DataView(i);return e.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),t(null,e)}},Dc=function(e,t,n){return function(r,i){var a=i.response,o=Ic(r,i);return o?n(o,e):0===a.byteLength?n({status:i.status,message:"Empty HLS segment content at URL: "+i.uri,code:kc.FAILURE,xhr:i},e):(e.map.bytes=new Uint8Array(i.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=Ge.a.timescale(e.map.bytes),e.map.videoTrackIds=Ge.a.videoTrackIds(e.map.bytes),n(null,e))}},Pc=function(e,t,n){return function(r,i){var a=i.response,o=Ic(r,i),s=void 0;return o?n(o,e):0===a.byteLength?n({status:i.status,message:"Empty HLS segment content at URL: "+i.uri,code:kc.FAILURE,xhr:i},e):(e.stats=Oc(i),e.key?e.encryptedBytes=new Uint8Array(i.response):e.bytes=new Uint8Array(i.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),s=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales),s&&s.captions&&(e.captionStreams=s.captionStreams,e.fmp4Captions=s.captions)),n(null,e))}},Mc=function(e,t,n){var r=function r(i){if(i.data.source===t.requestId){e.removeEventListener("message",r);var a=i.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),n(null,t)}};e.addEventListener("message",r);var i=void 0;i=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(eu({source:t.requestId,encrypted:t.encryptedBytes,key:i,iv:t.key.iv}),[t.encryptedBytes.buffer,i.buffer])},Lc=function(e,t,n){var r=0,i=!1;return function(a,o){if(!i)return a?(i=!0,Rc(e),n(a,o)):(r+=1,r===e.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?Mc(t,o,n):n(null,o)):void 0)}},jc=function(e,t){return function(n){return e.stats=Zo.mergeOptions(e.stats,Ac(n)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(n,e)}},Bc=function(e,t,n,r,i,a,o){var s=[],u=Lc(s,n,o);if(i.key&&!i.key.bytes){var c=Zo.mergeOptions(t,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),l=Nc(i,u),d=e(c,l);s.push(d)}if(i.map&&!i.map.bytes){var p=Zo.mergeOptions(t,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:Xs(i.map)}),h=Dc(i,r,u),f=e(p,h);s.push(f)}var m=Zo.mergeOptions(t,{uri:i.resolvedUri,responseType:"arraybuffer",headers:Xs(i)}),v=Pc(i,r,u),g=e(m,v);return g.addEventListener("progress",jc(i,a)),s.push(g),function(){return Rc(s)}},Uc=function(e,t){var n=void 0;return e?(n=i.a.getComputedStyle(e),n?n[t]:""):""},Fc=function(e,t){var n=e.slice();e.sort((function(e,r){var i=t(e,r);return 0===i?n.indexOf(e)-n.indexOf(r):i}))},Vc=function(e,t){var n=void 0,r=void 0;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||i.a.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),r=r||i.a.Number.MAX_VALUE,n-r},qc=function(e,t){var n=void 0,r=void 0;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||i.a.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),r=r||i.a.Number.MAX_VALUE,n===r&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-r},Wc=function(e,t,n,r,a){var o=e.playlists.map((function(e){var t=void 0,n=void 0,r=void 0;return t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,r=e.attributes.BANDWIDTH,r=r||i.a.Number.MAX_VALUE,{bandwidth:r,width:t,height:n,playlist:e}}));Fc(o,(function(e,t){return e.bandwidth-t.bandwidth})),o=o.filter((function(e){return!Gs.isIncompatible(e.playlist)}));var s=o.filter((function(e){return Gs.isEnabled(e.playlist)}));s.length||(s=o.filter((function(e){return!Gs.isDisabled(e.playlist)})));var u=s.filter((function(e){return e.bandwidth*Ec.BANDWIDTH_VARIANCE<t})),c=u[u.length-1],l=u.filter((function(e){return e.bandwidth===c.bandwidth}))[0];if(!1===a){var d=l||s[0]||o[0];return d?d.playlist:null}var p=u.filter((function(e){return e.width&&e.height}));Fc(p,(function(e,t){return e.width-t.width}));var h=p.filter((function(e){return e.width===n&&e.height===r}));c=h[h.length-1];var f=h.filter((function(e){return e.bandwidth===c.bandwidth}))[0],m=void 0,v=void 0,g=void 0;f||(m=p.filter((function(e){return e.width>n||e.height>r})),v=m.filter((function(e){return e.width===m[0].width&&e.height===m[0].height})),c=v[v.length-1],g=v.filter((function(e){return e.bandwidth===c.bandwidth}))[0]);var y=g||f||l||s[0]||o[0];return y?y.playlist:null},zc=function(){var e=this.useDevicePixelRatio&&i.a.devicePixelRatio||1;return Wc(this.playlists.master,this.systemBandwidth,parseInt(Uc(this.tech_.el(),"width"),10)*e,parseInt(Uc(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},Gc=function(e){var t=e.master,n=e.currentTime,r=e.bandwidth,i=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,u=e.syncController,c=t.playlists.filter((function(e){return!Gs.isIncompatible(e)})),l=c.filter(Gs.isEnabled);l.length||(l=c.filter((function(e){return!Gs.isDisabled(e)})));var d=l.filter(Gs.hasAttribute.bind(null,"BANDWIDTH")),p=d.map((function(e){var t=u.getSyncPoint(e,i,s,n),c=t?1:2,l=Gs.estimateSegmentRequestTime(a,r,e),d=l*c-o;return{playlist:e,rebufferingImpact:d}})),h=p.filter((function(e){return e.rebufferingImpact<=0}));return Fc(h,(function(e,t){return Vc(t.playlist,e.playlist)})),h.length?h[0]:(Fc(p,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact})),p[0]||null)},Hc=function(){var e=this.playlists.master.playlists.filter(Gs.isEnabled);Fc(e,(function(e,t){return Vc(e,t)}));var t=e.filter((function(e){return Gu(e.attributes.CODECS).videoCodec}));return t[0]||null},$c=function(e,t,n){for(var r in n)if(!e[r]){t.trigger({type:"usage",name:"hls-608"});var i=t.textTracks().getTrackById(r);e[r]=i||t.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}},Kc=function(e){var t=e.inbandTextTracks,n=e.captionArray,r=e.timestampOffset;if(n){var i=window.WebKitDataCue||window.VTTCue;n.forEach((function(e){var n=e.stream,a=e.startTime,o=e.endTime;t[n]&&(a+=r,o+=r,t[n].addCue(new i(a,o,e.text)))}))}},Yc=500,Xc=function(e,t,n){if(!e||!t)return!1;var r=e.segments,i=n===r.length;return e.endList&&"open"===t.readyState&&i},Jc=function(e){return"number"===typeof e&&isFinite(e)},Qc=function(e,t,n){return"main"===e&&t&&n?n.containsAudio||n.containsVideo?t.containsVideo&&!n.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&n.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null},Zc=function(e,t,n){var r=t-30;e.length&&(r=Math.max(r,e.start(0)));var i=t-n;return Math.min(i,r)},el=function(e){var t=e.segment,n=t.start,r=t.end,i=e.playlist,a=i.mediaSequence,o=i.id,s=i.segments,u=void 0===s?[]:s,c=e.mediaIndex,l=e.timeline;return["appending ["+c+"] of ["+a+", "+(a+u.length)+"] from playlist ["+o+"]","["+n+" => "+r+"] in timeline ["+l+"]"].join(" ")},tl=function(e){function t(e){is(this,t);var n=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!==typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return n.bandwidth=e.bandwidth,n.throughput={rate:0,count:0},n.roundTrip=NaN,n.resetStats_(),n.mediaIndex=null,n.hasPlayed_=e.hasPlayed,n.currentTime_=e.currentTime,n.seekable_=e.seekable,n.seeking_=e.seeking,n.duration_=e.duration,n.mediaSource_=e.mediaSource,n.hls_=e.hls,n.loaderType_=e.loaderType,n.startingMedia_=void 0,n.segmentMetadataTrack_=e.segmentMetadataTrack,n.goalBufferLength_=e.goalBufferLength,n.sourceType_=e.sourceType,n.inbandTextTracks_=e.inbandTextTracks,n.state_="INIT",n.checkBufferTimeout_=null,n.error_=void 0,n.currentTimeline_=-1,n.pendingSegment_=null,n.mimeType_=null,n.sourceUpdater_=null,n.xhrOptions_=null,n.activeInitSegmentId_=null,n.initSegments_={},n.cacheEncryptionKeys_=e.cacheEncryptionKeys,n.keyCache_={},"main"===n.loaderType_?n.captionParser_=new $e.a:n.captionParser_=null,n.decrypter_=e.decrypter,n.syncController_=e.syncController,n.syncPoint_={segmentIndex:0,time:0},n.triggerSyncInfoUpdate_=function(){return n.trigger("syncinfoupdate")},n.syncController_.on("syncinfoupdate",n.triggerSyncInfoUpdate_),n.mediaSource_.addEventListener("sourceopen",(function(){return n.ended_=!1})),n.fetchAtBuffer_=!1,n.logger_=Tc("SegmentLoader["+n.loaderType_+"]"),Object.defineProperty(n,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),n}return ss(t,e),as(t,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset(),this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return"undefined"!==typeof e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():Zo.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=tu(e),r=this.initSegments_[n];return t&&!r&&e.bytes&&(this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),r||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=nu(e),r=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[n]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});var i={resolvedUri:(r||e).resolvedUri};return r&&(i.bytes=r.bytes),i}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new Sc(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var i=null;if(n&&(n.id?i=n.id:n.uri&&(i=n.uri)),this.logger_("playlist update ["+i+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var a=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),r&&(r.mediaIndex-=a,r.mediaIndex>=0&&(r.segment=e.segments[r.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,1/0,e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),Eu(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var r in this.inbandTextTracks_)Eu(e,t,this.inbandTextTracks_[r])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=i.a.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=i.a.setTimeout(this.monitorBufferTick_.bind(this),Yc)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_;return Xc(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,r,i,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var u=Math.max(0,o-i);if(!t.segments.length)return null;if(u>=this.goalBufferLength_())return null;if(!r&&u>=1)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n){t.segments[n];return s=o,this.generateSegmentInfo_(t,n+1,s,!1)}if(this.fetchAtBuffer_){var c=Gs.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}else{var l=Gs.getMediaInfoForTime(t,i,a.segmentIndex,a.time);n=l.mediaIndex,s=l.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map((function(e,t){return{timeline:e.timeline,segmentIndex:t}})).filter((function(e){return e.timeline===t.currentTimeline_}));return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,r){if(t<0||t>=e.segments.length)return null;var i=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:i.resolvedUri,mediaIndex:t,isSyncRequest:r,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:i.timeline,duration:i.duration,segment:i}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,r=this.pendingSegment_.duration,i=Gs.estimateSegmentRequestTime(r,n,this.playlist_,e.bytesReceived),a=Tu(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(i<=a)return!1;var o=Gc({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=i-a,u=s-o.rebufferingImpact,c=.5;return a<=vu&&(c=1),!o.playlist||o.playlist.uri===this.playlist_.uri||u<c?!1:(this.bandwidth=o.playlist.attributes.BANDWIDTH*Ec.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Bc(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=Zc(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var r=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=r}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===kc.ABORTED?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===kc.TIMEOUT?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&($c(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),Kc({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,n=t.segment,r=this.syncController_.probeSegmentInfo(t);"undefined"===typeof this.startingMedia_&&r&&(r.containsAudio||r.containsVideo)&&(this.startingMedia_={containsAudio:r.containsAudio,containsVideo:r.containsVideo});var i=Qc(this.loaderType_,this.startingMedia_,r);if(i)return this.error({message:i,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(r&&r.segmentTimestampInfo){var a=r.segmentTimestampInfo[0].ptsTime,o=r.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=a-o}this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset")}var s=this.syncController_.mappingForTimeline(t.timeline);if(null!==s&&this.trigger({type:"segmenttimemapping",mapping:s}),this.state="APPENDING",n.map){var u=tu(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==u){var c=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:c.bytes},(function(){e.activeInitSegmentId_=u}))}}t.byteLength=t.bytes.byteLength,"number"===typeof n.start&&"number"===typeof n.end?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(el(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,r=t.end;if(Jc(n)&&Jc(r)){Eu(n,r,this.segmentMetadataTrack_);var a=i.a.WebKitDataCue||i.a.VTTCue,o={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:r},s=JSON.stringify(o),u=new a(n,r,s);u.value=o,this.segmentMetadataTrack_.addCue(u)}}}}]),t}(Zo.EventTarget),nl=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},rl=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)}))),il=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};is(this,t);var r=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.mediaSource_=null,r.subtitlesTrack_=null,r.featuresNativeTextTracks_=e.featuresNativeTextTracks,r}return ss(t,e),as(t,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return Zo.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return Zo.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=tu(e),r=this.initSegments_[n];if(t&&!r&&e.bytes){var i=rl.byteLength+e.bytes.byteLength,a=new Uint8Array(i);a.set(e.bytes),a.set(rl,e.bytes.byteLength),this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return"undefined"===typeof e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){Eu(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t),t){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){var n=function(){e.state="READY",e.paused()||e.monitorBuffer_()};return this.syncController_.one("timestampoffset",n),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){while(e&&e.segment.empty)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var t=this.pendingSegment_,n=t.segment;if("function"!==typeof i.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var r=void 0,a=function(){e.subtitlesTrack_.tech_.off("vttjsloaded",r),e.error({message:"Error loading vtt.js"}),e.state="READY",e.pause(),e.trigger("error")};return r=function(){e.subtitlesTrack_.tech_.off("vttjserror",a),e.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",r),void this.subtitlesTrack_.tech_.one("vttjserror",a)}n.requested=!0;try{this.parseVTTCues_(t)}catch(Xl){return this.error({message:Xl.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(t,this.syncController_.timelines[t.timeline],this.playlist_),t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,t.cues.length&&this.remove(t.cues[0].endTime,t.cues[t.cues.length-1].endTime),t.cues.forEach((function(t){e.subtitlesTrack_.addCue(e.featuresNativeTextTracks_?new i.a.VTTCue(t.startTime,t.endTime,t.text):t)})),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(e){var t=void 0,n=!1;"function"===typeof i.a.TextDecoder?t=new i.a.TextDecoder("utf8"):(t=i.a.WebVTT.StringDecoder(),n=!0);var r=new i.a.WebVTT.Parser(i.a,i.a.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=e.cues.push.bind(e.cues),r.ontimestampmap=function(t){return e.timestampmap=t},r.onparsingerror=function(e){Zo.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){var a=e.segment.map.bytes;n&&(a=nl(a)),r.parse(a)}var o=e.bytes;n&&(o=nl(o)),r.parse(o),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var r=e.segment;if(t)if(e.cues.length){var i=e.timestampmap,a=i.MPEGTS/9e4-i.LOCAL+t.mapping;if(e.cues.forEach((function(e){e.startTime+=a,e.endTime+=a})),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-r.duration)}}}else r.empty=!0}}]),t}(tl),al=function(e,t){for(var n=e.cues,r=0;r<n.length;r++){var i=n[r];if(t>=i.adStartTime&&t<=i.adEndTime)return i}return null},ol=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.segments)for(var r=n,a=void 0,o=0;o<e.segments.length;o++){var s=e.segments[o];if(a||(a=al(t,r+s.duration/2)),a){if("cueIn"in s){a.endTime=r,a.adEndTime=r,r+=s.duration,a=null;continue}if(r<a.endTime){r+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&(a=new i.a.VTTCue(r,r+s.duration,s.cueOut),a.adStartTime=r,a.adEndTime=r+parseFloat(s.cueOut),t.addCue(a)),"cueOutCont"in s){var u=void 0,c=void 0,l=s.cueOutCont.split("/").map(parseFloat),d=cs(l,2);u=d[0],c=d[1],a=new i.a.VTTCue(r,r+s.duration,""),a.adStartTime=r-u,a.adEndTime=a.adStartTime+c,t.addCue(a)}r+=s.duration}},sl=Ye.a.inspect,ul=[{name:"VOD",run:function(e,t,n,r,i){if(n!==1/0){var a={time:0,segmentIndex:0};return a}return null}},{name:"ProgramDateTime",run:function(e,t,n,r,i){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;i=i||0;for(var u=0;u<a.length;u++){var c=a[u];if(c.dateTimeObject){var l=c.dateTimeObject.getTime()/1e3,d=l+e.datetimeToDisplayTime,p=Math.abs(i-d);if(null!==s&&(0===p||s<p))break;s=p,o={time:d,segmentIndex:u}}}return o}},{name:"Segment",run:function(e,t,n,r,i){var a=t.segments||[],o=null,s=null;i=i||0;for(var u=0;u<a.length;u++){var c=a[u];if(c.timeline===r&&"undefined"!==typeof c.start){var l=Math.abs(i-c.start);if(null!==s&&s<l)break;(!o||null===s||s>=l)&&(s=l,o={time:c.start,segmentIndex:u})}}return o}},{name:"Discontinuity",run:function(e,t,n,r,i){var a=null;if(i=i||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var u=t.discontinuityStarts[s],c=t.discontinuitySequence+s+1,l=e.discontinuities[c];if(l){var d=Math.abs(i-l.time);if(null!==o&&o<d)break;(!a||null===o||o>=d)&&(o=d,a={time:l.time,segmentIndex:u})}}return a}},{name:"Playlist",run:function(e,t,n,r,i){if(t.syncInfo){var a={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence};return a}return null}}],cl=function(e){function t(){is(this,t);var e=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Tc("SyncController"),e}return ss(t,e),as(t,[{key:"getSyncPoint",value:function(e,t,n,r){var i=this.runStrategies_(e,t,n,r);return i.length?this.selectSyncPoint_(i,{key:"time",value:r}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var r=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return r.segmentIndex>0&&(r.time*=-1),Math.abs(r.time+ks(e,r.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,r){for(var i=[],a=0;a<ul.length;a++){var o=ul[a],s=o.run(this,e,t,n,r);s&&(s.strategy=o.name,i.push({strategy:o.name,syncPoint:s}))}return i}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),i=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<r&&(r=o,n=e[a].syncPoint,i=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+i+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence,r=n-1;r>=0;r--){var i=e.segments[r];if(i&&"undefined"!==typeof i.start){t.syncInfo={mediaSequence:e.mediaSequence+r,time:i.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,n=e.playlist,r=void 0;return r=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e),r&&this.calculateSegmentTimeMapping_(e,r)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:t.start})),r}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Ge.a.timescale(t.map.bytes),r=Ge.a.compositionStartTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=r),{start:r,end:r+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=sl(e.bytes,this.inspectCache_),n=void 0,r=void 0,i=void 0;if(!t)return null;t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,r=t.video[1].dtsTime,i=t.video):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,r=t.audio[1].dtsTime,i=t.audio);var a={segmentTimestampInfo:i,start:n,end:r,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length};return a}},{key:"timestampOffsetForTimeline",value:function(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return"undefined"===typeof this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,r=this.timelines[e.timeline];if(null!==e.timestampOffset)r={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=r,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+r.time+"] [mapping: "+r.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+r.mapping;else{if(!r)return!1;n.start=t.start+r.mapping,n.end=t.end+r.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var i=t.discontinuityStarts[r],a=t.discontinuitySequence+r+1,o=i-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var u=void 0;u=o<0?n.start-ks(t,e.mediaIndex,i):n.end+ks(t,e.mediaIndex+1,i),this.discontinuities[a]={time:u,accuracy:s}}}}},{key:"dispose",value:function(){this.trigger("dispose"),this.off()}}]),t}(Zo.EventTarget),ll=new Lu("./decrypter-worker.worker.js",(function(e,t){var n=this;(function(){function e(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}var t=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t},o=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,u=[],c=[],l=void 0,d=void 0,p=void 0,h=void 0,f=void 0,m=void 0;for(a=0;a<256;a++)c[(u[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=l||1,s=c[s]||1)for(h=s^s<<1^s<<2^s<<3^s<<4,h=h>>8^255&h^99,r[o]=h,i[h]=o,p=u[d=u[l=u[o]]],m=16843009*p^65537*d^257*l^16843008*o,f=257*u[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=m=m<<24^m>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e},s=null,u=function(){function e(n){t(this,e),s||(s=o()),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];var r=void 0,i=void 0,a=void 0,u=void 0,c=void 0,l=this._tables[0][4],d=this._tables[1],p=n.length,h=1;if(4!==p&&6!==p&&8!==p)throw new Error("Invalid aes key size");for(u=n.slice(0),c=[],this._key=[u,c],r=p;r<4*p+28;r++)a=u[r-1],(r%p===0||8===p&&r%p===4)&&(a=l[a>>>24]<<24^l[a>>16&255]<<16^l[a>>8&255]<<8^l[255&a],r%p===0&&(a=a<<8^a>>>24^h<<24,h=h<<1^283*(h>>7))),u[r]=u[r-p]^a;for(i=0;r;i++,r--)a=u[3&i?r:r-4],c[i]=r<=4||i<4?a:d[0][l[a>>>24]]^d[1][l[a>>16&255]]^d[2][l[a>>8&255]]^d[3][l[255&a]]}return e.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],u=r^o[1],c=n^o[2],l=t^o[3],d=void 0,p=void 0,h=void 0,f=o.length/4-2,m=void 0,v=4,g=this._tables[1],y=g[0],b=g[1],_=g[2],w=g[3],x=g[4];for(m=0;m<f;m++)d=y[s>>>24]^b[u>>16&255]^_[c>>8&255]^w[255&l]^o[v],p=y[u>>>24]^b[c>>16&255]^_[l>>8&255]^w[255&s]^o[v+1],h=y[c>>>24]^b[l>>16&255]^_[s>>8&255]^w[255&u]^o[v+2],l=y[l>>>24]^b[s>>16&255]^_[u>>8&255]^w[255&c]^o[v+3],v+=4,s=d,u=p,c=h;for(m=0;m<4;m++)i[(3&-m)+a]=x[s>>>24]<<24^x[u>>16&255]<<16^x[c>>8&255]<<8^x[255&l]^o[v++],d=s,s=u,u=c,c=l,l=d},e}(),c=function(){function e(){t(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),l=function(e){function n(){t(this,n);var r=a(this,e.call(this,c));return r.jobs=[],r.delay=1,r.timeout_=null,r}return i(n,e),n.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},n.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},n}(c),d=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},p=function(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),i=new u(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,c=void 0,l=void 0,p=void 0,h=void 0,f=void 0,m=void 0,v=void 0,g=void 0;for(s=n[0],c=n[1],l=n[2],p=n[3],g=0;g<r.length;g+=4)h=d(r[g]),f=d(r[g+1]),m=d(r[g+2]),v=d(r[g+3]),i.decrypt(h,f,m,v,o,g),o[g]=d(o[g]^s),o[g+1]=d(o[g+1]^c),o[g+2]=d(o[g+2]^l),o[g+3]=d(o[g+3]^p),s=h,c=f,l=m,p=v;return a},h=function(){function n(r,i,a,o){t(this,n);var s=n.STEP,u=new Int32Array(r.buffer),c=new Uint8Array(r.byteLength),p=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(u.subarray(p,p+s),i,a,c)),p=s;p<u.length;p+=s)a=new Uint32Array([d(u[p-4]),d(u[p-3]),d(u[p-2]),d(u[p-1])]),this.asyncStream_.push(this.decryptChunk_(u.subarray(p,p+s),i,a,c));this.asyncStream_.push((function(){o(null,e(c))}))}return n.prototype.decryptChunk_=function(e,t,n,r){return function(){var i=p(e,t,n);r.set(i,e.byteOffset)}},r(n,null,[{key:"STEP",get:function(){return 32e3}}]),n}(),f=function(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];ArrayBuffer.isView(r)?t[n]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:t[n]=r})),t},m=function(e){e.onmessage=function(t){var n=t.data,r=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),i=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),a=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new h(r,i,a,(function(t,r){e.postMessage(f({source:n.source,decrypted:r}),[r.buffer])}))}},v=new m(n)})()})),dl=function(e){var t=e["default"]?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},pl=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},hl=function(e,t){t.activePlaylistLoader=e,e.load()},fl=function(e,t){return function(){var n=t.segmentLoaders,r=n[e],i=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),u=a.activePlaylistLoader;pl(r,a),s&&(s.playlistLoader?(r.resyncLoader(),hl(s.playlistLoader,a)):u&&i.resetEverything())}},ml=function(e,t){return function(){var n=t.segmentLoaders,r=n[e],i=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),u=a.activePlaylistLoader;pl(r,a),s&&(s.playlistLoader?u!==s.playlistLoader?(r.track&&r.track(o),r.resetEverything(),hl(s.playlistLoader,a)):hl(s.playlistLoader,a):i.resetEverything())}},vl={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e],i=t.blacklistCurrentPlaylist;pl(n,r);var a=r.activeTrack(),o=r.activeGroup(),s=(o.filter((function(e){return e["default"]}))[0]||o[0]).id,u=r.tracks[s];if(a!==u){for(var c in Zo.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),r.tracks)r.tracks[c].enabled=r.tracks[c]===u;r.onTrackChanged()}else i({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e];Zo.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),pl(n,r);var i=r.activeTrack();i&&(i.mode="disabled"),r.onTrackChanged()}}},gl={AUDIO:function(e,t,n){if(t){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,i),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),i),r.paused()||a.load()})),t.on("error",vl[e](e,n))}},SUBTITLES:function(e,t,n){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,i),a.track(o.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),i),r.paused()||a.load()})),t.on("error",vl[e](e,n))}},yl={AUDIO:function(e,t){var n=t.hls,r=t.sourceType,i=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],u=s.groups,c=s.tracks,l=t.masterPlaylistLoader;for(var d in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var p in u[d]||(u[d]=[]),o[e][d]){var h=o[e][d][p],f=void 0;if(f=h.resolvedUri?new ws(h.resolvedUri,n,a):h.playlists&&"dash"===r?new xc(h.playlists[0],n,a,l):null,h=Zo.mergeOptions({id:p,playlistLoader:f},h),gl[e](e,h.playlistLoader,t),u[d].push(h),"undefined"===typeof c[p]){var m=new Zo.AudioTrack({id:p,kind:dl(h),enabled:!1,language:h.language,default:h["default"],label:p});c[p]=m}}i.on("error",vl[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,r=t.hls,i=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,u=t.mediaTypes[e],c=u.groups,l=u.tracks,d=t.masterPlaylistLoader;for(var p in s[e])for(var h in c[p]||(c[p]=[]),s[e][p])if(!s[e][p][h].forced){var f=s[e][p][h],m=void 0;if("hls"===i?m=new ws(f.resolvedUri,r,o):"dash"===i&&(m=new xc(f.playlists[0],r,o,d)),f=Zo.mergeOptions({id:h,playlistLoader:m},f),gl[e](e,f.playlistLoader,t),c[p].push(f),"undefined"===typeof l[h]){var v=n.addRemoteTextTrack({id:h,kind:"subtitles",default:f["default"]&&f.autoselect,language:f.language,label:h},!1).track;l[h]=v}}a.on("error",vl[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,r=t.master.mediaGroups,i=t.mediaTypes[e],a=i.groups,o=i.tracks;for(var s in r[e])for(var u in a[s]||(a[s]=[]),r[e][s]){var c=r[e][s][u];if(c.instreamId.match(/CC\d/)&&(a[s].push(Zo.mergeOptions({id:u},c)),"undefined"===typeof o[u])){var l=n.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c["default"]&&c.autoselect,language:c.language,label:u},!1).track;o[u]=l}}}},bl=function(e,t){return function(n){var r=t.masterPlaylistLoader,i=t.mediaTypes[e].groups,a=r.media();if(!a)return null;var o=null;return a.attributes[e]&&(o=i[a.attributes[e]]),o=o||i.main,"undefined"===typeof n?o:null===n?null:o.filter((function(e){return e.id===n.id}))[0]||null}},_l={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if(n[r].enabled)return n[r];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if("showing"===n[r].mode||"hidden"===n[r].mode)return n[r];return null}}},wl=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){yl[t](t,e)}));var t=e.mediaTypes,n=e.masterPlaylistLoader,r=e.tech,i=e.hls;["AUDIO","SUBTITLES"].forEach((function(n){t[n].activeGroup=bl(n,e),t[n].activeTrack=_l[n](n,e),t[n].onGroupChanged=fl(n,e),t[n].onTrackChanged=ml(n,e)}));var a=t.AUDIO.activeGroup(),o=(a.filter((function(e){return e["default"]}))[0]||a[0]).id;t.AUDIO.tracks[o].enabled=!0,t.AUDIO.onTrackChanged(),n.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanged()}))}));var s=function(){t.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"hls-audio-change"})};for(var u in r.audioTracks().addEventListener("change",s),r.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),i.on("dispose",(function(){r.audioTracks().removeEventListener("change",s),r.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)})),r.clearTracks("audio"),t.AUDIO.tracks)r.audioTracks().addTrack(t.AUDIO.tracks[u])},xl=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Cc,activeTrack:Cc,onGroupChanged:Cc,onTrackChanged:Cc}})),e},Tl=120,Cl=void 0,Sl=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],El=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},kl=function(e){var t=e.currentPlaylist,n=e.nextPlaylist,r=e.forwardBuffer,i=e.bufferLowWaterLine,a=e.duration;e.log;return n?!t.endList||(a<Ec.MAX_BUFFER_LOW_WATER_LINE||(n.attributes.BANDWIDTH<t.attributes.BANDWIDTH||r>=i)):(Zo.log.warn("We received no playlist to switch to. Please check your stream."),!1)},Rl=function(e){function t(e){is(this,t);var n=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=e.url,i=e.handleManifestRedirects,a=e.withCredentials,o=e.tech,s=e.bandwidth,u=e.externHls,c=e.useCueTags,l=e.blacklistDuration,d=e.enableLowInitialPlaylist,p=e.cacheEncryptionKeys,h=e.sourceType;if(!r)throw new Error("A non-empty playlist URL is required");Cl=u,n.withCredentials=a,n.tech_=o,n.hls_=o.hls,n.sourceType_=h,n.useCueTags_=c,n.blacklistDuration=l,n.enableLowInitialPlaylist=d,n.useCueTags_&&(n.cueTagsTrack_=n.tech_.addTextTrack("metadata","ad-cues"),n.cueTagsTrack_.inBandMetadataTrackDispatchType=""),n.requestOptions_={withCredentials:a,handleManifestRedirects:i,timeout:null},n.mediaTypes_=xl(),n.mediaSource=new Zo.MediaSource,n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen_.bind(n)),n.seekable_=Zo.createTimeRanges(),n.hasPlayed_=!1,n.syncController_=new cl(e),n.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,n.decrypter_=new ll,n.inbandTextTracks_={};var f={hls:n.hls_,mediaSource:n.mediaSource,currentTime:n.tech_.currentTime.bind(n.tech_),seekable:function(){return n.seekable()},seeking:function(){return n.tech_.seeking()},duration:function(){return n.mediaSource.duration},hasPlayed:function(){return n.hasPlayed_},goalBufferLength:function(){return n.goalBufferLength()},bandwidth:s,syncController:n.syncController_,decrypter:n.decrypter_,sourceType:n.sourceType_,inbandTextTracks:n.inbandTextTracks_,cacheEncryptionKeys:p};return n.masterPlaylistLoader_="dash"===n.sourceType_?new xc(r,n.hls_,n.requestOptions_):new ws(r,n.hls_,n.requestOptions_),n.setupMasterPlaylistLoaderListeners_(),n.mainSegmentLoader_=new tl(Zo.mergeOptions(f,{segmentMetadataTrack:n.segmentMetadataTrack_,loaderType:"main"}),e),n.audioSegmentLoader_=new tl(Zo.mergeOptions(f,{loaderType:"audio"}),e),n.subtitleSegmentLoader_=new il(Zo.mergeOptions(f,{loaderType:"vtt",featuresNativeTextTracks:n.tech_.featuresNativeTextTracks}),e),n.setupSegmentLoaderListeners_(),Sl.forEach((function(e){n[e+"_"]=El.bind(n,e)})),n.logger_=Tc("MPC"),n.masterPlaylistLoader_.load(),n}return ss(t,e),as(t,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;zs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),wl({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(Xl){return Zo.log.warn("Failed to create SourceBuffers",Xl),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))})),this.masterPlaylistLoader_.on("loadedplaylist",(function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;return e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var r=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};if(e.duration()!==1/0){var i=function t(){e.duration()===1/0?r():e.tech_.one("durationchange",t)};e.tech_.one("durationchange",i)}else r()}})),this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)})),this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()})),this.masterPlaylistLoader_.on("mediachange",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;zs(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})})),this.masterPlaylistLoader_.on("playlistunchanged",(function(){var t=e.masterPlaylistLoader_.media(),n=e.stuckAtPlaylistEnd_(t);n&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))})),this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})})),this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},r=!0,i=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){var s=n.AUDIO[a][o];s.uri||(r=!1)}r&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),Cl.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),Cl.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),i.length&&Object.keys(n.AUDIO[i[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",(function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),r=e.tech_.buffered(),i=r.length?r.end(r.length-1)-e.tech_.currentTime():0,a=e.bufferLowWaterLine();kl({currentPlaylist:n,nextPlaylist:t,forwardBuffer:i,bufferLowWaterLine:a,duration:e.duration(),log:e.logger_})&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")})),this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("ended",(function(){e.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},Tl)})),this.mainSegmentLoader_.on("reseteverything",(function(){e.tech_.trigger("hls-reset")})),this.mainSegmentLoader_.on("segmenttimemapping",(function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})})),this.audioSegmentLoader_.on("ended",(function(){e.onEndOfStream()}))}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything((function(){Zo.browser.IE_VERSION||Zo.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())})))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(Zo.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0})),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(Xl){return Zo.log.warn("Failed to create Source Buffers",Xl),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();"undefined"!==typeof e&&"function"===typeof e.then&&e.then(null,(function(e){}))}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(Xl){Zo.log.warn("Failed to call media source endOfStream",Xl)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){var t=this.seekable();if(!t.length)return!1;var n=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===n)return!1;var r=Cl.Playlist.playlistEnd(e,n),i=this.tech_.currentTime(),a=this.tech_.buffered();if(!a.length)return r-i<=gu;var o=a.end(a.length-1);return o-i<=gu&&r-o<=gu}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,r=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(Xl){return this.trigger("error")}}var i=1===this.masterPlaylistLoader_.master.playlists.filter(Bs).length,a=this.masterPlaylistLoader_.master.playlists;return 1===a.length?(Zo.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(i)):(i&&(Zo.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),a.forEach((function(e){e.excludeUntil!==1/0&&delete e.excludeUntil})),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),r=this.selectPlaylist(),Zo.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(r,i))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=bu(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:Cl.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var n=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(null!==n){var r=this.masterPlaylistLoader_.master.suggestedPresentationDelay,i=Cl.Playlist.seekable(t,n,r);if(0!==i.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),n=this.syncController_.getExpiredTime(t,this.mediaSource.duration),null===n)return;if(e=Cl.Playlist.seekable(t,n,r),0===e.length)return}var a=void 0,o=void 0;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>i.end(0)||i.start(0)>e.end(0)?this.seekable_=i:this.seekable_=Zo.createTimeRanges([[e.start(0)>i.start(0)?e.start(0):i.start(0),e.end(0)<i.end(0)?e.end(0):i.end(0)]]):this.seekable_=i,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===o||(this.logger_("seekable updated ["+xu(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=Cl.Playlist.duration(this.masterPlaylistLoader_.media()),r=this.tech_.buffered(),i=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(Xl){Zo.log.warn("Failed to set media source duration",Xl)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};r.length>0&&(n=Math.max(n,r.end(r.length-1))),t!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",i):i())}},{key:"dispose",value:function(){var e=this;this.trigger("dispose"),this.decrypter_&&this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach((function(t){var n=e.mediaTypes_[t].groups;for(var r in n)n[r].forEach((function(e){e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.off(),this.mediaSource.dispose&&this.mediaSource.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e=this.masterPlaylistLoader_.media(),t=void 0;if(e&&"open"===this.mediaSource.readyState){if(t=Ju(this.masterPlaylistLoader_.master,e),t.length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+e.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(t),this.excludeIncompatibleVariants_(e)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new Zo.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach((function(e){e.attributes.CODECS&&i.a.MediaSource&&i.a.MediaSource.isTypeSupported&&!i.a.MediaSource.isTypeSupported('video/mp4; codecs="'+Hu(e.attributes.CODECS)+'"')&&(e.excludeUntil=1/0)}))}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,r=void 0;e.attributes.CODECS&&(r=Gu(e.attributes.CODECS),n=r.videoCodec,t=r.codecCount),this.master().playlists.forEach((function(e){var r={codecCount:2,videoCodec:null};e.attributes.CODECS&&(r=Gu(e.attributes.CODECS)),r.codecCount!==t&&(e.excludeUntil=1/0),r.videoCodec!==n&&(e.excludeUntil=1/0)}))}},{key:"updateAdCues_",value:function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),ol(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Ec.GOAL_BUFFER_LENGTH,n=Ec.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,Ec.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,r)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Ec.BUFFER_LOW_WATER_LINE,n=Ec.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,Ec.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,r)}}]),t}(Zo.EventTarget),Ol=function(e,t,n){return function(r){var i=e.master.playlists[t],a=js(i),o=Bs(i);return"undefined"===typeof r?o:(r?delete i.disabled:i.disabled=!0,r===o||a||(n(),r?e.trigger("renditionenabled"):e.trigger("renditiondisabled")),r)}},Al=function e(t,n,r){is(this,e);var i=t.masterPlaylistController_,a=t.options_.smoothQualityChange,o=a?"smooth":"fast",s=i[o+"QualityChange_"].bind(i);if(n.attributes.RESOLUTION){var u=n.attributes.RESOLUTION;this.width=u.width,this.height=u.height}this.bandwidth=n.attributes.BANDWIDTH,this.id=r,this.enabled=Ol(t.playlists,n.id,s)},Il=function(e){var t=e.playlists;e.representations=function(){return t&&t.master&&t.master.playlists?t.master.playlists.filter((function(e){return!js(e)})).map((function(t,n){return new Al(e,t,t.id)})):[]}},Nl=["seeking","seeked","pause","playing","error"],Dl=function(){function e(t){var n=this;is(this,e),this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Tc("PlaybackWatcher"),this.logger_("initialize");var r=function(){return n.monitorCurrentTime_()},a=function(){return n.techWaiting_()},o=function(){return n.cancelTimer_()},s=function(){return n.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",a),this.tech_.on(Nl,o),this.tech_.on("canplay",r),this.dispose=function(){n.logger_("dispose"),n.tech_.off("seekablechanged",s),n.tech_.off("waiting",a),n.tech_.off(Nl,o),n.tech_.off("canplay",r),n.checkCurrentTimeTimeout_&&i.a.clearTimeout(n.checkCurrentTimeTimeout_),n.cancelTimer_()}}return as(e,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&i.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=i.a.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+gu>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var e=this.tech_.seeking();if(!e)return!1;var t=this.seekable(),n=this.tech_.currentTime(),r=this.afterSeekableWindow_(t,n,this.media(),this.allowSeeksWithinUnsafeLiveWindow),i=void 0;if(r){var a=t.end(t.length-1);i=a}if(this.beforeSeekableWindow_(t,n)){var o=t.start(0);i=o+gu}return"undefined"!==typeof i&&(this.logger_("Trying to seek outside of seekable at time "+n+" with seekable range "+xu(t)+". Seeking to "+i+"."),this.tech_.setCurrentTime(i),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=bu(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var r=this.tech_.buffered(),i=_u(r,t);if(this.videoUnderflow_(i,r,t))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(i.length>0){var a=i.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+i.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;var i=e.end(e.length-1)+gu,a=!n.endList;return a&&r&&(i=e.end(e.length-1)+3*n.targetDuration),t>i}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-gu)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var r=this.gapFromVideoUnderflow_(t,n);if(r)return this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),r=_u(t,n);this.cancelTimer_(),0!==r.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+vu),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=wu(e),r=0;r<n.length;r++){var i=n.start(r),a=n.end(r);if(t-i<4&&t-i>2)return{start:i,end:a}}return null}}]),e}(),Pl={errorInterval:30,getSource:function(e){var t=this.tech({IWillNotUseThisInPlugins:!0}),n=t.currentSource_;return e(n)}},Ml=function e(t,n){var r=0,i=0,a=Zo.mergeOptions(Pl,n);t.ready((function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var o=function(){i&&t.currentTime(i)},s=function(e){null!==e&&void 0!==e&&(i=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},u=function(){if(Date.now()-r<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"===typeof a.getSource)return r=Date.now(),a.getSource.call(t,s);Zo.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},c=function e(){t.off("loadedmetadata",o),t.off("error",u),t.off("dispose",e)},l=function(n){c(),e(t,n)};t.on("error",u),t.on("dispose",c),t.reloadSourceOnError=l},Ll=function(e){Ml(this,e)},jl="1.13.2",Bl={PlaylistLoader:ws,Playlist:Gs,Decrypter:ut,AsyncStream:at,decrypt:st,utils:ou,STANDARD_PLAYLIST_SELECTOR:zc,INITIAL_PLAYLIST_SELECTOR:Hc,comparePlaylistBandwidth:Vc,comparePlaylistResolution:qc,xhr:Ks()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach((function(e){Object.defineProperty(Bl,e,{get:function(){return Zo.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Ec[e]},set:function(t){Zo.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!==typeof t||t<0?Zo.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Ec[e]=t}})}));var Ul="videojs-vhs",Fl=function(e){var t=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(t.test(e))return"hls";var n=/^application\/dash\+xml/i;return n.test(e)?"dash":null},Vl=function(e,t){for(var n=t.media(),r=-1,i=0;i<e.length;i++)if(e[i].id===n.id){r=i;break}e.selectedIndex_=r,e.trigger({selectedIndex:r,type:"change"})},ql=function(e,t){t.representations().forEach((function(t){e.addQualityLevel(t)})),Vl(e,t.playlists)};Bl.canPlaySource=function(){return Zo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Wl=function(e,t,n){if(!e)return e;var r=void 0,i=void 0;if(n.mimeType_)r=t.mimeType_,i=n.mimeType_;else{var a=Qu(t.mimeType_),o=a.parameters.codecs.split(","),s=void 0,u=void 0;o.forEach((function(e){e=e.trim(),Zu(e)?s=e:ec(e)&&(u=e)})),r=a.type+'; codecs="'+u+'"',i=a.type.replace("video","audio")+'; codecs="'+s+'"'}var c={},l=t.playlist_;for(var d in e)c[d]={audioContentType:i,videoContentType:r},l.contentProtection&&l.contentProtection[d]&&l.contentProtection[d].pssh&&(c[d].pssh=l.contentProtection[d].pssh),"string"===typeof e[d]&&(c[d].url=e[d]);return Zo.mergeOptions(e,c)},zl=function(e){var t=e.masterPlaylistController_.mainSegmentLoader_,n=e.masterPlaylistController_.audioSegmentLoader_,r=Zo.players[e.tech_.options_.playerId];if(r.eme){var i=Wl(e.source_.keySystems,t,n);i&&(r.currentSource().keySystems=i,11!==Zo.browser.IE_VERSION&&r.eme.initializeMediaKeys&&r.eme.initializeMediaKeys())}},Gl=function(){if(!window.localStorage)return null;var e=window.localStorage.getItem(Ul);if(!e)return null;try{return JSON.parse(e)}catch(Xl){return null}},Hl=function(e){if(!window.localStorage)return!1;var t=Gl();t=t?Zo.mergeOptions(t,e):e;try{window.localStorage.setItem(Ul,JSON.stringify(t))}catch(Xl){return!1}return t};Bl.supportsNativeHls=function(){var e=o.a.createElement("video");if(!Zo.getTech("Html5").isSupported())return!1;var t=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return t.some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}(),Bl.supportsNativeDash=function(){return!!Zo.getTech("Html5").isSupported()&&/maybe|probably/i.test(o.a.createElement("video").canPlayType("application/dash+xml"))}(),Bl.supportsTypeNatively=function(e){return"hls"===e?Bl.supportsNativeHls:"dash"===e&&Bl.supportsNativeDash},Bl.isSupported=function(){return Zo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var $l=Zo.getComponent("Component"),Kl=function(e){function t(e,n,r){is(this,t);var i=us(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,r.hls));if(n.options_&&n.options_.playerId){var a=Zo(n.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return Zo.log.warn("player.hls is deprecated. Use player.tech().hls instead."),n.trigger({type:"usage",name:"hls-player-access"}),i},configurable:!0}),a.vhs=i,a.dash=i,i.player_=a}if(i.tech_=n,i.source_=e,i.stats={},i.ignoreNextSeekingEvent_=!1,i.setOptions_(),i.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(i.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return i.on(o.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=o.a.fullscreenElement||o.a.webkitFullscreenElement||o.a.mozFullScreenElement||o.a.msFullscreenElement;t&&t.contains(i.tech_.el())&&i.masterPlaylistController_.smoothQualityChange_()})),i.on(i.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),i.on(i.tech_,"error",(function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()})),i.on(i.tech_,"play",i.play),i}return ss(t,e),as(t,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!==typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!==typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=Gl();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!==typeof this.options_.bandwidth&&(this.options_.bandwidth=Ec.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ec.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach((function(t){"undefined"!==typeof e.source_[t]&&(e.options_[t]=e.source_[t])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Bl,this.options_.sourceType=Fl(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e)},this.masterPlaylistController_=new Rl(this.options_),this.playbackWatcher_=new Dl(Zo.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",(function(){var e=Zo.players[n.tech_.options_.playerId];e.error(n.masterPlaylistController_.error)})),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Bl.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Bl.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;t=this.throughput>0?1/this.throughput:0;var n=Math.floor(1/(e+t));return n},set:function(){Zo.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Cu(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Cu(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",(function(){n.options_.useBandwidthFromLocalStorage&&Hl({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})})),this.masterPlaylistController_.on("selectedinitialmedia",(function(){Il(n),zl(n)})),this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&this.tech_.src(Zo.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=Zo.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",(function(){ql(e.qualityLevels_,e)})),this.playlists.on("mediachange",(function(){Vl(e.qualityLevels_,e.playlists)})))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,os(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return fu({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return mu({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),t}($l),Yl={name:"videojs-http-streaming",VERSION:jl,canHandleSource:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Zo.mergeOptions(Zo.options,t);return Yl.canPlayType(e.type,n)},handleSource:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Zo.mergeOptions(Zo.options,n);return t.hls=new Kl(e,t,r),t.hls.xhr=Ks(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Zo.mergeOptions(Zo.options,t),r=n.hls.overrideNative,i=Fl(e),a=i&&(!Bl.supportsTypeNatively(i)||r);return a?"maybe":""}};"undefined"!==typeof Zo.MediaSource&&"undefined"!==typeof Zo.URL||(Zo.MediaSource=pc,Zo.URL=hc),pc.supportsNativeMediaSources()&&Zo.getTech("Html5").registerSourceHandler(Yl,0),Zo.HlsHandler=Kl,Zo.HlsSourceHandler=Yl,Zo.Hls=Bl,Zo.use||Zo.registerComponent("Hls",Bl),Zo.options.hls=Zo.options.hls||{},Zo.registerPlugin?Zo.registerPlugin("reloadSourceOnError",Ll):Zo.plugin("reloadSourceOnError",Ll);t["default"]=Zo},f5df:function(e,t,n){var r=n("00ee"),i=n("c6b6"),a=n("b622"),o=a("toStringTag"),s="Arguments"==i(function(){return arguments}()),u=function(e,t){try{return e[t]}catch(n){}};e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=u(t=Object(e),o))?n:s?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},f772:function(e,t,n){var r=n("5692"),i=n("90e3"),a=r("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},f8bb:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return T})),n.d(t,"i",(function(){return E})),n.d(t,"c",(function(){return k})),n.d(t,"f",(function(){return R})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return N})),n.d(t,"k",(function(){return P})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return L})),n.d(t,"j",(function(){return j})),n.d(t,"b",(function(){return B}));var r=n("45ef"),i=n("46cc"),a=n("d303"),o=n("526c"),s=n("aeab"),u=n("c8ad"),c=n("5874"),l=n("9489"),d=n("04b8"),p=n("f011"),h=n("d556"),f=n("3d50"),m=n("29d85"),v=n("a80f"),g=n("673d"),y=n("3bfc"),b=n("31bb"),_=n("dbf3"),w=n("113e"),x=n("9e7b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class T{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[s,u,c,l,d,p,h,v,m,f,g,y,b,_,w,x],t=[].concat(...e.map(e=>e.json));this.opMappers=t.reduce((e,t)=>(e[t.tfOpName]=t,e),{})}transformGraph(e,t={}){const n=e.node,r=[],i=[],a=n.reduce((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")&&r.push(e[t.name]),"Const"===t.op&&i.push(e[t.name]),e),{});let s=[];const u=[];let c={},l={};null!=t&&(c=this.mapSignatureEntries(t.inputs),l=this.mapSignatureEntries(t.outputs));const d=Object.keys(a);d.forEach(e=>{const t=a[e];t.inputNames.forEach(e=>{const[n]=Object(o["a"])(e);t.inputs.push(a[n]),a[n].children.push(t)})}),0===Object.keys(l).length?d.forEach(e=>{const t=a[e];0===t.children.length&&u.push(t)}):Object.keys(l).forEach(e=>{const[t]=Object(o["a"])(e),n=a[t];null!=n&&(n.signatureKey=l[e],u.push(n))}),Object.keys(c).length>0?Object.keys(c).forEach(e=>{const[t]=Object(o["a"])(e),n=a[t];n&&(n.signatureKey=c[e],s.push(n))}):s=r;let p={};return null!=e.library&&null!=e.library.function&&(p=e.library.function.reduce((e,t)=>(e[t.signature.name]=this.mapFunction(t),e),{})),{nodes:a,inputs:s,outputs:u,weights:i,placeholders:r,signature:t,functions:p}}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,n)=>(t[e[n].name]=n,t),{})}mapNode(e){const t=Object(a["a"])(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(e=>e.startsWith("^")?e.substr(1):e),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((t,n)=>{const r=n.type;let i=void 0;switch(n.type){case"string":i=E(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=E(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":i=L(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=L(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":i=R(e.attr,n.tfName,n.defaultValue||0),void 0===i&&n.tfDeprecatedName&&(i=R(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":i=M(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=M(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":i=k(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=k(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":i=B(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=B(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":i=P(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=P(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":i=j(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=j(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":i=I(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=I(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":i=N(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=N(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":i=A(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=A(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:i,type:r},t},{})),n}mapFunction(e){const t=e.nodeDef,n=[],r=[];let i={};null!=t&&(i=t.reduce((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&r.push(e[t.name]),e),{}));const a=[],s=[];e.signature.inputArg.forEach(e=>{const[t]=Object(o["a"])(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:O(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,a.push(n),i[t]=n});const u=Object.keys(i);u.forEach(e=>{const t=i[e];t.inputNames.forEach(e=>{const[n]=Object(o["a"])(e);t.inputs.push(i[n]),i[n].children.push(t)})});const c=e.ret;e.signature.outputArg.forEach(e=>{const[t,n]=Object(o["a"])(c[e.name]),r=i[t];null!=r&&(r.defaultOutput=n,s.push(r))});const l=this.mapArgsToSignature(e);return{nodes:i,inputs:a,outputs:s,weights:r,placeholders:n,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e),{}),outputs:e.signature.outputArg.reduce((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function C(t){const n=Object(r["env"])().global;if("undefined"!==typeof n.atob)return n.atob(t);if("undefined"!==typeof e)return new e(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function S(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):C(e);return t?n:n.toLowerCase()}function E(e,t,n,r=!1){const i=e[t];return null!=i?S(i.s,r):n}function k(e,t,n){const r=e[t];return r?r.b:n}function R(e,t,n){const r=e[t]||{},i=null!=r["i"]?r["i"]:null!=r["f"]?r["f"]:n;return"number"===typeof i?i:parseInt(i,10)}function O(e){switch("string"===typeof e&&(e=i["a"][e]),e){case i["a"].DT_FLOAT:return"float32";case i["a"].DT_INT32:case i["a"].DT_INT64:case i["a"].DT_INT8:case i["a"].DT_UINT8:return"int32";case i["a"].DT_BOOL:return"bool";case i["a"].DT_DOUBLE:return"float32";case i["a"].DT_STRING:return"string";default:return null}}function A(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function I(e,t,n){const r=e[t];return r&&r.type?O(r.type):n}function N(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map(e=>O(e)):n}function D(e){if(!e.unknownRank)return null!=e.dim?e.dim.map(e=>"number"===typeof e.size?e.size:parseInt(e.size,10)):[]}function P(e,t,n){const r=e[t];return r&&r.shape?D(r.shape):n}function M(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(e=>"number"===typeof e?e:parseInt(e,10)):n}function L(e,t,n,r=!1){const i=e[t];return i&&i.list&&i.list.s?i.list.s.map(e=>S(e,r)):n}function j(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(e=>D(e)):n}function B(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n("b639").Buffer)},f97d:function(e,t){var n={"":!0,up:!0};function r(e){if("string"!==typeof e)return!1;var t=n[e.toLowerCase()];return!!t&&e.toLowerCase()}function i(e){return"number"===typeof e&&e>=0&&e<=100}function a(){var e=100,t=3,n=0,a=100,o=0,s=100,u="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!i(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!==typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!i(e))throw new Error("RegionAnchorX must be between 0 and 100.");a=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!i(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!i(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!i(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return u},set:function(e){var t=r(e);!1===t?console.warn("Scroll: an invalid or illegal string was specified."):u=t}}})}e.exports=a},fbd0:function(e,t,n){"use strict";var r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},a=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},o=function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i},s=function(e,t,n){return unescape(o(e,t,n))},u=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],r=e[t+5],i=(16&r)>>4;return i?n+20:n+10},c=function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3,i=6144&e[t+3];return i|r|n},l=function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240===(240&e[t+1])?"audio":null},d=function(e){var t=0;while(t+5<e.length){if(255===e[t]&&240===(246&e[t+1]))return r[(60&e[t+2])>>>2];t++}return null},p=function(e){var t,n,r,i;t=10,64&e[5]&&(t+=4,t+=a(e.subarray(10,14)));do{if(n=a(e.subarray(t+4,t+8)),n<1)return null;if(i=String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3]),"PRIV"===i){r=e.subarray(t+10,t+n+10);for(var o=0;o<r.byteLength;o++)if(0===r[o]){var u=s(r,0,o);if("com.apple.streaming.transportStreamTimestamp"===u){var c=r.subarray(o+1),l=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;return l*=4,l+=3&c[7],l}break}}t+=10,t+=n}while(t<e.byteLength);return null};e.exports={isLikelyAacData:i,parseId3TagSize:u,parseAdtsSize:c,parseType:l,parseSampleRate:d,parseAacTimestamp:p}},fc6a:function(e,t,n){var r=n("44ad"),i=n("1d80");e.exports=function(e){return r(i(e))}},fda2:function(e,t,n){},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(e,t,n){var r=n("4930");e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(e,t,n){var r=n("da84");e.exports=r.Promise}}]);
//# sourceMappingURL=chunk-vendors.0c7a9dff.js.map